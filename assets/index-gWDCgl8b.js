const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/coupon.service-Cr-N3BwU.js","assets/charts-CKULyBNE.js","assets/vendor-C1760L19.js","assets/pdf-IUycIs1B.js","assets/admin.service-BC-t6ThH.js","assets/MangalyaanLanding-MTEWPBW8.js","assets/use-in-view-DBmjzhnb.js","assets/NasaLanding-D6S_1iwA.js"])))=>i.map(i=>d[i]);
import{r as v0,a as _,j as s,C as kf,b as Sf,L as zf,B as jf,c as _f,P as Af,A as Ef,p as Cf,d as Tf,e as Nf,i as Rf,f as Is,g as Mf,D as Of}from"./charts-CKULyBNE.js";import{r as w0}from"./vendor-C1760L19.js";import{_ as Ze}from"./pdf-IUycIs1B.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const p of document.querySelectorAll('link[rel="modulepreload"]'))l(p);new MutationObserver(p=>{for(const c of p)if(c.type==="childList")for(const g of c.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&l(g)}).observe(document,{childList:!0,subtree:!0});function o(p){const c={};return p.integrity&&(c.integrity=p.integrity),p.referrerPolicy&&(c.referrerPolicy=p.referrerPolicy),p.crossOrigin==="use-credentials"?c.credentials="include":p.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function l(p){if(p.ep)return;p.ep=!0;const c=o(p);fetch(p.href,c)}})();var gc={exports:{}},Yn={},hc={exports:{}},fc={};var qh;function k0(){return qh||(qh=1,(function(r){function a(w,C){var ne=w.length;w.push(C);e:for(;0<ne;){var F=ne-1>>>1,q=w[F];if(0<p(q,C))w[F]=C,w[ne]=q,ne=F;else break e}}function o(w){return w.length===0?null:w[0]}function l(w){if(w.length===0)return null;var C=w[0],ne=w.pop();if(ne!==C){w[0]=ne;e:for(var F=0,q=w.length,H=q>>>1;F<H;){var oe=2*(F+1)-1,de=w[oe],Se=oe+1,Le=w[Se];if(0>p(de,ne))Se<q&&0>p(Le,de)?(w[F]=Le,w[Se]=ne,F=Se):(w[F]=de,w[oe]=ne,F=oe);else if(Se<q&&0>p(Le,ne))w[F]=Le,w[Se]=ne,F=Se;else break e}}return C}function p(w,C){var ne=w.sortIndex-C.sortIndex;return ne!==0?ne:w.id-C.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;r.unstable_now=function(){return c.now()}}else{var g=Date,h=g.now();r.unstable_now=function(){return g.now()-h}}var b=[],m=[],v=1,z=null,k=3,S=!1,j=!1,R=!1,I=!1,D=typeof setTimeout=="function"?setTimeout:null,U=typeof clearTimeout=="function"?clearTimeout:null,B=typeof setImmediate<"u"?setImmediate:null;function E(w){for(var C=o(m);C!==null;){if(C.callback===null)l(m);else if(C.startTime<=w)l(m),C.sortIndex=C.expirationTime,a(b,C);else break;C=o(m)}}function N(w){if(R=!1,E(w),!j)if(o(b)!==null)j=!0,M||(M=!0,Q());else{var C=o(m);C!==null&&se(N,C.startTime-w)}}var M=!1,y=-1,O=5,$=-1;function ee(){return I?!0:!(r.unstable_now()-$<O)}function J(){if(I=!1,M){var w=r.unstable_now();$=w;var C=!0;try{e:{j=!1,R&&(R=!1,U(y),y=-1),S=!0;var ne=k;try{t:{for(E(w),z=o(b);z!==null&&!(z.expirationTime>w&&ee());){var F=z.callback;if(typeof F=="function"){z.callback=null,k=z.priorityLevel;var q=F(z.expirationTime<=w);if(w=r.unstable_now(),typeof q=="function"){z.callback=q,E(w),C=!0;break t}z===o(b)&&l(b),E(w)}else l(b);z=o(b)}if(z!==null)C=!0;else{var H=o(m);H!==null&&se(N,H.startTime-w),C=!1}}break e}finally{z=null,k=ne,S=!1}C=void 0}}finally{C?Q():M=!1}}}var Q;if(typeof B=="function")Q=function(){B(J)};else if(typeof MessageChannel<"u"){var re=new MessageChannel,Z=re.port2;re.port1.onmessage=J,Q=function(){Z.postMessage(null)}}else Q=function(){D(J,0)};function se(w,C){y=D(function(){w(r.unstable_now())},C)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(w){w.callback=null},r.unstable_forceFrameRate=function(w){0>w||125<w?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<w?Math.floor(1e3/w):5},r.unstable_getCurrentPriorityLevel=function(){return k},r.unstable_next=function(w){switch(k){case 1:case 2:case 3:var C=3;break;default:C=k}var ne=k;k=C;try{return w()}finally{k=ne}},r.unstable_requestPaint=function(){I=!0},r.unstable_runWithPriority=function(w,C){switch(w){case 1:case 2:case 3:case 4:case 5:break;default:w=3}var ne=k;k=w;try{return C()}finally{k=ne}},r.unstable_scheduleCallback=function(w,C,ne){var F=r.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?F+ne:F):ne=F,w){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=ne+q,w={id:v++,callback:C,priorityLevel:w,startTime:ne,expirationTime:q,sortIndex:-1},ne>F?(w.sortIndex=ne,a(m,w),o(b)===null&&w===o(m)&&(R?(U(y),y=-1):R=!0,se(N,ne-F))):(w.sortIndex=q,a(b,w),j||S||(j=!0,M||(M=!0,Q()))),w},r.unstable_shouldYield=ee,r.unstable_wrapCallback=function(w){var C=k;return function(){var ne=k;k=C;try{return w.apply(this,arguments)}finally{k=ne}}}})(fc)),fc}var Hh;function S0(){return Hh||(Hh=1,hc.exports=k0()),hc.exports}var Ph;function z0(){if(Ph)return Yn;Ph=1;var r=S0(),a=v0(),o=w0();function l(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var i=2;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function p(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function c(e){var t=e,i=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(i=t.return),e=t.return;while(e)}return t.tag===3?i:null}function g(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function h(e){if(e.tag===31){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function b(e){if(c(e)!==e)throw Error(l(188))}function m(e){var t=e.alternate;if(!t){if(t=c(e),t===null)throw Error(l(188));return t!==e?null:e}for(var i=e,n=t;;){var d=i.return;if(d===null)break;var u=d.alternate;if(u===null){if(n=d.return,n!==null){i=n;continue}break}if(d.child===u.child){for(u=d.child;u;){if(u===i)return b(d),e;if(u===n)return b(d),t;u=u.sibling}throw Error(l(188))}if(i.return!==n.return)i=d,n=u;else{for(var f=!1,x=d.child;x;){if(x===i){f=!0,i=d,n=u;break}if(x===n){f=!0,n=d,i=u;break}x=x.sibling}if(!f){for(x=u.child;x;){if(x===i){f=!0,i=u,n=d;break}if(x===n){f=!0,n=u,i=d;break}x=x.sibling}if(!f)throw Error(l(189))}}if(i.alternate!==n)throw Error(l(190))}if(i.tag!==3)throw Error(l(188));return i.stateNode.current===i?e:t}function v(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=v(e),t!==null)return t;e=e.sibling}return null}var z=Object.assign,k=Symbol.for("react.element"),S=Symbol.for("react.transitional.element"),j=Symbol.for("react.portal"),R=Symbol.for("react.fragment"),I=Symbol.for("react.strict_mode"),D=Symbol.for("react.profiler"),U=Symbol.for("react.consumer"),B=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),M=Symbol.for("react.suspense_list"),y=Symbol.for("react.memo"),O=Symbol.for("react.lazy"),$=Symbol.for("react.activity"),ee=Symbol.for("react.memo_cache_sentinel"),J=Symbol.iterator;function Q(e){return e===null||typeof e!="object"?null:(e=J&&e[J]||e["@@iterator"],typeof e=="function"?e:null)}var re=Symbol.for("react.client.reference");function Z(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===re?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case R:return"Fragment";case D:return"Profiler";case I:return"StrictMode";case N:return"Suspense";case M:return"SuspenseList";case $:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case j:return"Portal";case B:return e.displayName||"Context";case U:return(e._context.displayName||"Context")+".Consumer";case E:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case y:return t=e.displayName||null,t!==null?t:Z(e.type)||"Memo";case O:t=e._payload,e=e._init;try{return Z(e(t))}catch{}}return null}var se=Array.isArray,w=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,C=o.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ne={pending:!1,data:null,method:null,action:null},F=[],q=-1;function H(e){return{current:e}}function oe(e){0>q||(e.current=F[q],F[q]=null,q--)}function de(e,t){q++,F[q]=e.current,e.current=t}var Se=H(null),Le=H(null),tt=H(null),Ye=H(null);function gt(e,t){switch(de(tt,t),de(Le,e),de(Se,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?dh(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=dh(t),e=ch(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}oe(Se),de(Se,e)}function ot(){oe(Se),oe(Le),oe(tt)}function ze(e){e.memoizedState!==null&&de(Ye,e);var t=Se.current,i=ch(t,e.type);t!==i&&(de(Le,e),de(Se,i))}function me(e){Le.current===e&&(oe(Se),oe(Le)),Ye.current===e&&(oe(Ye),Hn._currentValue=ne)}var Te,Ce;function ct(e){if(Te===void 0)try{throw Error()}catch(i){var t=i.stack.trim().match(/\n( *(at )?)/);Te=t&&t[1]||"",Ce=-1<i.stack.indexOf(`
    at`)?" (<anonymous>)":-1<i.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Te+e+Ce}var yt=!1;function V(e,t){if(!e||yt)return"";yt=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var n={DetermineComponentFrameRoot:function(){try{if(t){var ae=function(){throw Error()};if(Object.defineProperty(ae.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ae,[])}catch(K){var Y=K}Reflect.construct(e,[],ae)}else{try{ae.call()}catch(K){Y=K}e.call(ae.prototype)}}else{try{throw Error()}catch(K){Y=K}(ae=e())&&typeof ae.catch=="function"&&ae.catch(function(){})}}catch(K){if(K&&Y&&typeof K.stack=="string")return[K.stack,Y.stack]}return[null,null]}};n.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var d=Object.getOwnPropertyDescriptor(n.DetermineComponentFrameRoot,"name");d&&d.configurable&&Object.defineProperty(n.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var u=n.DetermineComponentFrameRoot(),f=u[0],x=u[1];if(f&&x){var A=f.split(`
`),G=x.split(`
`);for(d=n=0;n<A.length&&!A[n].includes("DetermineComponentFrameRoot");)n++;for(;d<G.length&&!G[d].includes("DetermineComponentFrameRoot");)d++;if(n===A.length||d===G.length)for(n=A.length-1,d=G.length-1;1<=n&&0<=d&&A[n]!==G[d];)d--;for(;1<=n&&0<=d;n--,d--)if(A[n]!==G[d]){if(n!==1||d!==1)do if(n--,d--,0>d||A[n]!==G[d]){var X=`
`+A[n].replace(" at new "," at ");return e.displayName&&X.includes("<anonymous>")&&(X=X.replace("<anonymous>",e.displayName)),X}while(1<=n&&0<=d);break}}}finally{yt=!1,Error.prepareStackTrace=i}return(i=e?e.displayName||e.name:"")?ct(i):""}function ie(e,t){switch(e.tag){case 26:case 27:case 5:return ct(e.type);case 16:return ct("Lazy");case 13:return e.child!==t&&t!==null?ct("Suspense Fallback"):ct("Suspense");case 19:return ct("SuspenseList");case 0:case 15:return V(e.type,!1);case 11:return V(e.type.render,!1);case 1:return V(e.type,!0);case 31:return ct("Activity");default:return""}}function je(e){try{var t="",i=null;do t+=ie(e,i),i=e,e=e.return;while(e);return t}catch(n){return`
Error generating stack: `+n.message+`
`+n.stack}}var Ae=Object.prototype.hasOwnProperty,le=r.unstable_scheduleCallback,ue=r.unstable_cancelCallback,pe=r.unstable_shouldYield,Ue=r.unstable_requestPaint,ye=r.unstable_now,W=r.unstable_getCurrentPriorityLevel,he=r.unstable_ImmediatePriority,qe=r.unstable_UserBlockingPriority,at=r.unstable_NormalPriority,Xr=r.unstable_LowPriority,Be=r.unstable_IdlePriority,vt=r.log,Fa=r.unstable_setDisableYieldValue,_a=null,jt=null;function ua(e){if(typeof vt=="function"&&Fa(e),jt&&typeof jt.setStrictMode=="function")try{jt.setStrictMode(_a,e)}catch{}}var $t=Math.clz32?Math.clz32:ob,rb=Math.log,nb=Math.LN2;function ob(e){return e>>>=0,e===0?32:31-(rb(e)/nb|0)|0}var co=256,uo=262144,po=4194304;function _i(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function go(e,t,i){var n=e.pendingLanes;if(n===0)return 0;var d=0,u=e.suspendedLanes,f=e.pingedLanes;e=e.warmLanes;var x=n&134217727;return x!==0?(n=x&~u,n!==0?d=_i(n):(f&=x,f!==0?d=_i(f):i||(i=x&~e,i!==0&&(d=_i(i))))):(x=n&~u,x!==0?d=_i(x):f!==0?d=_i(f):i||(i=n&~e,i!==0&&(d=_i(i)))),d===0?0:t!==0&&t!==d&&(t&u)===0&&(u=d&-d,i=t&-t,u>=i||u===32&&(i&4194048)!==0)?t:d}function Zr(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function sb(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $c(){var e=po;return po<<=1,(po&62914560)===0&&(po=4194304),e}function tl(e){for(var t=[],i=0;31>i;i++)t.push(e);return t}function en(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function lb(e,t,i,n,d,u){var f=e.pendingLanes;e.pendingLanes=i,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=i,e.entangledLanes&=i,e.errorRecoveryDisabledLanes&=i,e.shellSuspendCounter=0;var x=e.entanglements,A=e.expirationTimes,G=e.hiddenUpdates;for(i=f&~i;0<i;){var X=31-$t(i),ae=1<<X;x[X]=0,A[X]=-1;var Y=G[X];if(Y!==null)for(G[X]=null,X=0;X<Y.length;X++){var K=Y[X];K!==null&&(K.lane&=-536870913)}i&=~ae}n!==0&&Yc(e,n,0),u!==0&&d===0&&e.tag!==0&&(e.suspendedLanes|=u&~(f&~t))}function Yc(e,t,i){e.pendingLanes|=t,e.suspendedLanes&=~t;var n=31-$t(t);e.entangledLanes|=t,e.entanglements[n]=e.entanglements[n]|1073741824|i&261930}function Vc(e,t){var i=e.entangledLanes|=t;for(e=e.entanglements;i;){var n=31-$t(i),d=1<<n;d&t|e[n]&t&&(e[n]|=t),i&=~d}}function Qc(e,t){var i=t&-t;return i=(i&42)!==0?1:al(i),(i&(e.suspendedLanes|t))!==0?0:i}function al(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function il(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function Fc(){var e=C.p;return e!==0?e:(e=window.event,e===void 0?32:Mh(e.type))}function Kc(e,t){var i=C.p;try{return C.p=e,t()}finally{C.p=i}}var Ka=Math.random().toString(36).slice(2),_t="__reactFiber$"+Ka,Bt="__reactProps$"+Ka,ar="__reactContainer$"+Ka,rl="__reactEvents$"+Ka,db="__reactListeners$"+Ka,cb="__reactHandles$"+Ka,Wc="__reactResources$"+Ka,tn="__reactMarker$"+Ka;function nl(e){delete e[_t],delete e[Bt],delete e[rl],delete e[db],delete e[cb]}function ir(e){var t=e[_t];if(t)return t;for(var i=e.parentNode;i;){if(t=i[ar]||i[_t]){if(i=t.alternate,t.child!==null||i!==null&&i.child!==null)for(e=mh(e);e!==null;){if(i=e[_t])return i;e=mh(e)}return t}e=i,i=e.parentNode}return null}function rr(e){if(e=e[_t]||e[ar]){var t=e.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return e}return null}function an(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(l(33))}function nr(e){var t=e[Wc];return t||(t=e[Wc]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function St(e){e[tn]=!0}var Jc=new Set,Xc={};function Ai(e,t){or(e,t),or(e+"Capture",t)}function or(e,t){for(Xc[e]=t,e=0;e<t.length;e++)Jc.add(t[e])}var ub=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Zc={},eu={};function pb(e){return Ae.call(eu,e)?!0:Ae.call(Zc,e)?!1:ub.test(e)?eu[e]=!0:(Zc[e]=!0,!1)}function ho(e,t,i){if(pb(t))if(i===null)e.removeAttribute(t);else{switch(typeof i){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var n=t.toLowerCase().slice(0,5);if(n!=="data-"&&n!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+i)}}function fo(e,t,i){if(i===null)e.removeAttribute(t);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+i)}}function Aa(e,t,i,n){if(n===null)e.removeAttribute(i);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(i);return}e.setAttributeNS(t,i,""+n)}}function ta(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function tu(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function gb(e,t,i){var n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var d=n.get,u=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return d.call(this)},set:function(f){i=""+f,u.call(this,f)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(f){i=""+f},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ol(e){if(!e._valueTracker){var t=tu(e)?"checked":"value";e._valueTracker=gb(e,t,""+e[t])}}function au(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var i=t.getValue(),n="";return e&&(n=tu(e)?e.checked?"true":"false":e.value),e=n,e!==i?(t.setValue(e),!0):!1}function bo(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var hb=/[\n"\\]/g;function aa(e){return e.replace(hb,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function sl(e,t,i,n,d,u,f,x){e.name="",f!=null&&typeof f!="function"&&typeof f!="symbol"&&typeof f!="boolean"?e.type=f:e.removeAttribute("type"),t!=null?f==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+ta(t)):e.value!==""+ta(t)&&(e.value=""+ta(t)):f!=="submit"&&f!=="reset"||e.removeAttribute("value"),t!=null?ll(e,f,ta(t)):i!=null?ll(e,f,ta(i)):n!=null&&e.removeAttribute("value"),d==null&&u!=null&&(e.defaultChecked=!!u),d!=null&&(e.checked=d&&typeof d!="function"&&typeof d!="symbol"),x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"?e.name=""+ta(x):e.removeAttribute("name")}function iu(e,t,i,n,d,u,f,x){if(u!=null&&typeof u!="function"&&typeof u!="symbol"&&typeof u!="boolean"&&(e.type=u),t!=null||i!=null){if(!(u!=="submit"&&u!=="reset"||t!=null)){ol(e);return}i=i!=null?""+ta(i):"",t=t!=null?""+ta(t):i,x||t===e.value||(e.value=t),e.defaultValue=t}n=n??d,n=typeof n!="function"&&typeof n!="symbol"&&!!n,e.checked=x?e.checked:!!n,e.defaultChecked=!!n,f!=null&&typeof f!="function"&&typeof f!="symbol"&&typeof f!="boolean"&&(e.name=f),ol(e)}function ll(e,t,i){t==="number"&&bo(e.ownerDocument)===e||e.defaultValue===""+i||(e.defaultValue=""+i)}function sr(e,t,i,n){if(e=e.options,t){t={};for(var d=0;d<i.length;d++)t["$"+i[d]]=!0;for(i=0;i<e.length;i++)d=t.hasOwnProperty("$"+e[i].value),e[i].selected!==d&&(e[i].selected=d),d&&n&&(e[i].defaultSelected=!0)}else{for(i=""+ta(i),t=null,d=0;d<e.length;d++){if(e[d].value===i){e[d].selected=!0,n&&(e[d].defaultSelected=!0);return}t!==null||e[d].disabled||(t=e[d])}t!==null&&(t.selected=!0)}}function ru(e,t,i){if(t!=null&&(t=""+ta(t),t!==e.value&&(e.value=t),i==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=i!=null?""+ta(i):""}function nu(e,t,i,n){if(t==null){if(n!=null){if(i!=null)throw Error(l(92));if(se(n)){if(1<n.length)throw Error(l(93));n=n[0]}i=n}i==null&&(i=""),t=i}i=ta(t),e.defaultValue=i,n=e.textContent,n===i&&n!==""&&n!==null&&(e.value=n),ol(e)}function lr(e,t){if(t){var i=e.firstChild;if(i&&i===e.lastChild&&i.nodeType===3){i.nodeValue=t;return}}e.textContent=t}var fb=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ou(e,t,i){var n=t.indexOf("--")===0;i==null||typeof i=="boolean"||i===""?n?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":n?e.setProperty(t,i):typeof i!="number"||i===0||fb.has(t)?t==="float"?e.cssFloat=i:e[t]=(""+i).trim():e[t]=i+"px"}function su(e,t,i){if(t!=null&&typeof t!="object")throw Error(l(62));if(e=e.style,i!=null){for(var n in i)!i.hasOwnProperty(n)||t!=null&&t.hasOwnProperty(n)||(n.indexOf("--")===0?e.setProperty(n,""):n==="float"?e.cssFloat="":e[n]="");for(var d in t)n=t[d],t.hasOwnProperty(d)&&i[d]!==n&&ou(e,d,n)}else for(var u in t)t.hasOwnProperty(u)&&ou(e,u,t[u])}function dl(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var bb=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),mb=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function mo(e){return mb.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Ea(){}var cl=null;function ul(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var dr=null,cr=null;function lu(e){var t=rr(e);if(t&&(e=t.stateNode)){var i=e[Bt]||null;e:switch(e=t.stateNode,t.type){case"input":if(sl(e,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name),t=i.name,i.type==="radio"&&t!=null){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll('input[name="'+aa(""+t)+'"][type="radio"]'),t=0;t<i.length;t++){var n=i[t];if(n!==e&&n.form===e.form){var d=n[Bt]||null;if(!d)throw Error(l(90));sl(n,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name)}}for(t=0;t<i.length;t++)n=i[t],n.form===e.form&&au(n)}break e;case"textarea":ru(e,i.value,i.defaultValue);break e;case"select":t=i.value,t!=null&&sr(e,!!i.multiple,t,!1)}}}var pl=!1;function du(e,t,i){if(pl)return e(t,i);pl=!0;try{var n=e(t);return n}finally{if(pl=!1,(dr!==null||cr!==null)&&(rs(),dr&&(t=dr,e=cr,cr=dr=null,lu(t),e)))for(t=0;t<e.length;t++)lu(e[t])}}function rn(e,t){var i=e.stateNode;if(i===null)return null;var n=i[Bt]||null;if(n===null)return null;i=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(i&&typeof i!="function")throw Error(l(231,t,typeof i));return i}var Ca=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),gl=!1;if(Ca)try{var nn={};Object.defineProperty(nn,"passive",{get:function(){gl=!0}}),window.addEventListener("test",nn,nn),window.removeEventListener("test",nn,nn)}catch{gl=!1}var Wa=null,hl=null,xo=null;function cu(){if(xo)return xo;var e,t=hl,i=t.length,n,d="value"in Wa?Wa.value:Wa.textContent,u=d.length;for(e=0;e<i&&t[e]===d[e];e++);var f=i-e;for(n=1;n<=f&&t[i-n]===d[u-n];n++);return xo=d.slice(e,1<n?1-n:void 0)}function yo(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function vo(){return!0}function uu(){return!1}function It(e){function t(i,n,d,u,f){this._reactName=i,this._targetInst=d,this.type=n,this.nativeEvent=u,this.target=f,this.currentTarget=null;for(var x in e)e.hasOwnProperty(x)&&(i=e[x],this[x]=i?i(u):u[x]);return this.isDefaultPrevented=(u.defaultPrevented!=null?u.defaultPrevented:u.returnValue===!1)?vo:uu,this.isPropagationStopped=uu,this}return z(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=vo)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=vo)},persist:function(){},isPersistent:vo}),t}var Ei={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},wo=It(Ei),on=z({},Ei,{view:0,detail:0}),xb=It(on),fl,bl,sn,ko=z({},on,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xl,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==sn&&(sn&&e.type==="mousemove"?(fl=e.screenX-sn.screenX,bl=e.screenY-sn.screenY):bl=fl=0,sn=e),fl)},movementY:function(e){return"movementY"in e?e.movementY:bl}}),pu=It(ko),yb=z({},ko,{dataTransfer:0}),vb=It(yb),wb=z({},on,{relatedTarget:0}),ml=It(wb),kb=z({},Ei,{animationName:0,elapsedTime:0,pseudoElement:0}),Sb=It(kb),zb=z({},Ei,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),jb=It(zb),_b=z({},Ei,{data:0}),gu=It(_b),Ab={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Eb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Cb={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Tb(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Cb[e])?!!t[e]:!1}function xl(){return Tb}var Nb=z({},on,{key:function(e){if(e.key){var t=Ab[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=yo(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Eb[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xl,charCode:function(e){return e.type==="keypress"?yo(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?yo(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Rb=It(Nb),Mb=z({},ko,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),hu=It(Mb),Ob=z({},on,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xl}),Db=It(Ob),Bb=z({},Ei,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ib=It(Bb),Lb=z({},ko,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ub=It(Lb),qb=z({},Ei,{newState:0,oldState:0}),Hb=It(qb),Pb=[9,13,27,32],yl=Ca&&"CompositionEvent"in window,ln=null;Ca&&"documentMode"in document&&(ln=document.documentMode);var Gb=Ca&&"TextEvent"in window&&!ln,fu=Ca&&(!yl||ln&&8<ln&&11>=ln),bu=" ",mu=!1;function xu(e,t){switch(e){case"keyup":return Pb.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function yu(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ur=!1;function $b(e,t){switch(e){case"compositionend":return yu(t);case"keypress":return t.which!==32?null:(mu=!0,bu);case"textInput":return e=t.data,e===bu&&mu?null:e;default:return null}}function Yb(e,t){if(ur)return e==="compositionend"||!yl&&xu(e,t)?(e=cu(),xo=hl=Wa=null,ur=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return fu&&t.locale!=="ko"?null:t.data;default:return null}}var Vb={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function vu(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Vb[e.type]:t==="textarea"}function wu(e,t,i,n){dr?cr?cr.push(n):cr=[n]:dr=n,t=us(t,"onChange"),0<t.length&&(i=new wo("onChange","change",null,i,n),e.push({event:i,listeners:t}))}var dn=null,cn=null;function Qb(e){ih(e,0)}function So(e){var t=an(e);if(au(t))return e}function ku(e,t){if(e==="change")return t}var Su=!1;if(Ca){var vl;if(Ca){var wl="oninput"in document;if(!wl){var zu=document.createElement("div");zu.setAttribute("oninput","return;"),wl=typeof zu.oninput=="function"}vl=wl}else vl=!1;Su=vl&&(!document.documentMode||9<document.documentMode)}function ju(){dn&&(dn.detachEvent("onpropertychange",_u),cn=dn=null)}function _u(e){if(e.propertyName==="value"&&So(cn)){var t=[];wu(t,cn,e,ul(e)),du(Qb,t)}}function Fb(e,t,i){e==="focusin"?(ju(),dn=t,cn=i,dn.attachEvent("onpropertychange",_u)):e==="focusout"&&ju()}function Kb(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return So(cn)}function Wb(e,t){if(e==="click")return So(t)}function Jb(e,t){if(e==="input"||e==="change")return So(t)}function Xb(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Yt=typeof Object.is=="function"?Object.is:Xb;function un(e,t){if(Yt(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var i=Object.keys(e),n=Object.keys(t);if(i.length!==n.length)return!1;for(n=0;n<i.length;n++){var d=i[n];if(!Ae.call(t,d)||!Yt(e[d],t[d]))return!1}return!0}function Au(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Eu(e,t){var i=Au(e);e=0;for(var n;i;){if(i.nodeType===3){if(n=e+i.textContent.length,e<=t&&n>=t)return{node:i,offset:t-e};e=n}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=Au(i)}}function Cu(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Cu(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Tu(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=bo(e.document);t instanceof e.HTMLIFrameElement;){try{var i=typeof t.contentWindow.location.href=="string"}catch{i=!1}if(i)e=t.contentWindow;else break;t=bo(e.document)}return t}function kl(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var Zb=Ca&&"documentMode"in document&&11>=document.documentMode,pr=null,Sl=null,pn=null,zl=!1;function Nu(e,t,i){var n=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;zl||pr==null||pr!==bo(n)||(n=pr,"selectionStart"in n&&kl(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),pn&&un(pn,n)||(pn=n,n=us(Sl,"onSelect"),0<n.length&&(t=new wo("onSelect","select",null,t,i),e.push({event:t,listeners:n}),t.target=pr)))}function Ci(e,t){var i={};return i[e.toLowerCase()]=t.toLowerCase(),i["Webkit"+e]="webkit"+t,i["Moz"+e]="moz"+t,i}var gr={animationend:Ci("Animation","AnimationEnd"),animationiteration:Ci("Animation","AnimationIteration"),animationstart:Ci("Animation","AnimationStart"),transitionrun:Ci("Transition","TransitionRun"),transitionstart:Ci("Transition","TransitionStart"),transitioncancel:Ci("Transition","TransitionCancel"),transitionend:Ci("Transition","TransitionEnd")},jl={},Ru={};Ca&&(Ru=document.createElement("div").style,"AnimationEvent"in window||(delete gr.animationend.animation,delete gr.animationiteration.animation,delete gr.animationstart.animation),"TransitionEvent"in window||delete gr.transitionend.transition);function Ti(e){if(jl[e])return jl[e];if(!gr[e])return e;var t=gr[e],i;for(i in t)if(t.hasOwnProperty(i)&&i in Ru)return jl[e]=t[i];return e}var Mu=Ti("animationend"),Ou=Ti("animationiteration"),Du=Ti("animationstart"),em=Ti("transitionrun"),tm=Ti("transitionstart"),am=Ti("transitioncancel"),Bu=Ti("transitionend"),Iu=new Map,_l="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");_l.push("scrollEnd");function pa(e,t){Iu.set(e,t),Ai(t,[e])}var zo=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},ia=[],hr=0,Al=0;function jo(){for(var e=hr,t=Al=hr=0;t<e;){var i=ia[t];ia[t++]=null;var n=ia[t];ia[t++]=null;var d=ia[t];ia[t++]=null;var u=ia[t];if(ia[t++]=null,n!==null&&d!==null){var f=n.pending;f===null?d.next=d:(d.next=f.next,f.next=d),n.pending=d}u!==0&&Lu(i,d,u)}}function _o(e,t,i,n){ia[hr++]=e,ia[hr++]=t,ia[hr++]=i,ia[hr++]=n,Al|=n,e.lanes|=n,e=e.alternate,e!==null&&(e.lanes|=n)}function El(e,t,i,n){return _o(e,t,i,n),Ao(e)}function Ni(e,t){return _o(e,null,null,t),Ao(e)}function Lu(e,t,i){e.lanes|=i;var n=e.alternate;n!==null&&(n.lanes|=i);for(var d=!1,u=e.return;u!==null;)u.childLanes|=i,n=u.alternate,n!==null&&(n.childLanes|=i),u.tag===22&&(e=u.stateNode,e===null||e._visibility&1||(d=!0)),e=u,u=u.return;return e.tag===3?(u=e.stateNode,d&&t!==null&&(d=31-$t(i),e=u.hiddenUpdates,n=e[d],n===null?e[d]=[t]:n.push(t),t.lane=i|536870912),u):null}function Ao(e){if(50<On)throw On=0,Id=null,Error(l(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var fr={};function im(e,t,i,n){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vt(e,t,i,n){return new im(e,t,i,n)}function Cl(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Ta(e,t){var i=e.alternate;return i===null?(i=Vt(e.tag,t,e.key,e.mode),i.elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=t,i.type=e.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=e.flags&65011712,i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,t=e.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i.refCleanup=e.refCleanup,i}function Uu(e,t){e.flags&=65011714;var i=e.alternate;return i===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=i.childLanes,e.lanes=i.lanes,e.child=i.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=i.memoizedProps,e.memoizedState=i.memoizedState,e.updateQueue=i.updateQueue,e.type=i.type,t=i.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Eo(e,t,i,n,d,u){var f=0;if(n=e,typeof e=="function")Cl(e)&&(f=1);else if(typeof e=="string")f=l0(e,i,Se.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case $:return e=Vt(31,i,t,d),e.elementType=$,e.lanes=u,e;case R:return Ri(i.children,d,u,t);case I:f=8,d|=24;break;case D:return e=Vt(12,i,t,d|2),e.elementType=D,e.lanes=u,e;case N:return e=Vt(13,i,t,d),e.elementType=N,e.lanes=u,e;case M:return e=Vt(19,i,t,d),e.elementType=M,e.lanes=u,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case B:f=10;break e;case U:f=9;break e;case E:f=11;break e;case y:f=14;break e;case O:f=16,n=null;break e}f=29,i=Error(l(130,e===null?"null":typeof e,"")),n=null}return t=Vt(f,i,t,d),t.elementType=e,t.type=n,t.lanes=u,t}function Ri(e,t,i,n){return e=Vt(7,e,n,t),e.lanes=i,e}function Tl(e,t,i){return e=Vt(6,e,null,t),e.lanes=i,e}function qu(e){var t=Vt(18,null,null,0);return t.stateNode=e,t}function Nl(e,t,i){return t=Vt(4,e.children!==null?e.children:[],e.key,t),t.lanes=i,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Hu=new WeakMap;function ra(e,t){if(typeof e=="object"&&e!==null){var i=Hu.get(e);return i!==void 0?i:(t={value:e,source:t,stack:je(t)},Hu.set(e,t),t)}return{value:e,source:t,stack:je(t)}}var br=[],mr=0,Co=null,gn=0,na=[],oa=0,Ja=null,xa=1,ya="";function Na(e,t){br[mr++]=gn,br[mr++]=Co,Co=e,gn=t}function Pu(e,t,i){na[oa++]=xa,na[oa++]=ya,na[oa++]=Ja,Ja=e;var n=xa;e=ya;var d=32-$t(n)-1;n&=~(1<<d),i+=1;var u=32-$t(t)+d;if(30<u){var f=d-d%5;u=(n&(1<<f)-1).toString(32),n>>=f,d-=f,xa=1<<32-$t(t)+d|i<<d|n,ya=u+e}else xa=1<<u|i<<d|n,ya=e}function Rl(e){e.return!==null&&(Na(e,1),Pu(e,1,0))}function Ml(e){for(;e===Co;)Co=br[--mr],br[mr]=null,gn=br[--mr],br[mr]=null;for(;e===Ja;)Ja=na[--oa],na[oa]=null,ya=na[--oa],na[oa]=null,xa=na[--oa],na[oa]=null}function Gu(e,t){na[oa++]=xa,na[oa++]=ya,na[oa++]=Ja,xa=t.id,ya=t.overflow,Ja=e}var At=null,it=null,Ie=!1,Xa=null,sa=!1,Ol=Error(l(519));function Za(e){var t=Error(l(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw hn(ra(t,e)),Ol}function $u(e){var t=e.stateNode,i=e.type,n=e.memoizedProps;switch(t[_t]=e,t[Bt]=n,i){case"dialog":Re("cancel",t),Re("close",t);break;case"iframe":case"object":case"embed":Re("load",t);break;case"video":case"audio":for(i=0;i<Bn.length;i++)Re(Bn[i],t);break;case"source":Re("error",t);break;case"img":case"image":case"link":Re("error",t),Re("load",t);break;case"details":Re("toggle",t);break;case"input":Re("invalid",t),iu(t,n.value,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name,!0);break;case"select":Re("invalid",t);break;case"textarea":Re("invalid",t),nu(t,n.value,n.defaultValue,n.children)}i=n.children,typeof i!="string"&&typeof i!="number"&&typeof i!="bigint"||t.textContent===""+i||n.suppressHydrationWarning===!0||sh(t.textContent,i)?(n.popover!=null&&(Re("beforetoggle",t),Re("toggle",t)),n.onScroll!=null&&Re("scroll",t),n.onScrollEnd!=null&&Re("scrollend",t),n.onClick!=null&&(t.onclick=Ea),t=!0):t=!1,t||Za(e,!0)}function Yu(e){for(At=e.return;At;)switch(At.tag){case 5:case 31:case 13:sa=!1;return;case 27:case 3:sa=!0;return;default:At=At.return}}function xr(e){if(e!==At)return!1;if(!Ie)return Yu(e),Ie=!0,!1;var t=e.tag,i;if((i=t!==3&&t!==27)&&((i=t===5)&&(i=e.type,i=!(i!=="form"&&i!=="button")||Xd(e.type,e.memoizedProps)),i=!i),i&&it&&Za(e),Yu(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(317));it=bh(e)}else if(t===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(317));it=bh(e)}else t===27?(t=it,gi(e.type)?(e=ic,ic=null,it=e):it=t):it=At?da(e.stateNode.nextSibling):null;return!0}function Mi(){it=At=null,Ie=!1}function Dl(){var e=Xa;return e!==null&&(Ht===null?Ht=e:Ht.push.apply(Ht,e),Xa=null),e}function hn(e){Xa===null?Xa=[e]:Xa.push(e)}var Bl=H(null),Oi=null,Ra=null;function ei(e,t,i){de(Bl,t._currentValue),t._currentValue=i}function Ma(e){e._currentValue=Bl.current,oe(Bl)}function Il(e,t,i){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===i)break;e=e.return}}function Ll(e,t,i,n){var d=e.child;for(d!==null&&(d.return=e);d!==null;){var u=d.dependencies;if(u!==null){var f=d.child;u=u.firstContext;e:for(;u!==null;){var x=u;u=d;for(var A=0;A<t.length;A++)if(x.context===t[A]){u.lanes|=i,x=u.alternate,x!==null&&(x.lanes|=i),Il(u.return,i,e),n||(f=null);break e}u=x.next}}else if(d.tag===18){if(f=d.return,f===null)throw Error(l(341));f.lanes|=i,u=f.alternate,u!==null&&(u.lanes|=i),Il(f,i,e),f=null}else f=d.child;if(f!==null)f.return=d;else for(f=d;f!==null;){if(f===e){f=null;break}if(d=f.sibling,d!==null){d.return=f.return,f=d;break}f=f.return}d=f}}function yr(e,t,i,n){e=null;for(var d=t,u=!1;d!==null;){if(!u){if((d.flags&524288)!==0)u=!0;else if((d.flags&262144)!==0)break}if(d.tag===10){var f=d.alternate;if(f===null)throw Error(l(387));if(f=f.memoizedProps,f!==null){var x=d.type;Yt(d.pendingProps.value,f.value)||(e!==null?e.push(x):e=[x])}}else if(d===Ye.current){if(f=d.alternate,f===null)throw Error(l(387));f.memoizedState.memoizedState!==d.memoizedState.memoizedState&&(e!==null?e.push(Hn):e=[Hn])}d=d.return}e!==null&&Ll(t,e,i,n),t.flags|=262144}function To(e){for(e=e.firstContext;e!==null;){if(!Yt(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Di(e){Oi=e,Ra=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Et(e){return Vu(Oi,e)}function No(e,t){return Oi===null&&Di(e),Vu(e,t)}function Vu(e,t){var i=t._currentValue;if(t={context:t,memoizedValue:i,next:null},Ra===null){if(e===null)throw Error(l(308));Ra=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Ra=Ra.next=t;return i}var rm=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(i,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach(function(i){return i()})}},nm=r.unstable_scheduleCallback,om=r.unstable_NormalPriority,ht={$$typeof:B,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ul(){return{controller:new rm,data:new Map,refCount:0}}function fn(e){e.refCount--,e.refCount===0&&nm(om,function(){e.controller.abort()})}var bn=null,ql=0,vr=0,wr=null;function sm(e,t){if(bn===null){var i=bn=[];ql=0,vr=Gd(),wr={status:"pending",value:void 0,then:function(n){i.push(n)}}}return ql++,t.then(Qu,Qu),t}function Qu(){if(--ql===0&&bn!==null){wr!==null&&(wr.status="fulfilled");var e=bn;bn=null,vr=0,wr=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function lm(e,t){var i=[],n={status:"pending",value:null,reason:null,then:function(d){i.push(d)}};return e.then(function(){n.status="fulfilled",n.value=t;for(var d=0;d<i.length;d++)(0,i[d])(t)},function(d){for(n.status="rejected",n.reason=d,d=0;d<i.length;d++)(0,i[d])(void 0)}),n}var Fu=w.S;w.S=function(e,t){Ng=ye(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&sm(e,t),Fu!==null&&Fu(e,t)};var Bi=H(null);function Hl(){var e=Bi.current;return e!==null?e:Je.pooledCache}function Ro(e,t){t===null?de(Bi,Bi.current):de(Bi,t.pool)}function Ku(){var e=Hl();return e===null?null:{parent:ht._currentValue,pool:e}}var kr=Error(l(460)),Pl=Error(l(474)),Mo=Error(l(542)),Oo={then:function(){}};function Wu(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Ju(e,t,i){switch(i=e[i],i===void 0?e.push(t):i!==t&&(t.then(Ea,Ea),t=i),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Zu(e),e;default:if(typeof t.status=="string")t.then(Ea,Ea);else{if(e=Je,e!==null&&100<e.shellSuspendCounter)throw Error(l(482));e=t,e.status="pending",e.then(function(n){if(t.status==="pending"){var d=t;d.status="fulfilled",d.value=n}},function(n){if(t.status==="pending"){var d=t;d.status="rejected",d.reason=n}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Zu(e),e}throw Li=t,kr}}function Ii(e){try{var t=e._init;return t(e._payload)}catch(i){throw i!==null&&typeof i=="object"&&typeof i.then=="function"?(Li=i,kr):i}}var Li=null;function Xu(){if(Li===null)throw Error(l(459));var e=Li;return Li=null,e}function Zu(e){if(e===kr||e===Mo)throw Error(l(483))}var Sr=null,mn=0;function Do(e){var t=mn;return mn+=1,Sr===null&&(Sr=[]),Ju(Sr,e,t)}function xn(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function Bo(e,t){throw t.$$typeof===k?Error(l(525)):(e=Object.prototype.toString.call(t),Error(l(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function ep(e){function t(L,T){if(e){var P=L.deletions;P===null?(L.deletions=[T],L.flags|=16):P.push(T)}}function i(L,T){if(!e)return null;for(;T!==null;)t(L,T),T=T.sibling;return null}function n(L){for(var T=new Map;L!==null;)L.key!==null?T.set(L.key,L):T.set(L.index,L),L=L.sibling;return T}function d(L,T){return L=Ta(L,T),L.index=0,L.sibling=null,L}function u(L,T,P){return L.index=P,e?(P=L.alternate,P!==null?(P=P.index,P<T?(L.flags|=67108866,T):P):(L.flags|=67108866,T)):(L.flags|=1048576,T)}function f(L){return e&&L.alternate===null&&(L.flags|=67108866),L}function x(L,T,P,te){return T===null||T.tag!==6?(T=Tl(P,L.mode,te),T.return=L,T):(T=d(T,P),T.return=L,T)}function A(L,T,P,te){var xe=P.type;return xe===R?X(L,T,P.props.children,te,P.key):T!==null&&(T.elementType===xe||typeof xe=="object"&&xe!==null&&xe.$$typeof===O&&Ii(xe)===T.type)?(T=d(T,P.props),xn(T,P),T.return=L,T):(T=Eo(P.type,P.key,P.props,null,L.mode,te),xn(T,P),T.return=L,T)}function G(L,T,P,te){return T===null||T.tag!==4||T.stateNode.containerInfo!==P.containerInfo||T.stateNode.implementation!==P.implementation?(T=Nl(P,L.mode,te),T.return=L,T):(T=d(T,P.children||[]),T.return=L,T)}function X(L,T,P,te,xe){return T===null||T.tag!==7?(T=Ri(P,L.mode,te,xe),T.return=L,T):(T=d(T,P),T.return=L,T)}function ae(L,T,P){if(typeof T=="string"&&T!==""||typeof T=="number"||typeof T=="bigint")return T=Tl(""+T,L.mode,P),T.return=L,T;if(typeof T=="object"&&T!==null){switch(T.$$typeof){case S:return P=Eo(T.type,T.key,T.props,null,L.mode,P),xn(P,T),P.return=L,P;case j:return T=Nl(T,L.mode,P),T.return=L,T;case O:return T=Ii(T),ae(L,T,P)}if(se(T)||Q(T))return T=Ri(T,L.mode,P,null),T.return=L,T;if(typeof T.then=="function")return ae(L,Do(T),P);if(T.$$typeof===B)return ae(L,No(L,T),P);Bo(L,T)}return null}function Y(L,T,P,te){var xe=T!==null?T.key:null;if(typeof P=="string"&&P!==""||typeof P=="number"||typeof P=="bigint")return xe!==null?null:x(L,T,""+P,te);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case S:return P.key===xe?A(L,T,P,te):null;case j:return P.key===xe?G(L,T,P,te):null;case O:return P=Ii(P),Y(L,T,P,te)}if(se(P)||Q(P))return xe!==null?null:X(L,T,P,te,null);if(typeof P.then=="function")return Y(L,T,Do(P),te);if(P.$$typeof===B)return Y(L,T,No(L,P),te);Bo(L,P)}return null}function K(L,T,P,te,xe){if(typeof te=="string"&&te!==""||typeof te=="number"||typeof te=="bigint")return L=L.get(P)||null,x(T,L,""+te,xe);if(typeof te=="object"&&te!==null){switch(te.$$typeof){case S:return L=L.get(te.key===null?P:te.key)||null,A(T,L,te,xe);case j:return L=L.get(te.key===null?P:te.key)||null,G(T,L,te,xe);case O:return te=Ii(te),K(L,T,P,te,xe)}if(se(te)||Q(te))return L=L.get(P)||null,X(T,L,te,xe,null);if(typeof te.then=="function")return K(L,T,P,Do(te),xe);if(te.$$typeof===B)return K(L,T,P,No(T,te),xe);Bo(T,te)}return null}function ge(L,T,P,te){for(var xe=null,He=null,fe=T,Ee=T=0,Oe=null;fe!==null&&Ee<P.length;Ee++){fe.index>Ee?(Oe=fe,fe=null):Oe=fe.sibling;var Pe=Y(L,fe,P[Ee],te);if(Pe===null){fe===null&&(fe=Oe);break}e&&fe&&Pe.alternate===null&&t(L,fe),T=u(Pe,T,Ee),He===null?xe=Pe:He.sibling=Pe,He=Pe,fe=Oe}if(Ee===P.length)return i(L,fe),Ie&&Na(L,Ee),xe;if(fe===null){for(;Ee<P.length;Ee++)fe=ae(L,P[Ee],te),fe!==null&&(T=u(fe,T,Ee),He===null?xe=fe:He.sibling=fe,He=fe);return Ie&&Na(L,Ee),xe}for(fe=n(fe);Ee<P.length;Ee++)Oe=K(fe,L,Ee,P[Ee],te),Oe!==null&&(e&&Oe.alternate!==null&&fe.delete(Oe.key===null?Ee:Oe.key),T=u(Oe,T,Ee),He===null?xe=Oe:He.sibling=Oe,He=Oe);return e&&fe.forEach(function(xi){return t(L,xi)}),Ie&&Na(L,Ee),xe}function ve(L,T,P,te){if(P==null)throw Error(l(151));for(var xe=null,He=null,fe=T,Ee=T=0,Oe=null,Pe=P.next();fe!==null&&!Pe.done;Ee++,Pe=P.next()){fe.index>Ee?(Oe=fe,fe=null):Oe=fe.sibling;var xi=Y(L,fe,Pe.value,te);if(xi===null){fe===null&&(fe=Oe);break}e&&fe&&xi.alternate===null&&t(L,fe),T=u(xi,T,Ee),He===null?xe=xi:He.sibling=xi,He=xi,fe=Oe}if(Pe.done)return i(L,fe),Ie&&Na(L,Ee),xe;if(fe===null){for(;!Pe.done;Ee++,Pe=P.next())Pe=ae(L,Pe.value,te),Pe!==null&&(T=u(Pe,T,Ee),He===null?xe=Pe:He.sibling=Pe,He=Pe);return Ie&&Na(L,Ee),xe}for(fe=n(fe);!Pe.done;Ee++,Pe=P.next())Pe=K(fe,L,Ee,Pe.value,te),Pe!==null&&(e&&Pe.alternate!==null&&fe.delete(Pe.key===null?Ee:Pe.key),T=u(Pe,T,Ee),He===null?xe=Pe:He.sibling=Pe,He=Pe);return e&&fe.forEach(function(y0){return t(L,y0)}),Ie&&Na(L,Ee),xe}function We(L,T,P,te){if(typeof P=="object"&&P!==null&&P.type===R&&P.key===null&&(P=P.props.children),typeof P=="object"&&P!==null){switch(P.$$typeof){case S:e:{for(var xe=P.key;T!==null;){if(T.key===xe){if(xe=P.type,xe===R){if(T.tag===7){i(L,T.sibling),te=d(T,P.props.children),te.return=L,L=te;break e}}else if(T.elementType===xe||typeof xe=="object"&&xe!==null&&xe.$$typeof===O&&Ii(xe)===T.type){i(L,T.sibling),te=d(T,P.props),xn(te,P),te.return=L,L=te;break e}i(L,T);break}else t(L,T);T=T.sibling}P.type===R?(te=Ri(P.props.children,L.mode,te,P.key),te.return=L,L=te):(te=Eo(P.type,P.key,P.props,null,L.mode,te),xn(te,P),te.return=L,L=te)}return f(L);case j:e:{for(xe=P.key;T!==null;){if(T.key===xe)if(T.tag===4&&T.stateNode.containerInfo===P.containerInfo&&T.stateNode.implementation===P.implementation){i(L,T.sibling),te=d(T,P.children||[]),te.return=L,L=te;break e}else{i(L,T);break}else t(L,T);T=T.sibling}te=Nl(P,L.mode,te),te.return=L,L=te}return f(L);case O:return P=Ii(P),We(L,T,P,te)}if(se(P))return ge(L,T,P,te);if(Q(P)){if(xe=Q(P),typeof xe!="function")throw Error(l(150));return P=xe.call(P),ve(L,T,P,te)}if(typeof P.then=="function")return We(L,T,Do(P),te);if(P.$$typeof===B)return We(L,T,No(L,P),te);Bo(L,P)}return typeof P=="string"&&P!==""||typeof P=="number"||typeof P=="bigint"?(P=""+P,T!==null&&T.tag===6?(i(L,T.sibling),te=d(T,P),te.return=L,L=te):(i(L,T),te=Tl(P,L.mode,te),te.return=L,L=te),f(L)):i(L,T)}return function(L,T,P,te){try{mn=0;var xe=We(L,T,P,te);return Sr=null,xe}catch(fe){if(fe===kr||fe===Mo)throw fe;var He=Vt(29,fe,null,L.mode);return He.lanes=te,He.return=L,He}}}var Ui=ep(!0),tp=ep(!1),ti=!1;function Gl(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function $l(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function ai(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function ii(e,t,i){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,(Ge&2)!==0){var d=n.pending;return d===null?t.next=t:(t.next=d.next,d.next=t),n.pending=t,t=Ao(e),Lu(e,null,i),t}return _o(e,n,t,i),Ao(e)}function yn(e,t,i){if(t=t.updateQueue,t!==null&&(t=t.shared,(i&4194048)!==0)){var n=t.lanes;n&=e.pendingLanes,i|=n,t.lanes=i,Vc(e,i)}}function Yl(e,t){var i=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,i===n)){var d=null,u=null;if(i=i.firstBaseUpdate,i!==null){do{var f={lane:i.lane,tag:i.tag,payload:i.payload,callback:null,next:null};u===null?d=u=f:u=u.next=f,i=i.next}while(i!==null);u===null?d=u=t:u=u.next=t}else d=u=t;i={baseState:n.baseState,firstBaseUpdate:d,lastBaseUpdate:u,shared:n.shared,callbacks:n.callbacks},e.updateQueue=i;return}e=i.lastBaseUpdate,e===null?i.firstBaseUpdate=t:e.next=t,i.lastBaseUpdate=t}var Vl=!1;function vn(){if(Vl){var e=wr;if(e!==null)throw e}}function wn(e,t,i,n){Vl=!1;var d=e.updateQueue;ti=!1;var u=d.firstBaseUpdate,f=d.lastBaseUpdate,x=d.shared.pending;if(x!==null){d.shared.pending=null;var A=x,G=A.next;A.next=null,f===null?u=G:f.next=G,f=A;var X=e.alternate;X!==null&&(X=X.updateQueue,x=X.lastBaseUpdate,x!==f&&(x===null?X.firstBaseUpdate=G:x.next=G,X.lastBaseUpdate=A))}if(u!==null){var ae=d.baseState;f=0,X=G=A=null,x=u;do{var Y=x.lane&-536870913,K=Y!==x.lane;if(K?(Me&Y)===Y:(n&Y)===Y){Y!==0&&Y===vr&&(Vl=!0),X!==null&&(X=X.next={lane:0,tag:x.tag,payload:x.payload,callback:null,next:null});e:{var ge=e,ve=x;Y=t;var We=i;switch(ve.tag){case 1:if(ge=ve.payload,typeof ge=="function"){ae=ge.call(We,ae,Y);break e}ae=ge;break e;case 3:ge.flags=ge.flags&-65537|128;case 0:if(ge=ve.payload,Y=typeof ge=="function"?ge.call(We,ae,Y):ge,Y==null)break e;ae=z({},ae,Y);break e;case 2:ti=!0}}Y=x.callback,Y!==null&&(e.flags|=64,K&&(e.flags|=8192),K=d.callbacks,K===null?d.callbacks=[Y]:K.push(Y))}else K={lane:Y,tag:x.tag,payload:x.payload,callback:x.callback,next:null},X===null?(G=X=K,A=ae):X=X.next=K,f|=Y;if(x=x.next,x===null){if(x=d.shared.pending,x===null)break;K=x,x=K.next,K.next=null,d.lastBaseUpdate=K,d.shared.pending=null}}while(!0);X===null&&(A=ae),d.baseState=A,d.firstBaseUpdate=G,d.lastBaseUpdate=X,u===null&&(d.shared.lanes=0),li|=f,e.lanes=f,e.memoizedState=ae}}function ap(e,t){if(typeof e!="function")throw Error(l(191,e));e.call(t)}function ip(e,t){var i=e.callbacks;if(i!==null)for(e.callbacks=null,e=0;e<i.length;e++)ap(i[e],t)}var zr=H(null),Io=H(0);function rp(e,t){e=Pa,de(Io,e),de(zr,t),Pa=e|t.baseLanes}function Ql(){de(Io,Pa),de(zr,zr.current)}function Fl(){Pa=Io.current,oe(zr),oe(Io)}var Qt=H(null),la=null;function ri(e){var t=e.alternate;de(ut,ut.current&1),de(Qt,e),la===null&&(t===null||zr.current!==null||t.memoizedState!==null)&&(la=e)}function Kl(e){de(ut,ut.current),de(Qt,e),la===null&&(la=e)}function np(e){e.tag===22?(de(ut,ut.current),de(Qt,e),la===null&&(la=e)):ni()}function ni(){de(ut,ut.current),de(Qt,Qt.current)}function Ft(e){oe(Qt),la===e&&(la=null),oe(ut)}var ut=H(0);function Lo(e){for(var t=e;t!==null;){if(t.tag===13){var i=t.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||tc(i)||ac(i)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Oa=0,_e=null,Fe=null,ft=null,Uo=!1,jr=!1,qi=!1,qo=0,kn=0,_r=null,dm=0;function st(){throw Error(l(321))}function Wl(e,t){if(t===null)return!1;for(var i=0;i<t.length&&i<e.length;i++)if(!Yt(e[i],t[i]))return!1;return!0}function Jl(e,t,i,n,d,u){return Oa=u,_e=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,w.H=e===null||e.memoizedState===null?Pp:pd,qi=!1,u=i(n,d),qi=!1,jr&&(u=sp(t,i,n,d)),op(e),u}function op(e){w.H=jn;var t=Fe!==null&&Fe.next!==null;if(Oa=0,ft=Fe=_e=null,Uo=!1,kn=0,_r=null,t)throw Error(l(300));e===null||bt||(e=e.dependencies,e!==null&&To(e)&&(bt=!0))}function sp(e,t,i,n){_e=e;var d=0;do{if(jr&&(_r=null),kn=0,jr=!1,25<=d)throw Error(l(301));if(d+=1,ft=Fe=null,e.updateQueue!=null){var u=e.updateQueue;u.lastEffect=null,u.events=null,u.stores=null,u.memoCache!=null&&(u.memoCache.index=0)}w.H=Gp,u=t(i,n)}while(jr);return u}function cm(){var e=w.H,t=e.useState()[0];return t=typeof t.then=="function"?Sn(t):t,e=e.useState()[0],(Fe!==null?Fe.memoizedState:null)!==e&&(_e.flags|=1024),t}function Xl(){var e=qo!==0;return qo=0,e}function Zl(e,t,i){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i}function ed(e){if(Uo){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}Uo=!1}Oa=0,ft=Fe=_e=null,jr=!1,kn=qo=0,_r=null}function Ot(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ft===null?_e.memoizedState=ft=e:ft=ft.next=e,ft}function pt(){if(Fe===null){var e=_e.alternate;e=e!==null?e.memoizedState:null}else e=Fe.next;var t=ft===null?_e.memoizedState:ft.next;if(t!==null)ft=t,Fe=e;else{if(e===null)throw _e.alternate===null?Error(l(467)):Error(l(310));Fe=e,e={memoizedState:Fe.memoizedState,baseState:Fe.baseState,baseQueue:Fe.baseQueue,queue:Fe.queue,next:null},ft===null?_e.memoizedState=ft=e:ft=ft.next=e}return ft}function Ho(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Sn(e){var t=kn;return kn+=1,_r===null&&(_r=[]),e=Ju(_r,e,t),t=_e,(ft===null?t.memoizedState:ft.next)===null&&(t=t.alternate,w.H=t===null||t.memoizedState===null?Pp:pd),e}function Po(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Sn(e);if(e.$$typeof===B)return Et(e)}throw Error(l(438,String(e)))}function td(e){var t=null,i=_e.updateQueue;if(i!==null&&(t=i.memoCache),t==null){var n=_e.alternate;n!==null&&(n=n.updateQueue,n!==null&&(n=n.memoCache,n!=null&&(t={data:n.data.map(function(d){return d.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),i===null&&(i=Ho(),_e.updateQueue=i),i.memoCache=t,i=t.data[t.index],i===void 0)for(i=t.data[t.index]=Array(e),n=0;n<e;n++)i[n]=ee;return t.index++,i}function Da(e,t){return typeof t=="function"?t(e):t}function Go(e){var t=pt();return ad(t,Fe,e)}function ad(e,t,i){var n=e.queue;if(n===null)throw Error(l(311));n.lastRenderedReducer=i;var d=e.baseQueue,u=n.pending;if(u!==null){if(d!==null){var f=d.next;d.next=u.next,u.next=f}t.baseQueue=d=u,n.pending=null}if(u=e.baseState,d===null)e.memoizedState=u;else{t=d.next;var x=f=null,A=null,G=t,X=!1;do{var ae=G.lane&-536870913;if(ae!==G.lane?(Me&ae)===ae:(Oa&ae)===ae){var Y=G.revertLane;if(Y===0)A!==null&&(A=A.next={lane:0,revertLane:0,gesture:null,action:G.action,hasEagerState:G.hasEagerState,eagerState:G.eagerState,next:null}),ae===vr&&(X=!0);else if((Oa&Y)===Y){G=G.next,Y===vr&&(X=!0);continue}else ae={lane:0,revertLane:G.revertLane,gesture:null,action:G.action,hasEagerState:G.hasEagerState,eagerState:G.eagerState,next:null},A===null?(x=A=ae,f=u):A=A.next=ae,_e.lanes|=Y,li|=Y;ae=G.action,qi&&i(u,ae),u=G.hasEagerState?G.eagerState:i(u,ae)}else Y={lane:ae,revertLane:G.revertLane,gesture:G.gesture,action:G.action,hasEagerState:G.hasEagerState,eagerState:G.eagerState,next:null},A===null?(x=A=Y,f=u):A=A.next=Y,_e.lanes|=ae,li|=ae;G=G.next}while(G!==null&&G!==t);if(A===null?f=u:A.next=x,!Yt(u,e.memoizedState)&&(bt=!0,X&&(i=wr,i!==null)))throw i;e.memoizedState=u,e.baseState=f,e.baseQueue=A,n.lastRenderedState=u}return d===null&&(n.lanes=0),[e.memoizedState,n.dispatch]}function id(e){var t=pt(),i=t.queue;if(i===null)throw Error(l(311));i.lastRenderedReducer=e;var n=i.dispatch,d=i.pending,u=t.memoizedState;if(d!==null){i.pending=null;var f=d=d.next;do u=e(u,f.action),f=f.next;while(f!==d);Yt(u,t.memoizedState)||(bt=!0),t.memoizedState=u,t.baseQueue===null&&(t.baseState=u),i.lastRenderedState=u}return[u,n]}function lp(e,t,i){var n=_e,d=pt(),u=Ie;if(u){if(i===void 0)throw Error(l(407));i=i()}else i=t();var f=!Yt((Fe||d).memoizedState,i);if(f&&(d.memoizedState=i,bt=!0),d=d.queue,od(up.bind(null,n,d,e),[e]),d.getSnapshot!==t||f||ft!==null&&ft.memoizedState.tag&1){if(n.flags|=2048,Ar(9,{destroy:void 0},cp.bind(null,n,d,i,t),null),Je===null)throw Error(l(349));u||(Oa&127)!==0||dp(n,t,i)}return i}function dp(e,t,i){e.flags|=16384,e={getSnapshot:t,value:i},t=_e.updateQueue,t===null?(t=Ho(),_e.updateQueue=t,t.stores=[e]):(i=t.stores,i===null?t.stores=[e]:i.push(e))}function cp(e,t,i,n){t.value=i,t.getSnapshot=n,pp(t)&&gp(e)}function up(e,t,i){return i(function(){pp(t)&&gp(e)})}function pp(e){var t=e.getSnapshot;e=e.value;try{var i=t();return!Yt(e,i)}catch{return!0}}function gp(e){var t=Ni(e,2);t!==null&&Pt(t,e,2)}function rd(e){var t=Ot();if(typeof e=="function"){var i=e;if(e=i(),qi){ua(!0);try{i()}finally{ua(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Da,lastRenderedState:e},t}function hp(e,t,i,n){return e.baseState=i,ad(e,Fe,typeof n=="function"?n:Da)}function um(e,t,i,n,d){if(Vo(e))throw Error(l(485));if(e=t.action,e!==null){var u={payload:d,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(f){u.listeners.push(f)}};w.T!==null?i(!0):u.isTransition=!1,n(u),i=t.pending,i===null?(u.next=t.pending=u,fp(t,u)):(u.next=i.next,t.pending=i.next=u)}}function fp(e,t){var i=t.action,n=t.payload,d=e.state;if(t.isTransition){var u=w.T,f={};w.T=f;try{var x=i(d,n),A=w.S;A!==null&&A(f,x),bp(e,t,x)}catch(G){nd(e,t,G)}finally{u!==null&&f.types!==null&&(u.types=f.types),w.T=u}}else try{u=i(d,n),bp(e,t,u)}catch(G){nd(e,t,G)}}function bp(e,t,i){i!==null&&typeof i=="object"&&typeof i.then=="function"?i.then(function(n){mp(e,t,n)},function(n){return nd(e,t,n)}):mp(e,t,i)}function mp(e,t,i){t.status="fulfilled",t.value=i,xp(t),e.state=i,t=e.pending,t!==null&&(i=t.next,i===t?e.pending=null:(i=i.next,t.next=i,fp(e,i)))}function nd(e,t,i){var n=e.pending;if(e.pending=null,n!==null){n=n.next;do t.status="rejected",t.reason=i,xp(t),t=t.next;while(t!==n)}e.action=null}function xp(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function yp(e,t){return t}function vp(e,t){if(Ie){var i=Je.formState;if(i!==null){e:{var n=_e;if(Ie){if(it){t:{for(var d=it,u=sa;d.nodeType!==8;){if(!u){d=null;break t}if(d=da(d.nextSibling),d===null){d=null;break t}}u=d.data,d=u==="F!"||u==="F"?d:null}if(d){it=da(d.nextSibling),n=d.data==="F!";break e}}Za(n)}n=!1}n&&(t=i[0])}}return i=Ot(),i.memoizedState=i.baseState=t,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:yp,lastRenderedState:t},i.queue=n,i=Up.bind(null,_e,n),n.dispatch=i,n=rd(!1),u=ud.bind(null,_e,!1,n.queue),n=Ot(),d={state:t,dispatch:null,action:e,pending:null},n.queue=d,i=um.bind(null,_e,d,u,i),d.dispatch=i,n.memoizedState=e,[t,i,!1]}function wp(e){var t=pt();return kp(t,Fe,e)}function kp(e,t,i){if(t=ad(e,t,yp)[0],e=Go(Da)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var n=Sn(t)}catch(f){throw f===kr?Mo:f}else n=t;t=pt();var d=t.queue,u=d.dispatch;return i!==t.memoizedState&&(_e.flags|=2048,Ar(9,{destroy:void 0},pm.bind(null,d,i),null)),[n,u,e]}function pm(e,t){e.action=t}function Sp(e){var t=pt(),i=Fe;if(i!==null)return kp(t,i,e);pt(),t=t.memoizedState,i=pt();var n=i.queue.dispatch;return i.memoizedState=e,[t,n,!1]}function Ar(e,t,i,n){return e={tag:e,create:i,deps:n,inst:t,next:null},t=_e.updateQueue,t===null&&(t=Ho(),_e.updateQueue=t),i=t.lastEffect,i===null?t.lastEffect=e.next=e:(n=i.next,i.next=e,e.next=n,t.lastEffect=e),e}function zp(){return pt().memoizedState}function $o(e,t,i,n){var d=Ot();_e.flags|=e,d.memoizedState=Ar(1|t,{destroy:void 0},i,n===void 0?null:n)}function Yo(e,t,i,n){var d=pt();n=n===void 0?null:n;var u=d.memoizedState.inst;Fe!==null&&n!==null&&Wl(n,Fe.memoizedState.deps)?d.memoizedState=Ar(t,u,i,n):(_e.flags|=e,d.memoizedState=Ar(1|t,u,i,n))}function jp(e,t){$o(8390656,8,e,t)}function od(e,t){Yo(2048,8,e,t)}function gm(e){_e.flags|=4;var t=_e.updateQueue;if(t===null)t=Ho(),_e.updateQueue=t,t.events=[e];else{var i=t.events;i===null?t.events=[e]:i.push(e)}}function _p(e){var t=pt().memoizedState;return gm({ref:t,nextImpl:e}),function(){if((Ge&2)!==0)throw Error(l(440));return t.impl.apply(void 0,arguments)}}function Ap(e,t){return Yo(4,2,e,t)}function Ep(e,t){return Yo(4,4,e,t)}function Cp(e,t){if(typeof t=="function"){e=e();var i=t(e);return function(){typeof i=="function"?i():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Tp(e,t,i){i=i!=null?i.concat([e]):null,Yo(4,4,Cp.bind(null,t,e),i)}function sd(){}function Np(e,t){var i=pt();t=t===void 0?null:t;var n=i.memoizedState;return t!==null&&Wl(t,n[1])?n[0]:(i.memoizedState=[e,t],e)}function Rp(e,t){var i=pt();t=t===void 0?null:t;var n=i.memoizedState;if(t!==null&&Wl(t,n[1]))return n[0];if(n=e(),qi){ua(!0);try{e()}finally{ua(!1)}}return i.memoizedState=[n,t],n}function ld(e,t,i){return i===void 0||(Oa&1073741824)!==0&&(Me&261930)===0?e.memoizedState=t:(e.memoizedState=i,e=Mg(),_e.lanes|=e,li|=e,i)}function Mp(e,t,i,n){return Yt(i,t)?i:zr.current!==null?(e=ld(e,i,n),Yt(e,t)||(bt=!0),e):(Oa&42)===0||(Oa&1073741824)!==0&&(Me&261930)===0?(bt=!0,e.memoizedState=i):(e=Mg(),_e.lanes|=e,li|=e,t)}function Op(e,t,i,n,d){var u=C.p;C.p=u!==0&&8>u?u:8;var f=w.T,x={};w.T=x,ud(e,!1,t,i);try{var A=d(),G=w.S;if(G!==null&&G(x,A),A!==null&&typeof A=="object"&&typeof A.then=="function"){var X=lm(A,n);zn(e,t,X,Jt(e))}else zn(e,t,n,Jt(e))}catch(ae){zn(e,t,{then:function(){},status:"rejected",reason:ae},Jt())}finally{C.p=u,f!==null&&x.types!==null&&(f.types=x.types),w.T=f}}function hm(){}function dd(e,t,i,n){if(e.tag!==5)throw Error(l(476));var d=Dp(e).queue;Op(e,d,t,ne,i===null?hm:function(){return Bp(e),i(n)})}function Dp(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:ne,baseState:ne,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Da,lastRenderedState:ne},next:null};var i={};return t.next={memoizedState:i,baseState:i,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Da,lastRenderedState:i},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function Bp(e){var t=Dp(e);t.next===null&&(t=e.alternate.memoizedState),zn(e,t.next.queue,{},Jt())}function cd(){return Et(Hn)}function Ip(){return pt().memoizedState}function Lp(){return pt().memoizedState}function fm(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var i=Jt();e=ai(i);var n=ii(t,e,i);n!==null&&(Pt(n,t,i),yn(n,t,i)),t={cache:Ul()},e.payload=t;return}t=t.return}}function bm(e,t,i){var n=Jt();i={lane:n,revertLane:0,gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null},Vo(e)?qp(t,i):(i=El(e,t,i,n),i!==null&&(Pt(i,e,n),Hp(i,t,n)))}function Up(e,t,i){var n=Jt();zn(e,t,i,n)}function zn(e,t,i,n){var d={lane:n,revertLane:0,gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null};if(Vo(e))qp(t,d);else{var u=e.alternate;if(e.lanes===0&&(u===null||u.lanes===0)&&(u=t.lastRenderedReducer,u!==null))try{var f=t.lastRenderedState,x=u(f,i);if(d.hasEagerState=!0,d.eagerState=x,Yt(x,f))return _o(e,t,d,0),Je===null&&jo(),!1}catch{}if(i=El(e,t,d,n),i!==null)return Pt(i,e,n),Hp(i,t,n),!0}return!1}function ud(e,t,i,n){if(n={lane:2,revertLane:Gd(),gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},Vo(e)){if(t)throw Error(l(479))}else t=El(e,i,n,2),t!==null&&Pt(t,e,2)}function Vo(e){var t=e.alternate;return e===_e||t!==null&&t===_e}function qp(e,t){jr=Uo=!0;var i=e.pending;i===null?t.next=t:(t.next=i.next,i.next=t),e.pending=t}function Hp(e,t,i){if((i&4194048)!==0){var n=t.lanes;n&=e.pendingLanes,i|=n,t.lanes=i,Vc(e,i)}}var jn={readContext:Et,use:Po,useCallback:st,useContext:st,useEffect:st,useImperativeHandle:st,useLayoutEffect:st,useInsertionEffect:st,useMemo:st,useReducer:st,useRef:st,useState:st,useDebugValue:st,useDeferredValue:st,useTransition:st,useSyncExternalStore:st,useId:st,useHostTransitionStatus:st,useFormState:st,useActionState:st,useOptimistic:st,useMemoCache:st,useCacheRefresh:st};jn.useEffectEvent=st;var Pp={readContext:Et,use:Po,useCallback:function(e,t){return Ot().memoizedState=[e,t===void 0?null:t],e},useContext:Et,useEffect:jp,useImperativeHandle:function(e,t,i){i=i!=null?i.concat([e]):null,$o(4194308,4,Cp.bind(null,t,e),i)},useLayoutEffect:function(e,t){return $o(4194308,4,e,t)},useInsertionEffect:function(e,t){$o(4,2,e,t)},useMemo:function(e,t){var i=Ot();t=t===void 0?null:t;var n=e();if(qi){ua(!0);try{e()}finally{ua(!1)}}return i.memoizedState=[n,t],n},useReducer:function(e,t,i){var n=Ot();if(i!==void 0){var d=i(t);if(qi){ua(!0);try{i(t)}finally{ua(!1)}}}else d=t;return n.memoizedState=n.baseState=d,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:d},n.queue=e,e=e.dispatch=bm.bind(null,_e,e),[n.memoizedState,e]},useRef:function(e){var t=Ot();return e={current:e},t.memoizedState=e},useState:function(e){e=rd(e);var t=e.queue,i=Up.bind(null,_e,t);return t.dispatch=i,[e.memoizedState,i]},useDebugValue:sd,useDeferredValue:function(e,t){var i=Ot();return ld(i,e,t)},useTransition:function(){var e=rd(!1);return e=Op.bind(null,_e,e.queue,!0,!1),Ot().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,i){var n=_e,d=Ot();if(Ie){if(i===void 0)throw Error(l(407));i=i()}else{if(i=t(),Je===null)throw Error(l(349));(Me&127)!==0||dp(n,t,i)}d.memoizedState=i;var u={value:i,getSnapshot:t};return d.queue=u,jp(up.bind(null,n,u,e),[e]),n.flags|=2048,Ar(9,{destroy:void 0},cp.bind(null,n,u,i,t),null),i},useId:function(){var e=Ot(),t=Je.identifierPrefix;if(Ie){var i=ya,n=xa;i=(n&~(1<<32-$t(n)-1)).toString(32)+i,t="_"+t+"R_"+i,i=qo++,0<i&&(t+="H"+i.toString(32)),t+="_"}else i=dm++,t="_"+t+"r_"+i.toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:cd,useFormState:vp,useActionState:vp,useOptimistic:function(e){var t=Ot();t.memoizedState=t.baseState=e;var i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=i,t=ud.bind(null,_e,!0,i),i.dispatch=t,[e,t]},useMemoCache:td,useCacheRefresh:function(){return Ot().memoizedState=fm.bind(null,_e)},useEffectEvent:function(e){var t=Ot(),i={impl:e};return t.memoizedState=i,function(){if((Ge&2)!==0)throw Error(l(440));return i.impl.apply(void 0,arguments)}}},pd={readContext:Et,use:Po,useCallback:Np,useContext:Et,useEffect:od,useImperativeHandle:Tp,useInsertionEffect:Ap,useLayoutEffect:Ep,useMemo:Rp,useReducer:Go,useRef:zp,useState:function(){return Go(Da)},useDebugValue:sd,useDeferredValue:function(e,t){var i=pt();return Mp(i,Fe.memoizedState,e,t)},useTransition:function(){var e=Go(Da)[0],t=pt().memoizedState;return[typeof e=="boolean"?e:Sn(e),t]},useSyncExternalStore:lp,useId:Ip,useHostTransitionStatus:cd,useFormState:wp,useActionState:wp,useOptimistic:function(e,t){var i=pt();return hp(i,Fe,e,t)},useMemoCache:td,useCacheRefresh:Lp};pd.useEffectEvent=_p;var Gp={readContext:Et,use:Po,useCallback:Np,useContext:Et,useEffect:od,useImperativeHandle:Tp,useInsertionEffect:Ap,useLayoutEffect:Ep,useMemo:Rp,useReducer:id,useRef:zp,useState:function(){return id(Da)},useDebugValue:sd,useDeferredValue:function(e,t){var i=pt();return Fe===null?ld(i,e,t):Mp(i,Fe.memoizedState,e,t)},useTransition:function(){var e=id(Da)[0],t=pt().memoizedState;return[typeof e=="boolean"?e:Sn(e),t]},useSyncExternalStore:lp,useId:Ip,useHostTransitionStatus:cd,useFormState:Sp,useActionState:Sp,useOptimistic:function(e,t){var i=pt();return Fe!==null?hp(i,Fe,e,t):(i.baseState=e,[e,i.queue.dispatch])},useMemoCache:td,useCacheRefresh:Lp};Gp.useEffectEvent=_p;function gd(e,t,i,n){t=e.memoizedState,i=i(n,t),i=i==null?t:z({},t,i),e.memoizedState=i,e.lanes===0&&(e.updateQueue.baseState=i)}var hd={enqueueSetState:function(e,t,i){e=e._reactInternals;var n=Jt(),d=ai(n);d.payload=t,i!=null&&(d.callback=i),t=ii(e,d,n),t!==null&&(Pt(t,e,n),yn(t,e,n))},enqueueReplaceState:function(e,t,i){e=e._reactInternals;var n=Jt(),d=ai(n);d.tag=1,d.payload=t,i!=null&&(d.callback=i),t=ii(e,d,n),t!==null&&(Pt(t,e,n),yn(t,e,n))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var i=Jt(),n=ai(i);n.tag=2,t!=null&&(n.callback=t),t=ii(e,n,i),t!==null&&(Pt(t,e,i),yn(t,e,i))}};function $p(e,t,i,n,d,u,f){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,u,f):t.prototype&&t.prototype.isPureReactComponent?!un(i,n)||!un(d,u):!0}function Yp(e,t,i,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(i,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(i,n),t.state!==e&&hd.enqueueReplaceState(t,t.state,null)}function Hi(e,t){var i=t;if("ref"in t){i={};for(var n in t)n!=="ref"&&(i[n]=t[n])}if(e=e.defaultProps){i===t&&(i=z({},i));for(var d in e)i[d]===void 0&&(i[d]=e[d])}return i}function Vp(e){zo(e)}function Qp(e){console.error(e)}function Fp(e){zo(e)}function Qo(e,t){try{var i=e.onUncaughtError;i(t.value,{componentStack:t.stack})}catch(n){setTimeout(function(){throw n})}}function Kp(e,t,i){try{var n=e.onCaughtError;n(i.value,{componentStack:i.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(d){setTimeout(function(){throw d})}}function fd(e,t,i){return i=ai(i),i.tag=3,i.payload={element:null},i.callback=function(){Qo(e,t)},i}function Wp(e){return e=ai(e),e.tag=3,e}function Jp(e,t,i,n){var d=i.type.getDerivedStateFromError;if(typeof d=="function"){var u=n.value;e.payload=function(){return d(u)},e.callback=function(){Kp(t,i,n)}}var f=i.stateNode;f!==null&&typeof f.componentDidCatch=="function"&&(e.callback=function(){Kp(t,i,n),typeof d!="function"&&(di===null?di=new Set([this]):di.add(this));var x=n.stack;this.componentDidCatch(n.value,{componentStack:x!==null?x:""})})}function mm(e,t,i,n,d){if(i.flags|=32768,n!==null&&typeof n=="object"&&typeof n.then=="function"){if(t=i.alternate,t!==null&&yr(t,i,d,!0),i=Qt.current,i!==null){switch(i.tag){case 31:case 13:return la===null?ns():i.alternate===null&&lt===0&&(lt=3),i.flags&=-257,i.flags|=65536,i.lanes=d,n===Oo?i.flags|=16384:(t=i.updateQueue,t===null?i.updateQueue=new Set([n]):t.add(n),qd(e,n,d)),!1;case 22:return i.flags|=65536,n===Oo?i.flags|=16384:(t=i.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([n])},i.updateQueue=t):(i=t.retryQueue,i===null?t.retryQueue=new Set([n]):i.add(n)),qd(e,n,d)),!1}throw Error(l(435,i.tag))}return qd(e,n,d),ns(),!1}if(Ie)return t=Qt.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=d,n!==Ol&&(e=Error(l(422),{cause:n}),hn(ra(e,i)))):(n!==Ol&&(t=Error(l(423),{cause:n}),hn(ra(t,i))),e=e.current.alternate,e.flags|=65536,d&=-d,e.lanes|=d,n=ra(n,i),d=fd(e.stateNode,n,d),Yl(e,d),lt!==4&&(lt=2)),!1;var u=Error(l(520),{cause:n});if(u=ra(u,i),Mn===null?Mn=[u]:Mn.push(u),lt!==4&&(lt=2),t===null)return!0;n=ra(n,i),i=t;do{switch(i.tag){case 3:return i.flags|=65536,e=d&-d,i.lanes|=e,e=fd(i.stateNode,n,e),Yl(i,e),!1;case 1:if(t=i.type,u=i.stateNode,(i.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||u!==null&&typeof u.componentDidCatch=="function"&&(di===null||!di.has(u))))return i.flags|=65536,d&=-d,i.lanes|=d,d=Wp(d),Jp(d,e,i,n),Yl(i,d),!1}i=i.return}while(i!==null);return!1}var bd=Error(l(461)),bt=!1;function Ct(e,t,i,n){t.child=e===null?tp(t,null,i,n):Ui(t,e.child,i,n)}function Xp(e,t,i,n,d){i=i.render;var u=t.ref;if("ref"in n){var f={};for(var x in n)x!=="ref"&&(f[x]=n[x])}else f=n;return Di(t),n=Jl(e,t,i,f,u,d),x=Xl(),e!==null&&!bt?(Zl(e,t,d),Ba(e,t,d)):(Ie&&x&&Rl(t),t.flags|=1,Ct(e,t,n,d),t.child)}function Zp(e,t,i,n,d){if(e===null){var u=i.type;return typeof u=="function"&&!Cl(u)&&u.defaultProps===void 0&&i.compare===null?(t.tag=15,t.type=u,eg(e,t,u,n,d)):(e=Eo(i.type,null,n,t,t.mode,d),e.ref=t.ref,e.return=t,t.child=e)}if(u=e.child,!zd(e,d)){var f=u.memoizedProps;if(i=i.compare,i=i!==null?i:un,i(f,n)&&e.ref===t.ref)return Ba(e,t,d)}return t.flags|=1,e=Ta(u,n),e.ref=t.ref,e.return=t,t.child=e}function eg(e,t,i,n,d){if(e!==null){var u=e.memoizedProps;if(un(u,n)&&e.ref===t.ref)if(bt=!1,t.pendingProps=n=u,zd(e,d))(e.flags&131072)!==0&&(bt=!0);else return t.lanes=e.lanes,Ba(e,t,d)}return md(e,t,i,n,d)}function tg(e,t,i,n){var d=n.children,u=e!==null?e.memoizedState:null;if(e===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),n.mode==="hidden"){if((t.flags&128)!==0){if(u=u!==null?u.baseLanes|i:i,e!==null){for(n=t.child=e.child,d=0;n!==null;)d=d|n.lanes|n.childLanes,n=n.sibling;n=d&~u}else n=0,t.child=null;return ag(e,t,u,i,n)}if((i&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&Ro(t,u!==null?u.cachePool:null),u!==null?rp(t,u):Ql(),np(t);else return n=t.lanes=536870912,ag(e,t,u!==null?u.baseLanes|i:i,i,n)}else u!==null?(Ro(t,u.cachePool),rp(t,u),ni(),t.memoizedState=null):(e!==null&&Ro(t,null),Ql(),ni());return Ct(e,t,d,i),t.child}function _n(e,t){return e!==null&&e.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function ag(e,t,i,n,d){var u=Hl();return u=u===null?null:{parent:ht._currentValue,pool:u},t.memoizedState={baseLanes:i,cachePool:u},e!==null&&Ro(t,null),Ql(),np(t),e!==null&&yr(e,t,n,!0),t.childLanes=d,null}function Fo(e,t){return t=Wo({mode:t.mode,children:t.children},e.mode),t.ref=e.ref,e.child=t,t.return=e,t}function ig(e,t,i){return Ui(t,e.child,null,i),e=Fo(t,t.pendingProps),e.flags|=2,Ft(t),t.memoizedState=null,e}function xm(e,t,i){var n=t.pendingProps,d=(t.flags&128)!==0;if(t.flags&=-129,e===null){if(Ie){if(n.mode==="hidden")return e=Fo(t,n),t.lanes=536870912,_n(null,e);if(Kl(t),(e=it)?(e=fh(e,sa),e=e!==null&&e.data==="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:Ja!==null?{id:xa,overflow:ya}:null,retryLane:536870912,hydrationErrors:null},i=qu(e),i.return=t,t.child=i,At=t,it=null)):e=null,e===null)throw Za(t);return t.lanes=536870912,null}return Fo(t,n)}var u=e.memoizedState;if(u!==null){var f=u.dehydrated;if(Kl(t),d)if(t.flags&256)t.flags&=-257,t=ig(e,t,i);else if(t.memoizedState!==null)t.child=e.child,t.flags|=128,t=null;else throw Error(l(558));else if(bt||yr(e,t,i,!1),d=(i&e.childLanes)!==0,bt||d){if(n=Je,n!==null&&(f=Qc(n,i),f!==0&&f!==u.retryLane))throw u.retryLane=f,Ni(e,f),Pt(n,e,f),bd;ns(),t=ig(e,t,i)}else e=u.treeContext,it=da(f.nextSibling),At=t,Ie=!0,Xa=null,sa=!1,e!==null&&Gu(t,e),t=Fo(t,n),t.flags|=4096;return t}return e=Ta(e.child,{mode:n.mode,children:n.children}),e.ref=t.ref,t.child=e,e.return=t,e}function Ko(e,t){var i=t.ref;if(i===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof i!="function"&&typeof i!="object")throw Error(l(284));(e===null||e.ref!==i)&&(t.flags|=4194816)}}function md(e,t,i,n,d){return Di(t),i=Jl(e,t,i,n,void 0,d),n=Xl(),e!==null&&!bt?(Zl(e,t,d),Ba(e,t,d)):(Ie&&n&&Rl(t),t.flags|=1,Ct(e,t,i,d),t.child)}function rg(e,t,i,n,d,u){return Di(t),t.updateQueue=null,i=sp(t,n,i,d),op(e),n=Xl(),e!==null&&!bt?(Zl(e,t,u),Ba(e,t,u)):(Ie&&n&&Rl(t),t.flags|=1,Ct(e,t,i,u),t.child)}function ng(e,t,i,n,d){if(Di(t),t.stateNode===null){var u=fr,f=i.contextType;typeof f=="object"&&f!==null&&(u=Et(f)),u=new i(n,u),t.memoizedState=u.state!==null&&u.state!==void 0?u.state:null,u.updater=hd,t.stateNode=u,u._reactInternals=t,u=t.stateNode,u.props=n,u.state=t.memoizedState,u.refs={},Gl(t),f=i.contextType,u.context=typeof f=="object"&&f!==null?Et(f):fr,u.state=t.memoizedState,f=i.getDerivedStateFromProps,typeof f=="function"&&(gd(t,i,f,n),u.state=t.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof u.getSnapshotBeforeUpdate=="function"||typeof u.UNSAFE_componentWillMount!="function"&&typeof u.componentWillMount!="function"||(f=u.state,typeof u.componentWillMount=="function"&&u.componentWillMount(),typeof u.UNSAFE_componentWillMount=="function"&&u.UNSAFE_componentWillMount(),f!==u.state&&hd.enqueueReplaceState(u,u.state,null),wn(t,n,u,d),vn(),u.state=t.memoizedState),typeof u.componentDidMount=="function"&&(t.flags|=4194308),n=!0}else if(e===null){u=t.stateNode;var x=t.memoizedProps,A=Hi(i,x);u.props=A;var G=u.context,X=i.contextType;f=fr,typeof X=="object"&&X!==null&&(f=Et(X));var ae=i.getDerivedStateFromProps;X=typeof ae=="function"||typeof u.getSnapshotBeforeUpdate=="function",x=t.pendingProps!==x,X||typeof u.UNSAFE_componentWillReceiveProps!="function"&&typeof u.componentWillReceiveProps!="function"||(x||G!==f)&&Yp(t,u,n,f),ti=!1;var Y=t.memoizedState;u.state=Y,wn(t,n,u,d),vn(),G=t.memoizedState,x||Y!==G||ti?(typeof ae=="function"&&(gd(t,i,ae,n),G=t.memoizedState),(A=ti||$p(t,i,A,n,Y,G,f))?(X||typeof u.UNSAFE_componentWillMount!="function"&&typeof u.componentWillMount!="function"||(typeof u.componentWillMount=="function"&&u.componentWillMount(),typeof u.UNSAFE_componentWillMount=="function"&&u.UNSAFE_componentWillMount()),typeof u.componentDidMount=="function"&&(t.flags|=4194308)):(typeof u.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=G),u.props=n,u.state=G,u.context=f,n=A):(typeof u.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{u=t.stateNode,$l(e,t),f=t.memoizedProps,X=Hi(i,f),u.props=X,ae=t.pendingProps,Y=u.context,G=i.contextType,A=fr,typeof G=="object"&&G!==null&&(A=Et(G)),x=i.getDerivedStateFromProps,(G=typeof x=="function"||typeof u.getSnapshotBeforeUpdate=="function")||typeof u.UNSAFE_componentWillReceiveProps!="function"&&typeof u.componentWillReceiveProps!="function"||(f!==ae||Y!==A)&&Yp(t,u,n,A),ti=!1,Y=t.memoizedState,u.state=Y,wn(t,n,u,d),vn();var K=t.memoizedState;f!==ae||Y!==K||ti||e!==null&&e.dependencies!==null&&To(e.dependencies)?(typeof x=="function"&&(gd(t,i,x,n),K=t.memoizedState),(X=ti||$p(t,i,X,n,Y,K,A)||e!==null&&e.dependencies!==null&&To(e.dependencies))?(G||typeof u.UNSAFE_componentWillUpdate!="function"&&typeof u.componentWillUpdate!="function"||(typeof u.componentWillUpdate=="function"&&u.componentWillUpdate(n,K,A),typeof u.UNSAFE_componentWillUpdate=="function"&&u.UNSAFE_componentWillUpdate(n,K,A)),typeof u.componentDidUpdate=="function"&&(t.flags|=4),typeof u.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof u.componentDidUpdate!="function"||f===e.memoizedProps&&Y===e.memoizedState||(t.flags|=4),typeof u.getSnapshotBeforeUpdate!="function"||f===e.memoizedProps&&Y===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=K),u.props=n,u.state=K,u.context=A,n=X):(typeof u.componentDidUpdate!="function"||f===e.memoizedProps&&Y===e.memoizedState||(t.flags|=4),typeof u.getSnapshotBeforeUpdate!="function"||f===e.memoizedProps&&Y===e.memoizedState||(t.flags|=1024),n=!1)}return u=n,Ko(e,t),n=(t.flags&128)!==0,u||n?(u=t.stateNode,i=n&&typeof i.getDerivedStateFromError!="function"?null:u.render(),t.flags|=1,e!==null&&n?(t.child=Ui(t,e.child,null,d),t.child=Ui(t,null,i,d)):Ct(e,t,i,d),t.memoizedState=u.state,e=t.child):e=Ba(e,t,d),e}function og(e,t,i,n){return Mi(),t.flags|=256,Ct(e,t,i,n),t.child}var xd={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function yd(e){return{baseLanes:e,cachePool:Ku()}}function vd(e,t,i){return e=e!==null?e.childLanes&~i:0,t&&(e|=Wt),e}function sg(e,t,i){var n=t.pendingProps,d=!1,u=(t.flags&128)!==0,f;if((f=u)||(f=e!==null&&e.memoizedState===null?!1:(ut.current&2)!==0),f&&(d=!0,t.flags&=-129),f=(t.flags&32)!==0,t.flags&=-33,e===null){if(Ie){if(d?ri(t):ni(),(e=it)?(e=fh(e,sa),e=e!==null&&e.data!=="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:Ja!==null?{id:xa,overflow:ya}:null,retryLane:536870912,hydrationErrors:null},i=qu(e),i.return=t,t.child=i,At=t,it=null)):e=null,e===null)throw Za(t);return ac(e)?t.lanes=32:t.lanes=536870912,null}var x=n.children;return n=n.fallback,d?(ni(),d=t.mode,x=Wo({mode:"hidden",children:x},d),n=Ri(n,d,i,null),x.return=t,n.return=t,x.sibling=n,t.child=x,n=t.child,n.memoizedState=yd(i),n.childLanes=vd(e,f,i),t.memoizedState=xd,_n(null,n)):(ri(t),wd(t,x))}var A=e.memoizedState;if(A!==null&&(x=A.dehydrated,x!==null)){if(u)t.flags&256?(ri(t),t.flags&=-257,t=kd(e,t,i)):t.memoizedState!==null?(ni(),t.child=e.child,t.flags|=128,t=null):(ni(),x=n.fallback,d=t.mode,n=Wo({mode:"visible",children:n.children},d),x=Ri(x,d,i,null),x.flags|=2,n.return=t,x.return=t,n.sibling=x,t.child=n,Ui(t,e.child,null,i),n=t.child,n.memoizedState=yd(i),n.childLanes=vd(e,f,i),t.memoizedState=xd,t=_n(null,n));else if(ri(t),ac(x)){if(f=x.nextSibling&&x.nextSibling.dataset,f)var G=f.dgst;f=G,n=Error(l(419)),n.stack="",n.digest=f,hn({value:n,source:null,stack:null}),t=kd(e,t,i)}else if(bt||yr(e,t,i,!1),f=(i&e.childLanes)!==0,bt||f){if(f=Je,f!==null&&(n=Qc(f,i),n!==0&&n!==A.retryLane))throw A.retryLane=n,Ni(e,n),Pt(f,e,n),bd;tc(x)||ns(),t=kd(e,t,i)}else tc(x)?(t.flags|=192,t.child=e.child,t=null):(e=A.treeContext,it=da(x.nextSibling),At=t,Ie=!0,Xa=null,sa=!1,e!==null&&Gu(t,e),t=wd(t,n.children),t.flags|=4096);return t}return d?(ni(),x=n.fallback,d=t.mode,A=e.child,G=A.sibling,n=Ta(A,{mode:"hidden",children:n.children}),n.subtreeFlags=A.subtreeFlags&65011712,G!==null?x=Ta(G,x):(x=Ri(x,d,i,null),x.flags|=2),x.return=t,n.return=t,n.sibling=x,t.child=n,_n(null,n),n=t.child,x=e.child.memoizedState,x===null?x=yd(i):(d=x.cachePool,d!==null?(A=ht._currentValue,d=d.parent!==A?{parent:A,pool:A}:d):d=Ku(),x={baseLanes:x.baseLanes|i,cachePool:d}),n.memoizedState=x,n.childLanes=vd(e,f,i),t.memoizedState=xd,_n(e.child,n)):(ri(t),i=e.child,e=i.sibling,i=Ta(i,{mode:"visible",children:n.children}),i.return=t,i.sibling=null,e!==null&&(f=t.deletions,f===null?(t.deletions=[e],t.flags|=16):f.push(e)),t.child=i,t.memoizedState=null,i)}function wd(e,t){return t=Wo({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function Wo(e,t){return e=Vt(22,e,null,t),e.lanes=0,e}function kd(e,t,i){return Ui(t,e.child,null,i),e=wd(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function lg(e,t,i){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Il(e.return,t,i)}function Sd(e,t,i,n,d,u){var f=e.memoizedState;f===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:i,tailMode:d,treeForkCount:u}:(f.isBackwards=t,f.rendering=null,f.renderingStartTime=0,f.last=n,f.tail=i,f.tailMode=d,f.treeForkCount=u)}function dg(e,t,i){var n=t.pendingProps,d=n.revealOrder,u=n.tail;n=n.children;var f=ut.current,x=(f&2)!==0;if(x?(f=f&1|2,t.flags|=128):f&=1,de(ut,f),Ct(e,t,n,i),n=Ie?gn:0,!x&&e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&lg(e,i,t);else if(e.tag===19)lg(e,i,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(d){case"forwards":for(i=t.child,d=null;i!==null;)e=i.alternate,e!==null&&Lo(e)===null&&(d=i),i=i.sibling;i=d,i===null?(d=t.child,t.child=null):(d=i.sibling,i.sibling=null),Sd(t,!1,d,i,u,n);break;case"backwards":case"unstable_legacy-backwards":for(i=null,d=t.child,t.child=null;d!==null;){if(e=d.alternate,e!==null&&Lo(e)===null){t.child=d;break}e=d.sibling,d.sibling=i,i=d,d=e}Sd(t,!0,i,null,u,n);break;case"together":Sd(t,!1,null,null,void 0,n);break;default:t.memoizedState=null}return t.child}function Ba(e,t,i){if(e!==null&&(t.dependencies=e.dependencies),li|=t.lanes,(i&t.childLanes)===0)if(e!==null){if(yr(e,t,i,!1),(i&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(l(153));if(t.child!==null){for(e=t.child,i=Ta(e,e.pendingProps),t.child=i,i.return=t;e.sibling!==null;)e=e.sibling,i=i.sibling=Ta(e,e.pendingProps),i.return=t;i.sibling=null}return t.child}function zd(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&To(e)))}function ym(e,t,i){switch(t.tag){case 3:gt(t,t.stateNode.containerInfo),ei(t,ht,e.memoizedState.cache),Mi();break;case 27:case 5:ze(t);break;case 4:gt(t,t.stateNode.containerInfo);break;case 10:ei(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,Kl(t),null;break;case 13:var n=t.memoizedState;if(n!==null)return n.dehydrated!==null?(ri(t),t.flags|=128,null):(i&t.child.childLanes)!==0?sg(e,t,i):(ri(t),e=Ba(e,t,i),e!==null?e.sibling:null);ri(t);break;case 19:var d=(e.flags&128)!==0;if(n=(i&t.childLanes)!==0,n||(yr(e,t,i,!1),n=(i&t.childLanes)!==0),d){if(n)return dg(e,t,i);t.flags|=128}if(d=t.memoizedState,d!==null&&(d.rendering=null,d.tail=null,d.lastEffect=null),de(ut,ut.current),n)break;return null;case 22:return t.lanes=0,tg(e,t,i,t.pendingProps);case 24:ei(t,ht,e.memoizedState.cache)}return Ba(e,t,i)}function cg(e,t,i){if(e!==null)if(e.memoizedProps!==t.pendingProps)bt=!0;else{if(!zd(e,i)&&(t.flags&128)===0)return bt=!1,ym(e,t,i);bt=(e.flags&131072)!==0}else bt=!1,Ie&&(t.flags&1048576)!==0&&Pu(t,gn,t.index);switch(t.lanes=0,t.tag){case 16:e:{var n=t.pendingProps;if(e=Ii(t.elementType),t.type=e,typeof e=="function")Cl(e)?(n=Hi(e,n),t.tag=1,t=ng(null,t,e,n,i)):(t.tag=0,t=md(null,t,e,n,i));else{if(e!=null){var d=e.$$typeof;if(d===E){t.tag=11,t=Xp(null,t,e,n,i);break e}else if(d===y){t.tag=14,t=Zp(null,t,e,n,i);break e}}throw t=Z(e)||e,Error(l(306,t,""))}}return t;case 0:return md(e,t,t.type,t.pendingProps,i);case 1:return n=t.type,d=Hi(n,t.pendingProps),ng(e,t,n,d,i);case 3:e:{if(gt(t,t.stateNode.containerInfo),e===null)throw Error(l(387));n=t.pendingProps;var u=t.memoizedState;d=u.element,$l(e,t),wn(t,n,null,i);var f=t.memoizedState;if(n=f.cache,ei(t,ht,n),n!==u.cache&&Ll(t,[ht],i,!0),vn(),n=f.element,u.isDehydrated)if(u={element:n,isDehydrated:!1,cache:f.cache},t.updateQueue.baseState=u,t.memoizedState=u,t.flags&256){t=og(e,t,n,i);break e}else if(n!==d){d=ra(Error(l(424)),t),hn(d),t=og(e,t,n,i);break e}else for(e=t.stateNode.containerInfo,e.nodeType===9?e=e.body:e=e.nodeName==="HTML"?e.ownerDocument.body:e,it=da(e.firstChild),At=t,Ie=!0,Xa=null,sa=!0,i=tp(t,null,n,i),t.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling;else{if(Mi(),n===d){t=Ba(e,t,i);break e}Ct(e,t,n,i)}t=t.child}return t;case 26:return Ko(e,t),e===null?(i=wh(t.type,null,t.pendingProps,null))?t.memoizedState=i:Ie||(i=t.type,e=t.pendingProps,n=ps(tt.current).createElement(i),n[_t]=t,n[Bt]=e,Tt(n,i,e),St(n),t.stateNode=n):t.memoizedState=wh(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return ze(t),e===null&&Ie&&(n=t.stateNode=xh(t.type,t.pendingProps,tt.current),At=t,sa=!0,d=it,gi(t.type)?(ic=d,it=da(n.firstChild)):it=d),Ct(e,t,t.pendingProps.children,i),Ko(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&Ie&&((d=n=it)&&(n=Km(n,t.type,t.pendingProps,sa),n!==null?(t.stateNode=n,At=t,it=da(n.firstChild),sa=!1,d=!0):d=!1),d||Za(t)),ze(t),d=t.type,u=t.pendingProps,f=e!==null?e.memoizedProps:null,n=u.children,Xd(d,u)?n=null:f!==null&&Xd(d,f)&&(t.flags|=32),t.memoizedState!==null&&(d=Jl(e,t,cm,null,null,i),Hn._currentValue=d),Ko(e,t),Ct(e,t,n,i),t.child;case 6:return e===null&&Ie&&((e=i=it)&&(i=Wm(i,t.pendingProps,sa),i!==null?(t.stateNode=i,At=t,it=null,e=!0):e=!1),e||Za(t)),null;case 13:return sg(e,t,i);case 4:return gt(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Ui(t,null,n,i):Ct(e,t,n,i),t.child;case 11:return Xp(e,t,t.type,t.pendingProps,i);case 7:return Ct(e,t,t.pendingProps,i),t.child;case 8:return Ct(e,t,t.pendingProps.children,i),t.child;case 12:return Ct(e,t,t.pendingProps.children,i),t.child;case 10:return n=t.pendingProps,ei(t,t.type,n.value),Ct(e,t,n.children,i),t.child;case 9:return d=t.type._context,n=t.pendingProps.children,Di(t),d=Et(d),n=n(d),t.flags|=1,Ct(e,t,n,i),t.child;case 14:return Zp(e,t,t.type,t.pendingProps,i);case 15:return eg(e,t,t.type,t.pendingProps,i);case 19:return dg(e,t,i);case 31:return xm(e,t,i);case 22:return tg(e,t,i,t.pendingProps);case 24:return Di(t),n=Et(ht),e===null?(d=Hl(),d===null&&(d=Je,u=Ul(),d.pooledCache=u,u.refCount++,u!==null&&(d.pooledCacheLanes|=i),d=u),t.memoizedState={parent:n,cache:d},Gl(t),ei(t,ht,d)):((e.lanes&i)!==0&&($l(e,t),wn(t,null,null,i),vn()),d=e.memoizedState,u=t.memoizedState,d.parent!==n?(d={parent:n,cache:n},t.memoizedState=d,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=d),ei(t,ht,n)):(n=u.cache,ei(t,ht,n),n!==d.cache&&Ll(t,[ht],i,!0))),Ct(e,t,t.pendingProps.children,i),t.child;case 29:throw t.pendingProps}throw Error(l(156,t.tag))}function Ia(e){e.flags|=4}function jd(e,t,i,n,d){if((t=(e.mode&32)!==0)&&(t=!1),t){if(e.flags|=16777216,(d&335544128)===d)if(e.stateNode.complete)e.flags|=8192;else if(Ig())e.flags|=8192;else throw Li=Oo,Pl}else e.flags&=-16777217}function ug(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!_h(t))if(Ig())e.flags|=8192;else throw Li=Oo,Pl}function Jo(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?$c():536870912,e.lanes|=t,Nr|=t)}function An(e,t){if(!Ie)switch(e.tailMode){case"hidden":t=e.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var n=null;i!==null;)i.alternate!==null&&(n=i),i=i.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function rt(e){var t=e.alternate!==null&&e.alternate.child===e.child,i=0,n=0;if(t)for(var d=e.child;d!==null;)i|=d.lanes|d.childLanes,n|=d.subtreeFlags&65011712,n|=d.flags&65011712,d.return=e,d=d.sibling;else for(d=e.child;d!==null;)i|=d.lanes|d.childLanes,n|=d.subtreeFlags,n|=d.flags,d.return=e,d=d.sibling;return e.subtreeFlags|=n,e.childLanes=i,t}function vm(e,t,i){var n=t.pendingProps;switch(Ml(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return rt(t),null;case 1:return rt(t),null;case 3:return i=t.stateNode,n=null,e!==null&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Ma(ht),ot(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(e===null||e.child===null)&&(xr(t)?Ia(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,Dl())),rt(t),null;case 26:var d=t.type,u=t.memoizedState;return e===null?(Ia(t),u!==null?(rt(t),ug(t,u)):(rt(t),jd(t,d,null,n,i))):u?u!==e.memoizedState?(Ia(t),rt(t),ug(t,u)):(rt(t),t.flags&=-16777217):(e=e.memoizedProps,e!==n&&Ia(t),rt(t),jd(t,d,e,n,i)),null;case 27:if(me(t),i=tt.current,d=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==n&&Ia(t);else{if(!n){if(t.stateNode===null)throw Error(l(166));return rt(t),null}e=Se.current,xr(t)?$u(t):(e=xh(d,n,i),t.stateNode=e,Ia(t))}return rt(t),null;case 5:if(me(t),d=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==n&&Ia(t);else{if(!n){if(t.stateNode===null)throw Error(l(166));return rt(t),null}if(u=Se.current,xr(t))$u(t);else{var f=ps(tt.current);switch(u){case 1:u=f.createElementNS("http://www.w3.org/2000/svg",d);break;case 2:u=f.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;default:switch(d){case"svg":u=f.createElementNS("http://www.w3.org/2000/svg",d);break;case"math":u=f.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;case"script":u=f.createElement("div"),u.innerHTML="<script><\/script>",u=u.removeChild(u.firstChild);break;case"select":u=typeof n.is=="string"?f.createElement("select",{is:n.is}):f.createElement("select"),n.multiple?u.multiple=!0:n.size&&(u.size=n.size);break;default:u=typeof n.is=="string"?f.createElement(d,{is:n.is}):f.createElement(d)}}u[_t]=t,u[Bt]=n;e:for(f=t.child;f!==null;){if(f.tag===5||f.tag===6)u.appendChild(f.stateNode);else if(f.tag!==4&&f.tag!==27&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}t.stateNode=u;e:switch(Tt(u,d,n),d){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}n&&Ia(t)}}return rt(t),jd(t,t.type,e===null?null:e.memoizedProps,t.pendingProps,i),null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==n&&Ia(t);else{if(typeof n!="string"&&t.stateNode===null)throw Error(l(166));if(e=tt.current,xr(t)){if(e=t.stateNode,i=t.memoizedProps,n=null,d=At,d!==null)switch(d.tag){case 27:case 5:n=d.memoizedProps}e[_t]=t,e=!!(e.nodeValue===i||n!==null&&n.suppressHydrationWarning===!0||sh(e.nodeValue,i)),e||Za(t,!0)}else e=ps(e).createTextNode(n),e[_t]=t,t.stateNode=e}return rt(t),null;case 31:if(i=t.memoizedState,e===null||e.memoizedState!==null){if(n=xr(t),i!==null){if(e===null){if(!n)throw Error(l(318));if(e=t.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(557));e[_t]=t}else Mi(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;rt(t),e=!1}else i=Dl(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=i),e=!0;if(!e)return t.flags&256?(Ft(t),t):(Ft(t),null);if((t.flags&128)!==0)throw Error(l(558))}return rt(t),null;case 13:if(n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(d=xr(t),n!==null&&n.dehydrated!==null){if(e===null){if(!d)throw Error(l(318));if(d=t.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(l(317));d[_t]=t}else Mi(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;rt(t),d=!1}else d=Dl(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=d),d=!0;if(!d)return t.flags&256?(Ft(t),t):(Ft(t),null)}return Ft(t),(t.flags&128)!==0?(t.lanes=i,t):(i=n!==null,e=e!==null&&e.memoizedState!==null,i&&(n=t.child,d=null,n.alternate!==null&&n.alternate.memoizedState!==null&&n.alternate.memoizedState.cachePool!==null&&(d=n.alternate.memoizedState.cachePool.pool),u=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(u=n.memoizedState.cachePool.pool),u!==d&&(n.flags|=2048)),i!==e&&i&&(t.child.flags|=8192),Jo(t,t.updateQueue),rt(t),null);case 4:return ot(),e===null&&Qd(t.stateNode.containerInfo),rt(t),null;case 10:return Ma(t.type),rt(t),null;case 19:if(oe(ut),n=t.memoizedState,n===null)return rt(t),null;if(d=(t.flags&128)!==0,u=n.rendering,u===null)if(d)An(n,!1);else{if(lt!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(u=Lo(e),u!==null){for(t.flags|=128,An(n,!1),e=u.updateQueue,t.updateQueue=e,Jo(t,e),t.subtreeFlags=0,e=i,i=t.child;i!==null;)Uu(i,e),i=i.sibling;return de(ut,ut.current&1|2),Ie&&Na(t,n.treeForkCount),t.child}e=e.sibling}n.tail!==null&&ye()>as&&(t.flags|=128,d=!0,An(n,!1),t.lanes=4194304)}else{if(!d)if(e=Lo(u),e!==null){if(t.flags|=128,d=!0,e=e.updateQueue,t.updateQueue=e,Jo(t,e),An(n,!0),n.tail===null&&n.tailMode==="hidden"&&!u.alternate&&!Ie)return rt(t),null}else 2*ye()-n.renderingStartTime>as&&i!==536870912&&(t.flags|=128,d=!0,An(n,!1),t.lanes=4194304);n.isBackwards?(u.sibling=t.child,t.child=u):(e=n.last,e!==null?e.sibling=u:t.child=u,n.last=u)}return n.tail!==null?(e=n.tail,n.rendering=e,n.tail=e.sibling,n.renderingStartTime=ye(),e.sibling=null,i=ut.current,de(ut,d?i&1|2:i&1),Ie&&Na(t,n.treeForkCount),e):(rt(t),null);case 22:case 23:return Ft(t),Fl(),n=t.memoizedState!==null,e!==null?e.memoizedState!==null!==n&&(t.flags|=8192):n&&(t.flags|=8192),n?(i&536870912)!==0&&(t.flags&128)===0&&(rt(t),t.subtreeFlags&6&&(t.flags|=8192)):rt(t),i=t.updateQueue,i!==null&&Jo(t,i.retryQueue),i=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(i=e.memoizedState.cachePool.pool),n=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(n=t.memoizedState.cachePool.pool),n!==i&&(t.flags|=2048),e!==null&&oe(Bi),null;case 24:return i=null,e!==null&&(i=e.memoizedState.cache),t.memoizedState.cache!==i&&(t.flags|=2048),Ma(ht),rt(t),null;case 25:return null;case 30:return null}throw Error(l(156,t.tag))}function wm(e,t){switch(Ml(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ma(ht),ot(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return me(t),null;case 31:if(t.memoizedState!==null){if(Ft(t),t.alternate===null)throw Error(l(340));Mi()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 13:if(Ft(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(l(340));Mi()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return oe(ut),null;case 4:return ot(),null;case 10:return Ma(t.type),null;case 22:case 23:return Ft(t),Fl(),e!==null&&oe(Bi),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return Ma(ht),null;case 25:return null;default:return null}}function pg(e,t){switch(Ml(t),t.tag){case 3:Ma(ht),ot();break;case 26:case 27:case 5:me(t);break;case 4:ot();break;case 31:t.memoizedState!==null&&Ft(t);break;case 13:Ft(t);break;case 19:oe(ut);break;case 10:Ma(t.type);break;case 22:case 23:Ft(t),Fl(),e!==null&&oe(Bi);break;case 24:Ma(ht)}}function En(e,t){try{var i=t.updateQueue,n=i!==null?i.lastEffect:null;if(n!==null){var d=n.next;i=d;do{if((i.tag&e)===e){n=void 0;var u=i.create,f=i.inst;n=u(),f.destroy=n}i=i.next}while(i!==d)}}catch(x){Qe(t,t.return,x)}}function oi(e,t,i){try{var n=t.updateQueue,d=n!==null?n.lastEffect:null;if(d!==null){var u=d.next;n=u;do{if((n.tag&e)===e){var f=n.inst,x=f.destroy;if(x!==void 0){f.destroy=void 0,d=t;var A=i,G=x;try{G()}catch(X){Qe(d,A,X)}}}n=n.next}while(n!==u)}}catch(X){Qe(t,t.return,X)}}function gg(e){var t=e.updateQueue;if(t!==null){var i=e.stateNode;try{ip(t,i)}catch(n){Qe(e,e.return,n)}}}function hg(e,t,i){i.props=Hi(e.type,e.memoizedProps),i.state=e.memoizedState;try{i.componentWillUnmount()}catch(n){Qe(e,t,n)}}function Cn(e,t){try{var i=e.ref;if(i!==null){switch(e.tag){case 26:case 27:case 5:var n=e.stateNode;break;case 30:n=e.stateNode;break;default:n=e.stateNode}typeof i=="function"?e.refCleanup=i(n):i.current=n}}catch(d){Qe(e,t,d)}}function va(e,t){var i=e.ref,n=e.refCleanup;if(i!==null)if(typeof n=="function")try{n()}catch(d){Qe(e,t,d)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof i=="function")try{i(null)}catch(d){Qe(e,t,d)}else i.current=null}function fg(e){var t=e.type,i=e.memoizedProps,n=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":i.autoFocus&&n.focus();break e;case"img":i.src?n.src=i.src:i.srcSet&&(n.srcset=i.srcSet)}}catch(d){Qe(e,e.return,d)}}function _d(e,t,i){try{var n=e.stateNode;Gm(n,e.type,i,t),n[Bt]=t}catch(d){Qe(e,e.return,d)}}function bg(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&gi(e.type)||e.tag===4}function Ad(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||bg(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&gi(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Ed(e,t,i){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i).insertBefore(e,t):(t=i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,t.appendChild(e),i=i._reactRootContainer,i!=null||t.onclick!==null||(t.onclick=Ea));else if(n!==4&&(n===27&&gi(e.type)&&(i=e.stateNode,t=null),e=e.child,e!==null))for(Ed(e,t,i),e=e.sibling;e!==null;)Ed(e,t,i),e=e.sibling}function Xo(e,t,i){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?i.insertBefore(e,t):i.appendChild(e);else if(n!==4&&(n===27&&gi(e.type)&&(i=e.stateNode),e=e.child,e!==null))for(Xo(e,t,i),e=e.sibling;e!==null;)Xo(e,t,i),e=e.sibling}function mg(e){var t=e.stateNode,i=e.memoizedProps;try{for(var n=e.type,d=t.attributes;d.length;)t.removeAttributeNode(d[0]);Tt(t,n,i),t[_t]=e,t[Bt]=i}catch(u){Qe(e,e.return,u)}}var La=!1,mt=!1,Cd=!1,xg=typeof WeakSet=="function"?WeakSet:Set,zt=null;function km(e,t){if(e=e.containerInfo,Wd=ys,e=Tu(e),kl(e)){if("selectionStart"in e)var i={start:e.selectionStart,end:e.selectionEnd};else e:{i=(i=e.ownerDocument)&&i.defaultView||window;var n=i.getSelection&&i.getSelection();if(n&&n.rangeCount!==0){i=n.anchorNode;var d=n.anchorOffset,u=n.focusNode;n=n.focusOffset;try{i.nodeType,u.nodeType}catch{i=null;break e}var f=0,x=-1,A=-1,G=0,X=0,ae=e,Y=null;t:for(;;){for(var K;ae!==i||d!==0&&ae.nodeType!==3||(x=f+d),ae!==u||n!==0&&ae.nodeType!==3||(A=f+n),ae.nodeType===3&&(f+=ae.nodeValue.length),(K=ae.firstChild)!==null;)Y=ae,ae=K;for(;;){if(ae===e)break t;if(Y===i&&++G===d&&(x=f),Y===u&&++X===n&&(A=f),(K=ae.nextSibling)!==null)break;ae=Y,Y=ae.parentNode}ae=K}i=x===-1||A===-1?null:{start:x,end:A}}else i=null}i=i||{start:0,end:0}}else i=null;for(Jd={focusedElem:e,selectionRange:i},ys=!1,zt=t;zt!==null;)if(t=zt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,zt=e;else for(;zt!==null;){switch(t=zt,u=t.alternate,e=t.flags,t.tag){case 0:if((e&4)!==0&&(e=t.updateQueue,e=e!==null?e.events:null,e!==null))for(i=0;i<e.length;i++)d=e[i],d.ref.impl=d.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&u!==null){e=void 0,i=t,d=u.memoizedProps,u=u.memoizedState,n=i.stateNode;try{var ge=Hi(i.type,d);e=n.getSnapshotBeforeUpdate(ge,u),n.__reactInternalSnapshotBeforeUpdate=e}catch(ve){Qe(i,i.return,ve)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,i=e.nodeType,i===9)ec(e);else if(i===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":ec(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(l(163))}if(e=t.sibling,e!==null){e.return=t.return,zt=e;break}zt=t.return}}function yg(e,t,i){var n=i.flags;switch(i.tag){case 0:case 11:case 15:qa(e,i),n&4&&En(5,i);break;case 1:if(qa(e,i),n&4)if(e=i.stateNode,t===null)try{e.componentDidMount()}catch(f){Qe(i,i.return,f)}else{var d=Hi(i.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(d,t,e.__reactInternalSnapshotBeforeUpdate)}catch(f){Qe(i,i.return,f)}}n&64&&gg(i),n&512&&Cn(i,i.return);break;case 3:if(qa(e,i),n&64&&(e=i.updateQueue,e!==null)){if(t=null,i.child!==null)switch(i.child.tag){case 27:case 5:t=i.child.stateNode;break;case 1:t=i.child.stateNode}try{ip(e,t)}catch(f){Qe(i,i.return,f)}}break;case 27:t===null&&n&4&&mg(i);case 26:case 5:qa(e,i),t===null&&n&4&&fg(i),n&512&&Cn(i,i.return);break;case 12:qa(e,i);break;case 31:qa(e,i),n&4&&kg(e,i);break;case 13:qa(e,i),n&4&&Sg(e,i),n&64&&(e=i.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(i=Nm.bind(null,i),Jm(e,i))));break;case 22:if(n=i.memoizedState!==null||La,!n){t=t!==null&&t.memoizedState!==null||mt,d=La;var u=mt;La=n,(mt=t)&&!u?Ha(e,i,(i.subtreeFlags&8772)!==0):qa(e,i),La=d,mt=u}break;case 30:break;default:qa(e,i)}}function vg(e){var t=e.alternate;t!==null&&(e.alternate=null,vg(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&nl(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var nt=null,Lt=!1;function Ua(e,t,i){for(i=i.child;i!==null;)wg(e,t,i),i=i.sibling}function wg(e,t,i){if(jt&&typeof jt.onCommitFiberUnmount=="function")try{jt.onCommitFiberUnmount(_a,i)}catch{}switch(i.tag){case 26:mt||va(i,t),Ua(e,t,i),i.memoizedState?i.memoizedState.count--:i.stateNode&&(i=i.stateNode,i.parentNode.removeChild(i));break;case 27:mt||va(i,t);var n=nt,d=Lt;gi(i.type)&&(nt=i.stateNode,Lt=!1),Ua(e,t,i),Ln(i.stateNode),nt=n,Lt=d;break;case 5:mt||va(i,t);case 6:if(n=nt,d=Lt,nt=null,Ua(e,t,i),nt=n,Lt=d,nt!==null)if(Lt)try{(nt.nodeType===9?nt.body:nt.nodeName==="HTML"?nt.ownerDocument.body:nt).removeChild(i.stateNode)}catch(u){Qe(i,t,u)}else try{nt.removeChild(i.stateNode)}catch(u){Qe(i,t,u)}break;case 18:nt!==null&&(Lt?(e=nt,gh(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,i.stateNode),Ur(e)):gh(nt,i.stateNode));break;case 4:n=nt,d=Lt,nt=i.stateNode.containerInfo,Lt=!0,Ua(e,t,i),nt=n,Lt=d;break;case 0:case 11:case 14:case 15:oi(2,i,t),mt||oi(4,i,t),Ua(e,t,i);break;case 1:mt||(va(i,t),n=i.stateNode,typeof n.componentWillUnmount=="function"&&hg(i,t,n)),Ua(e,t,i);break;case 21:Ua(e,t,i);break;case 22:mt=(n=mt)||i.memoizedState!==null,Ua(e,t,i),mt=n;break;default:Ua(e,t,i)}}function kg(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Ur(e)}catch(i){Qe(t,t.return,i)}}}function Sg(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Ur(e)}catch(i){Qe(t,t.return,i)}}function Sm(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new xg),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new xg),t;default:throw Error(l(435,e.tag))}}function Zo(e,t){var i=Sm(e);t.forEach(function(n){if(!i.has(n)){i.add(n);var d=Rm.bind(null,e,n);n.then(d,d)}})}function Ut(e,t){var i=t.deletions;if(i!==null)for(var n=0;n<i.length;n++){var d=i[n],u=e,f=t,x=f;e:for(;x!==null;){switch(x.tag){case 27:if(gi(x.type)){nt=x.stateNode,Lt=!1;break e}break;case 5:nt=x.stateNode,Lt=!1;break e;case 3:case 4:nt=x.stateNode.containerInfo,Lt=!0;break e}x=x.return}if(nt===null)throw Error(l(160));wg(u,f,d),nt=null,Lt=!1,u=d.alternate,u!==null&&(u.return=null),d.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)zg(t,e),t=t.sibling}var ga=null;function zg(e,t){var i=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Ut(t,e),qt(e),n&4&&(oi(3,e,e.return),En(3,e),oi(5,e,e.return));break;case 1:Ut(t,e),qt(e),n&512&&(mt||i===null||va(i,i.return)),n&64&&La&&(e=e.updateQueue,e!==null&&(n=e.callbacks,n!==null&&(i=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=i===null?n:i.concat(n))));break;case 26:var d=ga;if(Ut(t,e),qt(e),n&512&&(mt||i===null||va(i,i.return)),n&4){var u=i!==null?i.memoizedState:null;if(n=e.memoizedState,i===null)if(n===null)if(e.stateNode===null){e:{n=e.type,i=e.memoizedProps,d=d.ownerDocument||d;t:switch(n){case"title":u=d.getElementsByTagName("title")[0],(!u||u[tn]||u[_t]||u.namespaceURI==="http://www.w3.org/2000/svg"||u.hasAttribute("itemprop"))&&(u=d.createElement(n),d.head.insertBefore(u,d.querySelector("head > title"))),Tt(u,n,i),u[_t]=e,St(u),n=u;break e;case"link":var f=zh("link","href",d).get(n+(i.href||""));if(f){for(var x=0;x<f.length;x++)if(u=f[x],u.getAttribute("href")===(i.href==null||i.href===""?null:i.href)&&u.getAttribute("rel")===(i.rel==null?null:i.rel)&&u.getAttribute("title")===(i.title==null?null:i.title)&&u.getAttribute("crossorigin")===(i.crossOrigin==null?null:i.crossOrigin)){f.splice(x,1);break t}}u=d.createElement(n),Tt(u,n,i),d.head.appendChild(u);break;case"meta":if(f=zh("meta","content",d).get(n+(i.content||""))){for(x=0;x<f.length;x++)if(u=f[x],u.getAttribute("content")===(i.content==null?null:""+i.content)&&u.getAttribute("name")===(i.name==null?null:i.name)&&u.getAttribute("property")===(i.property==null?null:i.property)&&u.getAttribute("http-equiv")===(i.httpEquiv==null?null:i.httpEquiv)&&u.getAttribute("charset")===(i.charSet==null?null:i.charSet)){f.splice(x,1);break t}}u=d.createElement(n),Tt(u,n,i),d.head.appendChild(u);break;default:throw Error(l(468,n))}u[_t]=e,St(u),n=u}e.stateNode=n}else jh(d,e.type,e.stateNode);else e.stateNode=Sh(d,n,e.memoizedProps);else u!==n?(u===null?i.stateNode!==null&&(i=i.stateNode,i.parentNode.removeChild(i)):u.count--,n===null?jh(d,e.type,e.stateNode):Sh(d,n,e.memoizedProps)):n===null&&e.stateNode!==null&&_d(e,e.memoizedProps,i.memoizedProps)}break;case 27:Ut(t,e),qt(e),n&512&&(mt||i===null||va(i,i.return)),i!==null&&n&4&&_d(e,e.memoizedProps,i.memoizedProps);break;case 5:if(Ut(t,e),qt(e),n&512&&(mt||i===null||va(i,i.return)),e.flags&32){d=e.stateNode;try{lr(d,"")}catch(ge){Qe(e,e.return,ge)}}n&4&&e.stateNode!=null&&(d=e.memoizedProps,_d(e,d,i!==null?i.memoizedProps:d)),n&1024&&(Cd=!0);break;case 6:if(Ut(t,e),qt(e),n&4){if(e.stateNode===null)throw Error(l(162));n=e.memoizedProps,i=e.stateNode;try{i.nodeValue=n}catch(ge){Qe(e,e.return,ge)}}break;case 3:if(fs=null,d=ga,ga=gs(t.containerInfo),Ut(t,e),ga=d,qt(e),n&4&&i!==null&&i.memoizedState.isDehydrated)try{Ur(t.containerInfo)}catch(ge){Qe(e,e.return,ge)}Cd&&(Cd=!1,jg(e));break;case 4:n=ga,ga=gs(e.stateNode.containerInfo),Ut(t,e),qt(e),ga=n;break;case 12:Ut(t,e),qt(e);break;case 31:Ut(t,e),qt(e),n&4&&(n=e.updateQueue,n!==null&&(e.updateQueue=null,Zo(e,n)));break;case 13:Ut(t,e),qt(e),e.child.flags&8192&&e.memoizedState!==null!=(i!==null&&i.memoizedState!==null)&&(ts=ye()),n&4&&(n=e.updateQueue,n!==null&&(e.updateQueue=null,Zo(e,n)));break;case 22:d=e.memoizedState!==null;var A=i!==null&&i.memoizedState!==null,G=La,X=mt;if(La=G||d,mt=X||A,Ut(t,e),mt=X,La=G,qt(e),n&8192)e:for(t=e.stateNode,t._visibility=d?t._visibility&-2:t._visibility|1,d&&(i===null||A||La||mt||Pi(e)),i=null,t=e;;){if(t.tag===5||t.tag===26){if(i===null){A=i=t;try{if(u=A.stateNode,d)f=u.style,typeof f.setProperty=="function"?f.setProperty("display","none","important"):f.display="none";else{x=A.stateNode;var ae=A.memoizedProps.style,Y=ae!=null&&ae.hasOwnProperty("display")?ae.display:null;x.style.display=Y==null||typeof Y=="boolean"?"":(""+Y).trim()}}catch(ge){Qe(A,A.return,ge)}}}else if(t.tag===6){if(i===null){A=t;try{A.stateNode.nodeValue=d?"":A.memoizedProps}catch(ge){Qe(A,A.return,ge)}}}else if(t.tag===18){if(i===null){A=t;try{var K=A.stateNode;d?hh(K,!0):hh(A.stateNode,!1)}catch(ge){Qe(A,A.return,ge)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;i===t&&(i=null),t=t.return}i===t&&(i=null),t.sibling.return=t.return,t=t.sibling}n&4&&(n=e.updateQueue,n!==null&&(i=n.retryQueue,i!==null&&(n.retryQueue=null,Zo(e,i))));break;case 19:Ut(t,e),qt(e),n&4&&(n=e.updateQueue,n!==null&&(e.updateQueue=null,Zo(e,n)));break;case 30:break;case 21:break;default:Ut(t,e),qt(e)}}function qt(e){var t=e.flags;if(t&2){try{for(var i,n=e.return;n!==null;){if(bg(n)){i=n;break}n=n.return}if(i==null)throw Error(l(160));switch(i.tag){case 27:var d=i.stateNode,u=Ad(e);Xo(e,u,d);break;case 5:var f=i.stateNode;i.flags&32&&(lr(f,""),i.flags&=-33);var x=Ad(e);Xo(e,x,f);break;case 3:case 4:var A=i.stateNode.containerInfo,G=Ad(e);Ed(e,G,A);break;default:throw Error(l(161))}}catch(X){Qe(e,e.return,X)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function jg(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;jg(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function qa(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)yg(e,t.alternate,t),t=t.sibling}function Pi(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:oi(4,t,t.return),Pi(t);break;case 1:va(t,t.return);var i=t.stateNode;typeof i.componentWillUnmount=="function"&&hg(t,t.return,i),Pi(t);break;case 27:Ln(t.stateNode);case 26:case 5:va(t,t.return),Pi(t);break;case 22:t.memoizedState===null&&Pi(t);break;case 30:Pi(t);break;default:Pi(t)}e=e.sibling}}function Ha(e,t,i){for(i=i&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var n=t.alternate,d=e,u=t,f=u.flags;switch(u.tag){case 0:case 11:case 15:Ha(d,u,i),En(4,u);break;case 1:if(Ha(d,u,i),n=u,d=n.stateNode,typeof d.componentDidMount=="function")try{d.componentDidMount()}catch(G){Qe(n,n.return,G)}if(n=u,d=n.updateQueue,d!==null){var x=n.stateNode;try{var A=d.shared.hiddenCallbacks;if(A!==null)for(d.shared.hiddenCallbacks=null,d=0;d<A.length;d++)ap(A[d],x)}catch(G){Qe(n,n.return,G)}}i&&f&64&&gg(u),Cn(u,u.return);break;case 27:mg(u);case 26:case 5:Ha(d,u,i),i&&n===null&&f&4&&fg(u),Cn(u,u.return);break;case 12:Ha(d,u,i);break;case 31:Ha(d,u,i),i&&f&4&&kg(d,u);break;case 13:Ha(d,u,i),i&&f&4&&Sg(d,u);break;case 22:u.memoizedState===null&&Ha(d,u,i),Cn(u,u.return);break;case 30:break;default:Ha(d,u,i)}t=t.sibling}}function Td(e,t){var i=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(i=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==i&&(e!=null&&e.refCount++,i!=null&&fn(i))}function Nd(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&fn(e))}function ha(e,t,i,n){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)_g(e,t,i,n),t=t.sibling}function _g(e,t,i,n){var d=t.flags;switch(t.tag){case 0:case 11:case 15:ha(e,t,i,n),d&2048&&En(9,t);break;case 1:ha(e,t,i,n);break;case 3:ha(e,t,i,n),d&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&fn(e)));break;case 12:if(d&2048){ha(e,t,i,n),e=t.stateNode;try{var u=t.memoizedProps,f=u.id,x=u.onPostCommit;typeof x=="function"&&x(f,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(A){Qe(t,t.return,A)}}else ha(e,t,i,n);break;case 31:ha(e,t,i,n);break;case 13:ha(e,t,i,n);break;case 23:break;case 22:u=t.stateNode,f=t.alternate,t.memoizedState!==null?u._visibility&2?ha(e,t,i,n):Tn(e,t):u._visibility&2?ha(e,t,i,n):(u._visibility|=2,Er(e,t,i,n,(t.subtreeFlags&10256)!==0||!1)),d&2048&&Td(f,t);break;case 24:ha(e,t,i,n),d&2048&&Nd(t.alternate,t);break;default:ha(e,t,i,n)}}function Er(e,t,i,n,d){for(d=d&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var u=e,f=t,x=i,A=n,G=f.flags;switch(f.tag){case 0:case 11:case 15:Er(u,f,x,A,d),En(8,f);break;case 23:break;case 22:var X=f.stateNode;f.memoizedState!==null?X._visibility&2?Er(u,f,x,A,d):Tn(u,f):(X._visibility|=2,Er(u,f,x,A,d)),d&&G&2048&&Td(f.alternate,f);break;case 24:Er(u,f,x,A,d),d&&G&2048&&Nd(f.alternate,f);break;default:Er(u,f,x,A,d)}t=t.sibling}}function Tn(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var i=e,n=t,d=n.flags;switch(n.tag){case 22:Tn(i,n),d&2048&&Td(n.alternate,n);break;case 24:Tn(i,n),d&2048&&Nd(n.alternate,n);break;default:Tn(i,n)}t=t.sibling}}var Nn=8192;function Cr(e,t,i){if(e.subtreeFlags&Nn)for(e=e.child;e!==null;)Ag(e,t,i),e=e.sibling}function Ag(e,t,i){switch(e.tag){case 26:Cr(e,t,i),e.flags&Nn&&e.memoizedState!==null&&d0(i,ga,e.memoizedState,e.memoizedProps);break;case 5:Cr(e,t,i);break;case 3:case 4:var n=ga;ga=gs(e.stateNode.containerInfo),Cr(e,t,i),ga=n;break;case 22:e.memoizedState===null&&(n=e.alternate,n!==null&&n.memoizedState!==null?(n=Nn,Nn=16777216,Cr(e,t,i),Nn=n):Cr(e,t,i));break;default:Cr(e,t,i)}}function Eg(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function Rn(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var i=0;i<t.length;i++){var n=t[i];zt=n,Tg(n,e)}Eg(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)Cg(e),e=e.sibling}function Cg(e){switch(e.tag){case 0:case 11:case 15:Rn(e),e.flags&2048&&oi(9,e,e.return);break;case 3:Rn(e);break;case 12:Rn(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,es(e)):Rn(e);break;default:Rn(e)}}function es(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var i=0;i<t.length;i++){var n=t[i];zt=n,Tg(n,e)}Eg(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:oi(8,t,t.return),es(t);break;case 22:i=t.stateNode,i._visibility&2&&(i._visibility&=-3,es(t));break;default:es(t)}e=e.sibling}}function Tg(e,t){for(;zt!==null;){var i=zt;switch(i.tag){case 0:case 11:case 15:oi(8,i,t);break;case 23:case 22:if(i.memoizedState!==null&&i.memoizedState.cachePool!==null){var n=i.memoizedState.cachePool.pool;n!=null&&n.refCount++}break;case 24:fn(i.memoizedState.cache)}if(n=i.child,n!==null)n.return=i,zt=n;else e:for(i=e;zt!==null;){n=zt;var d=n.sibling,u=n.return;if(vg(n),n===i){zt=null;break e}if(d!==null){d.return=u,zt=d;break e}zt=u}}}var zm={getCacheForType:function(e){var t=Et(ht),i=t.data.get(e);return i===void 0&&(i=e(),t.data.set(e,i)),i},cacheSignal:function(){return Et(ht).controller.signal}},jm=typeof WeakMap=="function"?WeakMap:Map,Ge=0,Je=null,Ne=null,Me=0,Ve=0,Kt=null,si=!1,Tr=!1,Rd=!1,Pa=0,lt=0,li=0,Gi=0,Md=0,Wt=0,Nr=0,Mn=null,Ht=null,Od=!1,ts=0,Ng=0,as=1/0,is=null,di=null,wt=0,ci=null,Rr=null,Ga=0,Dd=0,Bd=null,Rg=null,On=0,Id=null;function Jt(){return(Ge&2)!==0&&Me!==0?Me&-Me:w.T!==null?Gd():Fc()}function Mg(){if(Wt===0)if((Me&536870912)===0||Ie){var e=uo;uo<<=1,(uo&3932160)===0&&(uo=262144),Wt=e}else Wt=536870912;return e=Qt.current,e!==null&&(e.flags|=32),Wt}function Pt(e,t,i){(e===Je&&(Ve===2||Ve===9)||e.cancelPendingCommit!==null)&&(Mr(e,0),ui(e,Me,Wt,!1)),en(e,i),((Ge&2)===0||e!==Je)&&(e===Je&&((Ge&2)===0&&(Gi|=i),lt===4&&ui(e,Me,Wt,!1)),wa(e))}function Og(e,t,i){if((Ge&6)!==0)throw Error(l(327));var n=!i&&(t&127)===0&&(t&e.expiredLanes)===0||Zr(e,t),d=n?Em(e,t):Ud(e,t,!0),u=n;do{if(d===0){Tr&&!n&&ui(e,t,0,!1);break}else{if(i=e.current.alternate,u&&!_m(i)){d=Ud(e,t,!1),u=!1;continue}if(d===2){if(u=t,e.errorRecoveryDisabledLanes&u)var f=0;else f=e.pendingLanes&-536870913,f=f!==0?f:f&536870912?536870912:0;if(f!==0){t=f;e:{var x=e;d=Mn;var A=x.current.memoizedState.isDehydrated;if(A&&(Mr(x,f).flags|=256),f=Ud(x,f,!1),f!==2){if(Rd&&!A){x.errorRecoveryDisabledLanes|=u,Gi|=u,d=4;break e}u=Ht,Ht=d,u!==null&&(Ht===null?Ht=u:Ht.push.apply(Ht,u))}d=f}if(u=!1,d!==2)continue}}if(d===1){Mr(e,0),ui(e,t,0,!0);break}e:{switch(n=e,u=d,u){case 0:case 1:throw Error(l(345));case 4:if((t&4194048)!==t)break;case 6:ui(n,t,Wt,!si);break e;case 2:Ht=null;break;case 3:case 5:break;default:throw Error(l(329))}if((t&62914560)===t&&(d=ts+300-ye(),10<d)){if(ui(n,t,Wt,!si),go(n,0,!0)!==0)break e;Ga=t,n.timeoutHandle=uh(Dg.bind(null,n,i,Ht,is,Od,t,Wt,Gi,Nr,si,u,"Throttled",-0,0),d);break e}Dg(n,i,Ht,is,Od,t,Wt,Gi,Nr,si,u,null,-0,0)}}break}while(!0);wa(e)}function Dg(e,t,i,n,d,u,f,x,A,G,X,ae,Y,K){if(e.timeoutHandle=-1,ae=t.subtreeFlags,ae&8192||(ae&16785408)===16785408){ae={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Ea},Ag(t,u,ae);var ge=(u&62914560)===u?ts-ye():(u&4194048)===u?Ng-ye():0;if(ge=c0(ae,ge),ge!==null){Ga=u,e.cancelPendingCommit=ge(Gg.bind(null,e,t,u,i,n,d,f,x,A,X,ae,null,Y,K)),ui(e,u,f,!G);return}}Gg(e,t,u,i,n,d,f,x,A)}function _m(e){for(var t=e;;){var i=t.tag;if((i===0||i===11||i===15)&&t.flags&16384&&(i=t.updateQueue,i!==null&&(i=i.stores,i!==null)))for(var n=0;n<i.length;n++){var d=i[n],u=d.getSnapshot;d=d.value;try{if(!Yt(u(),d))return!1}catch{return!1}}if(i=t.child,t.subtreeFlags&16384&&i!==null)i.return=t,t=i;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ui(e,t,i,n){t&=~Md,t&=~Gi,e.suspendedLanes|=t,e.pingedLanes&=~t,n&&(e.warmLanes|=t),n=e.expirationTimes;for(var d=t;0<d;){var u=31-$t(d),f=1<<u;n[u]=-1,d&=~f}i!==0&&Yc(e,i,t)}function rs(){return(Ge&6)===0?(Dn(0),!1):!0}function Ld(){if(Ne!==null){if(Ve===0)var e=Ne.return;else e=Ne,Ra=Oi=null,ed(e),Sr=null,mn=0,e=Ne;for(;e!==null;)pg(e.alternate,e),e=e.return;Ne=null}}function Mr(e,t){var i=e.timeoutHandle;i!==-1&&(e.timeoutHandle=-1,Vm(i)),i=e.cancelPendingCommit,i!==null&&(e.cancelPendingCommit=null,i()),Ga=0,Ld(),Je=e,Ne=i=Ta(e.current,null),Me=t,Ve=0,Kt=null,si=!1,Tr=Zr(e,t),Rd=!1,Nr=Wt=Md=Gi=li=lt=0,Ht=Mn=null,Od=!1,(t&8)!==0&&(t|=t&32);var n=e.entangledLanes;if(n!==0)for(e=e.entanglements,n&=t;0<n;){var d=31-$t(n),u=1<<d;t|=e[d],n&=~u}return Pa=t,jo(),i}function Bg(e,t){_e=null,w.H=jn,t===kr||t===Mo?(t=Xu(),Ve=3):t===Pl?(t=Xu(),Ve=4):Ve=t===bd?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,Kt=t,Ne===null&&(lt=1,Qo(e,ra(t,e.current)))}function Ig(){var e=Qt.current;return e===null?!0:(Me&4194048)===Me?la===null:(Me&62914560)===Me||(Me&536870912)!==0?e===la:!1}function Lg(){var e=w.H;return w.H=jn,e===null?jn:e}function Ug(){var e=w.A;return w.A=zm,e}function ns(){lt=4,si||(Me&4194048)!==Me&&Qt.current!==null||(Tr=!0),(li&134217727)===0&&(Gi&134217727)===0||Je===null||ui(Je,Me,Wt,!1)}function Ud(e,t,i){var n=Ge;Ge|=2;var d=Lg(),u=Ug();(Je!==e||Me!==t)&&(is=null,Mr(e,t)),t=!1;var f=lt;e:do try{if(Ve!==0&&Ne!==null){var x=Ne,A=Kt;switch(Ve){case 8:Ld(),f=6;break e;case 3:case 2:case 9:case 6:Qt.current===null&&(t=!0);var G=Ve;if(Ve=0,Kt=null,Or(e,x,A,G),i&&Tr){f=0;break e}break;default:G=Ve,Ve=0,Kt=null,Or(e,x,A,G)}}Am(),f=lt;break}catch(X){Bg(e,X)}while(!0);return t&&e.shellSuspendCounter++,Ra=Oi=null,Ge=n,w.H=d,w.A=u,Ne===null&&(Je=null,Me=0,jo()),f}function Am(){for(;Ne!==null;)qg(Ne)}function Em(e,t){var i=Ge;Ge|=2;var n=Lg(),d=Ug();Je!==e||Me!==t?(is=null,as=ye()+500,Mr(e,t)):Tr=Zr(e,t);e:do try{if(Ve!==0&&Ne!==null){t=Ne;var u=Kt;t:switch(Ve){case 1:Ve=0,Kt=null,Or(e,t,u,1);break;case 2:case 9:if(Wu(u)){Ve=0,Kt=null,Hg(t);break}t=function(){Ve!==2&&Ve!==9||Je!==e||(Ve=7),wa(e)},u.then(t,t);break e;case 3:Ve=7;break e;case 4:Ve=5;break e;case 7:Wu(u)?(Ve=0,Kt=null,Hg(t)):(Ve=0,Kt=null,Or(e,t,u,7));break;case 5:var f=null;switch(Ne.tag){case 26:f=Ne.memoizedState;case 5:case 27:var x=Ne;if(f?_h(f):x.stateNode.complete){Ve=0,Kt=null;var A=x.sibling;if(A!==null)Ne=A;else{var G=x.return;G!==null?(Ne=G,os(G)):Ne=null}break t}}Ve=0,Kt=null,Or(e,t,u,5);break;case 6:Ve=0,Kt=null,Or(e,t,u,6);break;case 8:Ld(),lt=6;break e;default:throw Error(l(462))}}Cm();break}catch(X){Bg(e,X)}while(!0);return Ra=Oi=null,w.H=n,w.A=d,Ge=i,Ne!==null?0:(Je=null,Me=0,jo(),lt)}function Cm(){for(;Ne!==null&&!pe();)qg(Ne)}function qg(e){var t=cg(e.alternate,e,Pa);e.memoizedProps=e.pendingProps,t===null?os(e):Ne=t}function Hg(e){var t=e,i=t.alternate;switch(t.tag){case 15:case 0:t=rg(i,t,t.pendingProps,t.type,void 0,Me);break;case 11:t=rg(i,t,t.pendingProps,t.type.render,t.ref,Me);break;case 5:ed(t);default:pg(i,t),t=Ne=Uu(t,Pa),t=cg(i,t,Pa)}e.memoizedProps=e.pendingProps,t===null?os(e):Ne=t}function Or(e,t,i,n){Ra=Oi=null,ed(t),Sr=null,mn=0;var d=t.return;try{if(mm(e,d,t,i,Me)){lt=1,Qo(e,ra(i,e.current)),Ne=null;return}}catch(u){if(d!==null)throw Ne=d,u;lt=1,Qo(e,ra(i,e.current)),Ne=null;return}t.flags&32768?(Ie||n===1?e=!0:Tr||(Me&536870912)!==0?e=!1:(si=e=!0,(n===2||n===9||n===3||n===6)&&(n=Qt.current,n!==null&&n.tag===13&&(n.flags|=16384))),Pg(t,e)):os(t)}function os(e){var t=e;do{if((t.flags&32768)!==0){Pg(t,si);return}e=t.return;var i=vm(t.alternate,t,Pa);if(i!==null){Ne=i;return}if(t=t.sibling,t!==null){Ne=t;return}Ne=t=e}while(t!==null);lt===0&&(lt=5)}function Pg(e,t){do{var i=wm(e.alternate,e);if(i!==null){i.flags&=32767,Ne=i;return}if(i=e.return,i!==null&&(i.flags|=32768,i.subtreeFlags=0,i.deletions=null),!t&&(e=e.sibling,e!==null)){Ne=e;return}Ne=e=i}while(e!==null);lt=6,Ne=null}function Gg(e,t,i,n,d,u,f,x,A){e.cancelPendingCommit=null;do ss();while(wt!==0);if((Ge&6)!==0)throw Error(l(327));if(t!==null){if(t===e.current)throw Error(l(177));if(u=t.lanes|t.childLanes,u|=Al,lb(e,i,u,f,x,A),e===Je&&(Ne=Je=null,Me=0),Rr=t,ci=e,Ga=i,Dd=u,Bd=d,Rg=n,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,Mm(at,function(){return Fg(),null})):(e.callbackNode=null,e.callbackPriority=0),n=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||n){n=w.T,w.T=null,d=C.p,C.p=2,f=Ge,Ge|=4;try{km(e,t,i)}finally{Ge=f,C.p=d,w.T=n}}wt=1,$g(),Yg(),Vg()}}function $g(){if(wt===1){wt=0;var e=ci,t=Rr,i=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||i){i=w.T,w.T=null;var n=C.p;C.p=2;var d=Ge;Ge|=4;try{zg(t,e);var u=Jd,f=Tu(e.containerInfo),x=u.focusedElem,A=u.selectionRange;if(f!==x&&x&&x.ownerDocument&&Cu(x.ownerDocument.documentElement,x)){if(A!==null&&kl(x)){var G=A.start,X=A.end;if(X===void 0&&(X=G),"selectionStart"in x)x.selectionStart=G,x.selectionEnd=Math.min(X,x.value.length);else{var ae=x.ownerDocument||document,Y=ae&&ae.defaultView||window;if(Y.getSelection){var K=Y.getSelection(),ge=x.textContent.length,ve=Math.min(A.start,ge),We=A.end===void 0?ve:Math.min(A.end,ge);!K.extend&&ve>We&&(f=We,We=ve,ve=f);var L=Eu(x,ve),T=Eu(x,We);if(L&&T&&(K.rangeCount!==1||K.anchorNode!==L.node||K.anchorOffset!==L.offset||K.focusNode!==T.node||K.focusOffset!==T.offset)){var P=ae.createRange();P.setStart(L.node,L.offset),K.removeAllRanges(),ve>We?(K.addRange(P),K.extend(T.node,T.offset)):(P.setEnd(T.node,T.offset),K.addRange(P))}}}}for(ae=[],K=x;K=K.parentNode;)K.nodeType===1&&ae.push({element:K,left:K.scrollLeft,top:K.scrollTop});for(typeof x.focus=="function"&&x.focus(),x=0;x<ae.length;x++){var te=ae[x];te.element.scrollLeft=te.left,te.element.scrollTop=te.top}}ys=!!Wd,Jd=Wd=null}finally{Ge=d,C.p=n,w.T=i}}e.current=t,wt=2}}function Yg(){if(wt===2){wt=0;var e=ci,t=Rr,i=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||i){i=w.T,w.T=null;var n=C.p;C.p=2;var d=Ge;Ge|=4;try{yg(e,t.alternate,t)}finally{Ge=d,C.p=n,w.T=i}}wt=3}}function Vg(){if(wt===4||wt===3){wt=0,Ue();var e=ci,t=Rr,i=Ga,n=Rg;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?wt=5:(wt=0,Rr=ci=null,Qg(e,e.pendingLanes));var d=e.pendingLanes;if(d===0&&(di=null),il(i),t=t.stateNode,jt&&typeof jt.onCommitFiberRoot=="function")try{jt.onCommitFiberRoot(_a,t,void 0,(t.current.flags&128)===128)}catch{}if(n!==null){t=w.T,d=C.p,C.p=2,w.T=null;try{for(var u=e.onRecoverableError,f=0;f<n.length;f++){var x=n[f];u(x.value,{componentStack:x.stack})}}finally{w.T=t,C.p=d}}(Ga&3)!==0&&ss(),wa(e),d=e.pendingLanes,(i&261930)!==0&&(d&42)!==0?e===Id?On++:(On=0,Id=e):On=0,Dn(0)}}function Qg(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,fn(t)))}function ss(){return $g(),Yg(),Vg(),Fg()}function Fg(){if(wt!==5)return!1;var e=ci,t=Dd;Dd=0;var i=il(Ga),n=w.T,d=C.p;try{C.p=32>i?32:i,w.T=null,i=Bd,Bd=null;var u=ci,f=Ga;if(wt=0,Rr=ci=null,Ga=0,(Ge&6)!==0)throw Error(l(331));var x=Ge;if(Ge|=4,Cg(u.current),_g(u,u.current,f,i),Ge=x,Dn(0,!1),jt&&typeof jt.onPostCommitFiberRoot=="function")try{jt.onPostCommitFiberRoot(_a,u)}catch{}return!0}finally{C.p=d,w.T=n,Qg(e,t)}}function Kg(e,t,i){t=ra(i,t),t=fd(e.stateNode,t,2),e=ii(e,t,2),e!==null&&(en(e,2),wa(e))}function Qe(e,t,i){if(e.tag===3)Kg(e,e,i);else for(;t!==null;){if(t.tag===3){Kg(t,e,i);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(di===null||!di.has(n))){e=ra(i,e),i=Wp(2),n=ii(t,i,2),n!==null&&(Jp(i,n,t,e),en(n,2),wa(n));break}}t=t.return}}function qd(e,t,i){var n=e.pingCache;if(n===null){n=e.pingCache=new jm;var d=new Set;n.set(t,d)}else d=n.get(t),d===void 0&&(d=new Set,n.set(t,d));d.has(i)||(Rd=!0,d.add(i),e=Tm.bind(null,e,t,i),t.then(e,e))}function Tm(e,t,i){var n=e.pingCache;n!==null&&n.delete(t),e.pingedLanes|=e.suspendedLanes&i,e.warmLanes&=~i,Je===e&&(Me&i)===i&&(lt===4||lt===3&&(Me&62914560)===Me&&300>ye()-ts?(Ge&2)===0&&Mr(e,0):Md|=i,Nr===Me&&(Nr=0)),wa(e)}function Wg(e,t){t===0&&(t=$c()),e=Ni(e,t),e!==null&&(en(e,t),wa(e))}function Nm(e){var t=e.memoizedState,i=0;t!==null&&(i=t.retryLane),Wg(e,i)}function Rm(e,t){var i=0;switch(e.tag){case 31:case 13:var n=e.stateNode,d=e.memoizedState;d!==null&&(i=d.retryLane);break;case 19:n=e.stateNode;break;case 22:n=e.stateNode._retryCache;break;default:throw Error(l(314))}n!==null&&n.delete(t),Wg(e,i)}function Mm(e,t){return le(e,t)}var ls=null,Dr=null,Hd=!1,ds=!1,Pd=!1,pi=0;function wa(e){e!==Dr&&e.next===null&&(Dr===null?ls=Dr=e:Dr=Dr.next=e),ds=!0,Hd||(Hd=!0,Dm())}function Dn(e,t){if(!Pd&&ds){Pd=!0;do for(var i=!1,n=ls;n!==null;){if(e!==0){var d=n.pendingLanes;if(d===0)var u=0;else{var f=n.suspendedLanes,x=n.pingedLanes;u=(1<<31-$t(42|e)+1)-1,u&=d&~(f&~x),u=u&201326741?u&201326741|1:u?u|2:0}u!==0&&(i=!0,eh(n,u))}else u=Me,u=go(n,n===Je?u:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),(u&3)===0||Zr(n,u)||(i=!0,eh(n,u));n=n.next}while(i);Pd=!1}}function Om(){Jg()}function Jg(){ds=Hd=!1;var e=0;pi!==0&&Ym()&&(e=pi);for(var t=ye(),i=null,n=ls;n!==null;){var d=n.next,u=Xg(n,t);u===0?(n.next=null,i===null?ls=d:i.next=d,d===null&&(Dr=i)):(i=n,(e!==0||(u&3)!==0)&&(ds=!0)),n=d}wt!==0&&wt!==5||Dn(e),pi!==0&&(pi=0)}function Xg(e,t){for(var i=e.suspendedLanes,n=e.pingedLanes,d=e.expirationTimes,u=e.pendingLanes&-62914561;0<u;){var f=31-$t(u),x=1<<f,A=d[f];A===-1?((x&i)===0||(x&n)!==0)&&(d[f]=sb(x,t)):A<=t&&(e.expiredLanes|=x),u&=~x}if(t=Je,i=Me,i=go(e,e===t?i:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),n=e.callbackNode,i===0||e===t&&(Ve===2||Ve===9)||e.cancelPendingCommit!==null)return n!==null&&n!==null&&ue(n),e.callbackNode=null,e.callbackPriority=0;if((i&3)===0||Zr(e,i)){if(t=i&-i,t===e.callbackPriority)return t;switch(n!==null&&ue(n),il(i)){case 2:case 8:i=qe;break;case 32:i=at;break;case 268435456:i=Be;break;default:i=at}return n=Zg.bind(null,e),i=le(i,n),e.callbackPriority=t,e.callbackNode=i,t}return n!==null&&n!==null&&ue(n),e.callbackPriority=2,e.callbackNode=null,2}function Zg(e,t){if(wt!==0&&wt!==5)return e.callbackNode=null,e.callbackPriority=0,null;var i=e.callbackNode;if(ss()&&e.callbackNode!==i)return null;var n=Me;return n=go(e,e===Je?n:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),n===0?null:(Og(e,n,t),Xg(e,ye()),e.callbackNode!=null&&e.callbackNode===i?Zg.bind(null,e):null)}function eh(e,t){if(ss())return null;Og(e,t,!0)}function Dm(){Qm(function(){(Ge&6)!==0?le(he,Om):Jg()})}function Gd(){if(pi===0){var e=vr;e===0&&(e=co,co<<=1,(co&261888)===0&&(co=256)),pi=e}return pi}function th(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:mo(""+e)}function ah(e,t){var i=t.ownerDocument.createElement("input");return i.name=t.name,i.value=t.value,e.id&&i.setAttribute("form",e.id),t.parentNode.insertBefore(i,t),e=new FormData(e),i.parentNode.removeChild(i),e}function Bm(e,t,i,n,d){if(t==="submit"&&i&&i.stateNode===d){var u=th((d[Bt]||null).action),f=n.submitter;f&&(t=(t=f[Bt]||null)?th(t.formAction):f.getAttribute("formAction"),t!==null&&(u=t,f=null));var x=new wo("action","action",null,n,d);e.push({event:x,listeners:[{instance:null,listener:function(){if(n.defaultPrevented){if(pi!==0){var A=f?ah(d,f):new FormData(d);dd(i,{pending:!0,data:A,method:d.method,action:u},null,A)}}else typeof u=="function"&&(x.preventDefault(),A=f?ah(d,f):new FormData(d),dd(i,{pending:!0,data:A,method:d.method,action:u},u,A))},currentTarget:d}]})}}for(var $d=0;$d<_l.length;$d++){var Yd=_l[$d],Im=Yd.toLowerCase(),Lm=Yd[0].toUpperCase()+Yd.slice(1);pa(Im,"on"+Lm)}pa(Mu,"onAnimationEnd"),pa(Ou,"onAnimationIteration"),pa(Du,"onAnimationStart"),pa("dblclick","onDoubleClick"),pa("focusin","onFocus"),pa("focusout","onBlur"),pa(em,"onTransitionRun"),pa(tm,"onTransitionStart"),pa(am,"onTransitionCancel"),pa(Bu,"onTransitionEnd"),or("onMouseEnter",["mouseout","mouseover"]),or("onMouseLeave",["mouseout","mouseover"]),or("onPointerEnter",["pointerout","pointerover"]),or("onPointerLeave",["pointerout","pointerover"]),Ai("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ai("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ai("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ai("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ai("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ai("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Bn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Um=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Bn));function ih(e,t){t=(t&4)!==0;for(var i=0;i<e.length;i++){var n=e[i],d=n.event;n=n.listeners;e:{var u=void 0;if(t)for(var f=n.length-1;0<=f;f--){var x=n[f],A=x.instance,G=x.currentTarget;if(x=x.listener,A!==u&&d.isPropagationStopped())break e;u=x,d.currentTarget=G;try{u(d)}catch(X){zo(X)}d.currentTarget=null,u=A}else for(f=0;f<n.length;f++){if(x=n[f],A=x.instance,G=x.currentTarget,x=x.listener,A!==u&&d.isPropagationStopped())break e;u=x,d.currentTarget=G;try{u(d)}catch(X){zo(X)}d.currentTarget=null,u=A}}}}function Re(e,t){var i=t[rl];i===void 0&&(i=t[rl]=new Set);var n=e+"__bubble";i.has(n)||(rh(t,e,2,!1),i.add(n))}function Vd(e,t,i){var n=0;t&&(n|=4),rh(i,e,n,t)}var cs="_reactListening"+Math.random().toString(36).slice(2);function Qd(e){if(!e[cs]){e[cs]=!0,Jc.forEach(function(i){i!=="selectionchange"&&(Um.has(i)||Vd(i,!1,e),Vd(i,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[cs]||(t[cs]=!0,Vd("selectionchange",!1,t))}}function rh(e,t,i,n){switch(Mh(t)){case 2:var d=g0;break;case 8:d=h0;break;default:d=lc}i=d.bind(null,t,i,e),d=void 0,!gl||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(d=!0),n?d!==void 0?e.addEventListener(t,i,{capture:!0,passive:d}):e.addEventListener(t,i,!0):d!==void 0?e.addEventListener(t,i,{passive:d}):e.addEventListener(t,i,!1)}function Fd(e,t,i,n,d){var u=n;if((t&1)===0&&(t&2)===0&&n!==null)e:for(;;){if(n===null)return;var f=n.tag;if(f===3||f===4){var x=n.stateNode.containerInfo;if(x===d)break;if(f===4)for(f=n.return;f!==null;){var A=f.tag;if((A===3||A===4)&&f.stateNode.containerInfo===d)return;f=f.return}for(;x!==null;){if(f=ir(x),f===null)return;if(A=f.tag,A===5||A===6||A===26||A===27){n=u=f;continue e}x=x.parentNode}}n=n.return}du(function(){var G=u,X=ul(i),ae=[];e:{var Y=Iu.get(e);if(Y!==void 0){var K=wo,ge=e;switch(e){case"keypress":if(yo(i)===0)break e;case"keydown":case"keyup":K=Rb;break;case"focusin":ge="focus",K=ml;break;case"focusout":ge="blur",K=ml;break;case"beforeblur":case"afterblur":K=ml;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":K=pu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":K=vb;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":K=Db;break;case Mu:case Ou:case Du:K=Sb;break;case Bu:K=Ib;break;case"scroll":case"scrollend":K=xb;break;case"wheel":K=Ub;break;case"copy":case"cut":case"paste":K=jb;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":K=hu;break;case"toggle":case"beforetoggle":K=Hb}var ve=(t&4)!==0,We=!ve&&(e==="scroll"||e==="scrollend"),L=ve?Y!==null?Y+"Capture":null:Y;ve=[];for(var T=G,P;T!==null;){var te=T;if(P=te.stateNode,te=te.tag,te!==5&&te!==26&&te!==27||P===null||L===null||(te=rn(T,L),te!=null&&ve.push(In(T,te,P))),We)break;T=T.return}0<ve.length&&(Y=new K(Y,ge,null,i,X),ae.push({event:Y,listeners:ve}))}}if((t&7)===0){e:{if(Y=e==="mouseover"||e==="pointerover",K=e==="mouseout"||e==="pointerout",Y&&i!==cl&&(ge=i.relatedTarget||i.fromElement)&&(ir(ge)||ge[ar]))break e;if((K||Y)&&(Y=X.window===X?X:(Y=X.ownerDocument)?Y.defaultView||Y.parentWindow:window,K?(ge=i.relatedTarget||i.toElement,K=G,ge=ge?ir(ge):null,ge!==null&&(We=c(ge),ve=ge.tag,ge!==We||ve!==5&&ve!==27&&ve!==6)&&(ge=null)):(K=null,ge=G),K!==ge)){if(ve=pu,te="onMouseLeave",L="onMouseEnter",T="mouse",(e==="pointerout"||e==="pointerover")&&(ve=hu,te="onPointerLeave",L="onPointerEnter",T="pointer"),We=K==null?Y:an(K),P=ge==null?Y:an(ge),Y=new ve(te,T+"leave",K,i,X),Y.target=We,Y.relatedTarget=P,te=null,ir(X)===G&&(ve=new ve(L,T+"enter",ge,i,X),ve.target=P,ve.relatedTarget=We,te=ve),We=te,K&&ge)t:{for(ve=qm,L=K,T=ge,P=0,te=L;te;te=ve(te))P++;te=0;for(var xe=T;xe;xe=ve(xe))te++;for(;0<P-te;)L=ve(L),P--;for(;0<te-P;)T=ve(T),te--;for(;P--;){if(L===T||T!==null&&L===T.alternate){ve=L;break t}L=ve(L),T=ve(T)}ve=null}else ve=null;K!==null&&nh(ae,Y,K,ve,!1),ge!==null&&We!==null&&nh(ae,We,ge,ve,!0)}}e:{if(Y=G?an(G):window,K=Y.nodeName&&Y.nodeName.toLowerCase(),K==="select"||K==="input"&&Y.type==="file")var He=ku;else if(vu(Y))if(Su)He=Jb;else{He=Kb;var fe=Fb}else K=Y.nodeName,!K||K.toLowerCase()!=="input"||Y.type!=="checkbox"&&Y.type!=="radio"?G&&dl(G.elementType)&&(He=ku):He=Wb;if(He&&(He=He(e,G))){wu(ae,He,i,X);break e}fe&&fe(e,Y,G),e==="focusout"&&G&&Y.type==="number"&&G.memoizedProps.value!=null&&ll(Y,"number",Y.value)}switch(fe=G?an(G):window,e){case"focusin":(vu(fe)||fe.contentEditable==="true")&&(pr=fe,Sl=G,pn=null);break;case"focusout":pn=Sl=pr=null;break;case"mousedown":zl=!0;break;case"contextmenu":case"mouseup":case"dragend":zl=!1,Nu(ae,i,X);break;case"selectionchange":if(Zb)break;case"keydown":case"keyup":Nu(ae,i,X)}var Ee;if(yl)e:{switch(e){case"compositionstart":var Oe="onCompositionStart";break e;case"compositionend":Oe="onCompositionEnd";break e;case"compositionupdate":Oe="onCompositionUpdate";break e}Oe=void 0}else ur?xu(e,i)&&(Oe="onCompositionEnd"):e==="keydown"&&i.keyCode===229&&(Oe="onCompositionStart");Oe&&(fu&&i.locale!=="ko"&&(ur||Oe!=="onCompositionStart"?Oe==="onCompositionEnd"&&ur&&(Ee=cu()):(Wa=X,hl="value"in Wa?Wa.value:Wa.textContent,ur=!0)),fe=us(G,Oe),0<fe.length&&(Oe=new gu(Oe,e,null,i,X),ae.push({event:Oe,listeners:fe}),Ee?Oe.data=Ee:(Ee=yu(i),Ee!==null&&(Oe.data=Ee)))),(Ee=Gb?$b(e,i):Yb(e,i))&&(Oe=us(G,"onBeforeInput"),0<Oe.length&&(fe=new gu("onBeforeInput","beforeinput",null,i,X),ae.push({event:fe,listeners:Oe}),fe.data=Ee)),Bm(ae,e,G,i,X)}ih(ae,t)})}function In(e,t,i){return{instance:e,listener:t,currentTarget:i}}function us(e,t){for(var i=t+"Capture",n=[];e!==null;){var d=e,u=d.stateNode;if(d=d.tag,d!==5&&d!==26&&d!==27||u===null||(d=rn(e,i),d!=null&&n.unshift(In(e,d,u)),d=rn(e,t),d!=null&&n.push(In(e,d,u))),e.tag===3)return n;e=e.return}return[]}function qm(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function nh(e,t,i,n,d){for(var u=t._reactName,f=[];i!==null&&i!==n;){var x=i,A=x.alternate,G=x.stateNode;if(x=x.tag,A!==null&&A===n)break;x!==5&&x!==26&&x!==27||G===null||(A=G,d?(G=rn(i,u),G!=null&&f.unshift(In(i,G,A))):d||(G=rn(i,u),G!=null&&f.push(In(i,G,A)))),i=i.return}f.length!==0&&e.push({event:t,listeners:f})}var Hm=/\r\n?/g,Pm=/\u0000|\uFFFD/g;function oh(e){return(typeof e=="string"?e:""+e).replace(Hm,`
`).replace(Pm,"")}function sh(e,t){return t=oh(t),oh(e)===t}function Ke(e,t,i,n,d,u){switch(i){case"children":typeof n=="string"?t==="body"||t==="textarea"&&n===""||lr(e,n):(typeof n=="number"||typeof n=="bigint")&&t!=="body"&&lr(e,""+n);break;case"className":fo(e,"class",n);break;case"tabIndex":fo(e,"tabindex",n);break;case"dir":case"role":case"viewBox":case"width":case"height":fo(e,i,n);break;case"style":su(e,n,u);break;case"data":if(t!=="object"){fo(e,"data",n);break}case"src":case"href":if(n===""&&(t!=="a"||i!=="href")){e.removeAttribute(i);break}if(n==null||typeof n=="function"||typeof n=="symbol"||typeof n=="boolean"){e.removeAttribute(i);break}n=mo(""+n),e.setAttribute(i,n);break;case"action":case"formAction":if(typeof n=="function"){e.setAttribute(i,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof u=="function"&&(i==="formAction"?(t!=="input"&&Ke(e,t,"name",d.name,d,null),Ke(e,t,"formEncType",d.formEncType,d,null),Ke(e,t,"formMethod",d.formMethod,d,null),Ke(e,t,"formTarget",d.formTarget,d,null)):(Ke(e,t,"encType",d.encType,d,null),Ke(e,t,"method",d.method,d,null),Ke(e,t,"target",d.target,d,null)));if(n==null||typeof n=="symbol"||typeof n=="boolean"){e.removeAttribute(i);break}n=mo(""+n),e.setAttribute(i,n);break;case"onClick":n!=null&&(e.onclick=Ea);break;case"onScroll":n!=null&&Re("scroll",e);break;case"onScrollEnd":n!=null&&Re("scrollend",e);break;case"dangerouslySetInnerHTML":if(n!=null){if(typeof n!="object"||!("__html"in n))throw Error(l(61));if(i=n.__html,i!=null){if(d.children!=null)throw Error(l(60));e.innerHTML=i}}break;case"multiple":e.multiple=n&&typeof n!="function"&&typeof n!="symbol";break;case"muted":e.muted=n&&typeof n!="function"&&typeof n!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(n==null||typeof n=="function"||typeof n=="boolean"||typeof n=="symbol"){e.removeAttribute("xlink:href");break}i=mo(""+n),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",i);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":n!=null&&typeof n!="function"&&typeof n!="symbol"?e.setAttribute(i,""+n):e.removeAttribute(i);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":n&&typeof n!="function"&&typeof n!="symbol"?e.setAttribute(i,""):e.removeAttribute(i);break;case"capture":case"download":n===!0?e.setAttribute(i,""):n!==!1&&n!=null&&typeof n!="function"&&typeof n!="symbol"?e.setAttribute(i,n):e.removeAttribute(i);break;case"cols":case"rows":case"size":case"span":n!=null&&typeof n!="function"&&typeof n!="symbol"&&!isNaN(n)&&1<=n?e.setAttribute(i,n):e.removeAttribute(i);break;case"rowSpan":case"start":n==null||typeof n=="function"||typeof n=="symbol"||isNaN(n)?e.removeAttribute(i):e.setAttribute(i,n);break;case"popover":Re("beforetoggle",e),Re("toggle",e),ho(e,"popover",n);break;case"xlinkActuate":Aa(e,"http://www.w3.org/1999/xlink","xlink:actuate",n);break;case"xlinkArcrole":Aa(e,"http://www.w3.org/1999/xlink","xlink:arcrole",n);break;case"xlinkRole":Aa(e,"http://www.w3.org/1999/xlink","xlink:role",n);break;case"xlinkShow":Aa(e,"http://www.w3.org/1999/xlink","xlink:show",n);break;case"xlinkTitle":Aa(e,"http://www.w3.org/1999/xlink","xlink:title",n);break;case"xlinkType":Aa(e,"http://www.w3.org/1999/xlink","xlink:type",n);break;case"xmlBase":Aa(e,"http://www.w3.org/XML/1998/namespace","xml:base",n);break;case"xmlLang":Aa(e,"http://www.w3.org/XML/1998/namespace","xml:lang",n);break;case"xmlSpace":Aa(e,"http://www.w3.org/XML/1998/namespace","xml:space",n);break;case"is":ho(e,"is",n);break;case"innerText":case"textContent":break;default:(!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(i=bb.get(i)||i,ho(e,i,n))}}function Kd(e,t,i,n,d,u){switch(i){case"style":su(e,n,u);break;case"dangerouslySetInnerHTML":if(n!=null){if(typeof n!="object"||!("__html"in n))throw Error(l(61));if(i=n.__html,i!=null){if(d.children!=null)throw Error(l(60));e.innerHTML=i}}break;case"children":typeof n=="string"?lr(e,n):(typeof n=="number"||typeof n=="bigint")&&lr(e,""+n);break;case"onScroll":n!=null&&Re("scroll",e);break;case"onScrollEnd":n!=null&&Re("scrollend",e);break;case"onClick":n!=null&&(e.onclick=Ea);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Xc.hasOwnProperty(i))e:{if(i[0]==="o"&&i[1]==="n"&&(d=i.endsWith("Capture"),t=i.slice(2,d?i.length-7:void 0),u=e[Bt]||null,u=u!=null?u[i]:null,typeof u=="function"&&e.removeEventListener(t,u,d),typeof n=="function")){typeof u!="function"&&u!==null&&(i in e?e[i]=null:e.hasAttribute(i)&&e.removeAttribute(i)),e.addEventListener(t,n,d);break e}i in e?e[i]=n:n===!0?e.setAttribute(i,""):ho(e,i,n)}}}function Tt(e,t,i){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Re("error",e),Re("load",e);var n=!1,d=!1,u;for(u in i)if(i.hasOwnProperty(u)){var f=i[u];if(f!=null)switch(u){case"src":n=!0;break;case"srcSet":d=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(l(137,t));default:Ke(e,t,u,f,i,null)}}d&&Ke(e,t,"srcSet",i.srcSet,i,null),n&&Ke(e,t,"src",i.src,i,null);return;case"input":Re("invalid",e);var x=u=f=d=null,A=null,G=null;for(n in i)if(i.hasOwnProperty(n)){var X=i[n];if(X!=null)switch(n){case"name":d=X;break;case"type":f=X;break;case"checked":A=X;break;case"defaultChecked":G=X;break;case"value":u=X;break;case"defaultValue":x=X;break;case"children":case"dangerouslySetInnerHTML":if(X!=null)throw Error(l(137,t));break;default:Ke(e,t,n,X,i,null)}}iu(e,u,x,A,G,f,d,!1);return;case"select":Re("invalid",e),n=f=u=null;for(d in i)if(i.hasOwnProperty(d)&&(x=i[d],x!=null))switch(d){case"value":u=x;break;case"defaultValue":f=x;break;case"multiple":n=x;default:Ke(e,t,d,x,i,null)}t=u,i=f,e.multiple=!!n,t!=null?sr(e,!!n,t,!1):i!=null&&sr(e,!!n,i,!0);return;case"textarea":Re("invalid",e),u=d=n=null;for(f in i)if(i.hasOwnProperty(f)&&(x=i[f],x!=null))switch(f){case"value":n=x;break;case"defaultValue":d=x;break;case"children":u=x;break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(l(91));break;default:Ke(e,t,f,x,i,null)}nu(e,n,d,u);return;case"option":for(A in i)i.hasOwnProperty(A)&&(n=i[A],n!=null)&&(A==="selected"?e.selected=n&&typeof n!="function"&&typeof n!="symbol":Ke(e,t,A,n,i,null));return;case"dialog":Re("beforetoggle",e),Re("toggle",e),Re("cancel",e),Re("close",e);break;case"iframe":case"object":Re("load",e);break;case"video":case"audio":for(n=0;n<Bn.length;n++)Re(Bn[n],e);break;case"image":Re("error",e),Re("load",e);break;case"details":Re("toggle",e);break;case"embed":case"source":case"link":Re("error",e),Re("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(G in i)if(i.hasOwnProperty(G)&&(n=i[G],n!=null))switch(G){case"children":case"dangerouslySetInnerHTML":throw Error(l(137,t));default:Ke(e,t,G,n,i,null)}return;default:if(dl(t)){for(X in i)i.hasOwnProperty(X)&&(n=i[X],n!==void 0&&Kd(e,t,X,n,i,void 0));return}}for(x in i)i.hasOwnProperty(x)&&(n=i[x],n!=null&&Ke(e,t,x,n,i,null))}function Gm(e,t,i,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var d=null,u=null,f=null,x=null,A=null,G=null,X=null;for(K in i){var ae=i[K];if(i.hasOwnProperty(K)&&ae!=null)switch(K){case"checked":break;case"value":break;case"defaultValue":A=ae;default:n.hasOwnProperty(K)||Ke(e,t,K,null,n,ae)}}for(var Y in n){var K=n[Y];if(ae=i[Y],n.hasOwnProperty(Y)&&(K!=null||ae!=null))switch(Y){case"type":u=K;break;case"name":d=K;break;case"checked":G=K;break;case"defaultChecked":X=K;break;case"value":f=K;break;case"defaultValue":x=K;break;case"children":case"dangerouslySetInnerHTML":if(K!=null)throw Error(l(137,t));break;default:K!==ae&&Ke(e,t,Y,K,n,ae)}}sl(e,f,x,A,G,X,u,d);return;case"select":K=f=x=Y=null;for(u in i)if(A=i[u],i.hasOwnProperty(u)&&A!=null)switch(u){case"value":break;case"multiple":K=A;default:n.hasOwnProperty(u)||Ke(e,t,u,null,n,A)}for(d in n)if(u=n[d],A=i[d],n.hasOwnProperty(d)&&(u!=null||A!=null))switch(d){case"value":Y=u;break;case"defaultValue":x=u;break;case"multiple":f=u;default:u!==A&&Ke(e,t,d,u,n,A)}t=x,i=f,n=K,Y!=null?sr(e,!!i,Y,!1):!!n!=!!i&&(t!=null?sr(e,!!i,t,!0):sr(e,!!i,i?[]:"",!1));return;case"textarea":K=Y=null;for(x in i)if(d=i[x],i.hasOwnProperty(x)&&d!=null&&!n.hasOwnProperty(x))switch(x){case"value":break;case"children":break;default:Ke(e,t,x,null,n,d)}for(f in n)if(d=n[f],u=i[f],n.hasOwnProperty(f)&&(d!=null||u!=null))switch(f){case"value":Y=d;break;case"defaultValue":K=d;break;case"children":break;case"dangerouslySetInnerHTML":if(d!=null)throw Error(l(91));break;default:d!==u&&Ke(e,t,f,d,n,u)}ru(e,Y,K);return;case"option":for(var ge in i)Y=i[ge],i.hasOwnProperty(ge)&&Y!=null&&!n.hasOwnProperty(ge)&&(ge==="selected"?e.selected=!1:Ke(e,t,ge,null,n,Y));for(A in n)Y=n[A],K=i[A],n.hasOwnProperty(A)&&Y!==K&&(Y!=null||K!=null)&&(A==="selected"?e.selected=Y&&typeof Y!="function"&&typeof Y!="symbol":Ke(e,t,A,Y,n,K));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ve in i)Y=i[ve],i.hasOwnProperty(ve)&&Y!=null&&!n.hasOwnProperty(ve)&&Ke(e,t,ve,null,n,Y);for(G in n)if(Y=n[G],K=i[G],n.hasOwnProperty(G)&&Y!==K&&(Y!=null||K!=null))switch(G){case"children":case"dangerouslySetInnerHTML":if(Y!=null)throw Error(l(137,t));break;default:Ke(e,t,G,Y,n,K)}return;default:if(dl(t)){for(var We in i)Y=i[We],i.hasOwnProperty(We)&&Y!==void 0&&!n.hasOwnProperty(We)&&Kd(e,t,We,void 0,n,Y);for(X in n)Y=n[X],K=i[X],!n.hasOwnProperty(X)||Y===K||Y===void 0&&K===void 0||Kd(e,t,X,Y,n,K);return}}for(var L in i)Y=i[L],i.hasOwnProperty(L)&&Y!=null&&!n.hasOwnProperty(L)&&Ke(e,t,L,null,n,Y);for(ae in n)Y=n[ae],K=i[ae],!n.hasOwnProperty(ae)||Y===K||Y==null&&K==null||Ke(e,t,ae,Y,n,K)}function lh(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function $m(){if(typeof performance.getEntriesByType=="function"){for(var e=0,t=0,i=performance.getEntriesByType("resource"),n=0;n<i.length;n++){var d=i[n],u=d.transferSize,f=d.initiatorType,x=d.duration;if(u&&x&&lh(f)){for(f=0,x=d.responseEnd,n+=1;n<i.length;n++){var A=i[n],G=A.startTime;if(G>x)break;var X=A.transferSize,ae=A.initiatorType;X&&lh(ae)&&(A=A.responseEnd,f+=X*(A<x?1:(x-G)/(A-G)))}if(--n,t+=8*(u+f)/(d.duration/1e3),e++,10<e)break}}if(0<e)return t/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var Wd=null,Jd=null;function ps(e){return e.nodeType===9?e:e.ownerDocument}function dh(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ch(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function Xd(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Zd=null;function Ym(){var e=window.event;return e&&e.type==="popstate"?e===Zd?!1:(Zd=e,!0):(Zd=null,!1)}var uh=typeof setTimeout=="function"?setTimeout:void 0,Vm=typeof clearTimeout=="function"?clearTimeout:void 0,ph=typeof Promise=="function"?Promise:void 0,Qm=typeof queueMicrotask=="function"?queueMicrotask:typeof ph<"u"?function(e){return ph.resolve(null).then(e).catch(Fm)}:uh;function Fm(e){setTimeout(function(){throw e})}function gi(e){return e==="head"}function gh(e,t){var i=t,n=0;do{var d=i.nextSibling;if(e.removeChild(i),d&&d.nodeType===8)if(i=d.data,i==="/$"||i==="/&"){if(n===0){e.removeChild(d),Ur(t);return}n--}else if(i==="$"||i==="$?"||i==="$~"||i==="$!"||i==="&")n++;else if(i==="html")Ln(e.ownerDocument.documentElement);else if(i==="head"){i=e.ownerDocument.head,Ln(i);for(var u=i.firstChild;u;){var f=u.nextSibling,x=u.nodeName;u[tn]||x==="SCRIPT"||x==="STYLE"||x==="LINK"&&u.rel.toLowerCase()==="stylesheet"||i.removeChild(u),u=f}}else i==="body"&&Ln(e.ownerDocument.body);i=d}while(i);Ur(t)}function hh(e,t){var i=e;e=0;do{var n=i.nextSibling;if(i.nodeType===1?t?(i._stashedDisplay=i.style.display,i.style.display="none"):(i.style.display=i._stashedDisplay||"",i.getAttribute("style")===""&&i.removeAttribute("style")):i.nodeType===3&&(t?(i._stashedText=i.nodeValue,i.nodeValue=""):i.nodeValue=i._stashedText||""),n&&n.nodeType===8)if(i=n.data,i==="/$"){if(e===0)break;e--}else i!=="$"&&i!=="$?"&&i!=="$~"&&i!=="$!"||e++;i=n}while(i)}function ec(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var i=t;switch(t=t.nextSibling,i.nodeName){case"HTML":case"HEAD":case"BODY":ec(i),nl(i);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(i.rel.toLowerCase()==="stylesheet")continue}e.removeChild(i)}}function Km(e,t,i,n){for(;e.nodeType===1;){var d=i;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!n&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(n){if(!e[tn])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(u=e.getAttribute("rel"),u==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(u!==d.rel||e.getAttribute("href")!==(d.href==null||d.href===""?null:d.href)||e.getAttribute("crossorigin")!==(d.crossOrigin==null?null:d.crossOrigin)||e.getAttribute("title")!==(d.title==null?null:d.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(u=e.getAttribute("src"),(u!==(d.src==null?null:d.src)||e.getAttribute("type")!==(d.type==null?null:d.type)||e.getAttribute("crossorigin")!==(d.crossOrigin==null?null:d.crossOrigin))&&u&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var u=d.name==null?null:""+d.name;if(d.type==="hidden"&&e.getAttribute("name")===u)return e}else return e;if(e=da(e.nextSibling),e===null)break}return null}function Wm(e,t,i){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!i||(e=da(e.nextSibling),e===null))return null;return e}function fh(e,t){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!t||(e=da(e.nextSibling),e===null))return null;return e}function tc(e){return e.data==="$?"||e.data==="$~"}function ac(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function Jm(e,t){var i=e.ownerDocument;if(e.data==="$~")e._reactRetry=t;else if(e.data!=="$?"||i.readyState!=="loading")t();else{var n=function(){t(),i.removeEventListener("DOMContentLoaded",n)};i.addEventListener("DOMContentLoaded",n),e._reactRetry=n}}function da(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return e}var ic=null;function bh(e){e=e.nextSibling;for(var t=0;e;){if(e.nodeType===8){var i=e.data;if(i==="/$"||i==="/&"){if(t===0)return da(e.nextSibling);t--}else i!=="$"&&i!=="$!"&&i!=="$?"&&i!=="$~"&&i!=="&"||t++}e=e.nextSibling}return null}function mh(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var i=e.data;if(i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"){if(t===0)return e;t--}else i!=="/$"&&i!=="/&"||t++}e=e.previousSibling}return null}function xh(e,t,i){switch(t=ps(i),e){case"html":if(e=t.documentElement,!e)throw Error(l(452));return e;case"head":if(e=t.head,!e)throw Error(l(453));return e;case"body":if(e=t.body,!e)throw Error(l(454));return e;default:throw Error(l(451))}}function Ln(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);nl(e)}var ca=new Map,yh=new Set;function gs(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var $a=C.d;C.d={f:Xm,r:Zm,D:e0,C:t0,L:a0,m:i0,X:n0,S:r0,M:o0};function Xm(){var e=$a.f(),t=rs();return e||t}function Zm(e){var t=rr(e);t!==null&&t.tag===5&&t.type==="form"?Bp(t):$a.r(e)}var Br=typeof document>"u"?null:document;function vh(e,t,i){var n=Br;if(n&&typeof t=="string"&&t){var d=aa(t);d='link[rel="'+e+'"][href="'+d+'"]',typeof i=="string"&&(d+='[crossorigin="'+i+'"]'),yh.has(d)||(yh.add(d),e={rel:e,crossOrigin:i,href:t},n.querySelector(d)===null&&(t=n.createElement("link"),Tt(t,"link",e),St(t),n.head.appendChild(t)))}}function e0(e){$a.D(e),vh("dns-prefetch",e,null)}function t0(e,t){$a.C(e,t),vh("preconnect",e,t)}function a0(e,t,i){$a.L(e,t,i);var n=Br;if(n&&e&&t){var d='link[rel="preload"][as="'+aa(t)+'"]';t==="image"&&i&&i.imageSrcSet?(d+='[imagesrcset="'+aa(i.imageSrcSet)+'"]',typeof i.imageSizes=="string"&&(d+='[imagesizes="'+aa(i.imageSizes)+'"]')):d+='[href="'+aa(e)+'"]';var u=d;switch(t){case"style":u=Ir(e);break;case"script":u=Lr(e)}ca.has(u)||(e=z({rel:"preload",href:t==="image"&&i&&i.imageSrcSet?void 0:e,as:t},i),ca.set(u,e),n.querySelector(d)!==null||t==="style"&&n.querySelector(Un(u))||t==="script"&&n.querySelector(qn(u))||(t=n.createElement("link"),Tt(t,"link",e),St(t),n.head.appendChild(t)))}}function i0(e,t){$a.m(e,t);var i=Br;if(i&&e){var n=t&&typeof t.as=="string"?t.as:"script",d='link[rel="modulepreload"][as="'+aa(n)+'"][href="'+aa(e)+'"]',u=d;switch(n){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":u=Lr(e)}if(!ca.has(u)&&(e=z({rel:"modulepreload",href:e},t),ca.set(u,e),i.querySelector(d)===null)){switch(n){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(i.querySelector(qn(u)))return}n=i.createElement("link"),Tt(n,"link",e),St(n),i.head.appendChild(n)}}}function r0(e,t,i){$a.S(e,t,i);var n=Br;if(n&&e){var d=nr(n).hoistableStyles,u=Ir(e);t=t||"default";var f=d.get(u);if(!f){var x={loading:0,preload:null};if(f=n.querySelector(Un(u)))x.loading=5;else{e=z({rel:"stylesheet",href:e,"data-precedence":t},i),(i=ca.get(u))&&rc(e,i);var A=f=n.createElement("link");St(A),Tt(A,"link",e),A._p=new Promise(function(G,X){A.onload=G,A.onerror=X}),A.addEventListener("load",function(){x.loading|=1}),A.addEventListener("error",function(){x.loading|=2}),x.loading|=4,hs(f,t,n)}f={type:"stylesheet",instance:f,count:1,state:x},d.set(u,f)}}}function n0(e,t){$a.X(e,t);var i=Br;if(i&&e){var n=nr(i).hoistableScripts,d=Lr(e),u=n.get(d);u||(u=i.querySelector(qn(d)),u||(e=z({src:e,async:!0},t),(t=ca.get(d))&&nc(e,t),u=i.createElement("script"),St(u),Tt(u,"link",e),i.head.appendChild(u)),u={type:"script",instance:u,count:1,state:null},n.set(d,u))}}function o0(e,t){$a.M(e,t);var i=Br;if(i&&e){var n=nr(i).hoistableScripts,d=Lr(e),u=n.get(d);u||(u=i.querySelector(qn(d)),u||(e=z({src:e,async:!0,type:"module"},t),(t=ca.get(d))&&nc(e,t),u=i.createElement("script"),St(u),Tt(u,"link",e),i.head.appendChild(u)),u={type:"script",instance:u,count:1,state:null},n.set(d,u))}}function wh(e,t,i,n){var d=(d=tt.current)?gs(d):null;if(!d)throw Error(l(446));switch(e){case"meta":case"title":return null;case"style":return typeof i.precedence=="string"&&typeof i.href=="string"?(t=Ir(i.href),i=nr(d).hoistableStyles,n=i.get(t),n||(n={type:"style",instance:null,count:0,state:null},i.set(t,n)),n):{type:"void",instance:null,count:0,state:null};case"link":if(i.rel==="stylesheet"&&typeof i.href=="string"&&typeof i.precedence=="string"){e=Ir(i.href);var u=nr(d).hoistableStyles,f=u.get(e);if(f||(d=d.ownerDocument||d,f={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},u.set(e,f),(u=d.querySelector(Un(e)))&&!u._p&&(f.instance=u,f.state.loading=5),ca.has(e)||(i={rel:"preload",as:"style",href:i.href,crossOrigin:i.crossOrigin,integrity:i.integrity,media:i.media,hrefLang:i.hrefLang,referrerPolicy:i.referrerPolicy},ca.set(e,i),u||s0(d,e,i,f.state))),t&&n===null)throw Error(l(528,""));return f}if(t&&n!==null)throw Error(l(529,""));return null;case"script":return t=i.async,i=i.src,typeof i=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=Lr(i),i=nr(d).hoistableScripts,n=i.get(t),n||(n={type:"script",instance:null,count:0,state:null},i.set(t,n)),n):{type:"void",instance:null,count:0,state:null};default:throw Error(l(444,e))}}function Ir(e){return'href="'+aa(e)+'"'}function Un(e){return'link[rel="stylesheet"]['+e+"]"}function kh(e){return z({},e,{"data-precedence":e.precedence,precedence:null})}function s0(e,t,i,n){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?n.loading=1:(t=e.createElement("link"),n.preload=t,t.addEventListener("load",function(){return n.loading|=1}),t.addEventListener("error",function(){return n.loading|=2}),Tt(t,"link",i),St(t),e.head.appendChild(t))}function Lr(e){return'[src="'+aa(e)+'"]'}function qn(e){return"script[async]"+e}function Sh(e,t,i){if(t.count++,t.instance===null)switch(t.type){case"style":var n=e.querySelector('style[data-href~="'+aa(i.href)+'"]');if(n)return t.instance=n,St(n),n;var d=z({},i,{"data-href":i.href,"data-precedence":i.precedence,href:null,precedence:null});return n=(e.ownerDocument||e).createElement("style"),St(n),Tt(n,"style",d),hs(n,i.precedence,e),t.instance=n;case"stylesheet":d=Ir(i.href);var u=e.querySelector(Un(d));if(u)return t.state.loading|=4,t.instance=u,St(u),u;n=kh(i),(d=ca.get(d))&&rc(n,d),u=(e.ownerDocument||e).createElement("link"),St(u);var f=u;return f._p=new Promise(function(x,A){f.onload=x,f.onerror=A}),Tt(u,"link",n),t.state.loading|=4,hs(u,i.precedence,e),t.instance=u;case"script":return u=Lr(i.src),(d=e.querySelector(qn(u)))?(t.instance=d,St(d),d):(n=i,(d=ca.get(u))&&(n=z({},i),nc(n,d)),e=e.ownerDocument||e,d=e.createElement("script"),St(d),Tt(d,"link",n),e.head.appendChild(d),t.instance=d);case"void":return null;default:throw Error(l(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(n=t.instance,t.state.loading|=4,hs(n,i.precedence,e));return t.instance}function hs(e,t,i){for(var n=i.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),d=n.length?n[n.length-1]:null,u=d,f=0;f<n.length;f++){var x=n[f];if(x.dataset.precedence===t)u=x;else if(u!==d)break}u?u.parentNode.insertBefore(e,u.nextSibling):(t=i.nodeType===9?i.head:i,t.insertBefore(e,t.firstChild))}function rc(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function nc(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var fs=null;function zh(e,t,i){if(fs===null){var n=new Map,d=fs=new Map;d.set(i,n)}else d=fs,n=d.get(i),n||(n=new Map,d.set(i,n));if(n.has(e))return n;for(n.set(e,null),i=i.getElementsByTagName(e),d=0;d<i.length;d++){var u=i[d];if(!(u[tn]||u[_t]||e==="link"&&u.getAttribute("rel")==="stylesheet")&&u.namespaceURI!=="http://www.w3.org/2000/svg"){var f=u.getAttribute(t)||"";f=e+f;var x=n.get(f);x?x.push(u):n.set(f,[u])}}return n}function jh(e,t,i){e=e.ownerDocument||e,e.head.insertBefore(i,t==="title"?e.querySelector("head > title"):null)}function l0(e,t,i){if(i===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;return t.rel==="stylesheet"?(e=t.disabled,typeof t.precedence=="string"&&e==null):!0;case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function _h(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function d0(e,t,i,n){if(i.type==="stylesheet"&&(typeof n.media!="string"||matchMedia(n.media).matches!==!1)&&(i.state.loading&4)===0){if(i.instance===null){var d=Ir(n.href),u=t.querySelector(Un(d));if(u){t=u._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(e.count++,e=bs.bind(e),t.then(e,e)),i.state.loading|=4,i.instance=u,St(u);return}u=t.ownerDocument||t,n=kh(n),(d=ca.get(d))&&rc(n,d),u=u.createElement("link"),St(u);var f=u;f._p=new Promise(function(x,A){f.onload=x,f.onerror=A}),Tt(u,"link",n),i.instance=u}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(i,t),(t=i.state.preload)&&(i.state.loading&3)===0&&(e.count++,i=bs.bind(e),t.addEventListener("load",i),t.addEventListener("error",i))}}var oc=0;function c0(e,t){return e.stylesheets&&e.count===0&&xs(e,e.stylesheets),0<e.count||0<e.imgCount?function(i){var n=setTimeout(function(){if(e.stylesheets&&xs(e,e.stylesheets),e.unsuspend){var u=e.unsuspend;e.unsuspend=null,u()}},6e4+t);0<e.imgBytes&&oc===0&&(oc=62500*$m());var d=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&xs(e,e.stylesheets),e.unsuspend)){var u=e.unsuspend;e.unsuspend=null,u()}},(e.imgBytes>oc?50:800)+t);return e.unsuspend=i,function(){e.unsuspend=null,clearTimeout(n),clearTimeout(d)}}:null}function bs(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)xs(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var ms=null;function xs(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,ms=new Map,t.forEach(u0,e),ms=null,bs.call(e))}function u0(e,t){if(!(t.state.loading&4)){var i=ms.get(e);if(i)var n=i.get(null);else{i=new Map,ms.set(e,i);for(var d=e.querySelectorAll("link[data-precedence],style[data-precedence]"),u=0;u<d.length;u++){var f=d[u];(f.nodeName==="LINK"||f.getAttribute("media")!=="not all")&&(i.set(f.dataset.precedence,f),n=f)}n&&i.set(null,n)}d=t.instance,f=d.getAttribute("data-precedence"),u=i.get(f)||n,u===n&&i.set(null,d),i.set(f,d),this.count++,n=bs.bind(this),d.addEventListener("load",n),d.addEventListener("error",n),u?u.parentNode.insertBefore(d,u.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(d,e.firstChild)),t.state.loading|=4}}var Hn={$$typeof:B,Provider:null,Consumer:null,_currentValue:ne,_currentValue2:ne,_threadCount:0};function p0(e,t,i,n,d,u,f,x,A){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=tl(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=tl(0),this.hiddenUpdates=tl(null),this.identifierPrefix=n,this.onUncaughtError=d,this.onCaughtError=u,this.onRecoverableError=f,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=A,this.incompleteTransitions=new Map}function Ah(e,t,i,n,d,u,f,x,A,G,X,ae){return e=new p0(e,t,i,f,A,G,X,ae,x),t=1,u===!0&&(t|=24),u=Vt(3,null,null,t),e.current=u,u.stateNode=e,t=Ul(),t.refCount++,e.pooledCache=t,t.refCount++,u.memoizedState={element:n,isDehydrated:i,cache:t},Gl(u),e}function Eh(e){return e?(e=fr,e):fr}function Ch(e,t,i,n,d,u){d=Eh(d),n.context===null?n.context=d:n.pendingContext=d,n=ai(t),n.payload={element:i},u=u===void 0?null:u,u!==null&&(n.callback=u),i=ii(e,n,t),i!==null&&(Pt(i,e,t),yn(i,e,t))}function Th(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var i=e.retryLane;e.retryLane=i!==0&&i<t?i:t}}function sc(e,t){Th(e,t),(e=e.alternate)&&Th(e,t)}function Nh(e){if(e.tag===13||e.tag===31){var t=Ni(e,67108864);t!==null&&Pt(t,e,67108864),sc(e,67108864)}}function Rh(e){if(e.tag===13||e.tag===31){var t=Jt();t=al(t);var i=Ni(e,t);i!==null&&Pt(i,e,t),sc(e,t)}}var ys=!0;function g0(e,t,i,n){var d=w.T;w.T=null;var u=C.p;try{C.p=2,lc(e,t,i,n)}finally{C.p=u,w.T=d}}function h0(e,t,i,n){var d=w.T;w.T=null;var u=C.p;try{C.p=8,lc(e,t,i,n)}finally{C.p=u,w.T=d}}function lc(e,t,i,n){if(ys){var d=dc(n);if(d===null)Fd(e,t,n,vs,i),Oh(e,n);else if(b0(d,e,t,i,n))n.stopPropagation();else if(Oh(e,n),t&4&&-1<f0.indexOf(e)){for(;d!==null;){var u=rr(d);if(u!==null)switch(u.tag){case 3:if(u=u.stateNode,u.current.memoizedState.isDehydrated){var f=_i(u.pendingLanes);if(f!==0){var x=u;for(x.pendingLanes|=2,x.entangledLanes|=2;f;){var A=1<<31-$t(f);x.entanglements[1]|=A,f&=~A}wa(u),(Ge&6)===0&&(as=ye()+500,Dn(0))}}break;case 31:case 13:x=Ni(u,2),x!==null&&Pt(x,u,2),rs(),sc(u,2)}if(u=dc(n),u===null&&Fd(e,t,n,vs,i),u===d)break;d=u}d!==null&&n.stopPropagation()}else Fd(e,t,n,null,i)}}function dc(e){return e=ul(e),cc(e)}var vs=null;function cc(e){if(vs=null,e=ir(e),e!==null){var t=c(e);if(t===null)e=null;else{var i=t.tag;if(i===13){if(e=g(t),e!==null)return e;e=null}else if(i===31){if(e=h(t),e!==null)return e;e=null}else if(i===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return vs=e,null}function Mh(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(W()){case he:return 2;case qe:return 8;case at:case Xr:return 32;case Be:return 268435456;default:return 32}default:return 32}}var uc=!1,hi=null,fi=null,bi=null,Pn=new Map,Gn=new Map,mi=[],f0="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Oh(e,t){switch(e){case"focusin":case"focusout":hi=null;break;case"dragenter":case"dragleave":fi=null;break;case"mouseover":case"mouseout":bi=null;break;case"pointerover":case"pointerout":Pn.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Gn.delete(t.pointerId)}}function $n(e,t,i,n,d,u){return e===null||e.nativeEvent!==u?(e={blockedOn:t,domEventName:i,eventSystemFlags:n,nativeEvent:u,targetContainers:[d]},t!==null&&(t=rr(t),t!==null&&Nh(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,d!==null&&t.indexOf(d)===-1&&t.push(d),e)}function b0(e,t,i,n,d){switch(t){case"focusin":return hi=$n(hi,e,t,i,n,d),!0;case"dragenter":return fi=$n(fi,e,t,i,n,d),!0;case"mouseover":return bi=$n(bi,e,t,i,n,d),!0;case"pointerover":var u=d.pointerId;return Pn.set(u,$n(Pn.get(u)||null,e,t,i,n,d)),!0;case"gotpointercapture":return u=d.pointerId,Gn.set(u,$n(Gn.get(u)||null,e,t,i,n,d)),!0}return!1}function Dh(e){var t=ir(e.target);if(t!==null){var i=c(t);if(i!==null){if(t=i.tag,t===13){if(t=g(i),t!==null){e.blockedOn=t,Kc(e.priority,function(){Rh(i)});return}}else if(t===31){if(t=h(i),t!==null){e.blockedOn=t,Kc(e.priority,function(){Rh(i)});return}}else if(t===3&&i.stateNode.current.memoizedState.isDehydrated){e.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ws(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var i=dc(e.nativeEvent);if(i===null){i=e.nativeEvent;var n=new i.constructor(i.type,i);cl=n,i.target.dispatchEvent(n),cl=null}else return t=rr(i),t!==null&&Nh(t),e.blockedOn=i,!1;t.shift()}return!0}function Bh(e,t,i){ws(e)&&i.delete(t)}function m0(){uc=!1,hi!==null&&ws(hi)&&(hi=null),fi!==null&&ws(fi)&&(fi=null),bi!==null&&ws(bi)&&(bi=null),Pn.forEach(Bh),Gn.forEach(Bh)}function ks(e,t){e.blockedOn===t&&(e.blockedOn=null,uc||(uc=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,m0)))}var Ss=null;function Ih(e){Ss!==e&&(Ss=e,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){Ss===e&&(Ss=null);for(var t=0;t<e.length;t+=3){var i=e[t],n=e[t+1],d=e[t+2];if(typeof n!="function"){if(cc(n||i)===null)continue;break}var u=rr(i);u!==null&&(e.splice(t,3),t-=3,dd(u,{pending:!0,data:d,method:i.method,action:n},n,d))}}))}function Ur(e){function t(A){return ks(A,e)}hi!==null&&ks(hi,e),fi!==null&&ks(fi,e),bi!==null&&ks(bi,e),Pn.forEach(t),Gn.forEach(t);for(var i=0;i<mi.length;i++){var n=mi[i];n.blockedOn===e&&(n.blockedOn=null)}for(;0<mi.length&&(i=mi[0],i.blockedOn===null);)Dh(i),i.blockedOn===null&&mi.shift();if(i=(e.ownerDocument||e).$$reactFormReplay,i!=null)for(n=0;n<i.length;n+=3){var d=i[n],u=i[n+1],f=d[Bt]||null;if(typeof u=="function")f||Ih(i);else if(f){var x=null;if(u&&u.hasAttribute("formAction")){if(d=u,f=u[Bt]||null)x=f.formAction;else if(cc(d)!==null)continue}else x=f.action;typeof x=="function"?i[n+1]=x:(i.splice(n,3),n-=3),Ih(i)}}}function Lh(){function e(u){u.canIntercept&&u.info==="react-transition"&&u.intercept({handler:function(){return new Promise(function(f){return d=f})},focusReset:"manual",scroll:"manual"})}function t(){d!==null&&(d(),d=null),n||setTimeout(i,20)}function i(){if(!n&&!navigation.transition){var u=navigation.currentEntry;u&&u.url!=null&&navigation.navigate(u.url,{state:u.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var n=!1,d=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(i,100),function(){n=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),d!==null&&(d(),d=null)}}}function pc(e){this._internalRoot=e}zs.prototype.render=pc.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(l(409));var i=t.current,n=Jt();Ch(i,n,e,t,null,null)},zs.prototype.unmount=pc.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ch(e.current,2,null,e,null,null),rs(),t[ar]=null}};function zs(e){this._internalRoot=e}zs.prototype.unstable_scheduleHydration=function(e){if(e){var t=Fc();e={blockedOn:null,target:e,priority:t};for(var i=0;i<mi.length&&t!==0&&t<mi[i].priority;i++);mi.splice(i,0,e),i===0&&Dh(e)}};var Uh=a.version;if(Uh!=="19.2.4")throw Error(l(527,Uh,"19.2.4"));C.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(l(188)):(e=Object.keys(e).join(","),Error(l(268,e)));return e=m(t),e=e!==null?v(e):null,e=e===null?null:e.stateNode,e};var x0={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:w,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var js=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!js.isDisabled&&js.supportsFiber)try{_a=js.inject(x0),jt=js}catch{}}return Yn.createRoot=function(e,t){if(!p(e))throw Error(l(299));var i=!1,n="",d=Vp,u=Qp,f=Fp;return t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onUncaughtError!==void 0&&(d=t.onUncaughtError),t.onCaughtError!==void 0&&(u=t.onCaughtError),t.onRecoverableError!==void 0&&(f=t.onRecoverableError)),t=Ah(e,1,!1,null,null,i,n,null,d,u,f,Lh),e[ar]=t.current,Qd(e),new pc(t)},Yn.hydrateRoot=function(e,t,i){if(!p(e))throw Error(l(299));var n=!1,d="",u=Vp,f=Qp,x=Fp,A=null;return i!=null&&(i.unstable_strictMode===!0&&(n=!0),i.identifierPrefix!==void 0&&(d=i.identifierPrefix),i.onUncaughtError!==void 0&&(u=i.onUncaughtError),i.onCaughtError!==void 0&&(f=i.onCaughtError),i.onRecoverableError!==void 0&&(x=i.onRecoverableError),i.formState!==void 0&&(A=i.formState)),t=Ah(e,1,!0,t,i??null,n,d,A,u,f,x,Lh),t.context=Eh(null),i=t.current,n=Jt(),n=al(n),d=ai(n),d.callback=null,ii(i,d,n),i=n,t.current.lanes=i,en(t,i),wa(t),e[ar]=t.current,Qd(e),new zs(t)},Yn.version="19.2.4",Yn}var Gh;function j0(){if(Gh)return gc.exports;Gh=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(a){console.error(a)}}return r(),gc.exports=z0(),gc.exports}var _0=j0();function Ks(r,a){var o={};for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&a.indexOf(l)<0&&(o[l]=r[l]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var p=0,l=Object.getOwnPropertySymbols(r);p<l.length;p++)a.indexOf(l[p])<0&&Object.prototype.propertyIsEnumerable.call(r,l[p])&&(o[l[p]]=r[l[p]]);return o}function A0(r,a,o,l){function p(c){return c instanceof o?c:new o(function(g){g(c)})}return new(o||(o=Promise))(function(c,g){function h(v){try{m(l.next(v))}catch(z){g(z)}}function b(v){try{m(l.throw(v))}catch(z){g(z)}}function m(v){v.done?c(v.value):p(v.value).then(h,b)}m((l=l.apply(r,a||[])).next())})}const E0=r=>r?(...a)=>r(...a):(...a)=>fetch(...a);class qc extends Error{constructor(a,o="FunctionsError",l){super(a),this.name=o,this.context=l}}class C0 extends qc{constructor(a){super("Failed to send a request to the Edge Function","FunctionsFetchError",a)}}class $h extends qc{constructor(a){super("Relay Error invoking the Edge Function","FunctionsRelayError",a)}}class Yh extends qc{constructor(a){super("Edge Function returned a non-2xx status code","FunctionsHttpError",a)}}var Tc;(function(r){r.Any="any",r.ApNortheast1="ap-northeast-1",r.ApNortheast2="ap-northeast-2",r.ApSouth1="ap-south-1",r.ApSoutheast1="ap-southeast-1",r.ApSoutheast2="ap-southeast-2",r.CaCentral1="ca-central-1",r.EuCentral1="eu-central-1",r.EuWest1="eu-west-1",r.EuWest2="eu-west-2",r.EuWest3="eu-west-3",r.SaEast1="sa-east-1",r.UsEast1="us-east-1",r.UsWest1="us-west-1",r.UsWest2="us-west-2"})(Tc||(Tc={}));class T0{constructor(a,{headers:o={},customFetch:l,region:p=Tc.Any}={}){this.url=a,this.headers=o,this.region=p,this.fetch=E0(l)}setAuth(a){this.headers.Authorization=`Bearer ${a}`}invoke(a){return A0(this,arguments,void 0,function*(o,l={}){var p;let c,g;try{const{headers:h,method:b,body:m,signal:v,timeout:z}=l;let k={},{region:S}=l;S||(S=this.region);const j=new URL(`${this.url}/${o}`);S&&S!=="any"&&(k["x-region"]=S,j.searchParams.set("forceFunctionRegion",S));let R;m&&(h&&!Object.prototype.hasOwnProperty.call(h,"Content-Type")||!h)?typeof Blob<"u"&&m instanceof Blob||m instanceof ArrayBuffer?(k["Content-Type"]="application/octet-stream",R=m):typeof m=="string"?(k["Content-Type"]="text/plain",R=m):typeof FormData<"u"&&m instanceof FormData?R=m:(k["Content-Type"]="application/json",R=JSON.stringify(m)):m&&typeof m!="string"&&!(typeof Blob<"u"&&m instanceof Blob)&&!(m instanceof ArrayBuffer)&&!(typeof FormData<"u"&&m instanceof FormData)?R=JSON.stringify(m):R=m;let I=v;z&&(g=new AbortController,c=setTimeout(()=>g.abort(),z),v?(I=g.signal,v.addEventListener("abort",()=>g.abort())):I=g.signal);const D=yield this.fetch(j.toString(),{method:b||"POST",headers:Object.assign(Object.assign(Object.assign({},k),this.headers),h),body:R,signal:I}).catch(N=>{throw new C0(N)}),U=D.headers.get("x-relay-error");if(U&&U==="true")throw new $h(D);if(!D.ok)throw new Yh(D);let B=((p=D.headers.get("Content-Type"))!==null&&p!==void 0?p:"text/plain").split(";")[0].trim(),E;return B==="application/json"?E=yield D.json():B==="application/octet-stream"||B==="application/pdf"?E=yield D.blob():B==="text/event-stream"?E=D:B==="multipart/form-data"?E=yield D.formData():E=yield D.text(),{data:E,error:null,response:D}}catch(h){return{data:null,error:h,response:h instanceof Yh||h instanceof $h?h.context:void 0}}finally{c&&clearTimeout(c)}})}}var N0=class extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}},R0=class{constructor(r){var a,o,l;this.shouldThrowOnError=!1,this.method=r.method,this.url=r.url,this.headers=new Headers(r.headers),this.schema=r.schema,this.body=r.body,this.shouldThrowOnError=(a=r.shouldThrowOnError)!==null&&a!==void 0?a:!1,this.signal=r.signal,this.isMaybeSingle=(o=r.isMaybeSingle)!==null&&o!==void 0?o:!1,this.urlLengthLimit=(l=r.urlLengthLimit)!==null&&l!==void 0?l:8e3,r.fetch?this.fetch=r.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(r,a){return this.headers=new Headers(this.headers),this.headers.set(r,a),this}then(r,a){var o=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const l=this.fetch;let p=l(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{let g=null,h=null,b=null,m=c.status,v=c.statusText;if(c.ok){var z,k;if(o.method!=="HEAD"){var S;const D=await c.text();D===""||(o.headers.get("Accept")==="text/csv"||o.headers.get("Accept")&&(!((S=o.headers.get("Accept"))===null||S===void 0)&&S.includes("application/vnd.pgrst.plan+text"))?h=D:h=JSON.parse(D))}const R=(z=o.headers.get("Prefer"))===null||z===void 0?void 0:z.match(/count=(exact|planned|estimated)/),I=(k=c.headers.get("content-range"))===null||k===void 0?void 0:k.split("/");R&&I&&I.length>1&&(b=parseInt(I[1])),o.isMaybeSingle&&o.method==="GET"&&Array.isArray(h)&&(h.length>1?(g={code:"PGRST116",details:`Results contain ${h.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},h=null,b=null,m=406,v="Not Acceptable"):h.length===1?h=h[0]:h=null)}else{var j;const R=await c.text();try{g=JSON.parse(R),Array.isArray(g)&&c.status===404&&(h=[],g=null,m=200,v="OK")}catch{c.status===404&&R===""?(m=204,v="No Content"):g={message:R}}if(g&&o.isMaybeSingle&&(!(g==null||(j=g.details)===null||j===void 0)&&j.includes("0 rows"))&&(g=null,m=200,v="OK"),g&&o.shouldThrowOnError)throw new N0(g)}return{error:g,data:h,count:b,status:m,statusText:v}});return this.shouldThrowOnError||(p=p.catch(c=>{var g;let h="",b="",m="";const v=c?.cause;if(v){var z,k,S,j;const D=(z=v?.message)!==null&&z!==void 0?z:"",U=(k=v?.code)!==null&&k!==void 0?k:"";h=`${(S=c?.name)!==null&&S!==void 0?S:"FetchError"}: ${c?.message}`,h+=`

Caused by: ${(j=v?.name)!==null&&j!==void 0?j:"Error"}: ${D}`,U&&(h+=` (${U})`),v?.stack&&(h+=`
${v.stack}`)}else{var R;h=(R=c?.stack)!==null&&R!==void 0?R:""}const I=this.url.toString().length;return c?.name==="AbortError"||c?.code==="ABORT_ERR"?(m="",b="Request was aborted (timeout or manual cancellation)",I>this.urlLengthLimit&&(b+=`. Note: Your request URL is ${I} characters, which may exceed server limits. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [many IDs])), consider using an RPC function to pass values server-side.`)):(v?.name==="HeadersOverflowError"||v?.code==="UND_ERR_HEADERS_OVERFLOW")&&(m="",b="HTTP headers exceeded server limits (typically 16KB)",I>this.urlLengthLimit&&(b+=`. Your request URL is ${I} characters. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [200+ IDs])), consider using an RPC function instead.`)),{error:{message:`${(g=c?.name)!==null&&g!==void 0?g:"FetchError"}: ${c?.message}`,details:h,hint:b,code:m},data:null,count:null,status:0,statusText:""}})),p.then(r,a)}returns(){return this}overrideTypes(){return this}},M0=class extends R0{select(r){let a=!1;const o=(r??"*").split("").map(l=>/\s/.test(l)&&!a?"":(l==='"'&&(a=!a),l)).join("");return this.url.searchParams.set("select",o),this.headers.append("Prefer","return=representation"),this}order(r,{ascending:a=!0,nullsFirst:o,foreignTable:l,referencedTable:p=l}={}){const c=p?`${p}.order`:"order",g=this.url.searchParams.get(c);return this.url.searchParams.set(c,`${g?`${g},`:""}${r}.${a?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(r,{foreignTable:a,referencedTable:o=a}={}){const l=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(l,`${r}`),this}range(r,a,{foreignTable:o,referencedTable:l=o}={}){const p=typeof l>"u"?"offset":`${l}.offset`,c=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(p,`${r}`),this.url.searchParams.set(c,`${a-r+1}`),this}abortSignal(r){return this.signal=r,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:r=!1,verbose:a=!1,settings:o=!1,buffers:l=!1,wal:p=!1,format:c="text"}={}){var g;const h=[r?"analyze":null,a?"verbose":null,o?"settings":null,l?"buffers":null,p?"wal":null].filter(Boolean).join("|"),b=(g=this.headers.get("Accept"))!==null&&g!==void 0?g:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${c}; for="${b}"; options=${h};`),c==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(r){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${r}`),this}};const Vh=new RegExp("[,()]");var Vr=class extends M0{eq(r,a){return this.url.searchParams.append(r,`eq.${a}`),this}neq(r,a){return this.url.searchParams.append(r,`neq.${a}`),this}gt(r,a){return this.url.searchParams.append(r,`gt.${a}`),this}gte(r,a){return this.url.searchParams.append(r,`gte.${a}`),this}lt(r,a){return this.url.searchParams.append(r,`lt.${a}`),this}lte(r,a){return this.url.searchParams.append(r,`lte.${a}`),this}like(r,a){return this.url.searchParams.append(r,`like.${a}`),this}likeAllOf(r,a){return this.url.searchParams.append(r,`like(all).{${a.join(",")}}`),this}likeAnyOf(r,a){return this.url.searchParams.append(r,`like(any).{${a.join(",")}}`),this}ilike(r,a){return this.url.searchParams.append(r,`ilike.${a}`),this}ilikeAllOf(r,a){return this.url.searchParams.append(r,`ilike(all).{${a.join(",")}}`),this}ilikeAnyOf(r,a){return this.url.searchParams.append(r,`ilike(any).{${a.join(",")}}`),this}regexMatch(r,a){return this.url.searchParams.append(r,`match.${a}`),this}regexIMatch(r,a){return this.url.searchParams.append(r,`imatch.${a}`),this}is(r,a){return this.url.searchParams.append(r,`is.${a}`),this}isDistinct(r,a){return this.url.searchParams.append(r,`isdistinct.${a}`),this}in(r,a){const o=Array.from(new Set(a)).map(l=>typeof l=="string"&&Vh.test(l)?`"${l}"`:`${l}`).join(",");return this.url.searchParams.append(r,`in.(${o})`),this}notIn(r,a){const o=Array.from(new Set(a)).map(l=>typeof l=="string"&&Vh.test(l)?`"${l}"`:`${l}`).join(",");return this.url.searchParams.append(r,`not.in.(${o})`),this}contains(r,a){return typeof a=="string"?this.url.searchParams.append(r,`cs.${a}`):Array.isArray(a)?this.url.searchParams.append(r,`cs.{${a.join(",")}}`):this.url.searchParams.append(r,`cs.${JSON.stringify(a)}`),this}containedBy(r,a){return typeof a=="string"?this.url.searchParams.append(r,`cd.${a}`):Array.isArray(a)?this.url.searchParams.append(r,`cd.{${a.join(",")}}`):this.url.searchParams.append(r,`cd.${JSON.stringify(a)}`),this}rangeGt(r,a){return this.url.searchParams.append(r,`sr.${a}`),this}rangeGte(r,a){return this.url.searchParams.append(r,`nxl.${a}`),this}rangeLt(r,a){return this.url.searchParams.append(r,`sl.${a}`),this}rangeLte(r,a){return this.url.searchParams.append(r,`nxr.${a}`),this}rangeAdjacent(r,a){return this.url.searchParams.append(r,`adj.${a}`),this}overlaps(r,a){return typeof a=="string"?this.url.searchParams.append(r,`ov.${a}`):this.url.searchParams.append(r,`ov.{${a.join(",")}}`),this}textSearch(r,a,{config:o,type:l}={}){let p="";l==="plain"?p="pl":l==="phrase"?p="ph":l==="websearch"&&(p="w");const c=o===void 0?"":`(${o})`;return this.url.searchParams.append(r,`${p}fts${c}.${a}`),this}match(r){return Object.entries(r).forEach(([a,o])=>{this.url.searchParams.append(a,`eq.${o}`)}),this}not(r,a,o){return this.url.searchParams.append(r,`not.${a}.${o}`),this}or(r,{foreignTable:a,referencedTable:o=a}={}){const l=o?`${o}.or`:"or";return this.url.searchParams.append(l,`(${r})`),this}filter(r,a,o){return this.url.searchParams.append(r,`${a}.${o}`),this}},O0=class{constructor(r,{headers:a={},schema:o,fetch:l,urlLengthLimit:p=8e3}){this.url=r,this.headers=new Headers(a),this.schema=o,this.fetch=l,this.urlLengthLimit=p}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(r,a){const{head:o=!1,count:l}=a??{},p=o?"HEAD":"GET";let c=!1;const g=(r??"*").split("").map(m=>/\s/.test(m)&&!c?"":(m==='"'&&(c=!c),m)).join(""),{url:h,headers:b}=this.cloneRequestState();return h.searchParams.set("select",g),l&&b.append("Prefer",`count=${l}`),new Vr({method:p,url:h,headers:b,schema:this.schema,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}insert(r,{count:a,defaultToNull:o=!0}={}){var l;const p="POST",{url:c,headers:g}=this.cloneRequestState();if(a&&g.append("Prefer",`count=${a}`),o||g.append("Prefer","missing=default"),Array.isArray(r)){const h=r.reduce((b,m)=>b.concat(Object.keys(m)),[]);if(h.length>0){const b=[...new Set(h)].map(m=>`"${m}"`);c.searchParams.set("columns",b.join(","))}}return new Vr({method:p,url:c,headers:g,schema:this.schema,body:r,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch,urlLengthLimit:this.urlLengthLimit})}upsert(r,{onConflict:a,ignoreDuplicates:o=!1,count:l,defaultToNull:p=!0}={}){var c;const g="POST",{url:h,headers:b}=this.cloneRequestState();if(b.append("Prefer",`resolution=${o?"ignore":"merge"}-duplicates`),a!==void 0&&h.searchParams.set("on_conflict",a),l&&b.append("Prefer",`count=${l}`),p||b.append("Prefer","missing=default"),Array.isArray(r)){const m=r.reduce((v,z)=>v.concat(Object.keys(z)),[]);if(m.length>0){const v=[...new Set(m)].map(z=>`"${z}"`);h.searchParams.set("columns",v.join(","))}}return new Vr({method:g,url:h,headers:b,schema:this.schema,body:r,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch,urlLengthLimit:this.urlLengthLimit})}update(r,{count:a}={}){var o;const l="PATCH",{url:p,headers:c}=this.cloneRequestState();return a&&c.append("Prefer",`count=${a}`),new Vr({method:l,url:p,headers:c,schema:this.schema,body:r,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch,urlLengthLimit:this.urlLengthLimit})}delete({count:r}={}){var a;const o="DELETE",{url:l,headers:p}=this.cloneRequestState();return r&&p.append("Prefer",`count=${r}`),new Vr({method:o,url:l,headers:p,schema:this.schema,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch,urlLengthLimit:this.urlLengthLimit})}};function eo(r){"@babel/helpers - typeof";return eo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},eo(r)}function D0(r,a){if(eo(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,a);if(eo(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(r)}function B0(r){var a=D0(r,"string");return eo(a)=="symbol"?a:a+""}function I0(r,a,o){return(a=B0(a))in r?Object.defineProperty(r,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[a]=o,r}function Qh(r,a){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(p){return Object.getOwnPropertyDescriptor(r,p).enumerable})),o.push.apply(o,l)}return o}function _s(r){for(var a=1;a<arguments.length;a++){var o=arguments[a]!=null?arguments[a]:{};a%2?Qh(Object(o),!0).forEach(function(l){I0(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):Qh(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}var L0=class Df{constructor(a,{headers:o={},schema:l,fetch:p,timeout:c,urlLengthLimit:g=8e3}={}){this.url=a,this.headers=new Headers(o),this.schemaName=l,this.urlLengthLimit=g;const h=p??globalThis.fetch;c!==void 0&&c>0?this.fetch=(b,m)=>{const v=new AbortController,z=setTimeout(()=>v.abort(),c),k=m?.signal;if(k){if(k.aborted)return clearTimeout(z),h(b,m);const S=()=>{clearTimeout(z),v.abort()};return k.addEventListener("abort",S,{once:!0}),h(b,_s(_s({},m),{},{signal:v.signal})).finally(()=>{clearTimeout(z),k.removeEventListener("abort",S)})}return h(b,_s(_s({},m),{},{signal:v.signal})).finally(()=>clearTimeout(z))}:this.fetch=h}from(a){if(!a||typeof a!="string"||a.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new O0(new URL(`${this.url}/${a}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}schema(a){return new Df(this.url,{headers:this.headers,schema:a,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}rpc(a,o={},{head:l=!1,get:p=!1,count:c}={}){var g;let h;const b=new URL(`${this.url}/rpc/${a}`);let m;const v=S=>S!==null&&typeof S=="object"&&(!Array.isArray(S)||S.some(v)),z=l&&Object.values(o).some(v);z?(h="POST",m=o):l||p?(h=l?"HEAD":"GET",Object.entries(o).filter(([S,j])=>j!==void 0).map(([S,j])=>[S,Array.isArray(j)?`{${j.join(",")}}`:`${j}`]).forEach(([S,j])=>{b.searchParams.append(S,j)})):(h="POST",m=o);const k=new Headers(this.headers);return z?k.set("Prefer",c?`count=${c},return=minimal`:"return=minimal"):c&&k.set("Prefer",`count=${c}`),new Vr({method:h,url:b,headers:k,schema:this.schemaName,body:m,fetch:(g=this.fetch)!==null&&g!==void 0?g:fetch,urlLengthLimit:this.urlLengthLimit})}};class U0{constructor(){}static detectEnvironment(){var a;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((a=navigator.userAgent)===null||a===void 0)&&a.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const o=globalThis.process;if(o){const l=o.versions;if(l&&l.node){const p=l.node,c=parseInt(p.replace(/^v/,"").split(".")[0]);return c>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${c} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${c} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const a=this.detectEnvironment();if(a.constructor)return a.constructor;let o=a.error||"WebSocket not supported in this environment.";throw a.workaround&&(o+=`

Suggested solution: ${a.workaround}`),new Error(o)}static createWebSocket(a,o){const l=this.getWebSocketConstructor();return new l(a,o)}static isWebSocketSupported(){try{const a=this.detectEnvironment();return a.type==="native"||a.type==="ws"}catch{return!1}}}const q0="2.95.3",H0=`realtime-js/${q0}`,P0="1.0.0",Bf="2.0.0",Fh=Bf,Nc=1e4,G0=1e3,$0=100;var wi;(function(r){r[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed"})(wi||(wi={}));var kt;(function(r){r.closed="closed",r.errored="errored",r.joined="joined",r.joining="joining",r.leaving="leaving"})(kt||(kt={}));var ma;(function(r){r.close="phx_close",r.error="phx_error",r.join="phx_join",r.reply="phx_reply",r.leave="phx_leave",r.access_token="access_token"})(ma||(ma={}));var Rc;(function(r){r.websocket="websocket"})(Rc||(Rc={}));var Ki;(function(r){r.Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed"})(Ki||(Ki={}));class Y0{constructor(a){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=a??[]}encode(a,o){if(a.event===this.BROADCAST_EVENT&&!(a.payload instanceof ArrayBuffer)&&typeof a.payload.event=="string")return o(this._binaryEncodeUserBroadcastPush(a));let l=[a.join_ref,a.ref,a.topic,a.event,a.payload];return o(JSON.stringify(l))}_binaryEncodeUserBroadcastPush(a){var o;return this._isArrayBuffer((o=a.payload)===null||o===void 0?void 0:o.payload)?this._encodeBinaryUserBroadcastPush(a):this._encodeJsonUserBroadcastPush(a)}_encodeBinaryUserBroadcastPush(a){var o,l;const p=(l=(o=a.payload)===null||o===void 0?void 0:o.payload)!==null&&l!==void 0?l:new ArrayBuffer(0);return this._encodeUserBroadcastPush(a,this.BINARY_ENCODING,p)}_encodeJsonUserBroadcastPush(a){var o,l;const p=(l=(o=a.payload)===null||o===void 0?void 0:o.payload)!==null&&l!==void 0?l:{},g=new TextEncoder().encode(JSON.stringify(p)).buffer;return this._encodeUserBroadcastPush(a,this.JSON_ENCODING,g)}_encodeUserBroadcastPush(a,o,l){var p,c;const g=a.topic,h=(p=a.ref)!==null&&p!==void 0?p:"",b=(c=a.join_ref)!==null&&c!==void 0?c:"",m=a.payload.event,v=this.allowedMetadataKeys?this._pick(a.payload,this.allowedMetadataKeys):{},z=Object.keys(v).length===0?"":JSON.stringify(v);if(b.length>255)throw new Error(`joinRef length ${b.length} exceeds maximum of 255`);if(h.length>255)throw new Error(`ref length ${h.length} exceeds maximum of 255`);if(g.length>255)throw new Error(`topic length ${g.length} exceeds maximum of 255`);if(m.length>255)throw new Error(`userEvent length ${m.length} exceeds maximum of 255`);if(z.length>255)throw new Error(`metadata length ${z.length} exceeds maximum of 255`);const k=this.USER_BROADCAST_PUSH_META_LENGTH+b.length+h.length+g.length+m.length+z.length,S=new ArrayBuffer(this.HEADER_LENGTH+k);let j=new DataView(S),R=0;j.setUint8(R++,this.KINDS.userBroadcastPush),j.setUint8(R++,b.length),j.setUint8(R++,h.length),j.setUint8(R++,g.length),j.setUint8(R++,m.length),j.setUint8(R++,z.length),j.setUint8(R++,o),Array.from(b,D=>j.setUint8(R++,D.charCodeAt(0))),Array.from(h,D=>j.setUint8(R++,D.charCodeAt(0))),Array.from(g,D=>j.setUint8(R++,D.charCodeAt(0))),Array.from(m,D=>j.setUint8(R++,D.charCodeAt(0))),Array.from(z,D=>j.setUint8(R++,D.charCodeAt(0)));var I=new Uint8Array(S.byteLength+l.byteLength);return I.set(new Uint8Array(S),0),I.set(new Uint8Array(l),S.byteLength),I.buffer}decode(a,o){if(this._isArrayBuffer(a)){let l=this._binaryDecode(a);return o(l)}if(typeof a=="string"){const l=JSON.parse(a),[p,c,g,h,b]=l;return o({join_ref:p,ref:c,topic:g,event:h,payload:b})}return o({})}_binaryDecode(a){const o=new DataView(a),l=o.getUint8(0),p=new TextDecoder;if(l===this.KINDS.userBroadcast)return this._decodeUserBroadcast(a,o,p)}_decodeUserBroadcast(a,o,l){const p=o.getUint8(1),c=o.getUint8(2),g=o.getUint8(3),h=o.getUint8(4);let b=this.HEADER_LENGTH+4;const m=l.decode(a.slice(b,b+p));b=b+p;const v=l.decode(a.slice(b,b+c));b=b+c;const z=l.decode(a.slice(b,b+g));b=b+g;const k=a.slice(b,a.byteLength),S=h===this.JSON_ENCODING?JSON.parse(l.decode(k)):k,j={type:this.BROADCAST_EVENT,event:v,payload:S};return g>0&&(j.meta=JSON.parse(z)),{join_ref:null,ref:null,topic:m,event:this.BROADCAST_EVENT,payload:j}}_isArrayBuffer(a){var o;return a instanceof ArrayBuffer||((o=a?.constructor)===null||o===void 0?void 0:o.name)==="ArrayBuffer"}_pick(a,o){return!a||typeof a!="object"?{}:Object.fromEntries(Object.entries(a).filter(([l])=>o.includes(l)))}}class If{constructor(a,o){this.callback=a,this.timerCalc=o,this.timer=void 0,this.tries=0,this.callback=a,this.timerCalc=o}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var et;(function(r){r.abstime="abstime",r.bool="bool",r.date="date",r.daterange="daterange",r.float4="float4",r.float8="float8",r.int2="int2",r.int4="int4",r.int4range="int4range",r.int8="int8",r.int8range="int8range",r.json="json",r.jsonb="jsonb",r.money="money",r.numeric="numeric",r.oid="oid",r.reltime="reltime",r.text="text",r.time="time",r.timestamp="timestamp",r.timestamptz="timestamptz",r.timetz="timetz",r.tsrange="tsrange",r.tstzrange="tstzrange"})(et||(et={}));const Kh=(r,a,o={})=>{var l;const p=(l=o.skipTypes)!==null&&l!==void 0?l:[];return a?Object.keys(a).reduce((c,g)=>(c[g]=V0(g,r,a,p),c),{}):{}},V0=(r,a,o,l)=>{const p=a.find(h=>h.name===r),c=p?.type,g=o[r];return c&&!l.includes(c)?Lf(c,g):Mc(g)},Lf=(r,a)=>{if(r.charAt(0)==="_"){const o=r.slice(1,r.length);return W0(a,o)}switch(r){case et.bool:return Q0(a);case et.float4:case et.float8:case et.int2:case et.int4:case et.int8:case et.numeric:case et.oid:return F0(a);case et.json:case et.jsonb:return K0(a);case et.timestamp:return J0(a);case et.abstime:case et.date:case et.daterange:case et.int4range:case et.int8range:case et.money:case et.reltime:case et.text:case et.time:case et.timestamptz:case et.timetz:case et.tsrange:case et.tstzrange:return Mc(a);default:return Mc(a)}},Mc=r=>r,Q0=r=>{switch(r){case"t":return!0;case"f":return!1;default:return r}},F0=r=>{if(typeof r=="string"){const a=parseFloat(r);if(!Number.isNaN(a))return a}return r},K0=r=>{if(typeof r=="string")try{return JSON.parse(r)}catch{return r}return r},W0=(r,a)=>{if(typeof r!="string")return r;const o=r.length-1,l=r[o];if(r[0]==="{"&&l==="}"){let c;const g=r.slice(1,o);try{c=JSON.parse("["+g+"]")}catch{c=g?g.split(","):[]}return c.map(h=>Lf(a,h))}return r},J0=r=>typeof r=="string"?r.replace(" ","T"):r,Uf=r=>{const a=new URL(r);return a.protocol=a.protocol.replace(/^ws/i,"http"),a.pathname=a.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),a.pathname===""||a.pathname==="/"?a.pathname="/api/broadcast":a.pathname=a.pathname+"/api/broadcast",a.href};class bc{constructor(a,o,l={},p=Nc){this.channel=a,this.event=o,this.payload=l,this.timeout=p,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(a){this.timeout=a,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(a){this.payload=Object.assign(Object.assign({},this.payload),a)}receive(a,o){var l;return this._hasReceived(a)&&o((l=this.receivedResp)===null||l===void 0?void 0:l.response),this.recHooks.push({status:a,callback:o}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const a=o=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=o,this._matchReceive(o)};this.channel._on(this.refEvent,{},a),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(a,o){this.refEvent&&this.channel._trigger(this.refEvent,{status:a,response:o})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:a,response:o}){this.recHooks.filter(l=>l.status===a).forEach(l=>l.callback(o))}_hasReceived(a){return this.receivedResp&&this.receivedResp.status===a}}var Wh;(function(r){r.SYNC="sync",r.JOIN="join",r.LEAVE="leave"})(Wh||(Wh={}));class Wn{constructor(a,o){this.channel=a,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const l=o?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(l.state,{},p=>{const{onJoin:c,onLeave:g,onSync:h}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Wn.syncState(this.state,p,c,g),this.pendingDiffs.forEach(b=>{this.state=Wn.syncDiff(this.state,b,c,g)}),this.pendingDiffs=[],h()}),this.channel._on(l.diff,{},p=>{const{onJoin:c,onLeave:g,onSync:h}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(p):(this.state=Wn.syncDiff(this.state,p,c,g),h())}),this.onJoin((p,c,g)=>{this.channel._trigger("presence",{event:"join",key:p,currentPresences:c,newPresences:g})}),this.onLeave((p,c,g)=>{this.channel._trigger("presence",{event:"leave",key:p,currentPresences:c,leftPresences:g})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(a,o,l,p){const c=this.cloneDeep(a),g=this.transformState(o),h={},b={};return this.map(c,(m,v)=>{g[m]||(b[m]=v)}),this.map(g,(m,v)=>{const z=c[m];if(z){const k=v.map(I=>I.presence_ref),S=z.map(I=>I.presence_ref),j=v.filter(I=>S.indexOf(I.presence_ref)<0),R=z.filter(I=>k.indexOf(I.presence_ref)<0);j.length>0&&(h[m]=j),R.length>0&&(b[m]=R)}else h[m]=v}),this.syncDiff(c,{joins:h,leaves:b},l,p)}static syncDiff(a,o,l,p){const{joins:c,leaves:g}={joins:this.transformState(o.joins),leaves:this.transformState(o.leaves)};return l||(l=()=>{}),p||(p=()=>{}),this.map(c,(h,b)=>{var m;const v=(m=a[h])!==null&&m!==void 0?m:[];if(a[h]=this.cloneDeep(b),v.length>0){const z=a[h].map(S=>S.presence_ref),k=v.filter(S=>z.indexOf(S.presence_ref)<0);a[h].unshift(...k)}l(h,v,b)}),this.map(g,(h,b)=>{let m=a[h];if(!m)return;const v=b.map(z=>z.presence_ref);m=m.filter(z=>v.indexOf(z.presence_ref)<0),a[h]=m,p(h,m,b),m.length===0&&delete a[h]}),a}static map(a,o){return Object.getOwnPropertyNames(a).map(l=>o(l,a[l]))}static transformState(a){return a=this.cloneDeep(a),Object.getOwnPropertyNames(a).reduce((o,l)=>{const p=a[l];return"metas"in p?o[l]=p.metas.map(c=>(c.presence_ref=c.phx_ref,delete c.phx_ref,delete c.phx_ref_prev,c)):o[l]=p,o},{})}static cloneDeep(a){return JSON.parse(JSON.stringify(a))}onJoin(a){this.caller.onJoin=a}onLeave(a){this.caller.onLeave=a}onSync(a){this.caller.onSync=a}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Jh;(function(r){r.ALL="*",r.INSERT="INSERT",r.UPDATE="UPDATE",r.DELETE="DELETE"})(Jh||(Jh={}));var Jn;(function(r){r.BROADCAST="broadcast",r.PRESENCE="presence",r.POSTGRES_CHANGES="postgres_changes",r.SYSTEM="system"})(Jn||(Jn={}));var Ya;(function(r){r.SUBSCRIBED="SUBSCRIBED",r.TIMED_OUT="TIMED_OUT",r.CLOSED="CLOSED",r.CHANNEL_ERROR="CHANNEL_ERROR"})(Ya||(Ya={}));class Kr{constructor(a,o={config:{}},l){var p,c;if(this.topic=a,this.params=o,this.socket=l,this.bindings={},this.state=kt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=a.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},o.config),this.timeout=this.socket.timeout,this.joinPush=new bc(this,ma.join,this.params,this.timeout),this.rejoinTimer=new If(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=kt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(g=>g.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=kt.closed,this.socket._remove(this)}),this._onError(g=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,g),this.state=kt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=kt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",g=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,g),this.state=kt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ma.reply,{},(g,h)=>{this._trigger(this._replyEventName(h),g)}),this.presence=new Wn(this),this.broadcastEndpointURL=Uf(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((c=(p=this.params.config)===null||p===void 0?void 0:p.broadcast)===null||c===void 0)&&c.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(a,o=this.timeout){var l,p,c;if(this.socket.isConnected()||this.socket.connect(),this.state==kt.closed){const{config:{broadcast:g,presence:h,private:b}}=this.params,m=(p=(l=this.bindings.postgres_changes)===null||l===void 0?void 0:l.map(S=>S.filter))!==null&&p!==void 0?p:[],v=!!this.bindings[Jn.PRESENCE]&&this.bindings[Jn.PRESENCE].length>0||((c=this.params.config.presence)===null||c===void 0?void 0:c.enabled)===!0,z={},k={broadcast:g,presence:Object.assign(Object.assign({},h),{enabled:v}),postgres_changes:m,private:b};this.socket.accessTokenValue&&(z.access_token=this.socket.accessTokenValue),this._onError(S=>a?.(Ya.CHANNEL_ERROR,S)),this._onClose(()=>a?.(Ya.CLOSED)),this.updateJoinPayload(Object.assign({config:k},z)),this.joinedOnce=!0,this._rejoin(o),this.joinPush.receive("ok",async({postgres_changes:S})=>{var j;if(this.socket._isManualToken()||this.socket.setAuth(),S===void 0){a?.(Ya.SUBSCRIBED);return}else{const R=this.bindings.postgres_changes,I=(j=R?.length)!==null&&j!==void 0?j:0,D=[];for(let U=0;U<I;U++){const B=R[U],{filter:{event:E,schema:N,table:M,filter:y}}=B,O=S&&S[U];if(O&&O.event===E&&Kr.isFilterValueEqual(O.schema,N)&&Kr.isFilterValueEqual(O.table,M)&&Kr.isFilterValueEqual(O.filter,y))D.push(Object.assign(Object.assign({},B),{id:O.id}));else{this.unsubscribe(),this.state=kt.errored,a?.(Ya.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=D,a&&a(Ya.SUBSCRIBED);return}}).receive("error",S=>{this.state=kt.errored,a?.(Ya.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(S).join(", ")||"error")))}).receive("timeout",()=>{a?.(Ya.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(a,o={}){return await this.send({type:"presence",event:"track",payload:a},o.timeout||this.timeout)}async untrack(a={}){return await this.send({type:"presence",event:"untrack"},a)}on(a,o,l){return this.state===kt.joined&&a===Jn.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(a,o,l)}async httpSend(a,o,l={}){var p;if(o==null)return Promise.reject("Payload is required for httpSend()");const c={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(c.Authorization=`Bearer ${this.socket.accessTokenValue}`);const g={method:"POST",headers:c,body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:o,private:this.private}]})},h=await this._fetchWithTimeout(this.broadcastEndpointURL,g,(p=l.timeout)!==null&&p!==void 0?p:this.timeout);if(h.status===202)return{success:!0};let b=h.statusText;try{const m=await h.json();b=m.error||m.message||b}catch{}return Promise.reject(new Error(b))}async send(a,o={}){var l,p;if(!this._canPush()&&a.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:c,payload:g}=a,h={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(h.Authorization=`Bearer ${this.socket.accessTokenValue}`);const b={method:"POST",headers:h,body:JSON.stringify({messages:[{topic:this.subTopic,event:c,payload:g,private:this.private}]})};try{const m=await this._fetchWithTimeout(this.broadcastEndpointURL,b,(l=o.timeout)!==null&&l!==void 0?l:this.timeout);return await((p=m.body)===null||p===void 0?void 0:p.cancel()),m.ok?"ok":"error"}catch(m){return m.name==="AbortError"?"timed out":"error"}}else return new Promise(c=>{var g,h,b;const m=this._push(a.type,a,o.timeout||this.timeout);a.type==="broadcast"&&!(!((b=(h=(g=this.params)===null||g===void 0?void 0:g.config)===null||h===void 0?void 0:h.broadcast)===null||b===void 0)&&b.ack)&&c("ok"),m.receive("ok",()=>c("ok")),m.receive("error",()=>c("error")),m.receive("timeout",()=>c("timed out"))})}updateJoinPayload(a){this.joinPush.updatePayload(a)}unsubscribe(a=this.timeout){this.state=kt.leaving;const o=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ma.close,"leave",this._joinRef())};this.joinPush.destroy();let l=null;return new Promise(p=>{l=new bc(this,ma.leave,{},a),l.receive("ok",()=>{o(),p("ok")}).receive("timeout",()=>{o(),p("timed out")}).receive("error",()=>{p("error")}),l.send(),this._canPush()||l.trigger("ok",{})}).finally(()=>{l?.destroy()})}teardown(){this.pushBuffer.forEach(a=>a.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=kt.closed,this.bindings={}}async _fetchWithTimeout(a,o,l){const p=new AbortController,c=setTimeout(()=>p.abort(),l),g=await this.socket.fetch(a,Object.assign(Object.assign({},o),{signal:p.signal}));return clearTimeout(c),g}_push(a,o,l=this.timeout){if(!this.joinedOnce)throw`tried to push '${a}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let p=new bc(this,a,o,l);return this._canPush()?p.send():this._addToPushBuffer(p),p}_addToPushBuffer(a){if(a.startTimeout(),this.pushBuffer.push(a),this.pushBuffer.length>$0){const o=this.pushBuffer.shift();o&&(o.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${o.event}`,o.payload))}}_onMessage(a,o,l){return o}_isMember(a){return this.topic===a}_joinRef(){return this.joinPush.ref}_trigger(a,o,l){var p,c;const g=a.toLocaleLowerCase(),{close:h,error:b,leave:m,join:v}=ma;if(l&&[h,b,m,v].indexOf(g)>=0&&l!==this._joinRef())return;let k=this._onMessage(g,o,l);if(o&&!k)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(g)?(p=this.bindings.postgres_changes)===null||p===void 0||p.filter(S=>{var j,R,I;return((j=S.filter)===null||j===void 0?void 0:j.event)==="*"||((I=(R=S.filter)===null||R===void 0?void 0:R.event)===null||I===void 0?void 0:I.toLocaleLowerCase())===g}).map(S=>S.callback(k,l)):(c=this.bindings[g])===null||c===void 0||c.filter(S=>{var j,R,I,D,U,B;if(["broadcast","presence","postgres_changes"].includes(g))if("id"in S){const E=S.id,N=(j=S.filter)===null||j===void 0?void 0:j.event;return E&&((R=o.ids)===null||R===void 0?void 0:R.includes(E))&&(N==="*"||N?.toLocaleLowerCase()===((I=o.data)===null||I===void 0?void 0:I.type.toLocaleLowerCase()))}else{const E=(U=(D=S?.filter)===null||D===void 0?void 0:D.event)===null||U===void 0?void 0:U.toLocaleLowerCase();return E==="*"||E===((B=o?.event)===null||B===void 0?void 0:B.toLocaleLowerCase())}else return S.type.toLocaleLowerCase()===g}).map(S=>{if(typeof k=="object"&&"ids"in k){const j=k.data,{schema:R,table:I,commit_timestamp:D,type:U,errors:B}=j;k=Object.assign(Object.assign({},{schema:R,table:I,commit_timestamp:D,eventType:U,new:{},old:{},errors:B}),this._getPayloadRecords(j))}S.callback(k,l)})}_isClosed(){return this.state===kt.closed}_isJoined(){return this.state===kt.joined}_isJoining(){return this.state===kt.joining}_isLeaving(){return this.state===kt.leaving}_replyEventName(a){return`chan_reply_${a}`}_on(a,o,l){const p=a.toLocaleLowerCase(),c={type:p,filter:o,callback:l};return this.bindings[p]?this.bindings[p].push(c):this.bindings[p]=[c],this}_off(a,o){const l=a.toLocaleLowerCase();return this.bindings[l]&&(this.bindings[l]=this.bindings[l].filter(p=>{var c;return!(((c=p.type)===null||c===void 0?void 0:c.toLocaleLowerCase())===l&&Kr.isEqual(p.filter,o))})),this}static isEqual(a,o){if(Object.keys(a).length!==Object.keys(o).length)return!1;for(const l in a)if(a[l]!==o[l])return!1;return!0}static isFilterValueEqual(a,o){return(a??void 0)===(o??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(a){this._on(ma.close,{},a)}_onError(a){this._on(ma.error,{},o=>a(o))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(a=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=kt.joining,this.joinPush.resend(a))}_getPayloadRecords(a){const o={new:{},old:{}};return(a.type==="INSERT"||a.type==="UPDATE")&&(o.new=Kh(a.columns,a.record)),(a.type==="UPDATE"||a.type==="DELETE")&&(o.old=Kh(a.columns,a.old_record)),o}}const mc=()=>{},As={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},X0=[1e3,2e3,5e3,1e4],Z0=1e4,e1=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class t1{constructor(a,o){var l;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Nc,this.transport=null,this.heartbeatIntervalMs=As.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=mc,this.ref=0,this.reconnectTimer=null,this.vsn=Fh,this.logger=mc,this.conn=null,this.sendBuffer=[],this.serializer=new Y0,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=p=>p?(...c)=>p(...c):(...c)=>fetch(...c),!(!((l=o?.params)===null||l===void 0)&&l.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=o.params.apikey,this.endPoint=`${a}/${Rc.websocket}`,this.httpEndpoint=Uf(a),this._initializeOptions(o),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(o?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=U0.createWebSocket(this.endpointURL())}catch(a){this._setConnectionState("disconnected");const o=a.message;throw o.includes("Node.js")?new Error(`${o}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${o}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(a,o){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const l=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(l),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(a?this.conn.close(a,o??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(a){const o=await a.unsubscribe();return o==="ok"&&this._remove(a),this.channels.length===0&&this.disconnect(),o}async removeAllChannels(){const a=await Promise.all(this.channels.map(o=>o.unsubscribe()));return this.channels=[],this.disconnect(),a}log(a,o,l){this.logger(a,o,l)}connectionState(){switch(this.conn&&this.conn.readyState){case wi.connecting:return Ki.Connecting;case wi.open:return Ki.Open;case wi.closing:return Ki.Closing;default:return Ki.Closed}}isConnected(){return this.connectionState()===Ki.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(a,o={config:{}}){const l=`realtime:${a}`,p=this.getChannels().find(c=>c.topic===l);if(p)return p;{const c=new Kr(`realtime:${a}`,o,this);return this.channels.push(c),c}}push(a){const{topic:o,event:l,payload:p,ref:c}=a,g=()=>{this.encode(a,h=>{var b;(b=this.conn)===null||b===void 0||b.send(h)})};this.log("push",`${o} ${l} (${c})`,p),this.isConnected()?g():this.sendBuffer.push(g)}async setAuth(a=null){this._authPromise=this._performAuth(a);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var a;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(o){this.log("error","error in heartbeat callback",o)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(o){this.log("error","error in heartbeat callback",o)}this._wasManualDisconnect=!1,(a=this.conn)===null||a===void 0||a.close(G0,"heartbeat timeout"),setTimeout(()=>{var o;this.isConnected()||(o=this.reconnectTimer)===null||o===void 0||o.scheduleTimeout()},As.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(o){this.log("error","error in heartbeat callback",o)}this._setAuthSafely("heartbeat")}onHeartbeat(a){this.heartbeatCallback=a}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(a=>a()),this.sendBuffer=[])}_makeRef(){let a=this.ref+1;return a===this.ref?this.ref=0:this.ref=a,this.ref.toString()}_leaveOpenTopic(a){let o=this.channels.find(l=>l.topic===a&&(l._isJoined()||l._isJoining()));o&&(this.log("transport",`leaving duplicate topic "${a}"`),o.unsubscribe())}_remove(a){this.channels=this.channels.filter(o=>o.topic!==a.topic)}_onConnMessage(a){this.decode(a.data,o=>{if(o.topic==="phoenix"&&o.event==="phx_reply"&&o.ref&&o.ref===this.pendingHeartbeatRef){const m=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(o.payload.status==="ok"?"ok":"error",m)}catch(v){this.log("error","error in heartbeat callback",v)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:l,event:p,payload:c,ref:g}=o,h=g?`(${g})`:"",b=c.status||"";this.log("receive",`${b} ${l} ${p} ${h}`.trim(),c),this.channels.filter(m=>m._isMember(l)).forEach(m=>m._trigger(p,c,g)),this._triggerStateCallbacks("message",o)})}_clearTimer(a){var o;a==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):a==="reconnect"&&((o=this.reconnectTimer)===null||o===void 0||o.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=a=>this._onConnError(a),this.conn.onmessage=a=>this._onConnMessage(a),this.conn.onclose=a=>this._onConnClose(a),this.conn.readyState===wi.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===wi.open||this.conn.readyState===wi.connecting)try{this.conn.close()}catch(a){this.log("error","Error closing connection",a)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(a=>a.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(o=>{this.log("error","error waiting for auth on connect",o),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const a=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(a),this.workerRef.onerror=o=>{this.log("worker","worker error",o.message),this._terminateWorker()},this.workerRef.onmessage=o=>{o.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(a){var o;this._setConnectionState("disconnected"),this.log("transport","close",a),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(o=this.reconnectTimer)===null||o===void 0||o.scheduleTimeout(),this._triggerStateCallbacks("close",a)}_onConnError(a){this._setConnectionState("disconnected"),this.log("transport",`${a}`),this._triggerChanError(),this._triggerStateCallbacks("error",a);try{this.heartbeatCallback("error")}catch(o){this.log("error","error in heartbeat callback",o)}}_triggerChanError(){this.channels.forEach(a=>a._trigger(ma.error))}_appendParams(a,o){if(Object.keys(o).length===0)return a;const l=a.match(/\?/)?"&":"?",p=new URLSearchParams(o);return`${a}${l}${p}`}_workerObjectUrl(a){let o;if(a)o=a;else{const l=new Blob([e1],{type:"application/javascript"});o=URL.createObjectURL(l)}return o}_setConnectionState(a,o=!1){this._connectionState=a,a==="connecting"?this._wasManualDisconnect=!1:a==="disconnecting"&&(this._wasManualDisconnect=o)}async _performAuth(a=null){let o,l=!1;if(a)o=a,l=!0;else if(this.accessToken)try{o=await this.accessToken()}catch(p){this.log("error","Error fetching access token from callback",p),o=this.accessTokenValue}else o=this.accessTokenValue;l?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=o&&(this.accessTokenValue=o,this.channels.forEach(p=>{const c={access_token:o,version:H0};o&&p.updateJoinPayload(c),p.joinedOnce&&p._isJoined()&&p._push(ma.access_token,{access_token:o})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(a="general"){this._isManualToken()||this.setAuth().catch(o=>{this.log("error",`Error setting auth in ${a}`,o)})}_triggerStateCallbacks(a,o){try{this.stateChangeCallbacks[a].forEach(l=>{try{l(o)}catch(p){this.log("error",`error in ${a} callback`,p)}})}catch(l){this.log("error",`error triggering ${a} callbacks`,l)}}_setupReconnectionTimer(){this.reconnectTimer=new If(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},As.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(a){var o,l,p,c,g,h,b,m,v,z,k,S;switch(this.transport=(o=a?.transport)!==null&&o!==void 0?o:null,this.timeout=(l=a?.timeout)!==null&&l!==void 0?l:Nc,this.heartbeatIntervalMs=(p=a?.heartbeatIntervalMs)!==null&&p!==void 0?p:As.HEARTBEAT_INTERVAL,this.worker=(c=a?.worker)!==null&&c!==void 0?c:!1,this.accessToken=(g=a?.accessToken)!==null&&g!==void 0?g:null,this.heartbeatCallback=(h=a?.heartbeatCallback)!==null&&h!==void 0?h:mc,this.vsn=(b=a?.vsn)!==null&&b!==void 0?b:Fh,a?.params&&(this.params=a.params),a?.logger&&(this.logger=a.logger),(a?.logLevel||a?.log_level)&&(this.logLevel=a.logLevel||a.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(m=a?.reconnectAfterMs)!==null&&m!==void 0?m:(j=>X0[j-1]||Z0),this.vsn){case P0:this.encode=(v=a?.encode)!==null&&v!==void 0?v:((j,R)=>R(JSON.stringify(j))),this.decode=(z=a?.decode)!==null&&z!==void 0?z:((j,R)=>R(JSON.parse(j)));break;case Bf:this.encode=(k=a?.encode)!==null&&k!==void 0?k:this.serializer.encode.bind(this.serializer),this.decode=(S=a?.decode)!==null&&S!==void 0?S:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=a?.workerUrl}}}var to=class extends Error{constructor(r,a){super(r),this.name="IcebergError",this.status=a.status,this.icebergType=a.icebergType,this.icebergCode=a.icebergCode,this.details=a.details,this.isCommitStateUnknown=a.icebergType==="CommitStateUnknownException"||[500,502,504].includes(a.status)&&a.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function a1(r,a,o){const l=new URL(a,r);if(o)for(const[p,c]of Object.entries(o))c!==void 0&&l.searchParams.set(p,c);return l.toString()}async function i1(r){return!r||r.type==="none"?{}:r.type==="bearer"?{Authorization:`Bearer ${r.token}`}:r.type==="header"?{[r.name]:r.value}:r.type==="custom"?await r.getHeaders():{}}function r1(r){const a=r.fetchImpl??globalThis.fetch;return{async request({method:o,path:l,query:p,body:c,headers:g}){const h=a1(r.baseUrl,l,p),b=await i1(r.auth),m=await a(h,{method:o,headers:{...c?{"Content-Type":"application/json"}:{},...b,...g},body:c?JSON.stringify(c):void 0}),v=await m.text(),z=(m.headers.get("content-type")||"").includes("application/json"),k=z&&v?JSON.parse(v):v;if(!m.ok){const S=z?k:void 0,j=S?.error;throw new to(j?.message??`Request failed with status ${m.status}`,{status:m.status,icebergType:j?.type,icebergCode:j?.code,details:S})}return{status:m.status,headers:m.headers,data:k}}}}function Es(r){return r.join("")}var n1=class{constructor(r,a=""){this.client=r,this.prefix=a}async listNamespaces(r){const a=r?{parent:Es(r.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:a})).data.namespaces.map(l=>({namespace:l}))}async createNamespace(r,a){const o={namespace:r.namespace,properties:a?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:o})).data}async dropNamespace(r){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Es(r.namespace)}`})}async loadNamespaceMetadata(r){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Es(r.namespace)}`})).data.properties}}async namespaceExists(r){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Es(r.namespace)}`}),!0}catch(a){if(a instanceof to&&a.status===404)return!1;throw a}}async createNamespaceIfNotExists(r,a){try{return await this.createNamespace(r,a)}catch(o){if(o instanceof to&&o.status===409)return;throw o}}};function qr(r){return r.join("")}var o1=class{constructor(r,a="",o){this.client=r,this.prefix=a,this.accessDelegation=o}async listTables(r){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${qr(r.namespace)}/tables`})).data.identifiers}async createTable(r,a){const o={};return this.accessDelegation&&(o["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${qr(r.namespace)}/tables`,body:a,headers:o})).data.metadata}async updateTable(r,a){const o=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${qr(r.namespace)}/tables/${r.name}`,body:a});return{"metadata-location":o.data["metadata-location"],metadata:o.data.metadata}}async dropTable(r,a){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${qr(r.namespace)}/tables/${r.name}`,query:{purgeRequested:String(a?.purge??!1)}})}async loadTable(r){const a={};return this.accessDelegation&&(a["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${qr(r.namespace)}/tables/${r.name}`,headers:a})).data.metadata}async tableExists(r){const a={};this.accessDelegation&&(a["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${qr(r.namespace)}/tables/${r.name}`,headers:a}),!0}catch(o){if(o instanceof to&&o.status===404)return!1;throw o}}async createTableIfNotExists(r,a){try{return await this.createTable(r,a)}catch(o){if(o instanceof to&&o.status===409)return await this.loadTable({namespace:r.namespace,name:a.name});throw o}}},s1=class{constructor(r){let a="v1";r.catalogName&&(a+=`/${r.catalogName}`);const o=r.baseUrl.endsWith("/")?r.baseUrl:`${r.baseUrl}/`;this.client=r1({baseUrl:o,auth:r.auth,fetchImpl:r.fetch}),this.accessDelegation=r.accessDelegation?.join(","),this.namespaceOps=new n1(this.client,a),this.tableOps=new o1(this.client,a,this.accessDelegation)}async listNamespaces(r){return this.namespaceOps.listNamespaces(r)}async createNamespace(r,a){return this.namespaceOps.createNamespace(r,a)}async dropNamespace(r){await this.namespaceOps.dropNamespace(r)}async loadNamespaceMetadata(r){return this.namespaceOps.loadNamespaceMetadata(r)}async listTables(r){return this.tableOps.listTables(r)}async createTable(r,a){return this.tableOps.createTable(r,a)}async updateTable(r,a){return this.tableOps.updateTable(r,a)}async dropTable(r,a){await this.tableOps.dropTable(r,a)}async loadTable(r){return this.tableOps.loadTable(r)}async namespaceExists(r){return this.namespaceOps.namespaceExists(r)}async tableExists(r){return this.tableOps.tableExists(r)}async createNamespaceIfNotExists(r,a){return this.namespaceOps.createNamespaceIfNotExists(r,a)}async createTableIfNotExists(r,a){return this.tableOps.createTableIfNotExists(r,a)}},Ws=class extends Error{constructor(r,a="storage",o,l){super(r),this.__isStorageError=!0,this.namespace=a,this.name=a==="vectors"?"StorageVectorsError":"StorageError",this.status=o,this.statusCode=l}};function Js(r){return typeof r=="object"&&r!==null&&"__isStorageError"in r}var Cs=class extends Ws{constructor(r,a,o,l="storage"){super(r,l,a,o),this.name=l==="vectors"?"StorageVectorsApiError":"StorageApiError",this.status=a,this.statusCode=o}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},qf=class extends Ws{constructor(r,a,o="storage"){super(r,o),this.name=o==="vectors"?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=a}};const l1=r=>r?(...a)=>r(...a):(...a)=>fetch(...a),d1=r=>{if(typeof r!="object"||r===null)return!1;const a=Object.getPrototypeOf(r);return(a===null||a===Object.prototype||Object.getPrototypeOf(a)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)},Oc=r=>{if(Array.isArray(r))return r.map(o=>Oc(o));if(typeof r=="function"||r!==Object(r))return r;const a={};return Object.entries(r).forEach(([o,l])=>{const p=o.replace(/([-_][a-z])/gi,c=>c.toUpperCase().replace(/[-_]/g,""));a[p]=Oc(l)}),a},c1=r=>!r||typeof r!="string"||r.length===0||r.length>100||r.trim()!==r||r.includes("/")||r.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(r);function ao(r){"@babel/helpers - typeof";return ao=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},ao(r)}function u1(r,a){if(ao(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,a);if(ao(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(r)}function p1(r){var a=u1(r,"string");return ao(a)=="symbol"?a:a+""}function g1(r,a,o){return(a=p1(a))in r?Object.defineProperty(r,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[a]=o,r}function Xh(r,a){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(p){return Object.getOwnPropertyDescriptor(r,p).enumerable})),o.push.apply(o,l)}return o}function ke(r){for(var a=1;a<arguments.length;a++){var o=arguments[a]!=null?arguments[a]:{};a%2?Xh(Object(o),!0).forEach(function(l){g1(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):Xh(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}const Zh=r=>{var a;return r.msg||r.message||r.error_description||(typeof r.error=="string"?r.error:(a=r.error)===null||a===void 0?void 0:a.message)||JSON.stringify(r)},h1=async(r,a,o,l)=>{if(r&&typeof r=="object"&&"status"in r&&"ok"in r&&typeof r.status=="number"&&!o?.noResolveJson){const p=r,c=p.status||500;if(typeof p.json=="function")p.json().then(g=>{const h=g?.statusCode||g?.code||c+"";a(new Cs(Zh(g),c,h,l))}).catch(()=>{if(l==="vectors"){const g=c+"";a(new Cs(p.statusText||`HTTP ${c} error`,c,g,l))}else{const g=c+"";a(new Cs(p.statusText||`HTTP ${c} error`,c,g,l))}});else{const g=c+"";a(new Cs(p.statusText||`HTTP ${c} error`,c,g,l))}}else a(new qf(Zh(r),r,l))},f1=(r,a,o,l)=>{const p={method:r,headers:a?.headers||{}};return r==="GET"||r==="HEAD"||!l?ke(ke({},p),o):(d1(l)?(p.headers=ke({"Content-Type":"application/json"},a?.headers),p.body=JSON.stringify(l)):p.body=l,a?.duplex&&(p.duplex=a.duplex),ke(ke({},p),o))};async function Vn(r,a,o,l,p,c,g){return new Promise((h,b)=>{r(o,f1(a,l,p,c)).then(m=>{if(!m.ok)throw m;if(l?.noResolveJson)return m;if(g==="vectors"){const v=m.headers.get("content-type");if(m.headers.get("content-length")==="0"||m.status===204)return{};if(!v||!v.includes("application/json"))return{}}return m.json()}).then(m=>h(m)).catch(m=>h1(m,b,l,g))})}function Hf(r="storage"){return{get:async(a,o,l,p)=>Vn(a,"GET",o,l,p,void 0,r),post:async(a,o,l,p,c)=>Vn(a,"POST",o,p,c,l,r),put:async(a,o,l,p,c)=>Vn(a,"PUT",o,p,c,l,r),head:async(a,o,l,p)=>Vn(a,"HEAD",o,ke(ke({},l),{},{noResolveJson:!0}),p,void 0,r),remove:async(a,o,l,p,c)=>Vn(a,"DELETE",o,p,c,l,r)}}const b1=Hf("storage"),{get:io,post:ba,put:Dc,head:m1,remove:Hc}=b1,Zt=Hf("vectors");var Jr=class{constructor(r,a={},o,l="storage"){this.shouldThrowOnError=!1,this.url=r,this.headers=a,this.fetch=l1(o),this.namespace=l}throwOnError(){return this.shouldThrowOnError=!0,this}async handleOperation(r){var a=this;try{return{data:await r(),error:null}}catch(o){if(a.shouldThrowOnError)throw o;if(Js(o))return{data:null,error:o};throw o}}},x1=class{constructor(r,a){this.downloadFn=r,this.shouldThrowOnError=a}then(r,a){return this.execute().then(r,a)}async execute(){var r=this;try{return{data:(await r.downloadFn()).body,error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(Js(a))return{data:null,error:a};throw a}}};let Pf;Pf=Symbol.toStringTag;var y1=class{constructor(r,a){this.downloadFn=r,this.shouldThrowOnError=a,this[Pf]="BlobDownloadBuilder",this.promise=null}asStream(){return new x1(this.downloadFn,this.shouldThrowOnError)}then(r,a){return this.getPromise().then(r,a)}catch(r){return this.getPromise().catch(r)}finally(r){return this.getPromise().finally(r)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var r=this;try{return{data:await(await r.downloadFn()).blob(),error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(Js(a))return{data:null,error:a};throw a}}};const v1={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ef={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var w1=class extends Jr{constructor(r,a={},o,l){super(r,a,l,"storage"),this.bucketId=o}async uploadOrUpdate(r,a,o,l){var p=this;return p.handleOperation(async()=>{let c;const g=ke(ke({},ef),l);let h=ke(ke({},p.headers),r==="POST"&&{"x-upsert":String(g.upsert)});const b=g.metadata;typeof Blob<"u"&&o instanceof Blob?(c=new FormData,c.append("cacheControl",g.cacheControl),b&&c.append("metadata",p.encodeMetadata(b)),c.append("",o)):typeof FormData<"u"&&o instanceof FormData?(c=o,c.has("cacheControl")||c.append("cacheControl",g.cacheControl),b&&!c.has("metadata")&&c.append("metadata",p.encodeMetadata(b))):(c=o,h["cache-control"]=`max-age=${g.cacheControl}`,h["content-type"]=g.contentType,b&&(h["x-metadata"]=p.toBase64(p.encodeMetadata(b))),(typeof ReadableStream<"u"&&c instanceof ReadableStream||c&&typeof c=="object"&&"pipe"in c&&typeof c.pipe=="function")&&!g.duplex&&(g.duplex="half")),l?.headers&&(h=ke(ke({},h),l.headers));const m=p._removeEmptyFolders(a),v=p._getFinalPath(m),z=await(r=="PUT"?Dc:ba)(p.fetch,`${p.url}/object/${v}`,c,ke({headers:h},g?.duplex?{duplex:g.duplex}:{}));return{path:m,id:z.Id,fullPath:z.Key}})}async upload(r,a,o){return this.uploadOrUpdate("POST",r,a,o)}async uploadToSignedUrl(r,a,o,l){var p=this;const c=p._removeEmptyFolders(r),g=p._getFinalPath(c),h=new URL(p.url+`/object/upload/sign/${g}`);return h.searchParams.set("token",a),p.handleOperation(async()=>{let b;const m=ke({upsert:ef.upsert},l),v=ke(ke({},p.headers),{"x-upsert":String(m.upsert)});return typeof Blob<"u"&&o instanceof Blob?(b=new FormData,b.append("cacheControl",m.cacheControl),b.append("",o)):typeof FormData<"u"&&o instanceof FormData?(b=o,b.append("cacheControl",m.cacheControl)):(b=o,v["cache-control"]=`max-age=${m.cacheControl}`,v["content-type"]=m.contentType),{path:c,fullPath:(await Dc(p.fetch,h.toString(),b,{headers:v})).Key}})}async createSignedUploadUrl(r,a){var o=this;return o.handleOperation(async()=>{let l=o._getFinalPath(r);const p=ke({},o.headers);a?.upsert&&(p["x-upsert"]="true");const c=await ba(o.fetch,`${o.url}/object/upload/sign/${l}`,{},{headers:p}),g=new URL(o.url+c.url),h=g.searchParams.get("token");if(!h)throw new Ws("No token returned by API");return{signedUrl:g.toString(),path:r,token:h}})}async update(r,a,o){return this.uploadOrUpdate("PUT",r,a,o)}async move(r,a,o){var l=this;return l.handleOperation(async()=>await ba(l.fetch,`${l.url}/object/move`,{bucketId:l.bucketId,sourceKey:r,destinationKey:a,destinationBucket:o?.destinationBucket},{headers:l.headers}))}async copy(r,a,o){var l=this;return l.handleOperation(async()=>({path:(await ba(l.fetch,`${l.url}/object/copy`,{bucketId:l.bucketId,sourceKey:r,destinationKey:a,destinationBucket:o?.destinationBucket},{headers:l.headers})).Key}))}async createSignedUrl(r,a,o){var l=this;return l.handleOperation(async()=>{let p=l._getFinalPath(r),c=await ba(l.fetch,`${l.url}/object/sign/${p}`,ke({expiresIn:a},o?.transform?{transform:o.transform}:{}),{headers:l.headers});const g=o?.download?`&download=${o.download===!0?"":o.download}`:"";return{signedUrl:encodeURI(`${l.url}${c.signedURL}${g}`)}})}async createSignedUrls(r,a,o){var l=this;return l.handleOperation(async()=>{const p=await ba(l.fetch,`${l.url}/object/sign/${l.bucketId}`,{expiresIn:a,paths:r},{headers:l.headers}),c=o?.download?`&download=${o.download===!0?"":o.download}`:"";return p.map(g=>ke(ke({},g),{},{signedUrl:g.signedURL?encodeURI(`${l.url}${g.signedURL}${c}`):null}))})}download(r,a,o){const l=typeof a?.transform<"u"?"render/image/authenticated":"object",p=this.transformOptsToQueryString(a?.transform||{}),c=p?`?${p}`:"",g=this._getFinalPath(r),h=()=>io(this.fetch,`${this.url}/${l}/${g}${c}`,{headers:this.headers,noResolveJson:!0},o);return new y1(h,this.shouldThrowOnError)}async info(r){var a=this;const o=a._getFinalPath(r);return a.handleOperation(async()=>Oc(await io(a.fetch,`${a.url}/object/info/${o}`,{headers:a.headers})))}async exists(r){var a=this;const o=a._getFinalPath(r);try{return await m1(a.fetch,`${a.url}/object/${o}`,{headers:a.headers}),{data:!0,error:null}}catch(l){if(a.shouldThrowOnError)throw l;if(Js(l)&&l instanceof qf){const p=l.originalError;if([400,404].includes(p?.status))return{data:!1,error:l}}throw l}}getPublicUrl(r,a){const o=this._getFinalPath(r),l=[],p=a?.download?`download=${a.download===!0?"":a.download}`:"";p!==""&&l.push(p);const c=typeof a?.transform<"u"?"render/image":"object",g=this.transformOptsToQueryString(a?.transform||{});g!==""&&l.push(g);let h=l.join("&");return h!==""&&(h=`?${h}`),{data:{publicUrl:encodeURI(`${this.url}/${c}/public/${o}${h}`)}}}async remove(r){var a=this;return a.handleOperation(async()=>await Hc(a.fetch,`${a.url}/object/${a.bucketId}`,{prefixes:r},{headers:a.headers}))}async list(r,a,o){var l=this;return l.handleOperation(async()=>{const p=ke(ke(ke({},v1),a),{},{prefix:r||""});return await ba(l.fetch,`${l.url}/object/list/${l.bucketId}`,p,{headers:l.headers},o)})}async listV2(r,a){var o=this;return o.handleOperation(async()=>{const l=ke({},r);return await ba(o.fetch,`${o.url}/object/list-v2/${o.bucketId}`,l,{headers:o.headers},a)})}encodeMetadata(r){return JSON.stringify(r)}toBase64(r){return typeof Buffer<"u"?Buffer.from(r).toString("base64"):btoa(r)}_getFinalPath(r){return`${this.bucketId}/${r.replace(/^\/+/,"")}`}_removeEmptyFolders(r){return r.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(r){const a=[];return r.width&&a.push(`width=${r.width}`),r.height&&a.push(`height=${r.height}`),r.resize&&a.push(`resize=${r.resize}`),r.format&&a.push(`format=${r.format}`),r.quality&&a.push(`quality=${r.quality}`),a.join("&")}};const k1="2.95.3",so={"X-Client-Info":`storage-js/${k1}`};var S1=class extends Jr{constructor(r,a={},o,l){const p=new URL(r);l?.useNewHostname&&/supabase\.(co|in|red)$/.test(p.hostname)&&!p.hostname.includes("storage.supabase.")&&(p.hostname=p.hostname.replace("supabase.","storage.supabase."));const c=p.href.replace(/\/$/,""),g=ke(ke({},so),a);super(c,g,o,"storage")}async listBuckets(r){var a=this;return a.handleOperation(async()=>{const o=a.listBucketOptionsToQueryString(r);return await io(a.fetch,`${a.url}/bucket${o}`,{headers:a.headers})})}async getBucket(r){var a=this;return a.handleOperation(async()=>await io(a.fetch,`${a.url}/bucket/${r}`,{headers:a.headers}))}async createBucket(r,a={public:!1}){var o=this;return o.handleOperation(async()=>await ba(o.fetch,`${o.url}/bucket`,{id:r,name:r,type:a.type,public:a.public,file_size_limit:a.fileSizeLimit,allowed_mime_types:a.allowedMimeTypes},{headers:o.headers}))}async updateBucket(r,a){var o=this;return o.handleOperation(async()=>await Dc(o.fetch,`${o.url}/bucket/${r}`,{id:r,name:r,public:a.public,file_size_limit:a.fileSizeLimit,allowed_mime_types:a.allowedMimeTypes},{headers:o.headers}))}async emptyBucket(r){var a=this;return a.handleOperation(async()=>await ba(a.fetch,`${a.url}/bucket/${r}/empty`,{},{headers:a.headers}))}async deleteBucket(r){var a=this;return a.handleOperation(async()=>await Hc(a.fetch,`${a.url}/bucket/${r}`,{},{headers:a.headers}))}listBucketOptionsToQueryString(r){const a={};return r&&("limit"in r&&(a.limit=String(r.limit)),"offset"in r&&(a.offset=String(r.offset)),r.search&&(a.search=r.search),r.sortColumn&&(a.sortColumn=r.sortColumn),r.sortOrder&&(a.sortOrder=r.sortOrder)),Object.keys(a).length>0?"?"+new URLSearchParams(a).toString():""}},z1=class extends Jr{constructor(r,a={},o){const l=r.replace(/\/$/,""),p=ke(ke({},so),a);super(l,p,o,"storage")}async createBucket(r){var a=this;return a.handleOperation(async()=>await ba(a.fetch,`${a.url}/bucket`,{name:r},{headers:a.headers}))}async listBuckets(r){var a=this;return a.handleOperation(async()=>{const o=new URLSearchParams;r?.limit!==void 0&&o.set("limit",r.limit.toString()),r?.offset!==void 0&&o.set("offset",r.offset.toString()),r?.sortColumn&&o.set("sortColumn",r.sortColumn),r?.sortOrder&&o.set("sortOrder",r.sortOrder),r?.search&&o.set("search",r.search);const l=o.toString(),p=l?`${a.url}/bucket?${l}`:`${a.url}/bucket`;return await io(a.fetch,p,{headers:a.headers})})}async deleteBucket(r){var a=this;return a.handleOperation(async()=>await Hc(a.fetch,`${a.url}/bucket/${r}`,{},{headers:a.headers}))}from(r){var a=this;if(!c1(r))throw new Ws("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const o=new s1({baseUrl:this.url,catalogName:r,auth:{type:"custom",getHeaders:async()=>a.headers},fetch:this.fetch}),l=this.shouldThrowOnError;return new Proxy(o,{get(p,c){const g=p[c];return typeof g!="function"?g:async(...h)=>{try{return{data:await g.apply(p,h),error:null}}catch(b){if(l)throw b;return{data:null,error:b}}}}})}},j1=class extends Jr{constructor(r,a={},o){const l=r.replace(/\/$/,""),p=ke(ke({},so),{},{"Content-Type":"application/json"},a);super(l,p,o,"vectors")}async createIndex(r){var a=this;return a.handleOperation(async()=>await Zt.post(a.fetch,`${a.url}/CreateIndex`,r,{headers:a.headers})||{})}async getIndex(r,a){var o=this;return o.handleOperation(async()=>await Zt.post(o.fetch,`${o.url}/GetIndex`,{vectorBucketName:r,indexName:a},{headers:o.headers}))}async listIndexes(r){var a=this;return a.handleOperation(async()=>await Zt.post(a.fetch,`${a.url}/ListIndexes`,r,{headers:a.headers}))}async deleteIndex(r,a){var o=this;return o.handleOperation(async()=>await Zt.post(o.fetch,`${o.url}/DeleteIndex`,{vectorBucketName:r,indexName:a},{headers:o.headers})||{})}},_1=class extends Jr{constructor(r,a={},o){const l=r.replace(/\/$/,""),p=ke(ke({},so),{},{"Content-Type":"application/json"},a);super(l,p,o,"vectors")}async putVectors(r){var a=this;if(r.vectors.length<1||r.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return a.handleOperation(async()=>await Zt.post(a.fetch,`${a.url}/PutVectors`,r,{headers:a.headers})||{})}async getVectors(r){var a=this;return a.handleOperation(async()=>await Zt.post(a.fetch,`${a.url}/GetVectors`,r,{headers:a.headers}))}async listVectors(r){var a=this;if(r.segmentCount!==void 0){if(r.segmentCount<1||r.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(r.segmentIndex!==void 0&&(r.segmentIndex<0||r.segmentIndex>=r.segmentCount))throw new Error(`segmentIndex must be between 0 and ${r.segmentCount-1}`)}return a.handleOperation(async()=>await Zt.post(a.fetch,`${a.url}/ListVectors`,r,{headers:a.headers}))}async queryVectors(r){var a=this;return a.handleOperation(async()=>await Zt.post(a.fetch,`${a.url}/QueryVectors`,r,{headers:a.headers}))}async deleteVectors(r){var a=this;if(r.keys.length<1||r.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return a.handleOperation(async()=>await Zt.post(a.fetch,`${a.url}/DeleteVectors`,r,{headers:a.headers})||{})}},A1=class extends Jr{constructor(r,a={},o){const l=r.replace(/\/$/,""),p=ke(ke({},so),{},{"Content-Type":"application/json"},a);super(l,p,o,"vectors")}async createBucket(r){var a=this;return a.handleOperation(async()=>await Zt.post(a.fetch,`${a.url}/CreateVectorBucket`,{vectorBucketName:r},{headers:a.headers})||{})}async getBucket(r){var a=this;return a.handleOperation(async()=>await Zt.post(a.fetch,`${a.url}/GetVectorBucket`,{vectorBucketName:r},{headers:a.headers}))}async listBuckets(r={}){var a=this;return a.handleOperation(async()=>await Zt.post(a.fetch,`${a.url}/ListVectorBuckets`,r,{headers:a.headers}))}async deleteBucket(r){var a=this;return a.handleOperation(async()=>await Zt.post(a.fetch,`${a.url}/DeleteVectorBucket`,{vectorBucketName:r},{headers:a.headers})||{})}},E1=class extends A1{constructor(r,a={}){super(r,a.headers||{},a.fetch)}from(r){return new C1(this.url,this.headers,r,this.fetch)}async createBucket(r){var a=()=>super.createBucket,o=this;return a().call(o,r)}async getBucket(r){var a=()=>super.getBucket,o=this;return a().call(o,r)}async listBuckets(r={}){var a=()=>super.listBuckets,o=this;return a().call(o,r)}async deleteBucket(r){var a=()=>super.deleteBucket,o=this;return a().call(o,r)}},C1=class extends j1{constructor(r,a,o,l){super(r,a,l),this.vectorBucketName=o}async createIndex(r){var a=()=>super.createIndex,o=this;return a().call(o,ke(ke({},r),{},{vectorBucketName:o.vectorBucketName}))}async listIndexes(r={}){var a=()=>super.listIndexes,o=this;return a().call(o,ke(ke({},r),{},{vectorBucketName:o.vectorBucketName}))}async getIndex(r){var a=()=>super.getIndex,o=this;return a().call(o,o.vectorBucketName,r)}async deleteIndex(r){var a=()=>super.deleteIndex,o=this;return a().call(o,o.vectorBucketName,r)}index(r){return new T1(this.url,this.headers,this.vectorBucketName,r,this.fetch)}},T1=class extends _1{constructor(r,a,o,l,p){super(r,a,p),this.vectorBucketName=o,this.indexName=l}async putVectors(r){var a=()=>super.putVectors,o=this;return a().call(o,ke(ke({},r),{},{vectorBucketName:o.vectorBucketName,indexName:o.indexName}))}async getVectors(r){var a=()=>super.getVectors,o=this;return a().call(o,ke(ke({},r),{},{vectorBucketName:o.vectorBucketName,indexName:o.indexName}))}async listVectors(r={}){var a=()=>super.listVectors,o=this;return a().call(o,ke(ke({},r),{},{vectorBucketName:o.vectorBucketName,indexName:o.indexName}))}async queryVectors(r){var a=()=>super.queryVectors,o=this;return a().call(o,ke(ke({},r),{},{vectorBucketName:o.vectorBucketName,indexName:o.indexName}))}async deleteVectors(r){var a=()=>super.deleteVectors,o=this;return a().call(o,ke(ke({},r),{},{vectorBucketName:o.vectorBucketName,indexName:o.indexName}))}},N1=class extends S1{constructor(r,a={},o,l){super(r,a,o,l)}from(r){return new w1(this.url,this.headers,r,this.fetch)}get vectors(){return new E1(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new z1(this.url+"/iceberg",this.headers,this.fetch)}};const Gf="2.95.3",Qr=30*1e3,Bc=3,xc=Bc*Qr,R1="http://localhost:9999",M1="supabase.auth.token",O1={"X-Client-Info":`gotrue-js/${Gf}`},Ic="X-Supabase-Api-Version",$f={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},D1=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,B1=600*1e3;class ro extends Error{constructor(a,o,l){super(a),this.__isAuthError=!0,this.name="AuthError",this.status=o,this.code=l}}function be(r){return typeof r=="object"&&r!==null&&"__isAuthError"in r}class I1 extends ro{constructor(a,o,l){super(a,o,l),this.name="AuthApiError",this.status=o,this.code=l}}function L1(r){return be(r)&&r.name==="AuthApiError"}class Wi extends ro{constructor(a,o){super(a),this.name="AuthUnknownError",this.originalError=o}}class Qa extends ro{constructor(a,o,l,p){super(a,l,p),this.name=o,this.status=l}}class Xt extends Qa{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function yc(r){return be(r)&&r.name==="AuthSessionMissingError"}class Hr extends Qa{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Ts extends Qa{constructor(a){super(a,"AuthInvalidCredentialsError",400,void 0)}}class Ns extends Qa{constructor(a,o=null){super(a,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=o}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function U1(r){return be(r)&&r.name==="AuthImplicitGrantRedirectError"}class tf extends Qa{constructor(a,o=null){super(a,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=o}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class q1 extends Qa{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Lc extends Qa{constructor(a,o){super(a,"AuthRetryableFetchError",o,void 0)}}function vc(r){return be(r)&&r.name==="AuthRetryableFetchError"}class af extends Qa{constructor(a,o,l){super(a,"AuthWeakPasswordError",o,"weak_password"),this.reasons=l}}class Uc extends Qa{constructor(a){super(a,"AuthInvalidJwtError",400,"invalid_jwt")}}const $s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),rf=` 	
\r=`.split(""),H1=(()=>{const r=new Array(128);for(let a=0;a<r.length;a+=1)r[a]=-1;for(let a=0;a<rf.length;a+=1)r[rf[a].charCodeAt(0)]=-2;for(let a=0;a<$s.length;a+=1)r[$s[a].charCodeAt(0)]=a;return r})();function nf(r,a,o){if(r!==null)for(a.queue=a.queue<<8|r,a.queuedBits+=8;a.queuedBits>=6;){const l=a.queue>>a.queuedBits-6&63;o($s[l]),a.queuedBits-=6}else if(a.queuedBits>0)for(a.queue=a.queue<<6-a.queuedBits,a.queuedBits=6;a.queuedBits>=6;){const l=a.queue>>a.queuedBits-6&63;o($s[l]),a.queuedBits-=6}}function Yf(r,a,o){const l=H1[r];if(l>-1)for(a.queue=a.queue<<6|l,a.queuedBits+=6;a.queuedBits>=8;)o(a.queue>>a.queuedBits-8&255),a.queuedBits-=8;else{if(l===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(r)}"`)}}function of(r){const a=[],o=g=>{a.push(String.fromCodePoint(g))},l={utf8seq:0,codepoint:0},p={queue:0,queuedBits:0},c=g=>{$1(g,l,o)};for(let g=0;g<r.length;g+=1)Yf(r.charCodeAt(g),p,c);return a.join("")}function P1(r,a){if(r<=127){a(r);return}else if(r<=2047){a(192|r>>6),a(128|r&63);return}else if(r<=65535){a(224|r>>12),a(128|r>>6&63),a(128|r&63);return}else if(r<=1114111){a(240|r>>18),a(128|r>>12&63),a(128|r>>6&63),a(128|r&63);return}throw new Error(`Unrecognized Unicode codepoint: ${r.toString(16)}`)}function G1(r,a){for(let o=0;o<r.length;o+=1){let l=r.charCodeAt(o);if(l>55295&&l<=56319){const p=(l-55296)*1024&65535;l=(r.charCodeAt(o+1)-56320&65535|p)+65536,o+=1}P1(l,a)}}function $1(r,a,o){if(a.utf8seq===0){if(r<=127){o(r);return}for(let l=1;l<6;l+=1)if((r>>7-l&1)===0){a.utf8seq=l;break}if(a.utf8seq===2)a.codepoint=r&31;else if(a.utf8seq===3)a.codepoint=r&15;else if(a.utf8seq===4)a.codepoint=r&7;else throw new Error("Invalid UTF-8 sequence");a.utf8seq-=1}else if(a.utf8seq>0){if(r<=127)throw new Error("Invalid UTF-8 sequence");a.codepoint=a.codepoint<<6|r&63,a.utf8seq-=1,a.utf8seq===0&&o(a.codepoint)}}function Wr(r){const a=[],o={queue:0,queuedBits:0},l=p=>{a.push(p)};for(let p=0;p<r.length;p+=1)Yf(r.charCodeAt(p),o,l);return new Uint8Array(a)}function Y1(r){const a=[];return G1(r,o=>a.push(o)),new Uint8Array(a)}function Xi(r){const a=[],o={queue:0,queuedBits:0},l=p=>{a.push(p)};return r.forEach(p=>nf(p,o,l)),nf(null,o,l),a.join("")}function V1(r){return Math.round(Date.now()/1e3)+r}function Q1(){return Symbol("auth-callback")}const Rt=()=>typeof window<"u"&&typeof document<"u",$i={tested:!1,writable:!1},Vf=()=>{if(!Rt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if($i.tested)return $i.writable;const r=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(r,r),globalThis.localStorage.removeItem(r),$i.tested=!0,$i.writable=!0}catch{$i.tested=!0,$i.writable=!1}return $i.writable};function F1(r){const a={},o=new URL(r);if(o.hash&&o.hash[0]==="#")try{new URLSearchParams(o.hash.substring(1)).forEach((p,c)=>{a[c]=p})}catch{}return o.searchParams.forEach((l,p)=>{a[p]=l}),a}const Qf=r=>r?(...a)=>r(...a):(...a)=>fetch(...a),K1=r=>typeof r=="object"&&r!==null&&"status"in r&&"ok"in r&&"json"in r&&typeof r.json=="function",Fr=async(r,a,o)=>{await r.setItem(a,JSON.stringify(o))},Yi=async(r,a)=>{const o=await r.getItem(a);if(!o)return null;try{return JSON.parse(o)}catch{return o}},Nt=async(r,a)=>{await r.removeItem(a)};class Xs{constructor(){this.promise=new Xs.promiseConstructor((a,o)=>{this.resolve=a,this.reject=o})}}Xs.promiseConstructor=Promise;function Rs(r){const a=r.split(".");if(a.length!==3)throw new Uc("Invalid JWT structure");for(let l=0;l<a.length;l++)if(!D1.test(a[l]))throw new Uc("JWT not in base64url format");return{header:JSON.parse(of(a[0])),payload:JSON.parse(of(a[1])),signature:Wr(a[2]),raw:{header:a[0],payload:a[1]}}}async function W1(r){return await new Promise(a=>{setTimeout(()=>a(null),r)})}function J1(r,a){return new Promise((l,p)=>{(async()=>{for(let c=0;c<1/0;c++)try{const g=await r(c);if(!a(c,null,g)){l(g);return}}catch(g){if(!a(c,g)){p(g);return}}})()})}function X1(r){return("0"+r.toString(16)).substr(-2)}function Z1(){const a=new Uint32Array(56);if(typeof crypto>"u"){const o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",l=o.length;let p="";for(let c=0;c<56;c++)p+=o.charAt(Math.floor(Math.random()*l));return p}return crypto.getRandomValues(a),Array.from(a,X1).join("")}async function e2(r){const o=new TextEncoder().encode(r),l=await crypto.subtle.digest("SHA-256",o),p=new Uint8Array(l);return Array.from(p).map(c=>String.fromCharCode(c)).join("")}async function t2(r){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),r;const o=await e2(r);return btoa(o).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Pr(r,a,o=!1){const l=Z1();let p=l;o&&(p+="/PASSWORD_RECOVERY"),await Fr(r,`${a}-code-verifier`,p);const c=await t2(l);return[c,l===c?"plain":"s256"]}const a2=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function i2(r){const a=r.headers.get(Ic);if(!a||!a.match(a2))return null;try{return new Date(`${a}T00:00:00.0Z`)}catch{return null}}function r2(r){if(!r)throw new Error("Missing exp claim");const a=Math.floor(Date.now()/1e3);if(r<=a)throw new Error("JWT has expired")}function n2(r){switch(r){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const o2=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Gr(r){if(!o2.test(r))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function wc(){const r={};return new Proxy(r,{get:(a,o)=>{if(o==="__isUserNotAvailableProxy")return!0;if(typeof o=="symbol"){const l=o.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${o}" property of the session object is not supported. Please use getUser() instead.`)},set:(a,o)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${o}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(a,o)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${o}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function s2(r,a){return new Proxy(r,{get:(o,l,p)=>{if(l==="__isInsecureUserWarningProxy")return!0;if(typeof l=="symbol"){const c=l.toString();if(c==="Symbol(Symbol.toPrimitive)"||c==="Symbol(Symbol.toStringTag)"||c==="Symbol(util.inspect.custom)"||c==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(o,l,p)}return!a.value&&typeof l=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a.value=!0),Reflect.get(o,l,p)}})}function sf(r){return JSON.parse(JSON.stringify(r))}const Vi=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),l2=[502,503,504];async function lf(r){var a;if(!K1(r))throw new Lc(Vi(r),0);if(l2.includes(r.status))throw new Lc(Vi(r),r.status);let o;try{o=await r.json()}catch(c){throw new Wi(Vi(c),c)}let l;const p=i2(r);if(p&&p.getTime()>=$f["2024-01-01"].timestamp&&typeof o=="object"&&o&&typeof o.code=="string"?l=o.code:typeof o=="object"&&o&&typeof o.error_code=="string"&&(l=o.error_code),l){if(l==="weak_password")throw new af(Vi(o),r.status,((a=o.weak_password)===null||a===void 0?void 0:a.reasons)||[]);if(l==="session_not_found")throw new Xt}else if(typeof o=="object"&&o&&typeof o.weak_password=="object"&&o.weak_password&&Array.isArray(o.weak_password.reasons)&&o.weak_password.reasons.length&&o.weak_password.reasons.reduce((c,g)=>c&&typeof g=="string",!0))throw new af(Vi(o),r.status,o.weak_password.reasons);throw new I1(Vi(o),r.status||500,l)}const d2=(r,a,o,l)=>{const p={method:r,headers:a?.headers||{}};return r==="GET"?p:(p.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},a?.headers),p.body=JSON.stringify(l),Object.assign(Object.assign({},p),o))};async function we(r,a,o,l){var p;const c=Object.assign({},l?.headers);c[Ic]||(c[Ic]=$f["2024-01-01"].name),l?.jwt&&(c.Authorization=`Bearer ${l.jwt}`);const g=(p=l?.query)!==null&&p!==void 0?p:{};l?.redirectTo&&(g.redirect_to=l.redirectTo);const h=Object.keys(g).length?"?"+new URLSearchParams(g).toString():"",b=await c2(r,a,o+h,{headers:c,noResolveJson:l?.noResolveJson},{},l?.body);return l?.xform?l?.xform(b):{data:Object.assign({},b),error:null}}async function c2(r,a,o,l,p,c){const g=d2(a,l,p,c);let h;try{h=await r(o,Object.assign({},g))}catch(b){throw console.error(b),new Lc(Vi(b),0)}if(h.ok||await lf(h),l?.noResolveJson)return h;try{return await h.json()}catch(b){await lf(b)}}function fa(r){var a;let o=null;g2(r)&&(o=Object.assign({},r),r.expires_at||(o.expires_at=V1(r.expires_in)));const l=(a=r.user)!==null&&a!==void 0?a:r;return{data:{session:o,user:l},error:null}}function df(r){const a=fa(r);return!a.error&&r.weak_password&&typeof r.weak_password=="object"&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.message&&typeof r.weak_password.message=="string"&&r.weak_password.reasons.reduce((o,l)=>o&&typeof l=="string",!0)&&(a.data.weak_password=r.weak_password),a}function ki(r){var a;return{data:{user:(a=r.user)!==null&&a!==void 0?a:r},error:null}}function u2(r){return{data:r,error:null}}function p2(r){const{action_link:a,email_otp:o,hashed_token:l,redirect_to:p,verification_type:c}=r,g=Ks(r,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),h={action_link:a,email_otp:o,hashed_token:l,redirect_to:p,verification_type:c},b=Object.assign({},g);return{data:{properties:h,user:b},error:null}}function cf(r){return r}function g2(r){return r.access_token&&r.refresh_token&&r.expires_in}const kc=["global","local","others"];class h2{constructor({url:a="",headers:o={},fetch:l}){this.url=a,this.headers=o,this.fetch=Qf(l),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(a,o=kc[0]){if(kc.indexOf(o)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${kc.join(", ")}`);try{return await we(this.fetch,"POST",`${this.url}/logout?scope=${o}`,{headers:this.headers,jwt:a,noResolveJson:!0}),{data:null,error:null}}catch(l){if(be(l))return{data:null,error:l};throw l}}async inviteUserByEmail(a,o={}){try{return await we(this.fetch,"POST",`${this.url}/invite`,{body:{email:a,data:o.data},headers:this.headers,redirectTo:o.redirectTo,xform:ki})}catch(l){if(be(l))return{data:{user:null},error:l};throw l}}async generateLink(a){try{const{options:o}=a,l=Ks(a,["options"]),p=Object.assign(Object.assign({},l),o);return"newEmail"in l&&(p.new_email=l?.newEmail,delete p.newEmail),await we(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:p,headers:this.headers,xform:p2,redirectTo:o?.redirectTo})}catch(o){if(be(o))return{data:{properties:null,user:null},error:o};throw o}}async createUser(a){try{return await we(this.fetch,"POST",`${this.url}/admin/users`,{body:a,headers:this.headers,xform:ki})}catch(o){if(be(o))return{data:{user:null},error:o};throw o}}async listUsers(a){var o,l,p,c,g,h,b;try{const m={nextPage:null,lastPage:0,total:0},v=await we(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(l=(o=a?.page)===null||o===void 0?void 0:o.toString())!==null&&l!==void 0?l:"",per_page:(c=(p=a?.perPage)===null||p===void 0?void 0:p.toString())!==null&&c!==void 0?c:""},xform:cf});if(v.error)throw v.error;const z=await v.json(),k=(g=v.headers.get("x-total-count"))!==null&&g!==void 0?g:0,S=(b=(h=v.headers.get("link"))===null||h===void 0?void 0:h.split(","))!==null&&b!==void 0?b:[];return S.length>0&&(S.forEach(j=>{const R=parseInt(j.split(";")[0].split("=")[1].substring(0,1)),I=JSON.parse(j.split(";")[1].split("=")[1]);m[`${I}Page`]=R}),m.total=parseInt(k)),{data:Object.assign(Object.assign({},z),m),error:null}}catch(m){if(be(m))return{data:{users:[]},error:m};throw m}}async getUserById(a){Gr(a);try{return await we(this.fetch,"GET",`${this.url}/admin/users/${a}`,{headers:this.headers,xform:ki})}catch(o){if(be(o))return{data:{user:null},error:o};throw o}}async updateUserById(a,o){Gr(a);try{return await we(this.fetch,"PUT",`${this.url}/admin/users/${a}`,{body:o,headers:this.headers,xform:ki})}catch(l){if(be(l))return{data:{user:null},error:l};throw l}}async deleteUser(a,o=!1){Gr(a);try{return await we(this.fetch,"DELETE",`${this.url}/admin/users/${a}`,{headers:this.headers,body:{should_soft_delete:o},xform:ki})}catch(l){if(be(l))return{data:{user:null},error:l};throw l}}async _listFactors(a){Gr(a.userId);try{const{data:o,error:l}=await we(this.fetch,"GET",`${this.url}/admin/users/${a.userId}/factors`,{headers:this.headers,xform:p=>({data:{factors:p},error:null})});return{data:o,error:l}}catch(o){if(be(o))return{data:null,error:o};throw o}}async _deleteFactor(a){Gr(a.userId),Gr(a.id);try{return{data:await we(this.fetch,"DELETE",`${this.url}/admin/users/${a.userId}/factors/${a.id}`,{headers:this.headers}),error:null}}catch(o){if(be(o))return{data:null,error:o};throw o}}async _listOAuthClients(a){var o,l,p,c,g,h,b;try{const m={nextPage:null,lastPage:0,total:0},v=await we(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(l=(o=a?.page)===null||o===void 0?void 0:o.toString())!==null&&l!==void 0?l:"",per_page:(c=(p=a?.perPage)===null||p===void 0?void 0:p.toString())!==null&&c!==void 0?c:""},xform:cf});if(v.error)throw v.error;const z=await v.json(),k=(g=v.headers.get("x-total-count"))!==null&&g!==void 0?g:0,S=(b=(h=v.headers.get("link"))===null||h===void 0?void 0:h.split(","))!==null&&b!==void 0?b:[];return S.length>0&&(S.forEach(j=>{const R=parseInt(j.split(";")[0].split("=")[1].substring(0,1)),I=JSON.parse(j.split(";")[1].split("=")[1]);m[`${I}Page`]=R}),m.total=parseInt(k)),{data:Object.assign(Object.assign({},z),m),error:null}}catch(m){if(be(m))return{data:{clients:[]},error:m};throw m}}async _createOAuthClient(a){try{return await we(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:a,headers:this.headers,xform:o=>({data:o,error:null})})}catch(o){if(be(o))return{data:null,error:o};throw o}}async _getOAuthClient(a){try{return await we(this.fetch,"GET",`${this.url}/admin/oauth/clients/${a}`,{headers:this.headers,xform:o=>({data:o,error:null})})}catch(o){if(be(o))return{data:null,error:o};throw o}}async _updateOAuthClient(a,o){try{return await we(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${a}`,{body:o,headers:this.headers,xform:l=>({data:l,error:null})})}catch(l){if(be(l))return{data:null,error:l};throw l}}async _deleteOAuthClient(a){try{return await we(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${a}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(o){if(be(o))return{data:null,error:o};throw o}}async _regenerateOAuthClientSecret(a){try{return await we(this.fetch,"POST",`${this.url}/admin/oauth/clients/${a}/regenerate_secret`,{headers:this.headers,xform:o=>({data:o,error:null})})}catch(o){if(be(o))return{data:null,error:o};throw o}}}function uf(r={}){return{getItem:a=>r[a]||null,setItem:(a,o)=>{r[a]=o},removeItem:a=>{delete r[a]}}}const $r={debug:!!(globalThis&&Vf()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Ff extends Error{constructor(a){super(a),this.isAcquireTimeout=!0}}class f2 extends Ff{}async function b2(r,a,o){$r.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",r,a);const l=new globalThis.AbortController;return a>0&&setTimeout(()=>{l.abort(),$r.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",r)},a),await Promise.resolve().then(()=>globalThis.navigator.locks.request(r,a===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:l.signal},async p=>{if(p){$r.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",r,p.name);try{return await o()}finally{$r.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",r,p.name)}}else{if(a===0)throw $r.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",r),new f2(`Acquiring an exclusive Navigator LockManager lock "${r}" immediately failed`);if($r.debug)try{const c=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(c,null,"  "))}catch(c){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",c)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await o()}}))}function m2(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Kf(r){if(!/^0x[a-fA-F0-9]{40}$/.test(r))throw new Error(`@supabase/auth-js: Address "${r}" is invalid.`);return r.toLowerCase()}function x2(r){return parseInt(r,16)}function y2(r){const a=new TextEncoder().encode(r);return"0x"+Array.from(a,l=>l.toString(16).padStart(2,"0")).join("")}function v2(r){var a;const{chainId:o,domain:l,expirationTime:p,issuedAt:c=new Date,nonce:g,notBefore:h,requestId:b,resources:m,scheme:v,uri:z,version:k}=r;{if(!Number.isInteger(o))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${o}`);if(!l)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(g&&g.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${g}`);if(!z)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(k!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${k}`);if(!((a=r.statement)===null||a===void 0)&&a.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${r.statement}`)}const S=Kf(r.address),j=v?`${v}://${l}`:l,R=r.statement?`${r.statement}
`:"",I=`${j} wants you to sign in with your Ethereum account:
${S}

${R}`;let D=`URI: ${z}
Version: ${k}
Chain ID: ${o}${g?`
Nonce: ${g}`:""}
Issued At: ${c.toISOString()}`;if(p&&(D+=`
Expiration Time: ${p.toISOString()}`),h&&(D+=`
Not Before: ${h.toISOString()}`),b&&(D+=`
Request ID: ${b}`),m){let U=`
Resources:`;for(const B of m){if(!B||typeof B!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${B}`);U+=`
- ${B}`}D+=U}return`${I}
${D}`}class xt extends Error{constructor({message:a,code:o,cause:l,name:p}){var c;super(a,{cause:l}),this.__isWebAuthnError=!0,this.name=(c=p??(l instanceof Error?l.name:void 0))!==null&&c!==void 0?c:"Unknown Error",this.code=o}}class Ys extends xt{constructor(a,o){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o,message:a}),this.name="WebAuthnUnknownError",this.originalError=o}}function w2({error:r,options:a}){var o,l,p;const{publicKey:c}=a;if(!c)throw Error("options was missing required publicKey property");if(r.name==="AbortError"){if(a.signal instanceof AbortSignal)return new xt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:r})}else if(r.name==="ConstraintError"){if(((o=c.authenticatorSelection)===null||o===void 0?void 0:o.requireResidentKey)===!0)return new xt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:r});if(a.mediation==="conditional"&&((l=c.authenticatorSelection)===null||l===void 0?void 0:l.userVerification)==="required")return new xt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:r});if(((p=c.authenticatorSelection)===null||p===void 0?void 0:p.userVerification)==="required")return new xt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:r})}else{if(r.name==="InvalidStateError")return new xt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:r});if(r.name==="NotAllowedError")return new xt({message:r.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r});if(r.name==="NotSupportedError")return c.pubKeyCredParams.filter(h=>h.type==="public-key").length===0?new xt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:r}):new xt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:r});if(r.name==="SecurityError"){const g=window.location.hostname;if(Wf(g)){if(c.rp.id!==g)return new xt({message:`The RP ID "${c.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:r})}else return new xt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:r})}else if(r.name==="TypeError"){if(c.user.id.byteLength<1||c.user.id.byteLength>64)return new xt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:r})}else if(r.name==="UnknownError")return new xt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:r})}return new xt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r})}function k2({error:r,options:a}){const{publicKey:o}=a;if(!o)throw Error("options was missing required publicKey property");if(r.name==="AbortError"){if(a.signal instanceof AbortSignal)return new xt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:r})}else{if(r.name==="NotAllowedError")return new xt({message:r.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r});if(r.name==="SecurityError"){const l=window.location.hostname;if(Wf(l)){if(o.rpId!==l)return new xt({message:`The RP ID "${o.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:r})}else return new xt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:r})}else if(r.name==="UnknownError")return new xt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:r})}return new xt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r})}class S2{createNewAbortSignal(){if(this.controller){const o=new Error("Cancelling existing WebAuthn API call for new one");o.name="AbortError",this.controller.abort(o)}const a=new AbortController;return this.controller=a,a.signal}cancelCeremony(){if(this.controller){const a=new Error("Manually cancelling existing WebAuthn API call");a.name="AbortError",this.controller.abort(a),this.controller=void 0}}}const z2=new S2;function j2(r){if(!r)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(r);const{challenge:a,user:o,excludeCredentials:l}=r,p=Ks(r,["challenge","user","excludeCredentials"]),c=Wr(a).buffer,g=Object.assign(Object.assign({},o),{id:Wr(o.id).buffer}),h=Object.assign(Object.assign({},p),{challenge:c,user:g});if(l&&l.length>0){h.excludeCredentials=new Array(l.length);for(let b=0;b<l.length;b++){const m=l[b];h.excludeCredentials[b]=Object.assign(Object.assign({},m),{id:Wr(m.id).buffer,type:m.type||"public-key",transports:m.transports})}}return h}function _2(r){if(!r)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(r);const{challenge:a,allowCredentials:o}=r,l=Ks(r,["challenge","allowCredentials"]),p=Wr(a).buffer,c=Object.assign(Object.assign({},l),{challenge:p});if(o&&o.length>0){c.allowCredentials=new Array(o.length);for(let g=0;g<o.length;g++){const h=o[g];c.allowCredentials[g]=Object.assign(Object.assign({},h),{id:Wr(h.id).buffer,type:h.type||"public-key",transports:h.transports})}}return c}function A2(r){var a;if("toJSON"in r&&typeof r.toJSON=="function")return r.toJSON();const o=r;return{id:r.id,rawId:r.id,response:{attestationObject:Xi(new Uint8Array(r.response.attestationObject)),clientDataJSON:Xi(new Uint8Array(r.response.clientDataJSON))},type:"public-key",clientExtensionResults:r.getClientExtensionResults(),authenticatorAttachment:(a=o.authenticatorAttachment)!==null&&a!==void 0?a:void 0}}function E2(r){var a;if("toJSON"in r&&typeof r.toJSON=="function")return r.toJSON();const o=r,l=r.getClientExtensionResults(),p=r.response;return{id:r.id,rawId:r.id,response:{authenticatorData:Xi(new Uint8Array(p.authenticatorData)),clientDataJSON:Xi(new Uint8Array(p.clientDataJSON)),signature:Xi(new Uint8Array(p.signature)),userHandle:p.userHandle?Xi(new Uint8Array(p.userHandle)):void 0},type:"public-key",clientExtensionResults:l,authenticatorAttachment:(a=o.authenticatorAttachment)!==null&&a!==void 0?a:void 0}}function Wf(r){return r==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(r)}function pf(){var r,a;return!!(Rt()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((r=navigator?.credentials)===null||r===void 0?void 0:r.create)=="function"&&typeof((a=navigator?.credentials)===null||a===void 0?void 0:a.get)=="function")}async function C2(r){try{const a=await navigator.credentials.create(r);return a?a instanceof PublicKeyCredential?{data:a,error:null}:{data:null,error:new Ys("Browser returned unexpected credential type",a)}:{data:null,error:new Ys("Empty credential response",a)}}catch(a){return{data:null,error:w2({error:a,options:r})}}}async function T2(r){try{const a=await navigator.credentials.get(r);return a?a instanceof PublicKeyCredential?{data:a,error:null}:{data:null,error:new Ys("Browser returned unexpected credential type",a)}:{data:null,error:new Ys("Empty credential response",a)}}catch(a){return{data:null,error:k2({error:a,options:r})}}}const N2={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},R2={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Vs(...r){const a=p=>p!==null&&typeof p=="object"&&!Array.isArray(p),o=p=>p instanceof ArrayBuffer||ArrayBuffer.isView(p),l={};for(const p of r)if(p)for(const c in p){const g=p[c];if(g!==void 0)if(Array.isArray(g))l[c]=g;else if(o(g))l[c]=g;else if(a(g)){const h=l[c];a(h)?l[c]=Vs(h,g):l[c]=Vs(g)}else l[c]=g}return l}function M2(r,a){return Vs(N2,r,a||{})}function O2(r,a){return Vs(R2,r,a||{})}class D2{constructor(a){this.client=a,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(a){return this.client.mfa.enroll(Object.assign(Object.assign({},a),{factorType:"webauthn"}))}async _challenge({factorId:a,webauthn:o,friendlyName:l,signal:p},c){var g;try{const{data:h,error:b}=await this.client.mfa.challenge({factorId:a,webauthn:o});if(!h)return{data:null,error:b};const m=p??z2.createNewAbortSignal();if(h.webauthn.type==="create"){const{user:v}=h.webauthn.credential_options.publicKey;if(!v.name){const z=l;if(z)v.name=`${v.id}:${z}`;else{const S=(await this.client.getUser()).data.user,j=((g=S?.user_metadata)===null||g===void 0?void 0:g.name)||S?.email||S?.id||"User";v.name=`${v.id}:${j}`}}v.displayName||(v.displayName=v.name)}switch(h.webauthn.type){case"create":{const v=M2(h.webauthn.credential_options.publicKey,c?.create),{data:z,error:k}=await C2({publicKey:v,signal:m});return z?{data:{factorId:a,challengeId:h.id,webauthn:{type:h.webauthn.type,credential_response:z}},error:null}:{data:null,error:k}}case"request":{const v=O2(h.webauthn.credential_options.publicKey,c?.request),{data:z,error:k}=await T2(Object.assign(Object.assign({},h.webauthn.credential_options),{publicKey:v,signal:m}));return z?{data:{factorId:a,challengeId:h.id,webauthn:{type:h.webauthn.type,credential_response:z}},error:null}:{data:null,error:k}}}}catch(h){return be(h)?{data:null,error:h}:{data:null,error:new Wi("Unexpected error in challenge",h)}}}async _verify({challengeId:a,factorId:o,webauthn:l}){return this.client.mfa.verify({factorId:o,challengeId:a,webauthn:l})}async _authenticate({factorId:a,webauthn:{rpId:o=typeof window<"u"?window.location.hostname:void 0,rpOrigins:l=typeof window<"u"?[window.location.origin]:void 0,signal:p}={}},c){if(!o)return{data:null,error:new ro("rpId is required for WebAuthn authentication")};try{if(!pf())return{data:null,error:new Wi("Browser does not support WebAuthn",null)};const{data:g,error:h}=await this.challenge({factorId:a,webauthn:{rpId:o,rpOrigins:l},signal:p},{request:c});if(!g)return{data:null,error:h};const{webauthn:b}=g;return this._verify({factorId:a,challengeId:g.challengeId,webauthn:{type:b.type,rpId:o,rpOrigins:l,credential_response:b.credential_response}})}catch(g){return be(g)?{data:null,error:g}:{data:null,error:new Wi("Unexpected error in authenticate",g)}}}async _register({friendlyName:a,webauthn:{rpId:o=typeof window<"u"?window.location.hostname:void 0,rpOrigins:l=typeof window<"u"?[window.location.origin]:void 0,signal:p}={}},c){if(!o)return{data:null,error:new ro("rpId is required for WebAuthn registration")};try{if(!pf())return{data:null,error:new Wi("Browser does not support WebAuthn",null)};const{data:g,error:h}=await this._enroll({friendlyName:a});if(!g)return await this.client.mfa.listFactors().then(v=>{var z;return(z=v.data)===null||z===void 0?void 0:z.all.find(k=>k.factor_type==="webauthn"&&k.friendly_name===a&&k.status!=="unverified")}).then(v=>v?this.client.mfa.unenroll({factorId:v?.id}):void 0),{data:null,error:h};const{data:b,error:m}=await this._challenge({factorId:g.id,friendlyName:g.friendly_name,webauthn:{rpId:o,rpOrigins:l},signal:p},{create:c});return b?this._verify({factorId:g.id,challengeId:b.challengeId,webauthn:{rpId:o,rpOrigins:l,type:b.webauthn.type,credential_response:b.webauthn.credential_response}}):{data:null,error:m}}catch(g){return be(g)?{data:null,error:g}:{data:null,error:new Wi("Unexpected error in register",g)}}}}m2();const B2={url:R1,storageKey:M1,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:O1,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function gf(r,a,o){return await o()}const Yr={};class no{get jwks(){var a,o;return(o=(a=Yr[this.storageKey])===null||a===void 0?void 0:a.jwks)!==null&&o!==void 0?o:{keys:[]}}set jwks(a){Yr[this.storageKey]=Object.assign(Object.assign({},Yr[this.storageKey]),{jwks:a})}get jwks_cached_at(){var a,o;return(o=(a=Yr[this.storageKey])===null||a===void 0?void 0:a.cachedAt)!==null&&o!==void 0?o:Number.MIN_SAFE_INTEGER}set jwks_cached_at(a){Yr[this.storageKey]=Object.assign(Object.assign({},Yr[this.storageKey]),{cachedAt:a})}constructor(a){var o,l,p;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const c=Object.assign(Object.assign({},B2),a);if(this.storageKey=c.storageKey,this.instanceID=(o=no.nextInstanceID[this.storageKey])!==null&&o!==void 0?o:0,no.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!c.debug,typeof c.debug=="function"&&(this.logger=c.debug),this.instanceID>0&&Rt()){const g=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(g),this.logDebugMessages&&console.trace(g)}if(this.persistSession=c.persistSession,this.autoRefreshToken=c.autoRefreshToken,this.admin=new h2({url:c.url,headers:c.headers,fetch:c.fetch}),this.url=c.url,this.headers=c.headers,this.fetch=Qf(c.fetch),this.lock=c.lock||gf,this.detectSessionInUrl=c.detectSessionInUrl,this.flowType=c.flowType,this.hasCustomAuthorizationHeader=c.hasCustomAuthorizationHeader,this.throwOnError=c.throwOnError,this.lockAcquireTimeout=c.lockAcquireTimeout,c.lock?this.lock=c.lock:this.persistSession&&Rt()&&(!((l=globalThis?.navigator)===null||l===void 0)&&l.locks)?this.lock=b2:this.lock=gf,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new D2(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(c.storage?this.storage=c.storage:Vf()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=uf(this.memoryStorage)),c.userStorage&&(this.userStorage=c.userStorage)):(this.memoryStorage={},this.storage=uf(this.memoryStorage)),Rt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(g){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",g)}(p=this.broadcastChannel)===null||p===void 0||p.addEventListener("message",async g=>{this._debug("received broadcast notification from other tab or client",g);try{await this._notifyAllSubscribers(g.data.event,g.data.session,!1)}catch(h){this._debug("#broadcastChannel","error",h)}})}this.initialize().catch(g=>{this._debug("#initialize()","error",g)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(a){if(this.throwOnError&&a&&a.error)throw a.error;return a}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Gf}) ${new Date().toISOString()}`}_debug(...a){return this.logDebugMessages&&this.logger(this._logPrefix(),...a),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var a;try{let o={},l="none";if(Rt()&&(o=F1(window.location.href),this._isImplicitGrantCallback(o)?l="implicit":await this._isPKCECallback(o)&&(l="pkce")),Rt()&&this.detectSessionInUrl&&l!=="none"){const{data:p,error:c}=await this._getSessionFromURL(o,l);if(c){if(this._debug("#_initialize()","error detecting session from URL",c),U1(c)){const b=(a=c.details)===null||a===void 0?void 0:a.code;if(b==="identity_already_exists"||b==="identity_not_found"||b==="single_identity_not_deletable")return{error:c}}return{error:c}}const{session:g,redirectType:h}=p;return this._debug("#_initialize()","detected session in URL",g,"redirect type",h),await this._saveSession(g),setTimeout(async()=>{h==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",g):await this._notifyAllSubscribers("SIGNED_IN",g)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(o){return be(o)?this._returnResult({error:o}):this._returnResult({error:new Wi("Unexpected error during initialization",o)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(a){var o,l,p;try{const c=await we(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(l=(o=a?.options)===null||o===void 0?void 0:o.data)!==null&&l!==void 0?l:{},gotrue_meta_security:{captcha_token:(p=a?.options)===null||p===void 0?void 0:p.captchaToken}},xform:fa}),{data:g,error:h}=c;if(h||!g)return this._returnResult({data:{user:null,session:null},error:h});const b=g.session,m=g.user;return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",b)),this._returnResult({data:{user:m,session:b},error:null})}catch(c){if(be(c))return this._returnResult({data:{user:null,session:null},error:c});throw c}}async signUp(a){var o,l,p;try{let c;if("email"in a){const{email:v,password:z,options:k}=a;let S=null,j=null;this.flowType==="pkce"&&([S,j]=await Pr(this.storage,this.storageKey)),c=await we(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:k?.emailRedirectTo,body:{email:v,password:z,data:(o=k?.data)!==null&&o!==void 0?o:{},gotrue_meta_security:{captcha_token:k?.captchaToken},code_challenge:S,code_challenge_method:j},xform:fa})}else if("phone"in a){const{phone:v,password:z,options:k}=a;c=await we(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:v,password:z,data:(l=k?.data)!==null&&l!==void 0?l:{},channel:(p=k?.channel)!==null&&p!==void 0?p:"sms",gotrue_meta_security:{captcha_token:k?.captchaToken}},xform:fa})}else throw new Ts("You must provide either an email or phone number and a password");const{data:g,error:h}=c;if(h||!g)return await Nt(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:h});const b=g.session,m=g.user;return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",b)),this._returnResult({data:{user:m,session:b},error:null})}catch(c){if(await Nt(this.storage,`${this.storageKey}-code-verifier`),be(c))return this._returnResult({data:{user:null,session:null},error:c});throw c}}async signInWithPassword(a){try{let o;if("email"in a){const{email:c,password:g,options:h}=a;o=await we(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:c,password:g,gotrue_meta_security:{captcha_token:h?.captchaToken}},xform:df})}else if("phone"in a){const{phone:c,password:g,options:h}=a;o=await we(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:c,password:g,gotrue_meta_security:{captcha_token:h?.captchaToken}},xform:df})}else throw new Ts("You must provide either an email or phone number and a password");const{data:l,error:p}=o;if(p)return this._returnResult({data:{user:null,session:null},error:p});if(!l||!l.session||!l.user){const c=new Hr;return this._returnResult({data:{user:null,session:null},error:c})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign({user:l.user,session:l.session},l.weak_password?{weakPassword:l.weak_password}:null),error:p})}catch(o){if(be(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signInWithOAuth(a){var o,l,p,c;return await this._handleProviderSignIn(a.provider,{redirectTo:(o=a.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=a.options)===null||l===void 0?void 0:l.scopes,queryParams:(p=a.options)===null||p===void 0?void 0:p.queryParams,skipBrowserRedirect:(c=a.options)===null||c===void 0?void 0:c.skipBrowserRedirect})}async exchangeCodeForSession(a){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(a))}async signInWithWeb3(a){const{chain:o}=a;switch(o){case"ethereum":return await this.signInWithEthereum(a);case"solana":return await this.signInWithSolana(a);default:throw new Error(`@supabase/auth-js: Unsupported chain "${o}"`)}}async signInWithEthereum(a){var o,l,p,c,g,h,b,m,v,z,k;let S,j;if("message"in a)S=a.message,j=a.signature;else{const{chain:R,wallet:I,statement:D,options:U}=a;let B;if(Rt())if(typeof I=="object")B=I;else{const $=window;if("ethereum"in $&&typeof $.ethereum=="object"&&"request"in $.ethereum&&typeof $.ethereum.request=="function")B=$.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof I!="object"||!U?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");B=I}const E=new URL((o=U?.url)!==null&&o!==void 0?o:window.location.href),N=await B.request({method:"eth_requestAccounts"}).then($=>$).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!N||N.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const M=Kf(N[0]);let y=(l=U?.signInWithEthereum)===null||l===void 0?void 0:l.chainId;if(!y){const $=await B.request({method:"eth_chainId"});y=x2($)}const O={domain:E.host,address:M,statement:D,uri:E.href,version:"1",chainId:y,nonce:(p=U?.signInWithEthereum)===null||p===void 0?void 0:p.nonce,issuedAt:(g=(c=U?.signInWithEthereum)===null||c===void 0?void 0:c.issuedAt)!==null&&g!==void 0?g:new Date,expirationTime:(h=U?.signInWithEthereum)===null||h===void 0?void 0:h.expirationTime,notBefore:(b=U?.signInWithEthereum)===null||b===void 0?void 0:b.notBefore,requestId:(m=U?.signInWithEthereum)===null||m===void 0?void 0:m.requestId,resources:(v=U?.signInWithEthereum)===null||v===void 0?void 0:v.resources};S=v2(O),j=await B.request({method:"personal_sign",params:[y2(S),M]})}try{const{data:R,error:I}=await we(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:S,signature:j},!((z=a.options)===null||z===void 0)&&z.captchaToken?{gotrue_meta_security:{captcha_token:(k=a.options)===null||k===void 0?void 0:k.captchaToken}}:null),xform:fa});if(I)throw I;if(!R||!R.session||!R.user){const D=new Hr;return this._returnResult({data:{user:null,session:null},error:D})}return R.session&&(await this._saveSession(R.session),await this._notifyAllSubscribers("SIGNED_IN",R.session)),this._returnResult({data:Object.assign({},R),error:I})}catch(R){if(be(R))return this._returnResult({data:{user:null,session:null},error:R});throw R}}async signInWithSolana(a){var o,l,p,c,g,h,b,m,v,z,k,S;let j,R;if("message"in a)j=a.message,R=a.signature;else{const{chain:I,wallet:D,statement:U,options:B}=a;let E;if(Rt())if(typeof D=="object")E=D;else{const M=window;if("solana"in M&&typeof M.solana=="object"&&("signIn"in M.solana&&typeof M.solana.signIn=="function"||"signMessage"in M.solana&&typeof M.solana.signMessage=="function"))E=M.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof D!="object"||!B?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");E=D}const N=new URL((o=B?.url)!==null&&o!==void 0?o:window.location.href);if("signIn"in E&&E.signIn){const M=await E.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},B?.signInWithSolana),{version:"1",domain:N.host,uri:N.href}),U?{statement:U}:null));let y;if(Array.isArray(M)&&M[0]&&typeof M[0]=="object")y=M[0];else if(M&&typeof M=="object"&&"signedMessage"in M&&"signature"in M)y=M;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in y&&"signature"in y&&(typeof y.signedMessage=="string"||y.signedMessage instanceof Uint8Array)&&y.signature instanceof Uint8Array)j=typeof y.signedMessage=="string"?y.signedMessage:new TextDecoder().decode(y.signedMessage),R=y.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in E)||typeof E.signMessage!="function"||!("publicKey"in E)||typeof E!="object"||!E.publicKey||!("toBase58"in E.publicKey)||typeof E.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");j=[`${N.host} wants you to sign in with your Solana account:`,E.publicKey.toBase58(),...U?["",U,""]:[""],"Version: 1",`URI: ${N.href}`,`Issued At: ${(p=(l=B?.signInWithSolana)===null||l===void 0?void 0:l.issuedAt)!==null&&p!==void 0?p:new Date().toISOString()}`,...!((c=B?.signInWithSolana)===null||c===void 0)&&c.notBefore?[`Not Before: ${B.signInWithSolana.notBefore}`]:[],...!((g=B?.signInWithSolana)===null||g===void 0)&&g.expirationTime?[`Expiration Time: ${B.signInWithSolana.expirationTime}`]:[],...!((h=B?.signInWithSolana)===null||h===void 0)&&h.chainId?[`Chain ID: ${B.signInWithSolana.chainId}`]:[],...!((b=B?.signInWithSolana)===null||b===void 0)&&b.nonce?[`Nonce: ${B.signInWithSolana.nonce}`]:[],...!((m=B?.signInWithSolana)===null||m===void 0)&&m.requestId?[`Request ID: ${B.signInWithSolana.requestId}`]:[],...!((z=(v=B?.signInWithSolana)===null||v===void 0?void 0:v.resources)===null||z===void 0)&&z.length?["Resources",...B.signInWithSolana.resources.map(y=>`- ${y}`)]:[]].join(`
`);const M=await E.signMessage(new TextEncoder().encode(j),"utf8");if(!M||!(M instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");R=M}}try{const{data:I,error:D}=await we(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:j,signature:Xi(R)},!((k=a.options)===null||k===void 0)&&k.captchaToken?{gotrue_meta_security:{captcha_token:(S=a.options)===null||S===void 0?void 0:S.captchaToken}}:null),xform:fa});if(D)throw D;if(!I||!I.session||!I.user){const U=new Hr;return this._returnResult({data:{user:null,session:null},error:U})}return I.session&&(await this._saveSession(I.session),await this._notifyAllSubscribers("SIGNED_IN",I.session)),this._returnResult({data:Object.assign({},I),error:D})}catch(I){if(be(I))return this._returnResult({data:{user:null,session:null},error:I});throw I}}async _exchangeCodeForSession(a){const o=await Yi(this.storage,`${this.storageKey}-code-verifier`),[l,p]=(o??"").split("/");try{if(!l&&this.flowType==="pkce")throw new q1;const{data:c,error:g}=await we(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:a,code_verifier:l},xform:fa});if(await Nt(this.storage,`${this.storageKey}-code-verifier`),g)throw g;if(!c||!c.session||!c.user){const h=new Hr;return this._returnResult({data:{user:null,session:null,redirectType:null},error:h})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:Object.assign(Object.assign({},c),{redirectType:p??null}),error:g})}catch(c){if(await Nt(this.storage,`${this.storageKey}-code-verifier`),be(c))return this._returnResult({data:{user:null,session:null,redirectType:null},error:c});throw c}}async signInWithIdToken(a){try{const{options:o,provider:l,token:p,access_token:c,nonce:g}=a,h=await we(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:l,id_token:p,access_token:c,nonce:g,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:fa}),{data:b,error:m}=h;if(m)return this._returnResult({data:{user:null,session:null},error:m});if(!b||!b.session||!b.user){const v=new Hr;return this._returnResult({data:{user:null,session:null},error:v})}return b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),this._returnResult({data:b,error:m})}catch(o){if(be(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signInWithOtp(a){var o,l,p,c,g;try{if("email"in a){const{email:h,options:b}=a;let m=null,v=null;this.flowType==="pkce"&&([m,v]=await Pr(this.storage,this.storageKey));const{error:z}=await we(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:h,data:(o=b?.data)!==null&&o!==void 0?o:{},create_user:(l=b?.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:b?.captchaToken},code_challenge:m,code_challenge_method:v},redirectTo:b?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:z})}if("phone"in a){const{phone:h,options:b}=a,{data:m,error:v}=await we(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:h,data:(p=b?.data)!==null&&p!==void 0?p:{},create_user:(c=b?.shouldCreateUser)!==null&&c!==void 0?c:!0,gotrue_meta_security:{captcha_token:b?.captchaToken},channel:(g=b?.channel)!==null&&g!==void 0?g:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:m?.message_id},error:v})}throw new Ts("You must provide either an email or phone number.")}catch(h){if(await Nt(this.storage,`${this.storageKey}-code-verifier`),be(h))return this._returnResult({data:{user:null,session:null},error:h});throw h}}async verifyOtp(a){var o,l;try{let p,c;"options"in a&&(p=(o=a.options)===null||o===void 0?void 0:o.redirectTo,c=(l=a.options)===null||l===void 0?void 0:l.captchaToken);const{data:g,error:h}=await we(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},a),{gotrue_meta_security:{captcha_token:c}}),redirectTo:p,xform:fa});if(h)throw h;if(!g)throw new Error("An error occurred on token verification.");const b=g.session,m=g.user;return b?.access_token&&(await this._saveSession(b),await this._notifyAllSubscribers(a.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",b)),this._returnResult({data:{user:m,session:b},error:null})}catch(p){if(be(p))return this._returnResult({data:{user:null,session:null},error:p});throw p}}async signInWithSSO(a){var o,l,p,c,g;try{let h=null,b=null;this.flowType==="pkce"&&([h,b]=await Pr(this.storage,this.storageKey));const m=await we(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in a?{provider_id:a.providerId}:null),"domain"in a?{domain:a.domain}:null),{redirect_to:(l=(o=a.options)===null||o===void 0?void 0:o.redirectTo)!==null&&l!==void 0?l:void 0}),!((p=a?.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:a.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:h,code_challenge_method:b}),headers:this.headers,xform:u2});return!((c=m.data)===null||c===void 0)&&c.url&&Rt()&&!(!((g=a.options)===null||g===void 0)&&g.skipBrowserRedirect)&&window.location.assign(m.data.url),this._returnResult(m)}catch(h){if(await Nt(this.storage,`${this.storageKey}-code-verifier`),be(h))return this._returnResult({data:null,error:h});throw h}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async a=>{const{data:{session:o},error:l}=a;if(l)throw l;if(!o)throw new Xt;const{error:p}=await we(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:o.access_token});return this._returnResult({data:{user:null,session:null},error:p})})}catch(a){if(be(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async resend(a){try{const o=`${this.url}/resend`;if("email"in a){const{email:l,type:p,options:c}=a,{error:g}=await we(this.fetch,"POST",o,{headers:this.headers,body:{email:l,type:p,gotrue_meta_security:{captcha_token:c?.captchaToken}},redirectTo:c?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:g})}else if("phone"in a){const{phone:l,type:p,options:c}=a,{data:g,error:h}=await we(this.fetch,"POST",o,{headers:this.headers,body:{phone:l,type:p,gotrue_meta_security:{captcha_token:c?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:g?.message_id},error:h})}throw new Ts("You must provide either an email or phone number and a type")}catch(o){if(be(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async o=>o))}async _acquireLock(a,o){this._debug("#_acquireLock","begin",a);try{if(this.lockAcquired){const l=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),p=(async()=>(await l,await o()))();return this.pendingInLock.push((async()=>{try{await p}catch{}})()),p}return await this.lock(`lock:${this.storageKey}`,a,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const l=o();for(this.pendingInLock.push((async()=>{try{await l}catch{}})()),await l;this.pendingInLock.length;){const p=[...this.pendingInLock];await Promise.all(p),this.pendingInLock.splice(0,p.length)}return await l}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(a){this._debug("#_useSession","begin");try{const o=await this.__loadSession();return await a(o)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let a=null;const o=await Yi(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",o),o!==null&&(this._isValidSession(o)?a=o:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!a)return{data:{session:null},error:null};const l=a.expires_at?a.expires_at*1e3-Date.now()<xc:!1;if(this._debug("#__loadSession()",`session has${l?"":" not"} expired`,"expires_at",a.expires_at),!l){if(this.userStorage){const g=await Yi(this.userStorage,this.storageKey+"-user");g?.user?a.user=g.user:a.user=wc()}if(this.storage.isServer&&a.user&&!a.user.__isUserNotAvailableProxy){const g={value:this.suppressGetSessionWarning};a.user=s2(a.user,g),g.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:a},error:null}}const{data:p,error:c}=await this._callRefreshToken(a.refresh_token);return c?this._returnResult({data:{session:null},error:c}):this._returnResult({data:{session:p},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(a){if(a)return await this._getUser(a);await this.initializePromise;const o=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return o.data.user&&(this.suppressGetSessionWarning=!0),o}async _getUser(a){try{return a?await we(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:a,xform:ki}):await this._useSession(async o=>{var l,p,c;const{data:g,error:h}=o;if(h)throw h;return!(!((l=g.session)===null||l===void 0)&&l.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Xt}:await we(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(c=(p=g.session)===null||p===void 0?void 0:p.access_token)!==null&&c!==void 0?c:void 0,xform:ki})})}catch(o){if(be(o))return yc(o)&&(await this._removeSession(),await Nt(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:o});throw o}}async updateUser(a,o={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(a,o))}async _updateUser(a,o={}){try{return await this._useSession(async l=>{const{data:p,error:c}=l;if(c)throw c;if(!p.session)throw new Xt;const g=p.session;let h=null,b=null;this.flowType==="pkce"&&a.email!=null&&([h,b]=await Pr(this.storage,this.storageKey));const{data:m,error:v}=await we(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:o?.emailRedirectTo,body:Object.assign(Object.assign({},a),{code_challenge:h,code_challenge_method:b}),jwt:g.access_token,xform:ki});if(v)throw v;return g.user=m.user,await this._saveSession(g),await this._notifyAllSubscribers("USER_UPDATED",g),this._returnResult({data:{user:g.user},error:null})})}catch(l){if(await Nt(this.storage,`${this.storageKey}-code-verifier`),be(l))return this._returnResult({data:{user:null},error:l});throw l}}async setSession(a){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(a))}async _setSession(a){try{if(!a.access_token||!a.refresh_token)throw new Xt;const o=Date.now()/1e3;let l=o,p=!0,c=null;const{payload:g}=Rs(a.access_token);if(g.exp&&(l=g.exp,p=l<=o),p){const{data:h,error:b}=await this._callRefreshToken(a.refresh_token);if(b)return this._returnResult({data:{user:null,session:null},error:b});if(!h)return{data:{user:null,session:null},error:null};c=h}else{const{data:h,error:b}=await this._getUser(a.access_token);if(b)return this._returnResult({data:{user:null,session:null},error:b});c={access_token:a.access_token,refresh_token:a.refresh_token,user:h.user,token_type:"bearer",expires_in:l-o,expires_at:l},await this._saveSession(c),await this._notifyAllSubscribers("SIGNED_IN",c)}return this._returnResult({data:{user:c.user,session:c},error:null})}catch(o){if(be(o))return this._returnResult({data:{session:null,user:null},error:o});throw o}}async refreshSession(a){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(a))}async _refreshSession(a){try{return await this._useSession(async o=>{var l;if(!a){const{data:g,error:h}=o;if(h)throw h;a=(l=g.session)!==null&&l!==void 0?l:void 0}if(!a?.refresh_token)throw new Xt;const{data:p,error:c}=await this._callRefreshToken(a.refresh_token);return c?this._returnResult({data:{user:null,session:null},error:c}):p?this._returnResult({data:{user:p.user,session:p},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(o){if(be(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async _getSessionFromURL(a,o){try{if(!Rt())throw new Ns("No browser detected.");if(a.error||a.error_description||a.error_code)throw new Ns(a.error_description||"Error in URL with unspecified error_description",{error:a.error||"unspecified_error",code:a.error_code||"unspecified_code"});switch(o){case"implicit":if(this.flowType==="pkce")throw new tf("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ns("Not a valid implicit grant flow url.");break;default:}if(o==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!a.code)throw new tf("No code detected.");const{data:U,error:B}=await this._exchangeCodeForSession(a.code);if(B)throw B;const E=new URL(window.location.href);return E.searchParams.delete("code"),window.history.replaceState(window.history.state,"",E.toString()),{data:{session:U.session,redirectType:null},error:null}}const{provider_token:l,provider_refresh_token:p,access_token:c,refresh_token:g,expires_in:h,expires_at:b,token_type:m}=a;if(!c||!h||!g||!m)throw new Ns("No session defined in URL");const v=Math.round(Date.now()/1e3),z=parseInt(h);let k=v+z;b&&(k=parseInt(b));const S=k-v;S*1e3<=Qr&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${S}s, should have been closer to ${z}s`);const j=k-z;v-j>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",j,k,v):v-j<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",j,k,v);const{data:R,error:I}=await this._getUser(c);if(I)throw I;const D={provider_token:l,provider_refresh_token:p,access_token:c,expires_in:z,expires_at:k,refresh_token:g,token_type:m,user:R.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:D,redirectType:a.type},error:null})}catch(l){if(be(l))return this._returnResult({data:{session:null,redirectType:null},error:l});throw l}}_isImplicitGrantCallback(a){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),a):!!(a.access_token||a.error_description)}async _isPKCECallback(a){const o=await Yi(this.storage,`${this.storageKey}-code-verifier`);return!!(a.code&&o)}async signOut(a={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(a))}async _signOut({scope:a}={scope:"global"}){return await this._useSession(async o=>{var l;const{data:p,error:c}=o;if(c&&!yc(c))return this._returnResult({error:c});const g=(l=p.session)===null||l===void 0?void 0:l.access_token;if(g){const{error:h}=await this.admin.signOut(g,a);if(h&&!(L1(h)&&(h.status===404||h.status===401||h.status===403)||yc(h)))return this._returnResult({error:h})}return a!=="others"&&(await this._removeSession(),await Nt(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(a){const o=Q1(),l={id:o,callback:a,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",o),this.stateChangeEmitters.delete(o)}};return this._debug("#onAuthStateChange()","registered callback with id",o),this.stateChangeEmitters.set(o,l),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(o)})))(),{data:{subscription:l}}}async _emitInitialSession(a){return await this._useSession(async o=>{var l,p;try{const{data:{session:c},error:g}=o;if(g)throw g;await((l=this.stateChangeEmitters.get(a))===null||l===void 0?void 0:l.callback("INITIAL_SESSION",c)),this._debug("INITIAL_SESSION","callback id",a,"session",c)}catch(c){await((p=this.stateChangeEmitters.get(a))===null||p===void 0?void 0:p.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",a,"error",c),console.error(c)}})}async resetPasswordForEmail(a,o={}){let l=null,p=null;this.flowType==="pkce"&&([l,p]=await Pr(this.storage,this.storageKey,!0));try{return await we(this.fetch,"POST",`${this.url}/recover`,{body:{email:a,code_challenge:l,code_challenge_method:p,gotrue_meta_security:{captcha_token:o.captchaToken}},headers:this.headers,redirectTo:o.redirectTo})}catch(c){if(await Nt(this.storage,`${this.storageKey}-code-verifier`),be(c))return this._returnResult({data:null,error:c});throw c}}async getUserIdentities(){var a;try{const{data:o,error:l}=await this.getUser();if(l)throw l;return this._returnResult({data:{identities:(a=o.user.identities)!==null&&a!==void 0?a:[]},error:null})}catch(o){if(be(o))return this._returnResult({data:null,error:o});throw o}}async linkIdentity(a){return"token"in a?this.linkIdentityIdToken(a):this.linkIdentityOAuth(a)}async linkIdentityOAuth(a){var o;try{const{data:l,error:p}=await this._useSession(async c=>{var g,h,b,m,v;const{data:z,error:k}=c;if(k)throw k;const S=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,a.provider,{redirectTo:(g=a.options)===null||g===void 0?void 0:g.redirectTo,scopes:(h=a.options)===null||h===void 0?void 0:h.scopes,queryParams:(b=a.options)===null||b===void 0?void 0:b.queryParams,skipBrowserRedirect:!0});return await we(this.fetch,"GET",S,{headers:this.headers,jwt:(v=(m=z.session)===null||m===void 0?void 0:m.access_token)!==null&&v!==void 0?v:void 0})});if(p)throw p;return Rt()&&!(!((o=a.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(l?.url),this._returnResult({data:{provider:a.provider,url:l?.url},error:null})}catch(l){if(be(l))return this._returnResult({data:{provider:a.provider,url:null},error:l});throw l}}async linkIdentityIdToken(a){return await this._useSession(async o=>{var l;try{const{error:p,data:{session:c}}=o;if(p)throw p;const{options:g,provider:h,token:b,access_token:m,nonce:v}=a,z=await we(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(l=c?.access_token)!==null&&l!==void 0?l:void 0,body:{provider:h,id_token:b,access_token:m,nonce:v,link_identity:!0,gotrue_meta_security:{captcha_token:g?.captchaToken}},xform:fa}),{data:k,error:S}=z;return S?this._returnResult({data:{user:null,session:null},error:S}):!k||!k.session||!k.user?this._returnResult({data:{user:null,session:null},error:new Hr}):(k.session&&(await this._saveSession(k.session),await this._notifyAllSubscribers("USER_UPDATED",k.session)),this._returnResult({data:k,error:S}))}catch(p){if(await Nt(this.storage,`${this.storageKey}-code-verifier`),be(p))return this._returnResult({data:{user:null,session:null},error:p});throw p}})}async unlinkIdentity(a){try{return await this._useSession(async o=>{var l,p;const{data:c,error:g}=o;if(g)throw g;return await we(this.fetch,"DELETE",`${this.url}/user/identities/${a.identity_id}`,{headers:this.headers,jwt:(p=(l=c.session)===null||l===void 0?void 0:l.access_token)!==null&&p!==void 0?p:void 0})})}catch(o){if(be(o))return this._returnResult({data:null,error:o});throw o}}async _refreshAccessToken(a){const o=`#_refreshAccessToken(${a.substring(0,5)}...)`;this._debug(o,"begin");try{const l=Date.now();return await J1(async p=>(p>0&&await W1(200*Math.pow(2,p-1)),this._debug(o,"refreshing attempt",p),await we(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:a},headers:this.headers,xform:fa})),(p,c)=>{const g=200*Math.pow(2,p);return c&&vc(c)&&Date.now()+g-l<Qr})}catch(l){if(this._debug(o,"error",l),be(l))return this._returnResult({data:{session:null,user:null},error:l});throw l}finally{this._debug(o,"end")}}_isValidSession(a){return typeof a=="object"&&a!==null&&"access_token"in a&&"refresh_token"in a&&"expires_at"in a}async _handleProviderSignIn(a,o){const l=await this._getUrlForProvider(`${this.url}/authorize`,a,{redirectTo:o.redirectTo,scopes:o.scopes,queryParams:o.queryParams});return this._debug("#_handleProviderSignIn()","provider",a,"options",o,"url",l),Rt()&&!o.skipBrowserRedirect&&window.location.assign(l),{data:{provider:a,url:l},error:null}}async _recoverAndRefresh(){var a,o;const l="#_recoverAndRefresh()";this._debug(l,"begin");try{const p=await Yi(this.storage,this.storageKey);if(p&&this.userStorage){let g=await Yi(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!g&&(g={user:p.user},await Fr(this.userStorage,this.storageKey+"-user",g)),p.user=(a=g?.user)!==null&&a!==void 0?a:wc()}else if(p&&!p.user&&!p.user){const g=await Yi(this.storage,this.storageKey+"-user");g&&g?.user?(p.user=g.user,await Nt(this.storage,this.storageKey+"-user"),await Fr(this.storage,this.storageKey,p)):p.user=wc()}if(this._debug(l,"session from storage",p),!this._isValidSession(p)){this._debug(l,"session is not valid"),p!==null&&await this._removeSession();return}const c=((o=p.expires_at)!==null&&o!==void 0?o:1/0)*1e3-Date.now()<xc;if(this._debug(l,`session has${c?"":" not"} expired with margin of ${xc}s`),c){if(this.autoRefreshToken&&p.refresh_token){const{error:g}=await this._callRefreshToken(p.refresh_token);g&&(console.error(g),vc(g)||(this._debug(l,"refresh failed with a non-retryable error, removing the session",g),await this._removeSession()))}}else if(p.user&&p.user.__isUserNotAvailableProxy===!0)try{const{data:g,error:h}=await this._getUser(p.access_token);!h&&g?.user?(p.user=g.user,await this._saveSession(p),await this._notifyAllSubscribers("SIGNED_IN",p)):this._debug(l,"could not get user data, skipping SIGNED_IN notification")}catch(g){console.error("Error getting user data:",g),this._debug(l,"error getting user data, skipping SIGNED_IN notification",g)}else await this._notifyAllSubscribers("SIGNED_IN",p)}catch(p){this._debug(l,"error",p),console.error(p);return}finally{this._debug(l,"end")}}async _callRefreshToken(a){var o,l;if(!a)throw new Xt;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const p=`#_callRefreshToken(${a.substring(0,5)}...)`;this._debug(p,"begin");try{this.refreshingDeferred=new Xs;const{data:c,error:g}=await this._refreshAccessToken(a);if(g)throw g;if(!c.session)throw new Xt;await this._saveSession(c.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",c.session);const h={data:c.session,error:null};return this.refreshingDeferred.resolve(h),h}catch(c){if(this._debug(p,"error",c),be(c)){const g={data:null,error:c};return vc(c)||await this._removeSession(),(o=this.refreshingDeferred)===null||o===void 0||o.resolve(g),g}throw(l=this.refreshingDeferred)===null||l===void 0||l.reject(c),c}finally{this.refreshingDeferred=null,this._debug(p,"end")}}async _notifyAllSubscribers(a,o,l=!0){const p=`#_notifyAllSubscribers(${a})`;this._debug(p,"begin",o,`broadcast = ${l}`);try{this.broadcastChannel&&l&&this.broadcastChannel.postMessage({event:a,session:o});const c=[],g=Array.from(this.stateChangeEmitters.values()).map(async h=>{try{await h.callback(a,o)}catch(b){c.push(b)}});if(await Promise.all(g),c.length>0){for(let h=0;h<c.length;h+=1)console.error(c[h]);throw c[0]}}finally{this._debug(p,"end")}}async _saveSession(a){this._debug("#_saveSession()",a),this.suppressGetSessionWarning=!0,await Nt(this.storage,`${this.storageKey}-code-verifier`);const o=Object.assign({},a),l=o.user&&o.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!l&&o.user&&await Fr(this.userStorage,this.storageKey+"-user",{user:o.user});const p=Object.assign({},o);delete p.user;const c=sf(p);await Fr(this.storage,this.storageKey,c)}else{const p=sf(o);await Fr(this.storage,this.storageKey,p)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Nt(this.storage,this.storageKey),await Nt(this.storage,this.storageKey+"-code-verifier"),await Nt(this.storage,this.storageKey+"-user"),this.userStorage&&await Nt(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const a=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{a&&Rt()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",a)}catch(o){console.error("removing visibilitychange callback failed",o)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const a=setInterval(()=>this._autoRefreshTokenTick(),Qr);this.autoRefreshTicker=a,a&&typeof a=="object"&&typeof a.unref=="function"?a.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(a);const o=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=o,o&&typeof o=="object"&&typeof o.unref=="function"?o.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(o)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const a=this.autoRefreshTicker;this.autoRefreshTicker=null,a&&clearInterval(a);const o=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,o&&clearTimeout(o)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const a=Date.now();try{return await this._useSession(async o=>{const{data:{session:l}}=o;if(!l||!l.refresh_token||!l.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const p=Math.floor((l.expires_at*1e3-a)/Qr);this._debug("#_autoRefreshTokenTick()",`access token expires in ${p} ticks, a tick lasts ${Qr}ms, refresh threshold is ${Bc} ticks`),p<=Bc&&await this._callRefreshToken(l.refresh_token)})}catch(o){console.error("Auto refresh tick failed with error. This is likely a transient error.",o)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(a){if(a.isAcquireTimeout||a instanceof Ff)this._debug("auto refresh token tick lock not available");else throw a}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Rt()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(a){this._debug("#visibilityChangedCallback","error",a)}},window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(a){console.error("_handleVisibilityChange",a)}}async _onVisibilityChanged(a){const o=`#_onVisibilityChanged(${a})`;this._debug(o,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),a||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(o,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(a,o,l){const p=[`provider=${encodeURIComponent(o)}`];if(l?.redirectTo&&p.push(`redirect_to=${encodeURIComponent(l.redirectTo)}`),l?.scopes&&p.push(`scopes=${encodeURIComponent(l.scopes)}`),this.flowType==="pkce"){const[c,g]=await Pr(this.storage,this.storageKey),h=new URLSearchParams({code_challenge:`${encodeURIComponent(c)}`,code_challenge_method:`${encodeURIComponent(g)}`});p.push(h.toString())}if(l?.queryParams){const c=new URLSearchParams(l.queryParams);p.push(c.toString())}return l?.skipBrowserRedirect&&p.push(`skip_http_redirect=${l.skipBrowserRedirect}`),`${a}?${p.join("&")}`}async _unenroll(a){try{return await this._useSession(async o=>{var l;const{data:p,error:c}=o;return c?this._returnResult({data:null,error:c}):await we(this.fetch,"DELETE",`${this.url}/factors/${a.factorId}`,{headers:this.headers,jwt:(l=p?.session)===null||l===void 0?void 0:l.access_token})})}catch(o){if(be(o))return this._returnResult({data:null,error:o});throw o}}async _enroll(a){try{return await this._useSession(async o=>{var l,p;const{data:c,error:g}=o;if(g)return this._returnResult({data:null,error:g});const h=Object.assign({friendly_name:a.friendlyName,factor_type:a.factorType},a.factorType==="phone"?{phone:a.phone}:a.factorType==="totp"?{issuer:a.issuer}:{}),{data:b,error:m}=await we(this.fetch,"POST",`${this.url}/factors`,{body:h,headers:this.headers,jwt:(l=c?.session)===null||l===void 0?void 0:l.access_token});return m?this._returnResult({data:null,error:m}):(a.factorType==="totp"&&b.type==="totp"&&(!((p=b?.totp)===null||p===void 0)&&p.qr_code)&&(b.totp.qr_code=`data:image/svg+xml;utf-8,${b.totp.qr_code}`),this._returnResult({data:b,error:null}))})}catch(o){if(be(o))return this._returnResult({data:null,error:o});throw o}}async _verify(a){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async o=>{var l;const{data:p,error:c}=o;if(c)return this._returnResult({data:null,error:c});const g=Object.assign({challenge_id:a.challengeId},"webauthn"in a?{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_response:a.webauthn.type==="create"?A2(a.webauthn.credential_response):E2(a.webauthn.credential_response)})}:{code:a.code}),{data:h,error:b}=await we(this.fetch,"POST",`${this.url}/factors/${a.factorId}/verify`,{body:g,headers:this.headers,jwt:(l=p?.session)===null||l===void 0?void 0:l.access_token});return b?this._returnResult({data:null,error:b}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+h.expires_in},h)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",h),this._returnResult({data:h,error:b}))})}catch(o){if(be(o))return this._returnResult({data:null,error:o});throw o}})}async _challenge(a){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async o=>{var l;const{data:p,error:c}=o;if(c)return this._returnResult({data:null,error:c});const g=await we(this.fetch,"POST",`${this.url}/factors/${a.factorId}/challenge`,{body:a,headers:this.headers,jwt:(l=p?.session)===null||l===void 0?void 0:l.access_token});if(g.error)return g;const{data:h}=g;if(h.type!=="webauthn")return{data:h,error:null};switch(h.webauthn.type){case"create":return{data:Object.assign(Object.assign({},h),{webauthn:Object.assign(Object.assign({},h.webauthn),{credential_options:Object.assign(Object.assign({},h.webauthn.credential_options),{publicKey:j2(h.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},h),{webauthn:Object.assign(Object.assign({},h.webauthn),{credential_options:Object.assign(Object.assign({},h.webauthn.credential_options),{publicKey:_2(h.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(o){if(be(o))return this._returnResult({data:null,error:o});throw o}})}async _challengeAndVerify(a){const{data:o,error:l}=await this._challenge({factorId:a.factorId});return l?this._returnResult({data:null,error:l}):await this._verify({factorId:a.factorId,challengeId:o.id,code:a.code})}async _listFactors(){var a;const{data:{user:o},error:l}=await this.getUser();if(l)return{data:null,error:l};const p={all:[],phone:[],totp:[],webauthn:[]};for(const c of(a=o?.factors)!==null&&a!==void 0?a:[])p.all.push(c),c.status==="verified"&&p[c.factor_type].push(c);return{data:p,error:null}}async _getAuthenticatorAssuranceLevel(a){var o,l,p,c;if(a)try{const{payload:S}=Rs(a);let j=null;S.aal&&(j=S.aal);let R=j;const{data:{user:I},error:D}=await this.getUser(a);if(D)return this._returnResult({data:null,error:D});((l=(o=I?.factors)===null||o===void 0?void 0:o.filter(E=>E.status==="verified"))!==null&&l!==void 0?l:[]).length>0&&(R="aal2");const B=S.amr||[];return{data:{currentLevel:j,nextLevel:R,currentAuthenticationMethods:B},error:null}}catch(S){if(be(S))return this._returnResult({data:null,error:S});throw S}const{data:{session:g},error:h}=await this.getSession();if(h)return this._returnResult({data:null,error:h});if(!g)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:b}=Rs(g.access_token);let m=null;b.aal&&(m=b.aal);let v=m;((c=(p=g.user.factors)===null||p===void 0?void 0:p.filter(S=>S.status==="verified"))!==null&&c!==void 0?c:[]).length>0&&(v="aal2");const k=b.amr||[];return{data:{currentLevel:m,nextLevel:v,currentAuthenticationMethods:k},error:null}}async _getAuthorizationDetails(a){try{return await this._useSession(async o=>{const{data:{session:l},error:p}=o;return p?this._returnResult({data:null,error:p}):l?await we(this.fetch,"GET",`${this.url}/oauth/authorizations/${a}`,{headers:this.headers,jwt:l.access_token,xform:c=>({data:c,error:null})}):this._returnResult({data:null,error:new Xt})})}catch(o){if(be(o))return this._returnResult({data:null,error:o});throw o}}async _approveAuthorization(a,o){try{return await this._useSession(async l=>{const{data:{session:p},error:c}=l;if(c)return this._returnResult({data:null,error:c});if(!p)return this._returnResult({data:null,error:new Xt});const g=await we(this.fetch,"POST",`${this.url}/oauth/authorizations/${a}/consent`,{headers:this.headers,jwt:p.access_token,body:{action:"approve"},xform:h=>({data:h,error:null})});return g.data&&g.data.redirect_url&&Rt()&&!o?.skipBrowserRedirect&&window.location.assign(g.data.redirect_url),g})}catch(l){if(be(l))return this._returnResult({data:null,error:l});throw l}}async _denyAuthorization(a,o){try{return await this._useSession(async l=>{const{data:{session:p},error:c}=l;if(c)return this._returnResult({data:null,error:c});if(!p)return this._returnResult({data:null,error:new Xt});const g=await we(this.fetch,"POST",`${this.url}/oauth/authorizations/${a}/consent`,{headers:this.headers,jwt:p.access_token,body:{action:"deny"},xform:h=>({data:h,error:null})});return g.data&&g.data.redirect_url&&Rt()&&!o?.skipBrowserRedirect&&window.location.assign(g.data.redirect_url),g})}catch(l){if(be(l))return this._returnResult({data:null,error:l});throw l}}async _listOAuthGrants(){try{return await this._useSession(async a=>{const{data:{session:o},error:l}=a;return l?this._returnResult({data:null,error:l}):o?await we(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:o.access_token,xform:p=>({data:p,error:null})}):this._returnResult({data:null,error:new Xt})})}catch(a){if(be(a))return this._returnResult({data:null,error:a});throw a}}async _revokeOAuthGrant(a){try{return await this._useSession(async o=>{const{data:{session:l},error:p}=o;return p?this._returnResult({data:null,error:p}):l?(await we(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:l.access_token,query:{client_id:a.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Xt})})}catch(o){if(be(o))return this._returnResult({data:null,error:o});throw o}}async fetchJwk(a,o={keys:[]}){let l=o.keys.find(h=>h.kid===a);if(l)return l;const p=Date.now();if(l=this.jwks.keys.find(h=>h.kid===a),l&&this.jwks_cached_at+B1>p)return l;const{data:c,error:g}=await we(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(g)throw g;return!c.keys||c.keys.length===0||(this.jwks=c,this.jwks_cached_at=p,l=c.keys.find(h=>h.kid===a),!l)?null:l}async getClaims(a,o={}){try{let l=a;if(!l){const{data:S,error:j}=await this.getSession();if(j||!S.session)return this._returnResult({data:null,error:j});l=S.session.access_token}const{header:p,payload:c,signature:g,raw:{header:h,payload:b}}=Rs(l);o?.allowExpired||r2(c.exp);const m=!p.alg||p.alg.startsWith("HS")||!p.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(p.kid,o?.keys?{keys:o.keys}:o?.jwks);if(!m){const{error:S}=await this.getUser(l);if(S)throw S;return{data:{claims:c,header:p,signature:g},error:null}}const v=n2(p.alg),z=await crypto.subtle.importKey("jwk",m,v,!0,["verify"]);if(!await crypto.subtle.verify(v,z,g,Y1(`${h}.${b}`)))throw new Uc("Invalid JWT signature");return{data:{claims:c,header:p,signature:g},error:null}}catch(l){if(be(l))return this._returnResult({data:null,error:l});throw l}}}no.nextInstanceID={};const I2=no,L2="2.95.3";let Fn="";typeof Deno<"u"?Fn="deno":typeof document<"u"?Fn="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Fn="react-native":Fn="node";const U2={"X-Client-Info":`supabase-js-${Fn}/${L2}`},q2={headers:U2},H2={schema:"public"},P2={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},G2={};function oo(r){"@babel/helpers - typeof";return oo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},oo(r)}function $2(r,a){if(oo(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,a);if(oo(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(r)}function Y2(r){var a=$2(r,"string");return oo(a)=="symbol"?a:a+""}function V2(r,a,o){return(a=Y2(a))in r?Object.defineProperty(r,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[a]=o,r}function hf(r,a){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(p){return Object.getOwnPropertyDescriptor(r,p).enumerable})),o.push.apply(o,l)}return o}function dt(r){for(var a=1;a<arguments.length;a++){var o=arguments[a]!=null?arguments[a]:{};a%2?hf(Object(o),!0).forEach(function(l){V2(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):hf(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}const Q2=r=>r?(...a)=>r(...a):(...a)=>fetch(...a),F2=()=>Headers,K2=(r,a,o)=>{const l=Q2(o),p=F2();return async(c,g)=>{var h;const b=(h=await a())!==null&&h!==void 0?h:r;let m=new p(g?.headers);return m.has("apikey")||m.set("apikey",r),m.has("Authorization")||m.set("Authorization",`Bearer ${b}`),l(c,dt(dt({},g),{},{headers:m}))}};function W2(r){return r.endsWith("/")?r:r+"/"}function J2(r,a){var o,l;const{db:p,auth:c,realtime:g,global:h}=r,{db:b,auth:m,realtime:v,global:z}=a,k={db:dt(dt({},b),p),auth:dt(dt({},m),c),realtime:dt(dt({},v),g),storage:{},global:dt(dt(dt({},z),h),{},{headers:dt(dt({},(o=z?.headers)!==null&&o!==void 0?o:{}),(l=h?.headers)!==null&&l!==void 0?l:{})}),accessToken:async()=>""};return r.accessToken?k.accessToken=r.accessToken:delete k.accessToken,k}function X2(r){const a=r?.trim();if(!a)throw new Error("supabaseUrl is required.");if(!a.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(W2(a))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var Z2=class extends I2{constructor(r){super(r)}},ex=class{constructor(r,a,o){var l,p;this.supabaseUrl=r,this.supabaseKey=a;const c=X2(r);if(!a)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const g=`sb-${c.hostname.split(".")[0]}-auth-token`,h={db:H2,realtime:G2,auth:dt(dt({},P2),{},{storageKey:g}),global:q2},b=J2(o??{},h);if(this.storageKey=(l=b.auth.storageKey)!==null&&l!==void 0?l:"",this.headers=(p=b.global.headers)!==null&&p!==void 0?p:{},b.accessToken)this.accessToken=b.accessToken,this.auth=new Proxy({},{get:(v,z)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(z)} is not possible`)}});else{var m;this.auth=this._initSupabaseAuthClient((m=b.auth)!==null&&m!==void 0?m:{},this.headers,b.global.fetch)}this.fetch=K2(a,this._getAccessToken.bind(this),b.global.fetch),this.realtime=this._initRealtimeClient(dt({headers:this.headers,accessToken:this._getAccessToken.bind(this)},b.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(v=>this.realtime.setAuth(v)).catch(v=>console.warn("Failed to set initial Realtime auth token:",v)),this.rest=new L0(new URL("rest/v1",c).href,{headers:this.headers,schema:b.db.schema,fetch:this.fetch,timeout:b.db.timeout,urlLengthLimit:b.db.urlLengthLimit}),this.storage=new N1(this.storageUrl.href,this.headers,this.fetch,o?.storage),b.accessToken||this._listenForAuthEvents()}get functions(){return new T0(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(r){return this.rest.from(r)}schema(r){return this.rest.schema(r)}rpc(r,a={},o={head:!1,get:!1,count:void 0}){return this.rest.rpc(r,a,o)}channel(r,a={config:{}}){return this.realtime.channel(r,a)}getChannels(){return this.realtime.getChannels()}removeChannel(r){return this.realtime.removeChannel(r)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var r=this,a,o;if(r.accessToken)return await r.accessToken();const{data:l}=await r.auth.getSession();return(a=(o=l.session)===null||o===void 0?void 0:o.access_token)!==null&&a!==void 0?a:r.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:r,persistSession:a,detectSessionInUrl:o,storage:l,userStorage:p,storageKey:c,flowType:g,lock:h,debug:b,throwOnError:m},v,z){const k={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Z2({url:this.authUrl.href,headers:dt(dt({},k),v),storageKey:c,autoRefreshToken:r,persistSession:a,detectSessionInUrl:o,storage:l,userStorage:p,flowType:g,lock:h,debug:b,throwOnError:m,fetch:z,hasCustomAuthorizationHeader:Object.keys(this.headers).some(S=>S.toLowerCase()==="authorization")})}_initRealtimeClient(r){return new t1(this.realtimeUrl.href,dt(dt({},r),{},{params:dt(dt({},{apikey:this.supabaseKey}),r?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,a)=>{this._handleTokenChanged(r,"CLIENT",a?.access_token)})}_handleTokenChanged(r,a,o){(r==="TOKEN_REFRESHED"||r==="SIGNED_IN")&&this.changedAccessToken!==o?(this.changedAccessToken=o,this.realtime.setAuth(o)):r==="SIGNED_OUT"&&(this.realtime.setAuth(),a=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const ff=(r,a,o)=>new ex(r,a,o);function tx(){if(typeof window<"u")return!1;const r=globalThis.process;if(!r)return!1;const a=r.version;if(a==null)return!1;const o=a.match(/^v(\d+)\./);return o?parseInt(o[1],10)<=18:!1}tx()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Ms="https://vatjiadgkwgrwijwoasi.supabase.co",ax="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZhdGppYWRna3dncndpandvYXNpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA4NjkzMjAsImV4cCI6MjA4NjQ0NTMyMH0.6XP4xjZxk5yhVivpXsxMYg315MYsK7jlP0PqNnkJlgI",Sc="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZhdGppYWRna3dncndpandvYXNpIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc3MDg2OTMyMCwiZXhwIjoyMDg2NDQ1MzIwfQ.n13kPBYgVw4IPrdNh_4E8qR1cm0hhvcuF6h9NXcyz_E";let $e=null,Zi=null;try{Ms&&!Ms.includes("YOUR_")&&($e=ff(Ms,ax),Sc&&!Sc.includes("YOUR_")&&(Zi=ff(Ms,Sc,{auth:{autoRefreshToken:!1,persistSession:!1}})))}catch(r){console.warn("Supabase not configured:",r.message)}const Ji=$e,Jf=Object.freeze(Object.defineProperty({__proto__:null,default:Ji,get supabase(){return $e},get supabaseAdmin(){return Zi}},Symbol.toStringTag,{value:"Module"})),Xe=Zi||$e;async function ix(){const{data:r,error:a}=await Xe.from("profiles").select("*");return a?(console.error("getUsers error:",a),[]):r||[]}async function rx(r){const{data:a,error:o}=await Xe.from("profiles").select("*").eq("email",r).single();return o?null:a}async function nx(r){const{data:a,error:o}=await Xe.from("profiles").select("*").eq("id",r).single();return o?null:a}async function ox(r){const{data:a,error:o}=await Xe.from("profiles").insert({name:r.name,email:r.email,role:r.role||"parent",active:r.active!==void 0?r.active:!0}).select().single();return o?(console.error("addUser error:",o),null):a}async function sx(r,a){const{data:o,error:l}=await Xe.from("profiles").update(a).eq("id",r).select().single();return l?(console.error("updateUser error:",l),null):o}async function lx(r){await Xe.from("children").delete().eq("parent_id",r);const{error:a}=await Xe.from("profiles").delete().eq("id",r);return a?(console.error("deleteUser error:",a),!1):(await Pc("user_deleted",{userId:r}),!0)}async function dx(){const{data:r,error:a}=await Xe.from("children").select("*");return a?(console.error("getChildren error:",a),[]):r||[]}async function cx(r){const{data:a,error:o}=await Xe.from("children").select("*").eq("pin",r).single();return o?null:a}async function ux(r){const{data:a,error:o}=await Xe.from("children").select("*").eq("parent_id",r);return o?(console.error("getChildrenByParent error:",o),[]):a||[]}async function px(r){const{data:a,error:o}=await Xe.from("children").insert({name:r.name,age:r.age,pin:r.pin,parent_id:r.parentId||r.parent_id}).select().single();return o?(console.error("addChild error:",o),null):a}async function gx(r,a){const{data:o,error:l}=await Xe.from("children").update(a).eq("id",r).select().single();return l?(console.error("updateChild error:",l),null):o}async function hx(r){await Xe.from("progress").delete().eq("child_id",r);const{error:a}=await Xe.from("children").delete().eq("id",r);return a?(console.error("deleteChild error:",a),!1):!0}async function fx(){const{data:r,error:a}=await Xe.from("purchases").select("*").order("created_at",{ascending:!1});return a?(console.error("getPurchases error:",a),[]):r||[]}async function bx(r){const{data:a,error:o}=await Xe.from("purchases").insert({user_id:r.userId||r.user_id,plan:r.plan,course_id:r.courseId||r.course_id||null,amount:r.amount,currency:r.currency||"USD",status:r.status||"pending",method:r.method,coupon_id:r.couponId||r.coupon_id||null,coupon_discount:r.couponDiscount||r.coupon_discount||0}).select().single();return o?(console.error("addPurchase error:",o),null):(await Pc("purchase",r),a)}async function mx(r,a){const{data:o,error:l}=await Xe.from("purchases").update(a).eq("id",r).select().single();return l?(console.error("updatePurchase error:",l),null):o}async function xx(){const{data:r,error:a}=await Xe.from("progress").select("*");return a?(console.error("getProgress error:",a),[]):r||[]}async function yx(r){const{data:a,error:o}=await Xe.from("progress").upsert({child_id:r.childId||r.child_id,course_id:r.courseId||r.course_id,chapter_index:r.chapterIndex??r.chapter_index??r.chapterIdx,completed_at:r.completedAt||new Date().toISOString()},{onConflict:"child_id,course_id,chapter_index"}).select().single();return o?(console.error("addProgress error:",o),null):a}async function vx(r){const{data:a,error:o}=await Xe.from("progress").select("*").eq("child_id",r);return o?(console.error("getProgressByChild error:",o),[]):a||[]}async function wx(){const{data:r,error:a}=await Xe.from("courses").select("*").order("created_at");return a?(console.error("getCourses error:",a),[]):r||[]}async function kx(r){const{data:a,error:o}=await Xe.from("course_access").select("*").eq("user_id",r).eq("active",!0);return o?(console.error("getCourseAccess error:",o),[]):a||[]}function Sx(){try{return JSON.parse(localStorage.getItem("ngs_settings")||"null")||{demoMode:!1,pricing:{singleCourse:19,fullAccess:39,familyPlan:59},stripeKey:"",razorpayKey:""}}catch{return{demoMode:!1,pricing:{singleCourse:19,fullAccess:39,familyPlan:59}}}}function zx(r){localStorage.setItem("ngs_settings",JSON.stringify(r))}async function Pc(r,a){const{error:o}=await Xe.from("admin_events").insert({event_type:r,data:a});o&&console.error("logEvent error:",o)}async function jx(){try{const[r,a,o,l]=await Promise.all([Xe.from("profiles").select("id",{count:"exact",head:!0}).eq("role","parent"),Xe.from("children").select("id",{count:"exact",head:!0}),Xe.from("purchases").select("amount, status"),Xe.from("progress").select("id",{count:"exact",head:!0})]),p=o.data||[],c=p.filter(h=>h.status==="completed"||h.status==="success").reduce((h,b)=>h+(Number(b.amount)||0),0),g=p.filter(h=>h.status==="failed").length;return{totalFamilies:r.count||0,totalChildren:a.count||0,totalRevenue:c,totalPurchases:p.length,failedPayments:g,chaptersCompleted:l.count||0}}catch(r){return console.error("getStats error:",r),{totalFamilies:0,totalChildren:0,totalRevenue:0,totalPurchases:0,failedPayments:0,chaptersCompleted:0}}}const Dt={getUsers:ix,getUserByEmail:rx,getUserById:nx,addUser:ox,updateUser:sx,deleteUser:lx,getChildren:dx,getChildByPin:cx,getChildrenByParent:ux,addChild:px,updateChild:gx,deleteChild:hx,getPurchases:fx,addPurchase:bx,updatePurchase:mx,getProgress:xx,addProgress:yx,getProgressByChild:vx,getCourses:wx,getCourseAccess:kx,getSettings:Sx,saveSettings:zx,logEvent:Pc,getStats:jx};async function _x({name:r,email:a,password:o,childName:l,childAge:p,childPin:c}){const g="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZhdGppYWRna3dncndpandvYXNpIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc3MDg2OTMyMCwiZXhwIjoyMDg2NDQ1MzIwfQ.n13kPBYgVw4IPrdNh_4E8qR1cm0hhvcuF6h9NXcyz_E",h="https://vatjiadgkwgrwijwoasi.supabase.co";try{const S=await fetch(`${h}/auth/v1/admin/users`,{method:"POST",headers:{apikey:g,Authorization:`Bearer ${g}`,"Content-Type":"application/json"},body:JSON.stringify({email:a,password:o,email_confirm:!0,user_metadata:{name:r}})}),j=await S.json();if(!S.ok)return{data:null,error:j.msg||j.message||j.error||"Signup failed"};const R=j;await new Promise(B=>setTimeout(B,800));const{data:I}=await fetch(`${h}/rest/v1/profiles?id=eq.${R.id}`,{method:"PATCH",headers:{apikey:g,Authorization:`Bearer ${g}`,"Content-Type":"application/json",Prefer:"return=representation"},body:JSON.stringify({name:r})}).then(B=>B.json()).then(B=>({data:Array.isArray(B)?B[0]:B})).catch(()=>({data:null}));let D=null;if(l&&c&&c.length===4){const B=await fetch(`${h}/rest/v1/children`,{method:"POST",headers:{apikey:g,Authorization:`Bearer ${g}`,"Content-Type":"application/json",Prefer:"return=representation"},body:JSON.stringify({name:l,age:p||10,pin:c,parent_id:R.id})});if(B.ok){const E=await B.json();D=Array.isArray(E)?E[0]:E}}const{error:U}=await $e.auth.signInWithPassword({email:a,password:o});return U?{data:{user:R,profile:I,child:D},error:null}:{data:{user:R,profile:I,child:D},error:null}}catch(S){return{data:null,error:S.message||"Signup failed"}}const{data:b,error:m}=await $e.auth.signUp({email:a,password:o,options:{data:{name:r}}});if(m)return{data:null,error:m.message};const v=b.user;await new Promise(S=>setTimeout(S,500));const{data:z}=await $e.from("profiles").update({name:r}).eq("id",v.id).select().single();let k=null;if(l&&c&&c.length===4){const{data:S,error:j}=await $e.from("children").insert({name:l,age:p||10,pin:c,parent_id:v.id}).select().single();j||(k=S)}return{data:{user:v,profile:z,child:k},error:null}}async function Ax(r,a){const{data:o,error:l}=await $e.auth.signInWithPassword({email:r,password:a});return l?{data:null,error:l.message}:{data:{user:o.user,session:o.session},error:null}}async function Ex(r,a){let l=(Zi||$e).from("children").select("*").eq("pin",r);a&&(l=l.ilike("name",a.trim()));const{data:p,error:c}=await l;return c||!p||p.length===0?{data:null,error:"Invalid name or PIN. Try again."}:{data:{child:p[0]},error:null}}async function Cx(){const{error:r}=await $e.auth.signOut();return{error:r?.message||null}}async function Tx(){const{data:r,error:a}=await $e.auth.getSession();return a?{data:null,error:a.message}:{data:r.session,error:null}}async function bf(r){const{data:a,error:o}=await $e.from("profiles").select("*").eq("id",r).single();return o?{data:null,error:o.message}:{data:a,error:null}}function Nx(r){const{data:a}=$e.auth.onAuthStateChange(r);return a.subscription}async function Rx(r){const{data:a}=await $e.from("profiles").select("role").eq("id",r).single();return a?.role==="admin"}async function Mx(){const{data:r,error:a}=await $e.auth.signInWithOAuth({provider:"google",options:{redirectTo:window.location.origin+window.location.pathname}});return a?{data:null,error:a.message}:{data:r,error:null}}const Xf=_.createContext(null);function Ox({children:r}){const[a,o]=_.useState(null),[l,p]=_.useState(null),[c,g]=_.useState(!0),[h,b]=_.useState(!1),[m,v]=_.useState(null),[z,k]=_.useState(null),S=_.useRef(null);_.useEffect(()=>{if(!Ji){g(!1);return}return Tx().then(async({data:F})=>{if(F?.user){const q={id:F.user.id,email:F.user.email,name:F.user.user_metadata?.name||F.user.email,role:"parent"};o(q);try{const{data:H}=await bf(F.user.id);H&&(p(H),q.role=H.role||"parent",q.name=H.name||q.name,o({...q}))}catch{}}g(!1)}).catch(()=>g(!1)),S.current=Nx(async(F,q)=>{if(F==="SIGNED_IN"&&q?.user){const H={id:q.user.id,email:q.user.email,name:q.user.user_metadata?.name||q.user.email,role:"parent"};o(H),k(null);try{const{data:oe}=await bf(q.user.id);oe&&(p(oe),H.role=oe.role||"parent",H.name=oe.name||H.name,o({...H}))}catch{}}else F==="SIGNED_OUT"&&(o(null),p(null),k(null))}),()=>{S.current?.unsubscribe()}},[]);const j=_.useCallback(async(F,q)=>{const{data:H,error:oe}=await Ax(F,q);return oe?{error:oe}:{success:!0,user:H.user}},[]),R=_.useCallback(async(F,q,H,oe,de,Se)=>{if(!F||!q||!H)return{error:"Please fill in name, email, and password"};if(H.length<6)return{error:"Password must be at least 6 characters"};const{data:Le,error:tt}=await _x({name:F,email:q,password:H,childName:oe,childAge:de,childPin:Se});return tt?{error:tt}:{success:!0,user:Le.user,childName:oe}},[]),I=_.useCallback(async(F,q)=>{const{data:H,error:oe}=await Ex(F,q);if(oe)return{error:oe};const de={id:H.child.id,name:H.child.name,role:"child",parentId:H.child.parent_id};return k(de),{success:!0,user:de}},[]),D=_.useCallback(async F=>{F&&(F.preventDefault(),F.stopPropagation());try{Ji&&await Cx()}catch(q){console.warn("Sign out error:",q)}o(null),p(null),k(null),b(!1);try{Object.keys(localStorage).forEach(q=>{q.startsWith("sb-")&&localStorage.removeItem(q)})}catch{}window.location.hash="#home",window.location.reload()},[]),U=_.useCallback(async F=>{if(!Ji)return{error:"Supabase not configured"};const{error:q}=await Ji.auth.resetPasswordForEmail(F);return q?{error:q.message}:{success:!0}},[]),B=z||a,E=!!B||h,N=B?.role==="parent",M=B?.role==="child",y=l?.role==="admin"||B?.role==="admin",O=B,$=B,ee=_.useCallback(async F=>Ji?Rx(F):!1,[]),J=_.useCallback((F="login")=>v(F),[]),Q=_.useCallback(()=>v(null),[]),re=_.useCallback(()=>{b(!0)},[]),Z=_.useCallback(async({name:F,email:q,password:H,childName:oe,childAge:de,childPin:Se})=>{const Le=await R(F,q,H,oe,de,Se);if(Le.error)throw new Error(Le.error);return Le},[R]),se=_.useCallback(async(F,q)=>{const H=await j(F,q);if(H.error)throw new Error(H.error);return H},[j]),w=_.useCallback(async(F,q)=>{const H=await I(F,q);if(H.error)throw new Error(H.error);return H},[I]),C=_.useCallback(async()=>{const F=await Mx();if(F.error)throw new Error(F.error);return F},[]),ne={session:B,profile:l,login:j,signup:R,childLogin:I,logout:D,resetPassword:U,isLoggedIn:E,isParent:N,isChild:M,isAdmin:y,checkIsAdmin:ee,currentUser:O,user:$,isDemoMode:h,setDemoMode:b,authModalType:m,openAuthModal:J,closeAuthModal:Q,enableDemoMode:re,doSignup:Z,doLogin:se,doChildLogin:w,doGoogleLogin:C,loading:c,childSession:z};return s.jsx(Xf.Provider,{value:ne,children:r})}function ji(){const r=_.useContext(Xf);if(!r)throw new Error("useAuth must be used within AuthProvider");return r}const Zf=_.createContext(null);function Dx({children:r}){const{session:a,isLoggedIn:o,isChild:l,childSession:p,loading:c}=ji(),[g,h]=_.useState({points:0,completed:{},purchases:{},notifications:[],currentCourse:null,currentChapter:0,currentView:"home",dataLoading:!0}),[b,m]=_.useState(!1);_.useEffect(()=>{if(c)return;if(!a){h($=>({...$,completed:{},purchases:{},points:0,dataLoading:!1}));return}let y=!1;async function O(){try{const $={};let ee=0;if(l&&p)(await Dt.getProgressByChild(p.id)).forEach(re=>{$[`${re.course_id}_${re.chapter_index}`]=!0}),ee=Object.keys($).length*25;else if(a?.id){const Q=await Dt.getChildrenByParent(a.id);for(const re of Q)(await Dt.getProgressByChild(re.id)).forEach(se=>{$[`${se.course_id}_${se.chapter_index}`]=!0});ee=Object.keys($).length*25}const J={};if(a?.id){try{(await Dt.getPurchases()).filter(Z=>Z.user_id===a.id&&(Z.status==="completed"||Z.status==="success")).forEach(Z=>{Z.plan==="fullAccess"||Z.plan==="familyPlan"?J.fullAccess=!0:Z.plan==="singleCourse"&&Z.course_id&&(J[Z.course_id]=!0)})}catch{}try{const Q=await Dt.getCourseAccess(a.id);if(Q&&Q.length>0){const re=Q.map(Z=>Z.course_id);re.length>=4?J.fullAccess=!0:re.forEach(Z=>{J[Z]=!0})}}catch{}}y||h(Q=>({...Q,completed:$,purchases:J,points:ee,dataLoading:!1}))}catch($){console.error("Error loading app data:",$),y||h(ee=>({...ee,dataLoading:!1}))}}return O(),()=>{y=!0}},[a?.id,c,l,p?.id]);const v=_.useCallback(async(y,O)=>{const $=`${y}_${O}`;h(J=>J.completed[$]?J:{...J,completed:{...J.completed,[$]:!0},points:J.points+25});const ee=p?.id;if(ee)try{await Dt.addProgress({childId:ee,courseId:y,chapterIndex:O})}catch(J){console.error("Error saving progress:",J)}},[p?.id]),z=_.useCallback(y=>{h(O=>({...O,currentCourse:y,currentChapter:0}))},[]),k=_.useCallback(y=>{h(O=>({...O,currentChapter:y}))},[]),S=_.useCallback(y=>{h(O=>({...O,currentView:y}))},[]),j=_.useCallback(y=>{h(O=>({...O,notifications:y}))},[]),R=_.useCallback((y,O)=>{h($=>({...$,currentView:y})),window.location.hash=O||y},[]),I=_.useCallback(y=>{h(O=>({...O,currentCourse:y,currentChapter:0,currentView:"courses"})),window.location.hash="courses"},[]),D=_.useCallback(async(y,O=null)=>{const ee={singleCourse:19,fullAccess:39,familyPlan:59}[y]||0;let J=ee,Q=null;if(O&&a?.id)try{const{validateCoupon:se,redeemCoupon:w}=await Ze(async()=>{const{validateCoupon:ne,redeemCoupon:F}=await import("./coupon.service-Cr-N3BwU.js");return{validateCoupon:ne,redeemCoupon:F}},__vite__mapDeps([0,1,2,3])),C=await se(O);if(C.valid){Q=C.coupon;const ne=Q.type==="percentage"?ee*(Q.value/100):Math.min(Q.value,ee);J=Math.max(0,ee-ne),await w(O,a.id,y==="singleCourse"?g.currentCourse:null)}}catch(se){console.error("Coupon error:",se)}if(J===0&&a?.id){try{await Dt.addPurchase({userId:a.id,plan:y,amount:0,currency:"USD",status:"completed",method:"coupon",courseId:y==="singleCourse"?g.currentCourse:null});const{supabaseAdmin:se,supabase:w}=await Ze(async()=>{const{supabaseAdmin:F,supabase:q}=await Promise.resolve().then(()=>Jf);return{supabaseAdmin:F,supabase:q}},void 0),C=se||w,ne=y==="fullAccess"||y==="familyPlan"?["ai","space","robotics","aiart"]:[g.currentCourse||"ai"];for(const F of ne){const{data:q}=await C.from("course_access").select("id").eq("user_id",a.id).eq("course_id",F).limit(1);q?.length||await C.from("course_access").insert({user_id:a.id,course_id:F,granted_by:"coupon"})}}catch(se){console.error("Grant access error:",se)}h(se=>{const w={...se.purchases};return y==="fullAccess"||y==="familyPlan"?w.fullAccess=!0:y==="singleCourse"&&(w[se.currentCourse||"ai"]=!0),{...se,purchases:w}}),alert(" Coupon applied! Your courses are now unlocked for FREE!");return}if(a?.id)try{await Dt.addPurchase({userId:a.id,plan:y,amount:J,currency:"USD",status:"pending",method:"stripe",courseId:y==="singleCourse"?g.currentCourse:null})}catch{}const{PAYMENT_CONFIG:re}=await Ze(async()=>{const{PAYMENT_CONFIG:se}=await Promise.resolve().then(()=>qx);return{PAYMENT_CONFIG:se}},void 0),Z=re.paymentLinks?.[y];if(Z){localStorage.setItem("pending_payment",JSON.stringify({plan:y,userId:a?.id,couponCode:O,ts:Date.now()}));const se=new URL(Z);a?.email&&se.searchParams.set("prefilled_email",a.email),window.location.href=se.toString()}else alert("Payment not configured for this plan.")},[a?.id,g.currentCourse]),U=_.useCallback(y=>{h(O=>{const $={...O.purchases};return y==="fullAccess"||y==="familyPlan"?$.fullAccess=!0:y==="singleCourse"&&($[O.currentCourse||"ai"]=!0),{...O,purchases:$}})},[]),B=_.useCallback(async()=>{try{const y=await Dt.getStats();return{students:y.totalChildren||0,chapters:y.chaptersCompleted||0,badges:y.chaptersCompleted||0}}catch{return{students:0,chapters:0,badges:0}}},[]),E=_.useCallback(y=>{h(O=>({...O,points:O.points+y}))},[]),N=_.useCallback(()=>{m(y=>!y)},[]),M={state:g,setState:h,addPoints:E,completeChapter:v,setCurrentCourse:z,setCurrentChapter:k,setCurrentView:S,setNotifications:j,navigate:R,openCourse:I,handlePayment:D,handlePurchase:U,getMetrics:B,toggleNotifPanel:N,showNotifPanel:b,notifications:g.notifications};return s.jsx(Zf.Provider,{value:M,children:r})}function lo(){const r=_.useContext(Zf);if(!r)throw new Error("useApp must be used within AppProvider");return r}function Bx(){const r=_.useRef(null);return _.useEffect(()=>{const a=r.current;if(!a)return;const o=a.getContext("2d");let l=[],p;function c(){a.width=window.innerWidth,a.height=window.innerHeight,l=Array.from({length:200},()=>({x:Math.random()*a.width,y:Math.random()*a.height,r:Math.random()*1.5+.3,s:Math.random()*.5+.1,o:Math.random()}))}c(),window.addEventListener("resize",c);function g(){o.clearRect(0,0,a.width,a.height),l.forEach(h=>{h.o+=h.s*.01,o.beginPath(),o.arc(h.x,h.y,h.r,0,Math.PI*2),o.fillStyle=`rgba(255,255,255,${(Math.sin(h.o)+1)/3})`,o.fill()}),p=requestAnimationFrame(g)}return g(),()=>{window.removeEventListener("resize",c),cancelAnimationFrame(p)}},[]),s.jsx("canvas",{ref:r,id:"starfield"})}const Ix=[{id:"home",icon:"",label:"Home",hash:"home"},{id:"courses",icon:"",label:"Courses",hash:"courses",children:[{id:"ai",icon:"",label:"AI Adventures"},{id:"space",icon:"",label:"Space Explorers"},{id:"robotics",icon:"",label:"Robotics Lab"},{id:"aiart",icon:"",label:"AI Art Studio"},{id:"mangalyaan",icon:"",label:"Mangalyaan AI Explorer"},{id:"nasa",icon:"",label:"NASA Space Explorer"}]},{id:"badges",icon:"",label:"My Badges",hash:"badges"},{id:"parent",icon:"",label:"Parent Portal",hash:"parent"},{id:"admin",icon:"",label:"Admin Panel",hash:"admin"}];function Lx(){const{state:r,navigate:a,openCourse:o}=lo(),{isLoggedIn:l,isDemoMode:p,currentUser:c,isChild:g,childSession:h,openAuthModal:b,logout:m,isAdmin:v}=ji(),[z,k]=_.useState(!1),[S,j]=_.useState(!1),R=r.currentView,I=E=>{if(E.children){k(N=>!N);return}a(E.hash||E.id),j(!1)},D=E=>{o(E),j(!1)},B=g?{label:"Child",color:"var(--cyan)"}:c?.role==="admin"?{label:"Admin",color:"var(--pink)"}:c?.role==="parent"?{label:"Parent",color:"var(--purple)"}:null;return s.jsxs(s.Fragment,{children:[s.jsxs("button",{className:"sidebar-hamburger",onClick:()=>j(!0),"aria-label":"Open menu",children:[s.jsx("span",{}),s.jsx("span",{}),s.jsx("span",{})]}),S&&s.jsx("div",{className:"sidebar-overlay",onClick:()=>j(!1)}),s.jsxs("aside",{className:`sidebar${S?" open":""}`,children:[s.jsxs("div",{className:"sidebar-brand",children:[s.jsx("div",{className:"sidebar-logo",children:""}),s.jsxs("div",{children:[s.jsx("div",{className:"sidebar-title",children:"NextGen School"}),s.jsx("div",{className:"sidebar-tagline",children:"Mind Over Machines"})]}),s.jsx("button",{className:"sidebar-close",onClick:()=>j(!1),children:""})]}),s.jsx("nav",{className:"sidebar-nav",children:Ix.filter(E=>E.id!=="admin"||v).map(E=>s.jsxs("div",{children:[s.jsxs("button",{className:`sidebar-nav-item${R===E.id||E.id==="home"&&R==="home"?" active":""}`,onClick:()=>I(E),children:[s.jsx("span",{className:"sidebar-nav-icon",children:E.icon}),s.jsx("span",{className:"sidebar-nav-label",children:E.label}),E.children&&s.jsx("span",{className:`sidebar-nav-arrow${z?" open":""}`,children:""})]}),E.children&&z&&s.jsx("div",{className:"sidebar-submenu",children:E.children.map(N=>s.jsxs("button",{className:`sidebar-nav-item sidebar-sub-item${r.currentCourse===N.id&&R==="courses"?" active":""}`,onClick:()=>D(N.id),children:[s.jsx("span",{className:"sidebar-nav-icon",children:N.icon}),s.jsx("span",{className:"sidebar-nav-label",children:N.label})]},N.id))})]},E.id))}),s.jsxs("div",{className:"sidebar-bottom",children:[s.jsx("div",{className:"sidebar-divider"}),l&&!p?s.jsxs("div",{className:"sidebar-user",children:[s.jsx("div",{className:"sidebar-avatar",style:{background:"linear-gradient(135deg, var(--purple), var(--cyan))",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",width:36,height:36,fontSize:"1rem"},children:(c?.name||"U")[0].toUpperCase()}),s.jsxs("div",{className:"sidebar-user-info",children:[s.jsxs("div",{className:"sidebar-user-name",children:[c?.name||"User",B&&s.jsx("span",{style:{fontSize:".65rem",background:B.color,color:"#fff",padding:"2px 6px",borderRadius:8,marginLeft:6,verticalAlign:"middle"},children:B.label})]}),g&&h&&s.jsxs("div",{style:{display:"flex",gap:8},children:[s.jsx("button",{onClick:m,style:{background:"none",border:"none",color:"var(--cyan)",cursor:"pointer",fontSize:".75rem",padding:0},children:"Switch to Parent"}),s.jsx("button",{onClick:m,style:{background:"none",border:"none",color:"var(--red)",cursor:"pointer",fontSize:".75rem",padding:0},children:"Sign Out"})]}),!g&&s.jsx("button",{onClick:m,style:{background:"none",border:"none",color:"var(--red)",cursor:"pointer",fontSize:".75rem",padding:0},children:"Sign Out"})]})]}):p?s.jsxs("div",{className:"sidebar-user",children:[s.jsx("div",{className:"sidebar-avatar",children:""}),s.jsxs("div",{className:"sidebar-user-info",children:[s.jsx("div",{className:"sidebar-user-name",children:"Explorer"}),s.jsx("div",{className:"sidebar-demo-badge",children:"DEMO MODE"}),s.jsx("button",{onClick:()=>b("signup"),style:{background:"none",border:"none",color:"var(--cyan)",cursor:"pointer",fontSize:".75rem",padding:0,marginTop:"4px"},children:"Create Account"})]})]}):s.jsxs("div",{className:"sidebar-user",style:{gap:"8px"},children:[s.jsx("button",{className:"btn btn-primary",onClick:()=>b("signup"),style:{fontSize:".8rem",padding:"8px 16px",flex:1},children:"Sign Up"}),s.jsx("button",{className:"btn btn-back",onClick:()=>b("login"),style:{fontSize:".8rem",padding:"8px 16px",flex:1},children:"Log In"})]})]})]})]})}const Ux={stripePublicKey:"pk_test_51T0l3q3RZmzBrkDif5qKWMemYiaxVusT03HmWJAJdspZcLOab4lraVc5SzrIoprQdRETCvhxtzBehjsJSMC37Imp00Pz42BjiE",razorpayKeyId:"YOUR_RAZORPAY_KEY_ID",prices:{singleCourse:"price_1T0lG53RZmzBrkDiurnI2GTJ",fullAccess:"price_1T0lG53RZmzBrkDi1AjpKUmc",familyPlan:"price_1T0lG63RZmzBrkDic9V9FzZR"},paymentLinks:{singleCourse:"https://buy.stripe.com/test_8x28wI9Zl3pM5GbgzDfIs03",fullAccess:"https://buy.stripe.com/test_3cIbIU7Rd0dAb0v2INfIs04",familyPlan:"https://buy.stripe.com/test_7sYdR24F19Oab0v57bfIs05"}},tr={ai:{title:" AI Adventures",color:"var(--cyan)",chapters:[{title:"What is AI?",emoji:""},{title:"How AI Learns",emoji:""},{title:"Smart vs Wise",emoji:""},{title:"AI in Your World",emoji:""},{title:"Asking Better Questions",emoji:""},{title:"When AI Gets It Wrong",emoji:""},{title:"AI Ethics & Fairness",emoji:""},{title:"Be the AI Boss",emoji:""}]},space:{title:" Space Explorers",color:"var(--purple)",chapters:[{title:"Our Solar System",emoji:""},{title:"Life of a Star",emoji:""},{title:"Rockets & Launch Science",emoji:""},{title:"Mission to Mars",emoji:""},{title:"Gravity & Orbits",emoji:""},{title:"Space AI",emoji:""},{title:"Astronaut Training",emoji:""},{title:"Design Your Space Mission",emoji:""}]},robotics:{title:" Robotics Lab",color:"var(--green)",chapters:[{title:"What is a Robot?",emoji:""},{title:"Robot Senses",emoji:""},{title:"Robot Brain",emoji:""},{title:"Robot Movement",emoji:""},{title:"Types of Robots",emoji:""},{title:"Robots & AI Together",emoji:""},{title:"Robot Ethics",emoji:""},{title:"Design Your Robot",emoji:""}]},aiart:{title:" AI Art Studio",color:"var(--gold, #f59e0b)",chapters:[{title:"What is AI Image Generation?",emoji:""},{title:"The Magic of Prompts",emoji:""},{title:"Art Styles & Tools",emoji:""},{title:"Create & Share Your Art",emoji:""},{title:"Advanced Prompt Engineering",emoji:""},{title:"AI Art Ethics & Ownership",emoji:""},{title:"Building an Art Portfolio",emoji:""},{title:"Be a Digital Artist!",emoji:""}]},mangalyaan:{title:" Mangalyaan AI Explorer",color:"#f97316",chapters:[{title:"India's Dream of Mars",emoji:""},{title:"Building Mangalyaan",emoji:""},{title:"The Slingshot Journey",emoji:""},{title:"Arriving at Mars",emoji:""},{title:"Eyes on Mars",emoji:""},{title:"The 7-per-km Mission",emoji:""},{title:"India's Space Heroes",emoji:""},{title:"Your Mission Begins",emoji:""}]},nasa:{title:" NASA Space Explorer",color:"#3b82f6",chapters:[{title:"The Apollo Dream",emoji:""},{title:"Hubble's Eye",emoji:""},{title:"Mars Rovers",emoji:""},{title:"Voyager's Journey",emoji:""},{title:"James Webb Telescope",emoji:""},{title:"Space Station Life",emoji:""},{title:"SpaceX & Reusable Rockets",emoji:""},{title:"Your NASA Mission",emoji:""}]}};[...["ai","space","robotics","aiart","mangalyaan","nasa"].flatMap(r=>tr[r].chapters.map((a,o)=>({id:`${r}_${o}`,emoji:a.emoji,name:a.title,course:r})))];const qx=Object.freeze(Object.defineProperty({__proto__:null,COURSES:tr,PAYMENT_CONFIG:Ux},Symbol.toStringTag,{value:"Module"}));function Hx(){return s.jsxs("footer",{style:{textAlign:"center",padding:"40px 20px",borderTop:"1px solid var(--glass-border)",color:"var(--text3)",fontSize:".85rem",position:"relative",zIndex:1},children:[s.jsx("p",{style:{marginBottom:"8px"},children:"NextGen School  Mind Over Machines"}),s.jsxs("p",{style:{marginBottom:"4px"},children:["Founded by ",s.jsx("strong",{style:{color:"var(--text2)"},children:"Sathish "})," & ",s.jsx("strong",{style:{color:"var(--text2)"},children:"Rathish "})]}),s.jsxs("p",{style:{fontSize:".75rem",marginTop:"8px"},children:[" ",new Date().getFullYear()," NextGen School. All rights reserved."]})]})}const Px=[{emoji:"",title:"Think Critically",desc:"Question everything, including AI. Be the boss, not the follower."},{emoji:"",title:"Create & Build",desc:"Hands-on, visual, drag-and-drop. Learn by doing, not memorizing."},{emoji:"",title:"Ethics First",desc:"Technology should be fair, kind, and helpful for everyone."},{emoji:"",title:"Dream Big",desc:"From AI to space to robots  the future belongs to curious kids."},{emoji:"",title:"Stay Curious",desc:"Ask questions, explore answers, never stop wondering why."},{emoji:"",title:"Think Global",desc:"Learn how technology connects and impacts the whole world."}],Gx=[{title:" Free Trial",price:"$0",priceSub:"Forever free",priceClass:"price-free",features:["Chapter 1 of all 3 courses","3 interactive activities","Basic badge collection"],btnClass:"btn btn-primary",btnText:"Start Free ",action:"showCourses"},{title:" Single Course",price:"$19",priceSub:"per course",priceClass:"price-paid",features:["All 8 chapters in one course","50+ interactive activities","Course certificate","Badge collection"],btnClass:"btn btn-primary",btnText:"Unlock Course ",action:"singleCourse"},{title:" Full Access",price:"$39",priceSub:"all courses",priceClass:"price-paid",popular:!0,features:["All 3 courses (24 chapters)","150+ interactive activities","All certificates","Priority support"],btnClass:"btn btn-gold",btnText:"Best Value ",action:"fullAccess"},{title:" Family Plan",price:"$59",priceSub:"up to 3 kids",priceClass:"price-paid",features:["Everything in Full Access","Up to 3 child profiles","Parent dashboard","Progress reports"],btnClass:"btn btn-primary",btnText:"Get Family Plan ",action:"familyPlan"}];function mf(){const{navigate:r,openCourse:a,handlePayment:o,getMetrics:l}=lo(),{isLoggedIn:p,openAuthModal:c}=ji(),g=_.useRef(null),[h,b]=_.useState({students:0,chapters:0,badges:0}),[m,v]=_.useState(!1),[z,k]=_.useState(""),[S,j]=_.useState(null),[R,I]=_.useState(!1),[D,U]=_.useState(null),B=async()=>{if(z.trim()){I(!0),j(null);try{const{validateCoupon:y}=await Ze(async()=>{const{validateCoupon:$}=await import("./coupon.service-Cr-N3BwU.js");return{validateCoupon:$}},__vite__mapDeps([0,1,2,3])),O=await y(z.trim());j(O),O.valid&&U({code:z.trim().toUpperCase(),coupon:O.coupon,discount:O.discount})}catch{j({valid:!1,error:"Failed to validate coupon"})}finally{I(!1)}}},E=()=>{U(null),j(null),k("")},N=y=>{if(!D)return null;const O=parseFloat(y.replace("$",""));if(isNaN(O)||O===0)return null;const $=D.coupon,ee=$.type==="percentage"?O*($.value/100):Math.min($.value,O);return(O-ee).toFixed(2)};_.useEffect(()=>{let y=!1;async function O(){try{const $=await l();y||b($)}catch{}}return O(),()=>{y=!0}},[l]),_.useEffect(()=>{if(typeof window.gsap>"u")return;const y=window.gsap,O=g.current?.querySelectorAll(".gsap-reveal");if(!O)return;O.forEach(ee=>{y.fromTo(ee,{opacity:0,y:40},{opacity:1,y:0,duration:.8,ease:"power2.out",scrollTrigger:{trigger:ee,start:"top 85%",once:!0}})});const $=(ee,J)=>{const Q=document.getElementById(ee);Q&&y.to({val:0},{val:J,duration:2,ease:"power2.out",onUpdate(){Q.textContent=Math.round(this.targets()[0].val)}})};$("metric-students",h.students||0),$("metric-chapters",h.chapters||0),$("metric-badges",h.badges||0)},[h]);const M=Object.entries(tr||{});return s.jsxs("div",{id:"landing",ref:g,children:[s.jsx("section",{id:"hero",children:s.jsxs("div",{className:"hero-content",children:[s.jsxs("div",{className:"hero-badges",children:[s.jsxs("span",{className:"hero-badge",children:[s.jsx("span",{children:""})," Ages 9-13"]}),s.jsxs("span",{className:"hero-badge",children:[s.jsx("span",{children:""})," Visual Learning"]}),s.jsxs("span",{className:"hero-badge",children:[s.jsx("span",{children:""})," Interactive"]})]}),s.jsx("h1",{children:"Mind Over Machines"}),s.jsx("p",{children:"The futuristic school where kids master AI, explore space, and build robots  all through drag-and-drop adventures. No coding required!"}),s.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center",flexWrap:"wrap"},children:[s.jsx("button",{className:"btn btn-primary",onClick:()=>{if(!p){c("signup");return}document.getElementById("courses")?.scrollIntoView({behavior:"smooth"})},children:" Start Learning"}),p?s.jsx("button",{className:"btn btn-back",onClick:()=>r("parent"),style:{marginLeft:"8px"},children:" My Account"}):s.jsx("button",{className:"btn btn-back",onClick:()=>c("login"),style:{marginLeft:"8px"},children:" Log In"})]})]})}),s.jsx("section",{id:"metrics",className:"gsap-reveal",children:s.jsx("div",{className:"container",children:s.jsxs("div",{className:"metrics-grid",children:[s.jsxs("div",{className:"metric-card",children:[s.jsx("div",{className:"metric-num",id:"metric-students",children:h.students}),s.jsx("div",{className:"metric-label",children:"Students Learning"})]}),s.jsxs("div",{className:"metric-card",children:[s.jsx("div",{className:"metric-num",id:"metric-chapters",children:h.chapters}),s.jsx("div",{className:"metric-label",children:"Chapters Completed"})]}),s.jsxs("div",{className:"metric-card",children:[s.jsx("div",{className:"metric-num",id:"metric-badges",children:h.badges}),s.jsx("div",{className:"metric-label",children:"Badges Earned"})]})]})})}),s.jsx("section",{id:"principles",className:"gsap-reveal",children:s.jsxs("div",{className:"container",children:[s.jsx("h2",{children:" Our Core Principles"}),s.jsx("div",{className:"principles-grid",children:Px.map((y,O)=>s.jsxs("div",{className:"principle-card glass",children:[s.jsx("span",{className:"emoji",children:y.emoji}),s.jsx("h4",{children:y.title}),s.jsx("p",{children:y.desc})]},O))})]})}),s.jsx("section",{id:"courses",className:"gsap-reveal",children:s.jsxs("div",{className:"container",children:[s.jsx("h2",{children:"Choose Your Adventure"}),s.jsx("p",{className:"subtitle",children:"6 courses  48 chapters  Hundreds of interactive activities"}),s.jsx("div",{className:"courses-grid",children:M.map(([y,O])=>s.jsxs("div",{className:"course-card glass","data-course":y,onClick:()=>a(y),children:[s.jsx("span",{className:"emoji",children:O.chapters?.[0]?.emoji||(y==="ai"?"":y==="space"?"":y==="aiart"?"":"")}),s.jsx("h3",{children:O.title}),s.jsxs("p",{children:[y==="ai"&&"Discover how artificial intelligence works  visually! Drag, drop, and explore the world of smart machines.",y==="space"&&"Launch rockets, plan missions to Mars, explore the solar system. Become a space scientist through interactive adventures!",y==="robotics"&&"Build robots with visual blocks, navigate mazes, add sensors and AI. Design your own robot from scratch!",y==="aiart"&&"Create stunning AI art with words! Learn prompts, styles, and how AI turns text into beautiful images. No drawing skills needed!",y==="mangalyaan"&&"Learn AI through India's historic Mars mission! Explore how ISRO reached Mars on its first attempt for less than the cost of a Hollywood movie! ",y==="nasa"&&"Explore AI through America's greatest space adventures! From Apollo to Mars Rovers to James Webb  learn how NASA uses AI to conquer the final frontier! "]}),s.jsxs("span",{className:"chapters-count",children:[O.chapters?.length||8," Chapters  50+ Activities"]}),y==="mangalyaan"&&s.jsx("button",{onClick:$=>{$.stopPropagation(),window.location.hash="#mangalyaan-landing"},style:{marginTop:10,background:"linear-gradient(135deg, #f97316, #FF9933)",color:"#000",border:"none",borderRadius:8,padding:"8px 18px",fontWeight:700,fontSize:"0.85rem",cursor:"pointer",display:"block",width:"100%"},children:" Premium Preview"}),y==="nasa"&&s.jsx("button",{onClick:$=>{$.stopPropagation(),window.location.hash="#nasa-landing"},style:{marginTop:10,background:"linear-gradient(135deg, #3b82f6, #60a5fa)",color:"#fff",border:"none",borderRadius:8,padding:"8px 18px",fontWeight:700,fontSize:"0.85rem",cursor:"pointer",display:"block",width:"100%"},children:" Premium Preview"})]},y))})]})}),s.jsx("section",{id:"pricing",className:"gsap-reveal",children:s.jsxs("div",{className:"container",children:[s.jsx("h2",{children:" Choose Your Plan"}),s.jsx("p",{className:"subtitle",children:"Start free  upgrade anytime. Chapter 1 of every course is always free!"}),s.jsxs("div",{style:{maxWidth:480,margin:"0 auto 24px",textAlign:"center"},children:[!m&&!D&&s.jsx("button",{onClick:()=>v(!0),style:{background:"none",border:"none",color:"var(--cyan, #06b6d4)",cursor:"pointer",fontSize:".9rem",textDecoration:"underline"},children:" Have a coupon code?"}),m&&!D&&s.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"center",alignItems:"center",flexWrap:"wrap",background:"rgba(255,255,255,0.05)",borderRadius:12,padding:"12px 16px",border:"1px solid rgba(255,255,255,0.1)"},children:[s.jsx("input",{value:z,onChange:y=>k(y.target.value.toUpperCase()),placeholder:"Enter coupon code",onKeyDown:y=>y.key==="Enter"&&B(),style:{background:"rgba(255,255,255,0.08)",border:"1px solid rgba(255,255,255,0.15)",borderRadius:8,padding:"8px 14px",color:"#fff",fontSize:".95rem",outline:"none",flex:1,minWidth:160}}),s.jsx("button",{onClick:B,disabled:R,style:{background:"var(--cyan, #06b6d4)",color:"#000",border:"none",borderRadius:8,padding:"8px 20px",fontWeight:600,cursor:"pointer",fontSize:".9rem",opacity:R?.6:1},children:R?"...":"Apply"}),s.jsx("button",{onClick:()=>{v(!1),k(""),j(null)},style:{background:"none",border:"none",color:"#999",cursor:"pointer",fontSize:".85rem"},children:"Cancel"})]}),S&&!S.valid&&s.jsxs("p",{style:{color:"#ef4444",fontSize:".85rem",marginTop:8},children:[" ",S.error]}),D&&s.jsxs("div",{style:{background:"rgba(16,185,129,0.1)",border:"1px solid rgba(16,185,129,0.3)",borderRadius:12,padding:"10px 16px",display:"flex",alignItems:"center",justifyContent:"center",gap:12},children:[s.jsxs("span",{style:{color:"#10b981",fontWeight:600},children:[" ",D.code," applied  ",D.coupon.type==="percentage"?`${D.coupon.value}% off`:`$${D.coupon.value} off`]}),s.jsx("button",{onClick:E,style:{background:"none",border:"none",color:"#ef4444",cursor:"pointer",fontSize:".8rem"},children:"Remove"})]})]}),s.jsx("div",{className:"pricing-grid",children:Gx.map((y,O)=>{const $=N(y.price);return s.jsxs("div",{className:`pricing-card${y.popular?" popular":""}`,children:[s.jsx("h3",{children:y.title}),$&&y.price!=="$0"?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:`price ${y.priceClass}`,style:{textDecoration:"line-through",opacity:.5,fontSize:"1.2rem"},children:y.price}),s.jsxs("div",{className:`price ${y.priceClass}`,style:{color:"#10b981"},children:["$",$]})]}):s.jsx("div",{className:`price ${y.priceClass}`,children:y.price}),s.jsx("div",{className:"price-sub",children:y.priceSub}),s.jsx("ul",{children:y.features.map((ee,J)=>s.jsx("li",{children:ee},J))}),s.jsx("button",{className:y.btnClass,onClick:()=>{if(!p){c("signup");return}y.action==="showCourses"?document.getElementById("courses")?.scrollIntoView({behavior:"smooth"}):o&&o(y.action,D?D.code:null)},children:y.btnText})]},O)})}),s.jsxs("p",{style:{textAlign:"center",marginTop:"20px",fontSize:".85rem",color:"var(--text3)"},children:[" Indian parents: Razorpay also available."," ",s.jsx("a",{href:"mailto:hello@nextgenschool.aiupskills.com",style:{color:"var(--cyan)"},children:"Contact us"})]})]})}),s.jsx(Hx,{})]})}const Gt={courses:null,courseDetails:new Map,lessonContent:new Map},$x=300*1e3,Qs=new Map;function zc(r){const a=Qs.get(r);return a&&Date.now()-a<$x}function jc(r,a){return Qs.set(r,Date.now()),a}const Yx={async getAllCourses(){if(Gt.courses&&zc("courses"))return Gt.courses;if(!$e)return[];const{data:r,error:a}=await $e.from("courses").select("id, title, description, color, emoji, tags, chapter_count, active").eq("active",!0).order("sort_order",{ascending:!0});return a?(console.warn("CourseService.getAllCourses error:",a.message),[]):(Gt.courses=jc("courses",r||[]),Gt.courses)},async getCourse(r){const a=`course:${r}`;if(Gt.courseDetails.has(r)&&zc(a))return Gt.courseDetails.get(r);if(!$e)return null;const[o,l]=await Promise.all([$e.from("courses").select("*").eq("id",r).single(),$e.from("chapters").select("idx, title, emoji, duration_min").eq("course_id",r).order("idx",{ascending:!0})]);if(o.error)return console.warn("CourseService.getCourse error:",o.error.message),null;const p={...o.data,chapters:l.data||[]};return Gt.courseDetails.set(r,p),jc(a,p),p},async getLessonContent(r,a){const o=`${r}:${a}`;if(Gt.lessonContent.has(o)&&zc(`lesson:${o}`))return Gt.lessonContent.get(o);if(!$e)return null;const{data:l,error:p}=await $e.from("lesson_content").select("*").eq("course_id",r).eq("chapter_idx",a).single();return p||!l?null:(Gt.lessonContent.set(o,l),jc(`lesson:${o}`,l),l)},async searchCourses(r){if(!$e||!r?.trim())return[];const a=r.trim().toLowerCase(),{data:o,error:l}=await $e.from("courses").select("id, title, description, color, emoji, tags").eq("active",!0).or(`title.ilike.%${a}%,description.ilike.%${a}%,tags.cs.{${a}}`);return l?(console.warn("CourseService.searchCourses error:",l.message),[]):o||[]},async upsertLessonContent(r,a,o,l={}){const p=Zi||$e;if(!p)throw new Error("Supabase not configured");const{data:c,error:g}=await p.from("lesson_content").upsert({course_id:r,chapter_idx:a,content_html:o,has_interactive:l.has_interactive||!1,has_karaoke:l.has_karaoke||!1,has_threejs:l.has_threejs||!1,updated_at:new Date().toISOString()},{onConflict:"course_id,chapter_idx"}).select().single();if(g)throw g;const h=`${r}:${a}`;return Gt.lessonContent.delete(h),Qs.delete(`lesson:${h}`),c},clearCache(){Gt.courses=null,Gt.courseDetails.clear(),Gt.lessonContent.clear(),Qs.clear()}};let yi=null;async function Vx(r,a){if(!yi)try{yi=await Ze(()=>Promise.resolve().then(()=>ey),void 0)}catch{return null}const l={ai:yi.getAILesson,space:yi.getSpaceLesson,robotics:yi.getRoboticsLesson,aiart:yi.getAIArtLesson,mangalyaan:yi.getMangalyaanLesson,nasa:yi.getNasaLesson}[r];return l?l(a):null}function Qx(){return s.jsxs("div",{className:"lesson-content",children:[s.jsx("div",{className:"skeleton-line title"}),s.jsx("div",{className:"skeleton-line wide"}),s.jsx("div",{className:"skeleton-line wide"}),s.jsx("div",{className:"skeleton-line medium"}),s.jsx("div",{className:"skeleton-line wide"}),s.jsx("div",{className:"skeleton-line narrow"}),s.jsx("div",{className:"skeleton-line wide"}),s.jsx("div",{className:"skeleton-line medium"})]})}function Fx({courseId:r,chapterIdx:a,onContentReady:o}){const[l,p]=_.useState(null),[c,g]=_.useState(!0),[h,b]=_.useState(null),m=_.useRef(null),v=_.useRef(!1),z=_.useCallback(async()=>{g(!0),b(null);try{let k=await Yx.getLessonContent(r,a);if(k)p(k);else{const S=await Vx(r,a);S?p({content_html:typeof S=="string"?S:S.html||S.content||"",has_interactive:!1,has_karaoke:!1,has_threejs:!1}):(b("Lesson content not found."),p(null))}}catch(k){console.error("CourseRenderer fetch error:",k),b("Failed to load lesson.")}finally{g(!1)}},[r,a]);return _.useEffect(()=>{z()},[z]),_.useEffect(()=>{if(!l||!m.current)return;const k=m.current;if(window.__lessonArea=k,m.current.querySelectorAll("script[data-lesson-script]").forEach(j=>{try{new Function("area",j.textContent)(k)}catch(R){console.warn("Lesson script error:",R.message)}j.remove()}),l.has_interactive&&typeof window.initDrag=="function"&&window.initDrag(),l.has_karaoke&&typeof window.initKaraoke=="function"&&window.initKaraoke(),l.has_threejs&&!v.current){v.current=!0;const j=document.createElement("script");j.src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js",j.async=!0,document.head.appendChild(j)}m.current.querySelectorAll(".copy-btn").forEach(j=>{j.onclick=()=>{const R=j.closest(".prompt-box")?.querySelector("pre");R&&(navigator.clipboard.writeText(R.textContent),j.textContent="Copied!",setTimeout(()=>{j.textContent="Copy"},2e3))}}),o?.()},[l,o]),c?s.jsx(Qx,{}):h?s.jsx("div",{className:"lesson-content",children:s.jsxs("div",{className:"info-box warning",children:[" ",h]})}):l?.content_html?s.jsx("div",{ref:m,className:"lesson-content",dangerouslySetInnerHTML:{__html:l.content_html}}):s.jsx("div",{className:"lesson-content",children:s.jsx("div",{className:"info-box tip",children:" No content available for this lesson yet."})})}const eb="nextgen_progress";function Kx(){try{return JSON.parse(localStorage.getItem(eb)||"{}")}catch{return{}}}function Wx(r){localStorage.setItem(eb,JSON.stringify(r))}function Jx(r){const[a,o]=_.useState({}),[l,p]=_.useState(!0),c=_.useRef(!1);_.useEffect(()=>{if(c.current)return;c.current=!0;async function m(){if(r?.id&&$e){const{data:v}=await $e.from("progress").select("course_id, chapter_index").eq("child_id",r?.child_id||r?.id);if(v){const z={};v.forEach(({course_id:k,chapter_index:S})=>{z[k]||(z[k]=[]),z[k].push(S)}),o(z)}}else o(Kx());p(!1)}m()},[r]);const g=_.useCallback(async(m,v)=>{o(z=>{const k=z[m]||[];if(k.includes(v))return z;const S={...z,[m]:[...k,v]};return r?.id&&$e?$e.from("progress").upsert({child_id:r?.child_id||r?.id,course_id:m,chapter_index:v,completed_at:new Date().toISOString()},{onConflict:"child_id,course_id,chapter_index"}).then(()=>{}):Wx(S),S})},[r]),h=_.useCallback((m,v)=>{const z=a[m]||[],k=v||z.length||1;return{completed:z,total:k,percent:k>0?Math.round(z.length/k*1e3)/10:0}},[a]),b=_.useCallback((m,v)=>(a[m]||[]).includes(v),[a]);return{progress:a,loading:l,markComplete:g,getProgress:h,isChapterComplete:b}}const _c=2*Math.PI*24;function Xx({courseId:r,initialChapter:a=0,user:o,onBack:l}){const[p,c]=_.useState(a),[g,h]=_.useState(new Set([a])),[b,m]=_.useState(!1),{markComplete:v,getProgress:z,isChapterComplete:k}=Jx(o),S=tr[r],j=S?.chapters||[],R=j.length,{completed:I,percent:D}=z(r,R),U=I.length,B=_c-D/100*_c,E=_.useCallback(J=>{h(Q=>{const re=new Set(Q);return re.has(J)?re.delete(J):re.add(J),re})},[]),N=_.useCallback(J=>{c(J),h(Q=>new Set(Q).add(J)),m(!1),window.scrollTo({top:0,behavior:"smooth"})},[]),M=_.useCallback(()=>{v(r,p)},[r,p,v]);_.useEffect(()=>(window.completeChapter=(J,Q)=>{v(J,Q)},window.addPoints=window.addPoints||(()=>{}),()=>{delete window.completeChapter}),[v]);const y=p>0,O=p<R-1,$=k(r,p),ee=U>=R;return S?s.jsxs("div",{className:"course-layout",children:[s.jsx("div",{className:"course-bg-grid"}),s.jsx("div",{className:"course-bg-orb o1"}),s.jsx("div",{className:"course-bg-orb o2"}),s.jsx("div",{className:"course-bg-orb o3"}),s.jsxs("header",{className:"course-header",children:[s.jsx("button",{className:"course-hamburger",onClick:()=>m(!b),children:""}),s.jsxs("div",{className:"course-header-logo",children:[s.jsx("div",{className:"logo-icon",children:j[p]?.emoji||""}),s.jsx("span",{children:S.title})]}),s.jsxs("div",{className:"course-header-progress",children:[s.jsxs("span",{children:[Math.round(D),"% Complete"]}),s.jsx("div",{className:"course-header-progress-bar",children:s.jsx("div",{className:"course-header-progress-fill",style:{width:`${D}%`}})})]})]}),s.jsx("div",{className:`course-overlay ${b?"open":""}`,onClick:()=>m(!1)}),s.jsxs("aside",{className:`course-sidebar ${b?"open":""}`,children:[s.jsx("div",{className:"course-sidebar-header",children:s.jsxs("div",{className:"progress-ring-wrap",children:[s.jsxs("div",{className:"progress-ring",children:[s.jsxs("svg",{width:"56",height:"56",viewBox:"0 0 56 56",children:[s.jsx("defs",{children:s.jsxs("linearGradient",{id:"ringGrad",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[s.jsx("stop",{offset:"0%",stopColor:"var(--blue)"}),s.jsx("stop",{offset:"100%",stopColor:"var(--cyan)"})]})}),s.jsx("circle",{className:"ring-bg",cx:"28",cy:"28",r:"24"}),s.jsx("circle",{className:"ring-fill",cx:"28",cy:"28",r:"24",strokeDasharray:_c,strokeDashoffset:B})]}),s.jsxs("div",{className:"ring-text",children:[Math.round(D),"%"]})]}),s.jsxs("div",{children:[s.jsx("h3",{children:"Course Progress"}),s.jsxs("div",{style:{fontSize:12,color:"var(--text3)"},children:[U," / ",R," completed"]})]})]})}),s.jsx("div",{className:"module-list",children:j.map((J,Q)=>{const re=k(r,Q),Z=g.has(Q),se=Q===p;return s.jsxs("div",{className:"module-item",children:[s.jsxs("button",{className:`module-toggle ${re?"completed":""} ${Z?"open":""}`,onClick:()=>E(Q),children:[s.jsx("span",{className:"mod-num",children:Q+1}),s.jsxs("span",{className:"mod-title",children:[J.emoji," ",J.title]}),s.jsx("span",{className:"mod-arrow",children:""})]}),s.jsx("div",{className:`lesson-list ${Z?"open":""}`,children:s.jsxs("button",{className:`lesson-btn ${se?"active":""} ${re?"done":""}`,onClick:()=>N(Q),children:[s.jsx("span",{className:"check",children:re?"":""}),s.jsx("span",{children:J.title})]})})]},Q)})})]}),r==="mangalyaan"&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"mangalyaan-bg"}),s.jsx("div",{className:"ashoka-chakra",children:Array.from({length:24}).map((J,Q)=>s.jsx("div",{className:"spoke",style:{transform:`rotate(${Q*15}deg)`}},Q))}),s.jsxs("div",{className:"mangalyaan-anthem",onClick:()=>{const J=document.getElementById("anthem-player");J&&(J.paused?J.play():J.pause())},style:{position:"fixed",bottom:24,right:24,zIndex:200,background:"linear-gradient(135deg, #ff9933, #ffffff33, #138808)",backdropFilter:"blur(20px)",border:"2px solid rgba(255,153,51,0.4)",borderRadius:50,padding:"14px 24px",display:"flex",alignItems:"center",gap:12,cursor:"pointer",boxShadow:"0 8px 32px rgba(255,153,51,0.3)",animation:"kPulse 2s ease-in-out infinite"},children:[s.jsx("audio",{id:"anthem-player",src:"./audio/jana-gana-mana.mp3",loop:!0}),s.jsx("span",{style:{fontSize:"1.5rem"},children:""}),s.jsx("span",{style:{color:"white",fontWeight:700,fontSize:"0.95rem",letterSpacing:"1px",textShadow:"0 2px 8px rgba(0,0,0,0.5)"},children:"Play Anthem"})]})]}),r==="nasa"&&s.jsxs("div",{className:"mangalyaan-anthem",onClick:()=>{const J=document.getElementById("usa-anthem-player");J&&(J.paused?J.play():J.pause())},style:{position:"fixed",bottom:24,right:24,zIndex:200,background:"linear-gradient(135deg, #ef4444, #ffffff33, #3b82f6)",backdropFilter:"blur(20px)",border:"2px solid rgba(59,130,246,0.4)",borderRadius:50,padding:"14px 24px",display:"flex",alignItems:"center",gap:12,cursor:"pointer",boxShadow:"0 8px 32px rgba(59,130,246,0.3)",animation:"kPulse 2s ease-in-out infinite"},children:[s.jsx("audio",{id:"usa-anthem-player",src:"./audio/star-spangled-banner.mp3",loop:!0}),s.jsx("span",{style:{fontSize:"1.5rem"},children:""}),s.jsx("span",{style:{color:"white",fontWeight:700,fontSize:"0.95rem",letterSpacing:"1px",textShadow:"0 2px 8px rgba(0,0,0,0.5)"},children:"Play Anthem"})]}),s.jsxs("main",{className:"course-main",children:[ee&&s.jsxs("div",{className:"certificate",children:[s.jsx("h2",{children:" Certificate of Completion"}),s.jsx("p",{style:{color:"var(--text2)",marginTop:8},children:"Congratulations!"}),s.jsx("div",{className:"cert-name",children:o?.name||o?.email||"Student"}),s.jsx("p",{style:{color:"var(--text2)"},children:"has completed"}),s.jsx("h3",{style:{color:"var(--text)",margin:"8px 0"},children:S.title}),s.jsx("div",{className:"cert-date",children:new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]}),s.jsx(Fx,{courseId:r,chapterIdx:p}),s.jsxs("div",{className:"lesson-footer",children:[s.jsx("button",{className:"btn-nav",disabled:!y,onClick:()=>N(p-1),children:" Previous"}),s.jsx("button",{className:`mark-complete-btn ${$?"completed":""}`,onClick:M,disabled:$,children:$?" Completed":"Mark Complete "}),s.jsx("button",{className:"btn-nav",disabled:!O,onClick:()=>N(p+1),children:"Next "})]})]})]}):s.jsxs("div",{style:{padding:48,color:"var(--text2)",textAlign:"center"},children:[s.jsx("h2",{children:"Course not found"}),s.jsxs("p",{children:['Course ID "',r,`" doesn't exist.`]}),l&&s.jsx("button",{className:"btn btn-secondary",onClick:l,children:" Go Back"})]})}function vi(r){if(!r)return;const a=[{time:0,line:"Jana Gaa Mana Adhinyaka Jaya H",words:"Jana Gaa Mana Adhinyaka Jaya H".split(" "),hindi:"     "},{time:10,line:"Bhrata Bhgya Vidht",words:"Bhrata Bhgya Vidht".split(" "),hindi:"  "},{time:16,line:"Pajba Sindhu Gujarta Marh",words:"Pajba Sindhu Gujarta Marh".split(" "),hindi:"   "},{time:22,line:"Drvia Utkala Baga",words:"Drvia Utkala Baga".split(" "),hindi:"  "},{time:28,line:"Vindhya Himchala Yamun Gag",words:"Vindhya Himchala Yamun Gag".split(" "),hindi:"   "},{time:34,line:"Uchchala Jaladhi Taraga",words:"Uchchala Jaladhi Taraga".split(" "),hindi:"  "},{time:40,line:"Tava ubha Nm Jg",words:"Tava ubha Nm Jg".split(" "),hindi:"   "},{time:46,line:"Tava ubha ia Mg",words:"Tava ubha ia Mg".split(" "),hindi:"   "},{time:52,line:"Gh Tava Jaya Gth",words:"Gh Tava Jaya Gth".split(" "),hindi:"   "},{time:58,line:"Jana Gaa Magaladyaka Jaya H",words:"Jana Gaa Magaladyaka Jaya H".split(" "),hindi:"    "},{time:64,line:"Bhrata Bhgya Vidht",words:"Bhrata Bhgya Vidht".split(" "),hindi:"  "},{time:70,line:"Jaya H, Jaya H, Jaya H",words:"Jaya H, Jaya H, Jaya H".split(" "),hindi:" ,  ,  "},{time:76,line:"Jaya Jaya Jaya Jaya H! ",words:"Jaya Jaya Jaya Jaya H! ".split(" "),hindi:"    !"}],o=r.querySelector(".karaoke-audio"),l=r.querySelector(".karaoke-lyrics"),p=r.querySelector(".karaoke-play"),c=r.querySelectorAll(".karaoke-bar"),g=r.querySelector(".karaoke-progress");if(!o||!l)return;let h=!1,b=null;l.innerHTML=a.map((v,z)=>`<div class="k-line" data-idx="${z}" style="opacity:0.3;transition:all 0.5s ease;margin:8px 0;transform:scale(0.95)">
      <div style="font-size:1.15rem;font-weight:600;letter-spacing:0.5px">${v.words.map((k,S)=>`<span class="k-word" data-li="${z}" data-wi="${S}" style="transition:all 0.3s ease;display:inline-block;padding:2px 4px;border-radius:4px">${k}</span>`).join(" ")}</div>
      <div style="font-size:0.85rem;opacity:0.6;margin-top:2px">${v.hindi}</div>
    </div>`).join("");function m(){const v=o.currentTime,z=o.duration||83;g&&(g.style.width=v/z*100+"%"),a.forEach((k,S)=>{const j=l.querySelector(`.k-line[data-idx="${S}"]`);if(!j)return;const R=a[S+1]?a[S+1].time:z,I=v>=k.time&&v<R,D=v>=R;if(I){j.style.opacity="1",j.style.transform="scale(1.05)",j.style.textShadow="0 0 20px rgba(255,153,51,0.5)";const U=(R-k.time)/k.words.length;k.words.forEach((B,E)=>{const N=j.querySelector(`.k-word[data-wi="${E}"]`);if(!N)return;const M=k.time+E*U;v>=M?(N.style.color="#ff9933",N.style.background="rgba(255,153,51,0.15)",N.style.transform="scale(1.1)",N.style.textShadow="0 0 12px rgba(255,153,51,0.8)"):(N.style.color="white",N.style.background="none",N.style.transform="scale(1)",N.style.textShadow="none")}),j.scrollIntoView({behavior:"smooth",block:"center"})}else D?(j.style.opacity="0.5",j.style.transform="scale(0.95)",j.style.textShadow="none",j.querySelectorAll(".k-word").forEach(U=>{U.style.color="#138808",U.style.background="none",U.style.transform="scale(1)",U.style.textShadow="none"})):(j.style.opacity="0.3",j.style.transform="scale(0.95)",j.style.textShadow="none",j.querySelectorAll(".k-word").forEach(U=>{U.style.color="white",U.style.background="none",U.style.transform="scale(1)",U.style.textShadow="none"}))}),h&&(b=requestAnimationFrame(m))}p.addEventListener("click",()=>{h?(o.pause(),h=!1,p.innerHTML="",p.style.background="linear-gradient(135deg,#1a1a2e,#16213e)",p.style.animation="kPulse 2s ease-in-out infinite",c.forEach(v=>v.style.animationPlayState="paused"),cancelAnimationFrame(b)):(o.play(),h=!0,p.innerHTML="",p.style.background="radial-gradient(circle at 35% 35%,#3d2f1a,#1a0f0a 70%)",p.style.animation="none",p.style.borderColor="rgba(255,153,51,0.8)",p.style.boxShadow="0 0 50px rgba(255,153,51,0.4),0 0 100px rgba(19,136,8,0.2),inset 0 0 20px rgba(255,153,51,0.15)",c.forEach(v=>v.style.animationPlayState="running"),m())}),o.addEventListener("ended",()=>{h=!1,p.innerHTML="",p.style.background="linear-gradient(135deg,#1a1a2e,#16213e)",p.style.animation="kPulse 2s ease-in-out infinite",c.forEach(v=>v.style.animationPlayState="paused"),cancelAnimationFrame(b)})}let Kn=null,Va=null;function ce(r){if(!r){document.querySelectorAll(".drag-item").forEach(a=>{a.addEventListener("pointerdown",Xn)});return}r.classList?.contains("drag-item")?r.addEventListener("pointerdown",Xn):r.querySelectorAll?.(".drag-item")?.forEach(a=>{a.addEventListener("pointerdown",Xn)})}function Xn(r){const a=r.currentTarget;a.classList.contains("placed")||(r.preventDefault(),Kn={el:a,startX:r.clientX,startY:r.clientY,id:a.dataset.id,value:a.dataset.value},Va=a.cloneNode(!0),Va.style.cssText=`position:fixed;z-index:99999;pointer-events:none;opacity:0.8;left:${r.clientX-40}px;top:${r.clientY-20}px;`,document.body.appendChild(Va),a.style.opacity="0.4",document.addEventListener("pointermove",Zs),document.addEventListener("pointerup",el))}function Zs(r){Va&&(Va.style.left=r.clientX-40+"px",Va.style.top=r.clientY-20+"px",document.querySelectorAll(".drag-zone, .bucket, .sequence-slot, .flowchart-area, .cargo-bay, .rocket-slot").forEach(a=>{const o=a.getBoundingClientRect();r.clientX>=o.left&&r.clientX<=o.right&&r.clientY>=o.top&&r.clientY<=o.bottom?a.classList.add("over"):a.classList.remove("over")}))}function el(r){if(document.removeEventListener("pointermove",Zs),document.removeEventListener("pointerup",el),Va&&(Va.remove(),Va=null),!Kn)return;Kn.el.style.opacity="";const a=document.querySelectorAll(".drag-zone, .bucket, .sequence-slot, .flowchart-area, .cargo-bay, .rocket-slot");a.forEach(o=>o.classList.remove("over")),a.forEach(o=>{const l=o.getBoundingClientRect();r.clientX>=l.left&&r.clientX<=l.right&&r.clientY>=l.top&&r.clientY<=l.bottom&&o.dataset.onDrop&&window[o.dataset.onDrop](Kn,o)}),Kn=null}function De(r,a,o){let l=r.querySelector(".feedback");if(l||(l=document.createElement("div"),l.className="feedback",r.appendChild(l)),l.className=`feedback show ${a}`,a==="error"){const p=["You're doing amazing  every great thinker makes mistakes before getting it right! ","Almost there! The best scientists try again and again. You're learning SO much! ","Hey, getting it wrong means your brain is growing! That's literally how learning works! ","Don't give up! Einstein failed hundreds of times before his breakthroughs! You've got this! ","You're braver than you believe! Every wrong answer gets you closer to the right one! ","Mistakes are just practice for being awesome! Try one more time! ","The fact that you're trying makes you a REAL explorer! Keep going! ","Wrong answers aren't failures  they're stepping stones! You're on the right path! ","Even robots need a few tries to get things right! You're smarter than a robot! ","Your curiosity is your superpower! Let's figure this out together! "],c=p[Math.floor(Math.random()*p.length)];l.innerHTML=o+'<div class="encouragement">'+c+"</div>"}else l.textContent=o,a==="success"&&(l.innerHTML=o+' <span style="font-size:1.2rem"></span>');l.scrollIntoView({behavior:"smooth",block:"center"})}const Zx={ai:[function(r){r.innerHTML=`
      <img src="./infographics/ai-ch1.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="What is AI infographic">
      
      <div style="background:linear-gradient(135deg,rgba(139,92,246,0.15),rgba(6,182,212,0.15));border:1px solid rgba(139,92,246,0.3);border-radius:16px;padding:16px 20px;margin-bottom:24px;display:flex;align-items:center;gap:14px">
        <div style="font-size:1.8rem"></div>
        <div style="flex:1">
          <div style="font-weight:600;font-size:0.9rem;margin-bottom:6px;color:#c4b5fd">Listen to this lesson</div>
          <audio controls style="width:100%;height:36px;border-radius:8px" src="./audio/ai-ch1.mp3"></audio>
        </div>
      </div>
      
      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.2rem;margin:0"> What is AI?</h1>
        <p style="color:#94a3b8;font-size:1.1rem;margin-top:8px">Let's discover the amazing world of Artificial Intelligence!</p>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#06b6d4;margin-top:0"> Meet AI  Your Digital Brain!</h2>
        <p style="font-size:1.05rem;line-height:1.7">Imagine you had a <span style="color:#8b5cf6;font-weight:bold">super-smart helper</span> that could recognize your face in photos, recommend your favorite songs, and even beat you at chess. That's <strong>Artificial Intelligence</strong>!</p>
        <p style="font-size:1.05rem;line-height:1.7">AI is like a brain made of math and data. It can't think or feel like you do, but it can process information <em>really, really fast</em> </p>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#8b5cf6;margin-top:0"> How Does AI Work? (Super Simple!)</h2>
        <div style="display:flex;justify-content:center;gap:16px;flex-wrap:wrap;margin:20px 0">
          <div style="background:linear-gradient(135deg,#06b6d4,#0891b2);border-radius:12px;padding:20px 24px;text-align:center;min-width:120px">
            <div style="font-size:2rem"></div>
            <div style="font-weight:bold;margin-top:8px">INPUT</div>
            <div style="font-size:0.85rem;opacity:0.9">You give it data</div>
          </div>
          <div style="display:flex;align-items:center;font-size:2rem"></div>
          <div style="background:linear-gradient(135deg,#8b5cf6,#7c3aed);border-radius:12px;padding:20px 24px;text-align:center;min-width:120px">
            <div style="font-size:2rem"></div>
            <div style="font-weight:bold;margin-top:8px">PROCESS</div>
            <div style="font-size:0.85rem;opacity:0.9">It finds patterns</div>
          </div>
          <div style="display:flex;align-items:center;font-size:2rem"></div>
          <div style="background:linear-gradient(135deg,#10b981,#059669);border-radius:12px;padding:20px 24px;text-align:center;min-width:120px">
            <div style="font-size:2rem"></div>
            <div style="font-weight:bold;margin-top:8px">OUTPUT</div>
            <div style="font-size:0.85rem;opacity:0.9">It gives answers</div>
          </div>
        </div>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#06b6d4;margin-top:0"> Drag & Drop: AI or Not AI?</h2>
        <p>Drag each item to the correct box! Is it AI or NOT AI? </p>
        <div id="drag-container-1" style="display:flex;flex-wrap:wrap;gap:10px;margin:16px 0">
          <div class="drag-item" data-id="1" data-value="ai" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab;font-size:1rem"> Siri / Alexa</div>
          <div class="drag-item" data-id="2" data-value="not-ai" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab;font-size:1rem"> Screwdriver</div>
          <div class="drag-item" data-id="3" data-value="ai" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab;font-size:1rem"> Face Filters</div>
          <div class="drag-item" data-id="4" data-value="not-ai" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab;font-size:1rem"> Light Switch</div>
          <div class="drag-item" data-id="5" data-value="ai" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab;font-size:1rem"> Game NPCs</div>
          <div class="drag-item" data-id="6" data-value="not-ai" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab;font-size:1rem"> Ruler</div>
        </div>
        <div style="display:flex;gap:16px;flex-wrap:wrap">
          <div class="drag-zone" data-accept="ai" style="flex:1;min-width:200px;min-height:120px;border:2px dashed #06b6d4;border-radius:12px;padding:16px;text-align:center">
            <div style="color:#06b6d4;font-weight:bold;font-size:1.1rem;margin-bottom:8px"> This IS AI</div>
          </div>
          <div class="drag-zone" data-accept="not-ai" style="flex:1;min-width:200px;min-height:120px;border:2px dashed #8b5cf6;border-radius:12px;padding:16px;text-align:center">
            <div style="color:#8b5cf6;font-weight:bold;font-size:1.1rem;margin-bottom:8px"> This is NOT AI</div>
          </div>
        </div>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#8b5cf6;margin-top:0"> Quick Quiz!</h2>
        <p style="font-size:1.05rem;margin-bottom:16px">What does AI stand for?</p>
        <div id="quiz1" style="display:flex;flex-direction:column;gap:10px">
          <button onclick="
            document.querySelectorAll('#quiz1 button').forEach(b=>b.style.opacity='0.5');
            this.style.opacity='1';
            this.style.border='2px solid #ef4444';
            showFeedback(document.getElementById('quiz1'), 'wrong', 'Not quite! Try again ')
          " style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">A) Automatic Learning</button>
          <button onclick="
            document.querySelectorAll('#quiz1 button').forEach(b=>b.style.opacity='0.5');
            this.style.opacity='1';
            this.style.border='2px solid #10b981';
            showFeedback(document.getElementById('quiz1'), 'correct', ' Yes! Artificial Intelligence!');
            window.addPoints(25);
          " style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">B) Artificial Intelligence </button>
          <button onclick="
            document.querySelectorAll('#quiz1 button').forEach(b=>b.style.opacity='0.5');
            this.style.opacity='1';
            this.style.border='2px solid #ef4444';
            showFeedback(document.getElementById('quiz1'), 'wrong', 'Nope! Think about what artificial means ')
          " style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">C) Advanced Internet</button>
          <button onclick="
            document.querySelectorAll('#quiz1 button').forEach(b=>b.style.opacity='0.5');
            this.style.opacity='1';
            this.style.border='2px solid #ef4444';
            showFeedback(document.getElementById('quiz1'), 'wrong', 'Nice try but no! ')
          " style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">D) Alien Intelligence </button>
        </div>
      </div>

      <div style="background:linear-gradient(135deg,rgba(6,182,212,0.1),rgba(139,92,246,0.1));border:1px solid rgba(6,182,212,0.2);border-radius:16px;padding:24px;margin-bottom:20px;text-align:center">
        <h2 style="margin-top:0"> Key Takeaway</h2>
        <p style="font-size:1.15rem;line-height:1.7">AI is a tool made by humans that can learn from data and make predictions. It's <strong style="color:#06b6d4">super fast</strong> but not truly <strong style="color:#8b5cf6">intelligent</strong> like you!</p>
      </div>

      <button onclick="window.completeChapter('ai', 0)" style="width:100%;padding:16px;background:linear-gradient(135deg,#06b6d4,#8b5cf6);border:none;border-radius:12px;color:white;font-size:1.1rem;font-weight:bold;cursor:pointer;margin-top:12px"> Complete Chapter 1!</button>
    `,typeof ce=="function"&&ce(r.querySelector("#drag-container-1")?.parentElement)},function(r){r.innerHTML=`
      <img src="./infographics/ai-ch2.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="How AI Learns infographic">
      
      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.2rem;margin:0"> How AI Learns</h1>
        <p style="color:#94a3b8;font-size:1.1rem;margin-top:8px">AI doesn't go to school  it learns from DATA!</p>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#06b6d4;margin-top:0"> Learning Like a Pizza Expert</h2>
        <p style="font-size:1.05rem;line-height:1.7">Imagine you've never seen a pizza before. Someone shows you <strong>1,000 pictures of pizza</strong>  and <strong>1,000 pictures of NOT pizza</strong> . After seeing all those pictures, you'd be pretty good at spotting pizza, right?</p>
        <p style="font-size:1.05rem;line-height:1.7">That's <em>exactly</em> how AI learns! It looks at <span style="color:#06b6d4;font-weight:bold">tons of examples</span> (called <strong>training data</strong>) and finds patterns.</p>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#8b5cf6;margin-top:0"> The 3 Steps of AI Learning</h2>
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;margin:20px 0">
          <div style="background:linear-gradient(180deg,rgba(6,182,212,0.15),rgba(6,182,212,0.05));border-radius:12px;padding:20px;text-align:center">
            <div style="font-size:2.5rem;margin-bottom:8px"></div>
            <div style="font-weight:bold;color:#06b6d4;font-size:1.1rem">Step 1: Feed Data</div>
            <p style="font-size:0.9rem;color:#94a3b8;margin:8px 0 0">Give AI thousands of examples to study</p>
          </div>
          <div style="background:linear-gradient(180deg,rgba(139,92,246,0.15),rgba(139,92,246,0.05));border-radius:12px;padding:20px;text-align:center">
            <div style="font-size:2.5rem;margin-bottom:8px"></div>
            <div style="font-weight:bold;color:#8b5cf6;font-size:1.1rem">Step 2: Find Patterns</div>
            <p style="font-size:0.9rem;color:#94a3b8;margin:8px 0 0">AI spots what things have in common</p>
          </div>
          <div style="background:linear-gradient(180deg,rgba(16,185,129,0.15),rgba(16,185,129,0.05));border-radius:12px;padding:20px;text-align:center">
            <div style="font-size:2.5rem;margin-bottom:8px"></div>
            <div style="font-weight:bold;color:#10b981;font-size:1.1rem">Step 3: Predict!</div>
            <p style="font-size:0.9rem;color:#94a3b8;margin:8px 0 0">Now it can guess new things it hasn't seen</p>
          </div>
        </div>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#06b6d4;margin-top:0"> Drag & Drop: Match the Learning Step!</h2>
        <p>Drag each example to the correct learning step </p>
        <div id="drag-container-2" style="display:flex;flex-wrap:wrap;gap:10px;margin:16px 0">
          <div class="drag-item" data-id="1" data-value="data" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> Showing 1000 cat pics</div>
          <div class="drag-item" data-id="2" data-value="pattern" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> Noticing cats have pointy ears</div>
          <div class="drag-item" data-id="3" data-value="predict" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> Saying "that's a cat!" on a new photo</div>
          <div class="drag-item" data-id="4" data-value="data" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> Reading millions of sentences</div>
          <div class="drag-item" data-id="5" data-value="pattern" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> Learning "the" comes before nouns</div>
          <div class="drag-item" data-id="6" data-value="predict" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> Autocompleting your sentence</div>
        </div>
        <div style="display:flex;gap:12px;flex-wrap:wrap">
          <div class="drag-zone" data-accept="data" style="flex:1;min-width:150px;min-height:100px;border:2px dashed #06b6d4;border-radius:12px;padding:16px;text-align:center">
            <div style="color:#06b6d4;font-weight:bold"> Feed Data</div>
          </div>
          <div class="drag-zone" data-accept="pattern" style="flex:1;min-width:150px;min-height:100px;border:2px dashed #8b5cf6;border-radius:12px;padding:16px;text-align:center">
            <div style="color:#8b5cf6;font-weight:bold"> Find Patterns</div>
          </div>
          <div class="drag-zone" data-accept="predict" style="flex:1;min-width:150px;min-height:100px;border:2px dashed #10b981;border-radius:12px;padding:16px;text-align:center">
            <div style="color:#10b981;font-weight:bold"> Predict!</div>
          </div>
        </div>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#8b5cf6;margin-top:0"> Quiz Time!</h2>
        <p style="font-size:1.05rem;margin-bottom:16px">Why does AI need LOTS of data to learn?</p>
        <div id="quiz2" style="display:flex;flex-direction:column;gap:10px">
          <button onclick="document.querySelectorAll('#quiz2 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #ef4444';showFeedback(document.getElementById('quiz2'),'wrong','Not really! AI doesn\\'t get bored ')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">A) Because it gets bored easily</button>
          <button onclick="document.querySelectorAll('#quiz2 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #10b981';showFeedback(document.getElementById('quiz2'),'correct',' Exactly! More data = better patterns = smarter AI!');window.addPoints(25)" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">B) More examples help it find better patterns </button>
          <button onclick="document.querySelectorAll('#quiz2 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #ef4444';showFeedback(document.getElementById('quiz2'),'wrong','Nope! Data is like food for AI\\'s brain ')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">C) It needs to fill up its hard drive</button>
          <button onclick="document.querySelectorAll('#quiz2 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #ef4444';showFeedback(document.getElementById('quiz2'),'wrong','Good guess but no! ')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">D) Because its teacher said so</button>
        </div>
      </div>

      <div style="background:linear-gradient(135deg,rgba(6,182,212,0.1),rgba(139,92,246,0.1));border:1px solid rgba(6,182,212,0.2);border-radius:16px;padding:24px;margin-bottom:20px;text-align:center">
        <h2 style="margin-top:0"> Key Takeaway</h2>
        <p style="font-size:1.15rem;line-height:1.7">AI learns by studying <strong style="color:#06b6d4">massive amounts of data</strong>, finding <strong style="color:#8b5cf6">patterns</strong>, then making <strong style="color:#10b981">predictions</strong>. The more good data it gets, the smarter it becomes!</p>
      </div>

      <button onclick="window.completeChapter('ai', 1)" style="width:100%;padding:16px;background:linear-gradient(135deg,#06b6d4,#8b5cf6);border:none;border-radius:12px;color:white;font-size:1.1rem;font-weight:bold;cursor:pointer;margin-top:12px"> Complete Chapter 2!</button>
    `,typeof ce=="function"&&ce(r.querySelector("#drag-container-2")?.parentElement)},function(r){r.innerHTML=`
      <img src="./infographics/ai-ch3.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="Smart vs Wise infographic">
      
      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.2rem;margin:0"> Smart vs Wise</h1>
        <p style="color:#94a3b8;font-size:1.1rem;margin-top:8px">AI is super smart... but is it wise? Let's find out!</p>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#06b6d4;margin-top:0"> Smart = Fast & Accurate</h2>
        <p style="font-size:1.05rem;line-height:1.7">A calculator can add <strong>1,000,000 + 2,345,678</strong> in a millisecond. That's <span style="color:#06b6d4">SMART</span>! AI can read a whole book in seconds. Also SMART!</p>
        <div style="background:rgba(6,182,212,0.1);border-radius:12px;padding:16px;margin-top:12px;text-align:center">
          <span style="font-size:1.5rem"> AI can process 1 million images per hour!</span>
        </div>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#8b5cf6;margin-top:0"> Wise = Understanding & Caring</h2>
        <p style="font-size:1.05rem;line-height:1.7">Your grandma might not be as fast as a computer, but she knows <em>when you're sad</em>, <em>why sharing matters</em>, and <em>how to make you feel better</em>. That's <span style="color:#8b5cf6">WISDOM</span>!</p>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-top:16px">
          <div style="background:rgba(6,182,212,0.1);border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:1.8rem"></div>
            <div style="font-weight:bold;color:#06b6d4;margin:8px 0">AI (Smart)</div>
            <ul style="text-align:left;font-size:0.9rem;color:#94a3b8;padding-left:16px;margin:0">
              <li>Super fast math</li>
              <li>Never forgets data</li>
              <li>Finds patterns instantly</li>
              <li>Works 24/7 no sleep</li>
            </ul>
          </div>
          <div style="background:rgba(139,92,246,0.1);border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:1.8rem"></div>
            <div style="font-weight:bold;color:#8b5cf6;margin:8px 0">Humans (Wise)</div>
            <ul style="text-align:left;font-size:0.9rem;color:#94a3b8;padding-left:16px;margin:0">
              <li>Understands feelings</li>
              <li>Makes moral choices</li>
              <li>Shows creativity</li>
              <li>Has empathy & love</li>
            </ul>
          </div>
        </div>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#06b6d4;margin-top:0"> Drag & Drop: Smart or Wise?</h2>
        <p>Which abilities are SMART (AI can do) and which are WISE (only humans)?</p>
        <div id="drag-container-3" style="display:flex;flex-wrap:wrap;gap:10px;margin:16px 0">
          <div class="drag-item" data-id="1" data-value="smart" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> Calculate millions of numbers</div>
          <div class="drag-item" data-id="2" data-value="wise" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> Comfort a crying friend</div>
          <div class="drag-item" data-id="3" data-value="smart" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> Search billions of websites</div>
          <div class="drag-item" data-id="4" data-value="wise" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> Know right from wrong</div>
          <div class="drag-item" data-id="5" data-value="smart" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> Translate 100 languages</div>
          <div class="drag-item" data-id="6" data-value="wise" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> Dream up a new invention</div>
        </div>
        <div style="display:flex;gap:16px;flex-wrap:wrap">
          <div class="drag-zone" data-accept="smart" style="flex:1;min-width:200px;min-height:120px;border:2px dashed #06b6d4;border-radius:12px;padding:16px;text-align:center">
            <div style="color:#06b6d4;font-weight:bold;font-size:1.1rem"> Smart (AI)</div>
          </div>
          <div class="drag-zone" data-accept="wise" style="flex:1;min-width:200px;min-height:120px;border:2px dashed #8b5cf6;border-radius:12px;padding:16px;text-align:center">
            <div style="color:#8b5cf6;font-weight:bold;font-size:1.1rem"> Wise (Human)</div>
          </div>
        </div>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#8b5cf6;margin-top:0"> Quiz Time!</h2>
        <p style="font-size:1.05rem;margin-bottom:16px">Your friend is sad about losing a game. What should you use?</p>
        <div id="quiz3" style="display:flex;flex-direction:column;gap:10px">
          <button onclick="document.querySelectorAll('#quiz3 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #ef4444';showFeedback(document.getElementById('quiz3'),'wrong','AI can\\'t really understand feelings! ')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">A) Ask AI to cheer them up</button>
          <button onclick="document.querySelectorAll('#quiz3 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #ef4444';showFeedback(document.getElementById('quiz3'),'wrong','That\\'s smart but not wise! ')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">B) Show them game statistics</button>
          <button onclick="document.querySelectorAll('#quiz3 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #10b981';showFeedback(document.getElementById('quiz3'),'correct',' That\\'s wisdom! Empathy is a human superpower! ');window.addPoints(25)" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">C) Give them a hug and listen </button>
          <button onclick="document.querySelectorAll('#quiz3 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #ef4444';showFeedback(document.getElementById('quiz3'),'wrong','Ignoring feelings isn\\'t wise! ')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">D) Ignore them and play another game</button>
        </div>
      </div>

      <div style="background:linear-gradient(135deg,rgba(6,182,212,0.1),rgba(139,92,246,0.1));border:1px solid rgba(6,182,212,0.2);border-radius:16px;padding:24px;margin-bottom:20px;text-align:center">
        <h2 style="margin-top:0"> Key Takeaway</h2>
        <p style="font-size:1.15rem;line-height:1.7">AI is <strong style="color:#06b6d4">smart</strong> (fast, accurate, tireless) but YOU are <strong style="color:#8b5cf6">wise</strong> (creative, empathetic, moral). The best combo? Use AI's smarts WITH your wisdom! </p>
      </div>

      <button onclick="window.completeChapter('ai', 2)" style="width:100%;padding:16px;background:linear-gradient(135deg,#06b6d4,#8b5cf6);border:none;border-radius:12px;color:white;font-size:1.1rem;font-weight:bold;cursor:pointer;margin-top:12px"> Complete Chapter 3!</button>
    `,typeof ce=="function"&&ce(r.querySelector("#drag-container-3")?.parentElement)},function(r){r.innerHTML=`
      <img src="./infographics/ai-ch4.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="AI in Your World infographic">
      
      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.2rem;margin:0"> AI in Your World</h1>
        <p style="color:#94a3b8;font-size:1.1rem;margin-top:8px">AI is EVERYWHERE  you use it every single day!</p>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#06b6d4;margin-top:0"> AI You Already Use!</h2>
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:12px;margin-top:16px">
          <div style="background:linear-gradient(180deg,rgba(239,68,68,0.15),rgba(239,68,68,0.05));border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:2rem"></div>
            <div style="font-weight:bold;margin-top:4px">YouTube</div>
            <div style="font-size:0.8rem;color:#94a3b8">Recommends videos you'll love</div>
          </div>
          <div style="background:linear-gradient(180deg,rgba(59,130,246,0.15),rgba(59,130,246,0.05));border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:2rem"></div>
            <div style="font-weight:bold;margin-top:4px">Siri / Alexa</div>
            <div style="font-size:0.8rem;color:#94a3b8">Understands your voice</div>
          </div>
          <div style="background:linear-gradient(180deg,rgba(236,72,153,0.15),rgba(236,72,153,0.05));border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:2rem"></div>
            <div style="font-weight:bold;margin-top:4px">Photo Filters</div>
            <div style="font-size:0.8rem;color:#94a3b8">Detects your face in real-time</div>
          </div>
          <div style="background:linear-gradient(180deg,rgba(34,197,94,0.15),rgba(34,197,94,0.05));border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:2rem"></div>
            <div style="font-weight:bold;margin-top:4px">Autocorrect</div>
            <div style="font-size:0.8rem;color:#94a3b8">Fixes your typos</div>
          </div>
          <div style="background:linear-gradient(180deg,rgba(168,85,247,0.15),rgba(168,85,247,0.05));border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:2rem"></div>
            <div style="font-weight:bold;margin-top:4px">Game NPCs</div>
            <div style="font-size:0.8rem;color:#94a3b8">Characters that react to you</div>
          </div>
          <div style="background:linear-gradient(180deg,rgba(251,146,60,0.15),rgba(251,146,60,0.05));border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:2rem"></div>
            <div style="font-weight:bold;margin-top:4px">Google Maps</div>
            <div style="font-size:0.8rem;color:#94a3b8">Finds fastest routes</div>
          </div>
        </div>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#8b5cf6;margin-top:0"> Drag & Drop: Match AI to Its Job!</h2>
        <p>What does each AI do? Drag it to the right job!</p>
        <div id="drag-container-4" style="display:flex;flex-wrap:wrap;gap:10px;margin:16px 0">
          <div class="drag-item" data-id="1" data-value="recommend" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> Netflix / YouTube</div>
          <div class="drag-item" data-id="2" data-value="recognize" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> Face ID unlock</div>
          <div class="drag-item" data-id="3" data-value="translate" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> Google Translate</div>
          <div class="drag-item" data-id="4" data-value="recommend" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> Spotify playlists</div>
          <div class="drag-item" data-id="5" data-value="recognize" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> Voice assistants</div>
          <div class="drag-item" data-id="6" data-value="translate" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> Autocorrect spelling</div>
        </div>
        <div style="display:flex;gap:12px;flex-wrap:wrap">
          <div class="drag-zone" data-accept="recommend" style="flex:1;min-width:150px;min-height:100px;border:2px dashed #06b6d4;border-radius:12px;padding:16px;text-align:center">
            <div style="color:#06b6d4;font-weight:bold"> Recommends Things</div>
          </div>
          <div class="drag-zone" data-accept="recognize" style="flex:1;min-width:150px;min-height:100px;border:2px dashed #8b5cf6;border-radius:12px;padding:16px;text-align:center">
            <div style="color:#8b5cf6;font-weight:bold"> Recognizes Stuff</div>
          </div>
          <div class="drag-zone" data-accept="translate" style="flex:1;min-width:150px;min-height:100px;border:2px dashed #10b981;border-radius:12px;padding:16px;text-align:center">
            <div style="color:#10b981;font-weight:bold"> Works with Language</div>
          </div>
        </div>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#06b6d4;margin-top:0"> Quiz Time!</h2>
        <p style="font-size:1.05rem;margin-bottom:16px">Which of these does NOT use AI?</p>
        <div id="quiz4" style="display:flex;flex-direction:column;gap:10px">
          <button onclick="document.querySelectorAll('#quiz4 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #ef4444';showFeedback(document.getElementById('quiz4'),'wrong','Nope! Siri uses AI to understand your voice ')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">A) Asking Siri a question</button>
          <button onclick="document.querySelectorAll('#quiz4 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #10b981';showFeedback(document.getElementById('quiz4'),'correct',' Correct! A regular light switch is just a simple circuit  no AI needed!');window.addPoints(25)" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">B) Flipping a light switch </button>
          <button onclick="document.querySelectorAll('#quiz4 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #ef4444';showFeedback(document.getElementById('quiz4'),'wrong','YouTube uses AI to recommend videos! ')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">C) YouTube recommending a video</button>
        </div>
      </div>

      <div style="background:linear-gradient(135deg,rgba(6,182,212,0.1),rgba(139,92,246,0.1));border:1px solid rgba(6,182,212,0.2);border-radius:16px;padding:24px;margin-bottom:20px;text-align:center">
        <h2 style="margin-top:0"> Key Takeaway</h2>
        <p style="font-size:1.15rem;line-height:1.7">AI is already part of your daily life! From <strong style="color:#06b6d4">recommendations</strong> to <strong style="color:#8b5cf6">voice assistants</strong> to <strong style="color:#10b981">autocorrect</strong>  it's everywhere helping you! </p>
      </div>

      <button onclick="window.completeChapter('ai', 3)" style="width:100%;padding:16px;background:linear-gradient(135deg,#06b6d4,#8b5cf6);border:none;border-radius:12px;color:white;font-size:1.1rem;font-weight:bold;cursor:pointer;margin-top:12px"> Complete Chapter 4!</button>
    `,typeof ce=="function"&&ce(r.querySelector("#drag-container-4")?.parentElement)},function(r){r.innerHTML=`
      <img src="./infographics/ai-ch5.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="Asking Better Questions infographic">
      
      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.2rem;margin:0"> Asking Better Questions</h1>
        <p style="color:#94a3b8;font-size:1.1rem;margin-top:8px">The SECRET to getting amazing answers from AI? Ask amazing questions!</p>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#06b6d4;margin-top:0"> It's Like Ordering Food!</h2>
        <p style="font-size:1.05rem;line-height:1.7">Imagine going to a restaurant and saying <em>"Give me food"</em>. You might get anything!  But if you say <em>"I'd like a cheeseburger with no pickles, extra ketchup, and curly fries"</em>  you get EXACTLY what you want! </p>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-top:16px">
          <div style="background:rgba(239,68,68,0.1);border:1px solid rgba(239,68,68,0.2);border-radius:12px;padding:16px">
            <div style="color:#ef4444;font-weight:bold;font-size:1rem;margin-bottom:8px"> Vague Prompt</div>
            <div style="font-size:0.95rem;color:#94a3b8">"Tell me about space"</div>
            <div style="font-size:0.8rem;color:#64748b;margin-top:4px">Too broad! AI doesn't know what you want.</div>
          </div>
          <div style="background:rgba(16,185,129,0.1);border:1px solid rgba(16,185,129,0.2);border-radius:12px;padding:16px">
            <div style="color:#10b981;font-weight:bold;font-size:1rem;margin-bottom:8px"> Specific Prompt</div>
            <div style="font-size:0.95rem;color:#94a3b8">"Explain 5 fun facts about Mars for a 10-year-old"</div>
            <div style="font-size:0.8rem;color:#64748b;margin-top:4px">Perfect! Clear, specific, with context.</div>
          </div>
        </div>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#8b5cf6;margin-top:0"> The SPARK Formula</h2>
        <div style="display:grid;gap:12px;margin-top:16px">
          <div style="display:flex;align-items:center;gap:12px;background:rgba(6,182,212,0.08);border-radius:12px;padding:14px">
            <div style="font-size:1.8rem;min-width:40px;text-align:center"></div>
            <div><strong style="color:#06b6d4">S</strong>pecific  Be clear about what you want</div>
          </div>
          <div style="display:flex;align-items:center;gap:12px;background:rgba(139,92,246,0.08);border-radius:12px;padding:14px">
            <div style="font-size:1.8rem;min-width:40px;text-align:center"></div>
            <div><strong style="color:#8b5cf6">P</strong>erson  Tell AI who it's for (age, level)</div>
          </div>
          <div style="display:flex;align-items:center;gap:12px;background:rgba(16,185,129,0.08);border-radius:12px;padding:14px">
            <div style="font-size:1.8rem;min-width:40px;text-align:center"></div>
            <div><strong style="color:#10b981">A</strong>sk for format  List? Story? Poem?</div>
          </div>
          <div style="display:flex;align-items:center;gap:12px;background:rgba(251,146,60,0.08);border-radius:12px;padding:14px">
            <div style="font-size:1.8rem;min-width:40px;text-align:center"></div>
            <div><strong style="color:#fb923c">R</strong>ange  How long? How many?</div>
          </div>
          <div style="display:flex;align-items:center;gap:12px;background:rgba(236,72,153,0.08);border-radius:12px;padding:14px">
            <div style="font-size:1.8rem;min-width:40px;text-align:center"></div>
            <div><strong style="color:#ec4899">K</strong>ey details  Add important context</div>
          </div>
        </div>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#06b6d4;margin-top:0"> Drag & Drop: Fix the Prompt!</h2>
        <p>Drag each improvement to make this vague prompt better!</p>
        <div style="background:rgba(239,68,68,0.1);border-radius:12px;padding:14px;margin-bottom:16px;text-align:center">
          <span style="color:#ef4444">Vague: </span>"Write something about dogs"
        </div>
        <div id="drag-container-5" style="display:flex;flex-wrap:wrap;gap:10px;margin:16px 0">
          <div class="drag-item" data-id="1" data-value="specific" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> "about golden retrievers"</div>
          <div class="drag-item" data-id="2" data-value="person" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> "for a 10-year-old"</div>
          <div class="drag-item" data-id="3" data-value="format" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> "as a fun poem"</div>
          <div class="drag-item" data-id="4" data-value="range" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> "in 4 stanzas"</div>
        </div>
        <div style="display:flex;gap:12px;flex-wrap:wrap">
          <div class="drag-zone" data-accept="specific" style="flex:1;min-width:140px;min-height:80px;border:2px dashed #06b6d4;border-radius:12px;padding:12px;text-align:center">
            <div style="color:#06b6d4;font-weight:bold;font-size:0.9rem"> Specific</div>
          </div>
          <div class="drag-zone" data-accept="person" style="flex:1;min-width:140px;min-height:80px;border:2px dashed #8b5cf6;border-radius:12px;padding:12px;text-align:center">
            <div style="color:#8b5cf6;font-weight:bold;font-size:0.9rem"> Person</div>
          </div>
          <div class="drag-zone" data-accept="format" style="flex:1;min-width:140px;min-height:80px;border:2px dashed #10b981;border-radius:12px;padding:12px;text-align:center">
            <div style="color:#10b981;font-weight:bold;font-size:0.9rem"> Format</div>
          </div>
          <div class="drag-zone" data-accept="range" style="flex:1;min-width:140px;min-height:80px;border:2px dashed #fb923c;border-radius:12px;padding:12px;text-align:center">
            <div style="color:#fb923c;font-weight:bold;font-size:0.9rem"> Range</div>
          </div>
        </div>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#8b5cf6;margin-top:0"> Quiz Time!</h2>
        <p style="font-size:1.05rem;margin-bottom:16px">Which is the BEST prompt to ask AI?</p>
        <div id="quiz5" style="display:flex;flex-direction:column;gap:10px">
          <button onclick="document.querySelectorAll('#quiz5 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #ef4444';showFeedback(document.getElementById('quiz5'),'wrong','Too vague! What about history? ')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">A) "Tell me about history"</button>
          <button onclick="document.querySelectorAll('#quiz5 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #ef4444';showFeedback(document.getElementById('quiz5'),'wrong','Getting better but still pretty broad! ')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">B) "Tell me about ancient Egypt"</button>
          <button onclick="document.querySelectorAll('#quiz5 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #10b981';showFeedback(document.getElementById('quiz5'),'correct',' Perfect SPARK prompt! Specific + Person + Format + Range!');window.addPoints(25)" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">C) "List 5 cool facts about Egyptian pyramids for a 12-year-old, with emojis" </button>
          <button onclick="document.querySelectorAll('#quiz5 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #ef4444';showFeedback(document.getElementById('quiz5'),'wrong','Way too vague! ')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">D) "Stuff"</button>
        </div>
      </div>

      <div style="background:linear-gradient(135deg,rgba(6,182,212,0.1),rgba(139,92,246,0.1));border:1px solid rgba(6,182,212,0.2);border-radius:16px;padding:24px;margin-bottom:20px;text-align:center">
        <h2 style="margin-top:0"> Key Takeaway</h2>
        <p style="font-size:1.15rem;line-height:1.7">Better questions = better answers! Use the <strong style="color:#06b6d4">SPARK formula</strong> to get amazing results from AI every time! </p>
      </div>

      <button onclick="window.completeChapter('ai', 4)" style="width:100%;padding:16px;background:linear-gradient(135deg,#06b6d4,#8b5cf6);border:none;border-radius:12px;color:white;font-size:1.1rem;font-weight:bold;cursor:pointer;margin-top:12px"> Complete Chapter 5!</button>
    `,typeof ce=="function"&&ce(r.querySelector("#drag-container-5")?.parentElement)},function(r){r.innerHTML=`
      <img src="./infographics/ai-ch6.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="When AI Gets It Wrong infographic">
      
      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.2rem;margin:0"> When AI Gets It Wrong</h1>
        <p style="color:#94a3b8;font-size:1.1rem;margin-top:8px">Spoiler alert: AI messes up ALL THE TIME! </p>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#06b6d4;margin-top:0"> Epic AI Fails!</h2>
        <div style="display:grid;gap:12px;margin-top:16px">
          <div style="display:flex;align-items:center;gap:14px;background:rgba(239,68,68,0.08);border-radius:12px;padding:14px">
            <div style="font-size:2rem"></div>
            <div>
              <div style="font-weight:bold;color:#ef4444">AI Drawing Hands</div>
              <div style="font-size:0.9rem;color:#94a3b8">AI often draws people with 6 fingers, 3 thumbs, or spaghetti hands! </div>
            </div>
          </div>
          <div style="display:flex;align-items:center;gap:14px;background:rgba(251,146,60,0.08);border-radius:12px;padding:14px">
            <div style="font-size:2rem"></div>
            <div>
              <div style="font-weight:bold;color:#fb923c">Autocorrect Disasters</div>
              <div style="font-size:0.9rem;color:#94a3b8">"I love you mom"  "I love you MOM"  "I love you MOB" </div>
            </div>
          </div>
          <div style="display:flex;align-items:center;gap:14px;background:rgba(139,92,246,0.08);border-radius:12px;padding:14px">
            <div style="font-size:2rem"></div>
            <div>
              <div style="font-weight:bold;color:#8b5cf6">Voice Assistant Confusion</div>
              <div style="font-size:0.9rem;color:#94a3b8">"Play Let It Go"  Plays a random song about letting go of furniture </div>
            </div>
          </div>
          <div style="display:flex;align-items:center;gap:14px;background:rgba(6,182,212,0.08);border-radius:12px;padding:14px">
            <div style="font-size:2rem"></div>
            <div>
              <div style="font-weight:bold;color:#06b6d4">AI "Hallucinations"</div>
              <div style="font-size:0.9rem;color:#94a3b8">AI sometimes makes up facts that sound real but are totally fake! </div>
            </div>
          </div>
        </div>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#8b5cf6;margin-top:0"> The FACT Check Method</h2>
        <div style="display:grid;gap:12px;margin-top:16px">
          <div style="display:flex;align-items:center;gap:12px;background:rgba(6,182,212,0.08);border-radius:12px;padding:14px">
            <div style="font-size:1.5rem;min-width:35px;text-align:center;font-weight:bold;color:#06b6d4">F</div>
            <div><strong>Find</strong> another source  Don't trust just one!</div>
          </div>
          <div style="display:flex;align-items:center;gap:12px;background:rgba(139,92,246,0.08);border-radius:12px;padding:14px">
            <div style="font-size:1.5rem;min-width:35px;text-align:center;font-weight:bold;color:#8b5cf6">A</div>
            <div><strong>Ask</strong> an adult  Teachers & parents know stuff!</div>
          </div>
          <div style="display:flex;align-items:center;gap:12px;background:rgba(16,185,129,0.08);border-radius:12px;padding:14px">
            <div style="font-size:1.5rem;min-width:35px;text-align:center;font-weight:bold;color:#10b981">C</div>
            <div><strong>Check</strong> if it makes sense  Does it sound real?</div>
          </div>
          <div style="display:flex;align-items:center;gap:12px;background:rgba(251,146,60,0.08);border-radius:12px;padding:14px">
            <div style="font-size:1.5rem;min-width:35px;text-align:center;font-weight:bold;color:#fb923c">T</div>
            <div><strong>Think</strong> critically  Your brain is the best tool!</div>
          </div>
        </div>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#06b6d4;margin-top:0"> Drag & Drop: Trust or Verify?</h2>
        <p>Should you trust AI's answer or verify it first?</p>
        <div id="drag-container-6" style="display:flex;flex-wrap:wrap;gap:10px;margin:16px 0">
          <div class="drag-item" data-id="1" data-value="trust" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> "What's 245 + 378?"</div>
          <div class="drag-item" data-id="2" data-value="verify" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> "Is this news story real?"</div>
          <div class="drag-item" data-id="3" data-value="verify" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> "Is this food safe to eat?"</div>
          <div class="drag-item" data-id="4" data-value="trust" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> "Translate hello to Spanish"</div>
          <div class="drag-item" data-id="5" data-value="verify" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> "Facts for my school report"</div>
          <div class="drag-item" data-id="6" data-value="trust" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> "Make this image brighter"</div>
        </div>
        <div style="display:flex;gap:16px;flex-wrap:wrap">
          <div class="drag-zone" data-accept="trust" style="flex:1;min-width:200px;min-height:100px;border:2px dashed #10b981;border-radius:12px;padding:16px;text-align:center">
            <div style="color:#10b981;font-weight:bold"> Mostly Trustable</div>
          </div>
          <div class="drag-zone" data-accept="verify" style="flex:1;min-width:200px;min-height:100px;border:2px dashed #ef4444;border-radius:12px;padding:16px;text-align:center">
            <div style="color:#ef4444;font-weight:bold"> Must Verify!</div>
          </div>
        </div>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#8b5cf6;margin-top:0"> Quiz Time!</h2>
        <p style="font-size:1.05rem;margin-bottom:16px">AI tells you "The Eiffel Tower is in London." What should you do?</p>
        <div id="quiz6" style="display:flex;flex-direction:column;gap:10px">
          <button onclick="document.querySelectorAll('#quiz6 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #ef4444';showFeedback(document.getElementById('quiz6'),'wrong','Never blindly trust AI! Always think first! ')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">A) Believe it  AI is always right</button>
          <button onclick="document.querySelectorAll('#quiz6 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #10b981';showFeedback(document.getElementById('quiz6'),'correct',' Smart thinking! The Eiffel Tower is in PARIS, France! AI got it wrong!');window.addPoints(25)" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">B) Check another source  that sounds wrong! </button>
          <button onclick="document.querySelectorAll('#quiz6 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #ef4444';showFeedback(document.getElementById('quiz6'),'wrong','Don\\'t give up on AI! Just verify important facts ')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">C) Never use AI again</button>
        </div>
      </div>

      <div style="background:linear-gradient(135deg,rgba(6,182,212,0.1),rgba(139,92,246,0.1));border:1px solid rgba(6,182,212,0.2);border-radius:16px;padding:24px;margin-bottom:20px;text-align:center">
        <h2 style="margin-top:0"> Key Takeaway</h2>
        <p style="font-size:1.15rem;line-height:1.7">AI makes mistakes! Always use the <strong style="color:#06b6d4">FACT method</strong> to verify important information. You're smarter than you think! </p>
      </div>

      <button onclick="window.completeChapter('ai', 5)" style="width:100%;padding:16px;background:linear-gradient(135deg,#06b6d4,#8b5cf6);border:none;border-radius:12px;color:white;font-size:1.1rem;font-weight:bold;cursor:pointer;margin-top:12px"> Complete Chapter 6!</button>
    `,typeof ce=="function"&&ce(r.querySelector("#drag-container-6")?.parentElement)},function(r){r.innerHTML=`
      <img src="./infographics/ai-ch7.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="AI Ethics and Fairness infographic">
      
      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.2rem;margin:0"> AI Ethics & Fairness</h1>
        <p style="color:#94a3b8;font-size:1.1rem;margin-top:8px">With great AI power comes great responsibility! </p>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#06b6d4;margin-top:0"> What is Bias?</h2>
        <p style="font-size:1.05rem;line-height:1.7">Imagine you're training an AI to recognize "good students" but you only show it pictures of kids wearing glasses . Now it thinks ALL good students wear glasses! That's <strong style="color:#ef4444">bias</strong>  when AI learns unfair patterns from unfair data.</p>
        <div style="background:rgba(239,68,68,0.1);border-radius:12px;padding:16px;margin-top:12px">
          <div style="text-align:center;font-size:1.1rem"><strong>Bad data in  = Unfair results out </strong></div>
          <div style="text-align:center;font-size:0.9rem;color:#94a3b8;margin-top:4px">This is why DIVERSE data matters!</div>
        </div>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#8b5cf6;margin-top:0"> The 4 Rules of AI Ethics</h2>
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px;margin-top:16px">
          <div style="background:linear-gradient(180deg,rgba(6,182,212,0.15),rgba(6,182,212,0.05));border-radius:12px;padding:20px;text-align:center">
            <div style="font-size:2.2rem"></div>
            <div style="font-weight:bold;color:#06b6d4;margin:8px 0">Fairness</div>
            <div style="font-size:0.85rem;color:#94a3b8">AI should treat everyone equally, no matter who they are</div>
          </div>
          <div style="background:linear-gradient(180deg,rgba(139,92,246,0.15),rgba(139,92,246,0.05));border-radius:12px;padding:20px;text-align:center">
            <div style="font-size:2.2rem"></div>
            <div style="font-weight:bold;color:#8b5cf6;margin:8px 0">Privacy</div>
            <div style="font-size:0.85rem;color:#94a3b8">Your data belongs to YOU  AI shouldn't snoop!</div>
          </div>
          <div style="background:linear-gradient(180deg,rgba(16,185,129,0.15),rgba(16,185,129,0.05));border-radius:12px;padding:20px;text-align:center">
            <div style="font-size:2.2rem"></div>
            <div style="font-weight:bold;color:#10b981;margin:8px 0">Transparency</div>
            <div style="font-size:0.85rem;color:#94a3b8">You should know when you're talking to AI</div>
          </div>
          <div style="background:linear-gradient(180deg,rgba(251,146,60,0.15),rgba(251,146,60,0.05));border-radius:12px;padding:20px;text-align:center">
            <div style="font-size:2.2rem"></div>
            <div style="font-weight:bold;color:#fb923c;margin:8px 0">Accountability</div>
            <div style="font-size:0.85rem;color:#94a3b8">Humans are responsible for what AI does</div>
          </div>
        </div>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#06b6d4;margin-top:0"> Drag & Drop: Ethical or Not?</h2>
        <p>Is this use of AI ethical (fair) or unethical (unfair)?</p>
        <div id="drag-container-7" style="display:flex;flex-wrap:wrap;gap:10px;margin:16px 0">
          <div class="drag-item" data-id="1" data-value="ethical" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> AI helping doctors find diseases</div>
          <div class="drag-item" data-id="2" data-value="unethical" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> AI spying on people without permission</div>
          <div class="drag-item" data-id="3" data-value="ethical" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> AI making websites accessible</div>
          <div class="drag-item" data-id="4" data-value="unethical" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> AI that only works for one skin color</div>
          <div class="drag-item" data-id="5" data-value="ethical" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> AI translating for refugees</div>
          <div class="drag-item" data-id="6" data-value="unethical" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> AI writing your homework for you</div>
        </div>
        <div style="display:flex;gap:16px;flex-wrap:wrap">
          <div class="drag-zone" data-accept="ethical" style="flex:1;min-width:200px;min-height:100px;border:2px dashed #10b981;border-radius:12px;padding:16px;text-align:center">
            <div style="color:#10b981;font-weight:bold"> Ethical (Fair!)</div>
          </div>
          <div class="drag-zone" data-accept="unethical" style="flex:1;min-width:200px;min-height:100px;border:2px dashed #ef4444;border-radius:12px;padding:16px;text-align:center">
            <div style="color:#ef4444;font-weight:bold"> Unethical (Unfair!)</div>
          </div>
        </div>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#8b5cf6;margin-top:0"> Quiz Time!</h2>
        <p style="font-size:1.05rem;margin-bottom:16px">Why is it important that AI training data includes DIVERSE people?</p>
        <div id="quiz7" style="display:flex;flex-direction:column;gap:10px">
          <button onclick="document.querySelectorAll('#quiz7 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #ef4444';showFeedback(document.getElementById('quiz7'),'wrong','More data helps, but diversity is the key reason! ')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">A) More data makes AI faster</button>
          <button onclick="document.querySelectorAll('#quiz7 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #10b981';showFeedback(document.getElementById('quiz7'),'correct',' Exactly! Diverse data = fair AI that works for EVERYONE! ');window.addPoints(25)" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">B) So AI treats everyone fairly and works for all people </button>
          <button onclick="document.querySelectorAll('#quiz7 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #ef4444';showFeedback(document.getElementById('quiz7'),'wrong','Photos help but that\\'s not the main reason! ')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">C) Because AI needs pretty pictures</button>
          <button onclick="document.querySelectorAll('#quiz7 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #ef4444';showFeedback(document.getElementById('quiz7'),'wrong','It\\'s about fairness, not rules! ')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">D) It's a law that companies have to</button>
        </div>
      </div>

      <div style="background:linear-gradient(135deg,rgba(6,182,212,0.1),rgba(139,92,246,0.1));border:1px solid rgba(6,182,212,0.2);border-radius:16px;padding:24px;margin-bottom:20px;text-align:center">
        <h2 style="margin-top:0"> Key Takeaway</h2>
        <p style="font-size:1.15rem;line-height:1.7">AI must be <strong style="color:#06b6d4">fair</strong>, <strong style="color:#8b5cf6">private</strong>, <strong style="color:#10b981">transparent</strong>, and <strong style="color:#fb923c">accountable</strong>. YOU can help make AI better by speaking up when something isn't fair! </p>
      </div>

      <button onclick="window.completeChapter('ai', 6)" style="width:100%;padding:16px;background:linear-gradient(135deg,#06b6d4,#8b5cf6);border:none;border-radius:12px;color:white;font-size:1.1rem;font-weight:bold;cursor:pointer;margin-top:12px"> Complete Chapter 7!</button>
    `,typeof ce=="function"&&ce(r.querySelector("#drag-container-7")?.parentElement)},function(r){r.innerHTML=`
      <img src="./infographics/ai-ch8.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="Be the AI Boss infographic">
      
      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.2rem;margin:0"> Be the AI Boss!</h1>
        <p style="color:#94a3b8;font-size:1.1rem;margin-top:8px">YOU are in charge. AI works for YOU. Let's master it! </p>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#06b6d4;margin-top:0"> Your AI Superpowers!</h2>
        <p style="font-size:1.05rem;line-height:1.7">You've learned SO much! Here's what you can now do with AI:</p>
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px;margin-top:16px">
          <div style="background:linear-gradient(135deg,rgba(6,182,212,0.15),rgba(6,182,212,0.05));border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:2.2rem"></div>
            <div style="font-weight:bold;color:#06b6d4;margin-top:8px">Create Amazing Art</div>
            <div style="font-size:0.85rem;color:#94a3b8;margin-top:4px">Design, draw, and imagine with AI</div>
          </div>
          <div style="background:linear-gradient(135deg,rgba(139,92,246,0.15),rgba(139,92,246,0.05));border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:2.2rem"></div>
            <div style="font-weight:bold;color:#8b5cf6;margin-top:8px">Write Epic Stories</div>
            <div style="font-size:0.85rem;color:#94a3b8;margin-top:4px">Brainstorm and create with AI help</div>
          </div>
          <div style="background:linear-gradient(135deg,rgba(16,185,129,0.15),rgba(16,185,129,0.05));border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:2.2rem"></div>
            <div style="font-weight:bold;color:#10b981;margin-top:8px">Learn Faster</div>
            <div style="font-size:0.85rem;color:#94a3b8;margin-top:4px">Use AI as your study buddy</div>
          </div>
          <div style="background:linear-gradient(135deg,rgba(251,146,60,0.15),rgba(251,146,60,0.05));border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:2.2rem"></div>
            <div style="font-weight:bold;color:#fb923c;margin-top:8px">Solve Problems</div>
            <div style="font-size:0.85rem;color:#94a3b8;margin-top:4px">Break down big challenges with AI</div>
          </div>
        </div>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#8b5cf6;margin-top:0"> The AI Boss Checklist</h2>
        <div style="display:grid;gap:10px;margin-top:16px">
          <div style="display:flex;align-items:center;gap:12px;background:rgba(16,185,129,0.08);border-radius:12px;padding:14px">
            <div style="font-size:1.3rem"></div>
            <div>I know what AI is and how it learns</div>
          </div>
          <div style="display:flex;align-items:center;gap:12px;background:rgba(16,185,129,0.08);border-radius:12px;padding:14px">
            <div style="font-size:1.3rem"></div>
            <div>I know AI is smart but not wise  I bring the wisdom!</div>
          </div>
          <div style="display:flex;align-items:center;gap:12px;background:rgba(16,185,129,0.08);border-radius:12px;padding:14px">
            <div style="font-size:1.3rem"></div>
            <div>I can spot AI in my daily life</div>
          </div>
          <div style="display:flex;align-items:center;gap:12px;background:rgba(16,185,129,0.08);border-radius:12px;padding:14px">
            <div style="font-size:1.3rem"></div>
            <div>I use SPARK to write amazing prompts</div>
          </div>
          <div style="display:flex;align-items:center;gap:12px;background:rgba(16,185,129,0.08);border-radius:12px;padding:14px">
            <div style="font-size:1.3rem"></div>
            <div>I use FACT to verify AI's answers</div>
          </div>
          <div style="display:flex;align-items:center;gap:12px;background:rgba(16,185,129,0.08);border-radius:12px;padding:14px">
            <div style="font-size:1.3rem"></div>
            <div>I care about fairness and ethics in AI</div>
          </div>
          <div style="display:flex;align-items:center;gap:12px;background:rgba(16,185,129,0.08);border-radius:12px;padding:14px">
            <div style="font-size:1.3rem"></div>
            <div>I AM the AI Boss! </div>
          </div>
        </div>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#06b6d4;margin-top:0"> Final Drag & Drop: Build Your AI Rules!</h2>
        <p>Every AI Boss needs rules! Match each rule to why it matters.</p>
        <div id="drag-container-8" style="display:flex;flex-wrap:wrap;gap:10px;margin:16px 0">
          <div class="drag-item" data-id="1" data-value="verify" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> Always fact-check AI</div>
          <div class="drag-item" data-id="2" data-value="kind" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> Use AI to help, not hurt</div>
          <div class="drag-item" data-id="3" data-value="learn" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> Use AI to learn, not cheat</div>
          <div class="drag-item" data-id="4" data-value="private" style="background:linear-gradient(135deg,#1e1b4b,#312e81);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> Keep personal info private</div>
        </div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
          <div class="drag-zone" data-accept="verify" style="min-height:80px;border:2px dashed #06b6d4;border-radius:12px;padding:12px;text-align:center">
            <div style="color:#06b6d4;font-weight:bold;font-size:0.9rem"> Because AI makes mistakes</div>
          </div>
          <div class="drag-zone" data-accept="kind" style="min-height:80px;border:2px dashed #8b5cf6;border-radius:12px;padding:12px;text-align:center">
            <div style="color:#8b5cf6;font-weight:bold;font-size:0.9rem"> Because tech should help everyone</div>
          </div>
          <div class="drag-zone" data-accept="learn" style="min-height:80px;border:2px dashed #10b981;border-radius:12px;padding:12px;text-align:center">
            <div style="color:#10b981;font-weight:bold;font-size:0.9rem"> Because YOUR brain needs exercise too</div>
          </div>
          <div class="drag-zone" data-accept="private" style="min-height:80px;border:2px dashed #fb923c;border-radius:12px;padding:12px;text-align:center">
            <div style="color:#fb923c;font-weight:bold;font-size:0.9rem"> Because your data is valuable</div>
          </div>
        </div>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#8b5cf6;margin-top:0"> Final Quiz!</h2>
        <p style="font-size:1.05rem;margin-bottom:16px">What's the MOST important thing about using AI?</p>
        <div id="quiz8" style="display:flex;flex-direction:column;gap:10px">
          <button onclick="document.querySelectorAll('#quiz8 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #ef4444';showFeedback(document.getElementById('quiz8'),'wrong','AI is great but not the MOST important thing! ')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">A) Using it for everything possible</button>
          <button onclick="document.querySelectorAll('#quiz8 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #ef4444';showFeedback(document.getElementById('quiz8'),'wrong','Keeping up is cool but not the key! ')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">B) Knowing every new AI tool</button>
          <button onclick="document.querySelectorAll('#quiz8 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #10b981';showFeedback(document.getElementById('quiz8'),'correct',' YES! YOU are the boss! Use AI wisely, ethically, and creatively. You\\'re an AI Boss now! ');window.addPoints(25)" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">C) YOU stay in control  using AI wisely, ethically & creatively </button>
          <button onclick="document.querySelectorAll('#quiz8 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #ef4444';showFeedback(document.getElementById('quiz8'),'wrong','Keeping secrets isn\\'t the goal! ')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">D) Never telling anyone you use AI</button>
        </div>
      </div>

      <div style="background:linear-gradient(135deg,rgba(6,182,212,0.15),rgba(139,92,246,0.15));border:1px solid rgba(6,182,212,0.3);border-radius:16px;padding:32px;margin-bottom:20px;text-align:center">
        <div style="font-size:3rem;margin-bottom:12px"></div>
        <h2 style="margin-top:0;font-size:1.5rem">Congratulations, AI Boss!</h2>
        <p style="font-size:1.15rem;line-height:1.7">You've completed the entire <strong style="color:#06b6d4">AI Adventures</strong> course! You now understand AI better than most adults. Go out there and use your knowledge to <strong style="color:#8b5cf6">create</strong>, <strong style="color:#10b981">learn</strong>, and <strong style="color:#fb923c">make the world better</strong>!</p>
      </div>

      <button onclick="window.completeChapter('ai', 7)" style="width:100%;padding:18px;background:linear-gradient(135deg,#06b6d4,#8b5cf6,#ec4899);border:none;border-radius:12px;color:white;font-size:1.2rem;font-weight:bold;cursor:pointer;margin-top:12px;animation:pulse 2s infinite"> Complete AI Adventures! </button>
      <style>@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.02)}}</style>
    `,typeof ce=="function"&&ce(r.querySelector("#drag-container-8")?.parentElement)}],space:[function(r){r.innerHTML=`
      <img src="./infographics/space-ch1.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="Our Solar System Infographic">

      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.4rem;margin:0;background:linear-gradient(135deg,#f97316,#8b5cf6);-webkit-background-clip:text;-webkit-text-fill-color:transparent"> Our Solar System</h1>
        <p style="color:#94a3b8;font-size:1.1rem;margin-top:8px">Welcome to the cosmic neighbourhood!</p>
      </div>

      <!-- Intro Card -->
      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> Meet Our Star  The Sun!</h2>
        <p style="color:#e2e8f0;font-size:1.05rem;line-height:1.7">
          Imagine a ball of fire SO big that <strong>1.3 million Earths</strong> could fit inside it! 
          That's our Sun  the superstar at the center of our Solar System. Everything orbits around it,
          held in place by its powerful gravity (like an invisible leash!).
        </p>
        <div style="display:flex;gap:16px;flex-wrap:wrap;margin-top:16px">
          <div style="flex:1;min-width:200px;background:rgba(249,115,22,0.1);border:1px solid rgba(249,115,22,0.2);border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:2rem"></div>
            <div style="color:#f97316;font-weight:bold;font-size:1.2rem">5,500C</div>
            <div style="color:#94a3b8;font-size:0.85rem">Surface Temperature</div>
          </div>
          <div style="flex:1;min-width:200px;background:rgba(139,92,246,0.1);border:1px solid rgba(139,92,246,0.2);border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:2rem"></div>
            <div style="color:#8b5cf6;font-weight:bold;font-size:1.2rem">4.6 Billion</div>
            <div style="color:#94a3b8;font-size:0.85rem">Years Old</div>
          </div>
          <div style="flex:1;min-width:200px;background:rgba(249,115,22,0.1);border:1px solid rgba(249,115,22,0.2);border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:2rem"></div>
            <div style="color:#f97316;font-weight:bold;font-size:1.2rem">8 min 20 sec</div>
            <div style="color:#94a3b8;font-size:0.85rem">Light Travel to Earth</div>
          </div>
        </div>
      </div>

      <!-- Planet Cards -->
      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#8b5cf6;margin-top:0"> The Planet Lineup</h2>
        <p style="color:#cbd5e1;margin-bottom:16px">From closest to farthest from the Sun:</p>
        <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:12px">
          ${[{emoji:"",name:"Mercury",fact:"Smallest planet! A year is only 88 Earth days",color:"#a1a1aa"},{emoji:"",name:"Venus",fact:"Hottest planet at 465C! Spins backwards!",color:"#eab308"},{emoji:"",name:"Earth",fact:"Our home! Only planet with liquid water oceans",color:"#3b82f6"},{emoji:"",name:"Mars",fact:"The Red Planet! Has the tallest volcano in the solar system",color:"#ef4444"},{emoji:"",name:"Jupiter",fact:"King of planets! Has 95 moons & a giant storm",color:"#f97316"},{emoji:"",name:"Saturn",fact:"Famous for its beautiful rings made of ice & rock",color:"#eab308"},{emoji:"",name:"Uranus",fact:"Rolls on its side like a bowling ball!",color:"#06b6d4"},{emoji:"",name:"Neptune",fact:"Windiest planet! Winds reach 2,100 km/h",color:"#6366f1"}].map(a=>`
            <div style="background:rgba(255,255,255,0.04);border:1px solid ${a.color}33;border-radius:12px;padding:14px">
              <div style="font-size:1.6rem">${a.emoji}</div>
              <div style="color:${a.color};font-weight:bold;font-size:1.05rem">${a.name}</div>
              <div style="color:#94a3b8;font-size:0.85rem;margin-top:4px">${a.fact}</div>
            </div>
          `).join("")}
        </div>
      </div>

      <!-- Rocky vs Gas Giants - Drag Activity -->
      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px" id="drag-activity-1">
        <h2 style="color:#f97316;margin-top:0"> Sort the Planets!</h2>
        <p style="color:#cbd5e1;margin-bottom:16px">Drag each planet to the correct group  <strong>Rocky</strong> or <strong>Gas Giant</strong>?</p>

        <div style="display:flex;flex-wrap:wrap;gap:10px;margin-bottom:20px;justify-content:center" id="planet-source">
          <div class="drag-item" draggable="true" data-id="mercury" data-value="rocky" style="background:linear-gradient(135deg,#a1a1aa33,#a1a1aa11);border:1px solid #a1a1aa44;border-radius:12px;padding:10px 18px;cursor:grab;font-size:1rem;color:#e2e8f0"> Mercury</div>
          <div class="drag-item" draggable="true" data-id="jupiter" data-value="gas" style="background:linear-gradient(135deg,#f9731633,#f9731611);border:1px solid #f9731644;border-radius:12px;padding:10px 18px;cursor:grab;font-size:1rem;color:#e2e8f0"> Jupiter</div>
          <div class="drag-item" draggable="true" data-id="venus" data-value="rocky" style="background:linear-gradient(135deg,#eab30833,#eab30811);border:1px solid #eab30844;border-radius:12px;padding:10px 18px;cursor:grab;font-size:1rem;color:#e2e8f0"> Venus</div>
          <div class="drag-item" draggable="true" data-id="saturn" data-value="gas" style="background:linear-gradient(135deg,#eab30833,#eab30811);border:1px solid #eab30844;border-radius:12px;padding:10px 18px;cursor:grab;font-size:1rem;color:#e2e8f0"> Saturn</div>
          <div class="drag-item" draggable="true" data-id="earth" data-value="rocky" style="background:linear-gradient(135deg,#3b82f633,#3b82f611);border:1px solid #3b82f644;border-radius:12px;padding:10px 18px;cursor:grab;font-size:1rem;color:#e2e8f0"> Earth</div>
          <div class="drag-item" draggable="true" data-id="neptune" data-value="gas" style="background:linear-gradient(135deg,#6366f133,#6366f111);border:1px solid #6366f144;border-radius:12px;padding:10px 18px;cursor:grab;font-size:1rem;color:#e2e8f0"> Neptune</div>
          <div class="drag-item" draggable="true" data-id="mars" data-value="rocky" style="background:linear-gradient(135deg,#ef444433,#ef444411);border:1px solid #ef444444;border-radius:12px;padding:10px 18px;cursor:grab;font-size:1rem;color:#e2e8f0"> Mars</div>
          <div class="drag-item" draggable="true" data-id="uranus" data-value="gas" style="background:linear-gradient(135deg,#06b6d433,#06b6d411);border:1px solid #06b6d444;border-radius:12px;padding:10px 18px;cursor:grab;font-size:1rem;color:#e2e8f0"> Uranus</div>
        </div>

        <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px">
          <div class="drag-zone" data-accept="rocky" style="border:2px dashed rgba(249,115,22,0.4);border-radius:16px;padding:20px;min-height:120px;text-align:center">
            <div style="color:#f97316;font-weight:bold;font-size:1.1rem;margin-bottom:8px"> Rocky Planets</div>
            <div style="color:#64748b;font-size:0.85rem">Drop rocky planets here</div>
          </div>
          <div class="drag-zone" data-accept="gas" style="border:2px dashed rgba(139,92,246,0.4);border-radius:16px;padding:20px;min-height:120px;text-align:center">
            <div style="color:#8b5cf6;font-weight:bold;font-size:1.1rem;margin-bottom:8px"> Gas Giants</div>
            <div style="color:#64748b;font-size:0.85rem">Drop gas giants here</div>
          </div>
        </div>
      </div>

      <!-- Quiz -->
      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px" id="quiz-ch1">
        <h2 style="color:#8b5cf6;margin-top:0"> Quick Quiz!</h2>
        <p style="color:#e2e8f0;font-size:1.05rem;margin-bottom:16px"><strong>Which planet is the hottest in our Solar System?</strong></p>
        <div style="display:grid;gap:10px" id="quiz-options-1">
          <button onclick="checkQuiz1(this,'wrong')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px;color:#e2e8f0;font-size:1rem;cursor:pointer;text-align:left;transition:all 0.3s">A) Mercury  it's closest to the Sun!</button>
          <button onclick="checkQuiz1(this,'correct')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px;color:#e2e8f0;font-size:1rem;cursor:pointer;text-align:left;transition:all 0.3s">B) Venus  its thick atmosphere traps heat!</button>
          <button onclick="checkQuiz1(this,'wrong')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px;color:#e2e8f0;font-size:1rem;cursor:pointer;text-align:left;transition:all 0.3s">C) Jupiter  it's the biggest!</button>
          <button onclick="checkQuiz1(this,'wrong')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px;color:#e2e8f0;font-size:1rem;cursor:pointer;text-align:left;transition:all 0.3s">D) Mars  it's called the Red Planet!</button>
        </div>
      </div>

      <!-- Fun Fact -->
      <div style="background:linear-gradient(135deg,rgba(249,115,22,0.1),rgba(139,92,246,0.1));border:1px solid rgba(249,115,22,0.2);border-radius:16px;padding:24px;margin-bottom:20px;text-align:center">
        <div style="font-size:2.5rem;margin-bottom:8px"></div>
        <p style="color:#f97316;font-weight:bold;font-size:1.1rem;margin:0">Mind-Blowing Fact</p>
        <p style="color:#e2e8f0;font-size:1rem;margin-top:8px">If you could drive a car at highway speed (100 km/h) to the Sun, it would take you <strong style="color:#8b5cf6">171 YEARS</strong> to get there! </p>
      </div>

      <div style="text-align:center;margin-top:24px">
        <button onclick="window.addPoints(25);window.completeChapter('space',0)" style="background:linear-gradient(135deg,#f97316,#8b5cf6);border:none;border-radius:14px;padding:16px 40px;color:white;font-size:1.15rem;font-weight:bold;cursor:pointer;transition:transform 0.2s" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
           Complete Chapter 1!
        </button>
      </div>
    `,window.checkQuiz1=function(a,o){const l=document.getElementById("quiz-ch1");document.getElementById("quiz-options-1").querySelectorAll("button").forEach(c=>c.disabled=!0),o==="correct"?(a.style.background="rgba(34,197,94,0.2)",a.style.borderColor="#22c55e",De(l,"correct"," Correct! Venus is hotter than Mercury because its thick CO atmosphere traps heat like a blanket!"),window.addPoints(25)):(a.style.background="rgba(239,68,68,0.2)",a.style.borderColor="#ef4444",De(l,"wrong"," Not quite! Venus is the hottest  its thick atmosphere traps heat like a greenhouse!"))},typeof ce=="function"&&ce()},function(r){r.innerHTML=`
      <img src="./infographics/space-ch2.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="Life of a Star Infographic">

      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.4rem;margin:0;background:linear-gradient(135deg,#f97316,#8b5cf6);-webkit-background-clip:text;-webkit-text-fill-color:transparent"> Life of a Star</h1>
        <p style="color:#94a3b8;font-size:1.1rem;margin-top:8px">Stars are born, they live, and they die  just like everything else!</p>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> Step 1: The Cosmic Nursery</h2>
        <p style="color:#e2e8f0;font-size:1.05rem;line-height:1.7">
          Stars are born inside giant clouds of gas and dust called <strong style="color:#8b5cf6">nebulae</strong> (neb-you-lee).
          Think of a nebula as a <em>star nursery</em>   it's where baby stars grow!
        </p>
        <p style="color:#cbd5e1;font-size:1rem;line-height:1.7">
          Gravity pulls the gas together tighter and tighter until it gets SO hot in the center
          that <strong style="color:#f97316">nuclear fusion</strong> starts  atoms smash together and release
          ENORMOUS energy.  That's the moment a star is born!
        </p>
      </div>

      <!-- Star lifecycle timeline -->
      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#8b5cf6;margin-top:0"> The Star Lifecycle</h2>
        <div style="display:flex;flex-direction:column;gap:12px">
          ${[{emoji:"",stage:"Nebula",desc:"A huge cloud of gas & dust  the star's birthplace",color:"#a78bfa"},{emoji:"",stage:"Protostar",desc:"Gravity squeezes gas into a hot ball  a baby star forming!",color:"#f59e0b"},{emoji:"",stage:"Main Sequence",desc:"The star shines steadily for millions or billions of years (our Sun is here!)",color:"#fbbf24"},{emoji:"",stage:"Red Giant",desc:"The star swells up HUGE  it could swallow planets!",color:"#ef4444"},{emoji:"",stage:"Supernova (Big stars only!)",desc:"BOOM! The biggest explosion in the universe!",color:"#f97316"},{emoji:"",stage:"Black Hole or Neutron Star",desc:"What remains: an ultra-dense core, or a gravity monster!",color:"#6366f1"}].map((a,o)=>`
            <div style="display:flex;align-items:center;gap:16px;background:rgba(255,255,255,0.03);border-left:3px solid ${a.color};border-radius:0 12px 12px 0;padding:14px 18px">
              <div style="font-size:2rem;min-width:40px;text-align:center">${a.emoji}</div>
              <div>
                <div style="color:${a.color};font-weight:bold;font-size:1.05rem">${o+1}. ${a.stage}</div>
                <div style="color:#94a3b8;font-size:0.9rem">${a.desc}</div>
              </div>
            </div>
          `).join("")}
        </div>
      </div>

      <!-- Size Comparison -->
      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> Star Sizes are INSANE!</h2>
        <p style="color:#e2e8f0;line-height:1.7">If our Sun were a basketball , then:</p>
        <div style="display:flex;align-items:flex-end;gap:12px;padding:20px 0;justify-content:center;flex-wrap:wrap">
          <div style="text-align:center">
            <div style="width:8px;height:8px;background:#3b82f6;border-radius:50%;margin:0 auto"></div>
            <div style="color:#94a3b8;font-size:0.75rem;margin-top:6px">Earth<br>(a pea )</div>
          </div>
          <div style="text-align:center">
            <div style="width:40px;height:40px;background:linear-gradient(135deg,#fbbf24,#f97316);border-radius:50%;margin:0 auto"></div>
            <div style="color:#94a3b8;font-size:0.75rem;margin-top:6px">Sun<br>(basketball )</div>
          </div>
          <div style="text-align:center">
            <div style="width:100px;height:100px;background:linear-gradient(135deg,#ef4444,#991b1b);border-radius:50%;margin:0 auto"></div>
            <div style="color:#94a3b8;font-size:0.75rem;margin-top:6px">Red Giant<br>(a room! )</div>
          </div>
        </div>
        <p style="color:#8b5cf6;text-align:center;font-weight:bold">The biggest stars (UY Scuti) would fill your entire city! </p>
      </div>

      <!-- Drag Activity: Star Lifecycle Order -->
      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px" id="drag-activity-2">
        <h2 style="color:#f97316;margin-top:0"> Put the Star Lifecycle in Order!</h2>
        <p style="color:#cbd5e1;margin-bottom:16px">Drag each stage to the correct position (1st through 4th):</p>

        <div style="display:flex;flex-wrap:wrap;gap:10px;margin-bottom:20px;justify-content:center">
          <div class="drag-item" draggable="true" data-id="rg" data-value="stage3" style="background:linear-gradient(135deg,#ef444433,#ef444411);border:1px solid #ef444444;border-radius:12px;padding:10px 18px;cursor:grab;color:#e2e8f0"> Red Giant</div>
          <div class="drag-item" draggable="true" data-id="neb" data-value="stage1" style="background:linear-gradient(135deg,#a78bfa33,#a78bfa11);border:1px solid #a78bfa44;border-radius:12px;padding:10px 18px;cursor:grab;color:#e2e8f0"> Nebula</div>
          <div class="drag-item" draggable="true" data-id="sn" data-value="stage4" style="background:linear-gradient(135deg,#f9731633,#f9731611);border:1px solid #f9731644;border-radius:12px;padding:10px 18px;cursor:grab;color:#e2e8f0"> Supernova</div>
          <div class="drag-item" draggable="true" data-id="ms" data-value="stage2" style="background:linear-gradient(135deg,#fbbf2433,#fbbf2411);border:1px solid #fbbf2444;border-radius:12px;padding:10px 18px;cursor:grab;color:#e2e8f0"> Main Sequence</div>
        </div>

        <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:12px">
          <div class="drag-zone" data-accept="stage1" style="border:2px dashed rgba(139,92,246,0.4);border-radius:14px;padding:16px;min-height:80px;text-align:center">
            <div style="color:#8b5cf6;font-weight:bold">1st</div>
            <div style="color:#64748b;font-size:0.8rem">Birth</div>
          </div>
          <div class="drag-zone" data-accept="stage2" style="border:2px dashed rgba(249,115,22,0.4);border-radius:14px;padding:16px;min-height:80px;text-align:center">
            <div style="color:#f97316;font-weight:bold">2nd</div>
            <div style="color:#64748b;font-size:0.8rem">Shining</div>
          </div>
          <div class="drag-zone" data-accept="stage3" style="border:2px dashed rgba(239,68,68,0.4);border-radius:14px;padding:16px;min-height:80px;text-align:center">
            <div style="color:#ef4444;font-weight:bold">3rd</div>
            <div style="color:#64748b;font-size:0.8rem">Expanding</div>
          </div>
          <div class="drag-zone" data-accept="stage4" style="border:2px dashed rgba(249,115,22,0.4);border-radius:14px;padding:16px;min-height:80px;text-align:center">
            <div style="color:#f97316;font-weight:bold">4th</div>
            <div style="color:#64748b;font-size:0.8rem">Explosion</div>
          </div>
        </div>
      </div>

      <!-- Quiz -->
      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px" id="quiz-ch2">
        <h2 style="color:#8b5cf6;margin-top:0"> Quick Quiz!</h2>
        <p style="color:#e2e8f0;font-size:1.05rem;margin-bottom:16px"><strong>What powers a star and makes it shine?</strong></p>
        <div style="display:grid;gap:10px" id="quiz-options-2">
          <button onclick="checkQuiz2(this,'wrong')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px;color:#e2e8f0;font-size:1rem;cursor:pointer;text-align:left">A) Fire  like a giant campfire!</button>
          <button onclick="checkQuiz2(this,'wrong')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px;color:#e2e8f0;font-size:1rem;cursor:pointer;text-align:left">B) Electricity from space</button>
          <button onclick="checkQuiz2(this,'correct')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px;color:#e2e8f0;font-size:1rem;cursor:pointer;text-align:left">C) Nuclear fusion  atoms smashing together!</button>
          <button onclick="checkQuiz2(this,'wrong')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px;color:#e2e8f0;font-size:1rem;cursor:pointer;text-align:left">D) Batteries from aliens </button>
        </div>
      </div>

      <div style="background:linear-gradient(135deg,rgba(249,115,22,0.1),rgba(139,92,246,0.1));border:1px solid rgba(249,115,22,0.2);border-radius:16px;padding:24px;margin-bottom:20px;text-align:center">
        <div style="font-size:2.5rem;margin-bottom:8px"></div>
        <p style="color:#f97316;font-weight:bold;font-size:1.1rem;margin:0">You Are Made of Stars!</p>
        <p style="color:#e2e8f0;font-size:1rem;margin-top:8px">Every atom in your body was forged inside a star that exploded billions of years ago. You are literally <strong style="color:#8b5cf6">stardust</strong>! </p>
      </div>

      <div style="text-align:center;margin-top:24px">
        <button onclick="window.addPoints(25);window.completeChapter('space',1)" style="background:linear-gradient(135deg,#f97316,#8b5cf6);border:none;border-radius:14px;padding:16px 40px;color:white;font-size:1.15rem;font-weight:bold;cursor:pointer;transition:transform 0.2s" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
           Complete Chapter 2!
        </button>
      </div>
    `,window.checkQuiz2=function(a,o){const l=document.getElementById("quiz-ch2");document.getElementById("quiz-options-2").querySelectorAll("button").forEach(p=>p.disabled=!0),o==="correct"?(a.style.background="rgba(34,197,94,0.2)",a.style.borderColor="#22c55e",De(l,"correct"," Yes! Nuclear fusion is when hydrogen atoms smash together to make helium  releasing incredible energy!"),window.addPoints(25)):(a.style.background="rgba(239,68,68,0.2)",a.style.borderColor="#ef4444",De(l,"wrong"," Nope! Stars are powered by nuclear fusion  atoms smashing together deep inside the star's core!"))},typeof ce=="function"&&ce()},function(r){r.innerHTML=`
      <img src="./infographics/space-ch3.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="Rockets Infographic">

      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.4rem;margin:0;background:linear-gradient(135deg,#f97316,#8b5cf6);-webkit-background-clip:text;-webkit-text-fill-color:transparent"> Rockets & Launch Science</h1>
        <p style="color:#94a3b8;font-size:1.1rem;margin-top:8px">3... 2... 1... LIFTOFF! How do rockets actually work?</p>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> Newton's Third Law  The Balloon Trick!</h2>
        <p style="color:#e2e8f0;font-size:1.05rem;line-height:1.7">
          Ever blown up a balloon and let it go?  It flies around the room! That's EXACTLY how rockets work!
        </p>
        <p style="color:#cbd5e1;line-height:1.7">
          <strong style="color:#8b5cf6">Newton's Third Law:</strong> For every action, there is an equal and opposite reaction.
        </p>
        <div style="display:flex;gap:16px;flex-wrap:wrap;margin-top:16px">
          <div style="flex:1;min-width:200px;background:rgba(249,115,22,0.1);border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:2rem"></div>
            <div style="color:#f97316;font-weight:bold">ACTION</div>
            <div style="color:#94a3b8;font-size:0.9rem">Hot gas shoots DOWN</div>
          </div>
          <div style="flex:1;min-width:50px;display:flex;align-items:center;justify-content:center">
            <span style="color:#f97316;font-size:2rem">=</span>
          </div>
          <div style="flex:1;min-width:200px;background:rgba(139,92,246,0.1);border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:2rem"></div>
            <div style="color:#8b5cf6;font-weight:bold">REACTION</div>
            <div style="color:#94a3b8;font-size:0.9rem">Rocket pushes UP</div>
          </div>
        </div>
      </div>

      <!-- Rocket Anatomy -->
      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#8b5cf6;margin-top:0"> Inside a Rocket</h2>
        <div style="display:flex;gap:20px;flex-wrap:wrap">
          <div style="flex:1;min-width:180px">
            ${[{emoji:"",part:"Nose Cone",desc:"Pointy top  cuts through the air like a knife",color:"#ef4444"},{emoji:"",part:"Payload",desc:"The cargo! Astronauts, satellites, or rovers",color:"#3b82f6"},{emoji:"",part:"Fuel Tanks",desc:"Holds liquid hydrogen & liquid oxygen",color:"#eab308"},{emoji:"",part:"Engines",desc:"Where the magic happens  burning fuel for thrust",color:"#f97316"},{emoji:"",part:"Boosters",desc:"Extra rockets for the heavy lifting at launch",color:"#8b5cf6"}].map(a=>`
              <div style="display:flex;gap:12px;align-items:center;margin-bottom:12px;background:rgba(255,255,255,0.03);border-left:3px solid ${a.color};padding:10px 14px;border-radius:0 10px 10px 0">
                <span style="font-size:1.4rem">${a.emoji}</span>
                <div>
                  <div style="color:${a.color};font-weight:bold;font-size:0.95rem">${a.part}</div>
                  <div style="color:#94a3b8;font-size:0.8rem">${a.desc}</div>
                </div>
              </div>
            `).join("")}
          </div>
        </div>
      </div>

      <!-- Speed Stats -->
      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> Escape Velocity</h2>
        <p style="color:#e2e8f0;line-height:1.7">To escape Earth's gravity, a rocket needs to reach <strong style="color:#8b5cf6">40,270 km/h</strong> (11.2 km per second)!</p>
        <div style="display:flex;gap:12px;flex-wrap:wrap;margin-top:16px">
          <div style="flex:1;min-width:150px;background:rgba(255,255,255,0.04);border-radius:12px;padding:16px;text-align:center">
            <div style="color:#94a3b8;font-size:0.85rem"> Car</div>
            <div style="color:#e2e8f0;font-weight:bold;font-size:1.3rem">120 km/h</div>
          </div>
          <div style="flex:1;min-width:150px;background:rgba(255,255,255,0.04);border-radius:12px;padding:16px;text-align:center">
            <div style="color:#94a3b8;font-size:0.85rem"> Airplane</div>
            <div style="color:#e2e8f0;font-weight:bold;font-size:1.3rem">900 km/h</div>
          </div>
          <div style="flex:1;min-width:150px;background:linear-gradient(135deg,rgba(249,115,22,0.15),rgba(139,92,246,0.15));border:1px solid rgba(249,115,22,0.3);border-radius:12px;padding:16px;text-align:center">
            <div style="color:#f97316;font-size:0.85rem"> ROCKET</div>
            <div style="color:#f97316;font-weight:bold;font-size:1.3rem">40,270 km/h</div>
          </div>
        </div>
        <p style="color:#8b5cf6;text-align:center;margin-top:12px;font-weight:bold">That's 335x faster than a car! </p>
      </div>

      <!-- Drag: Build a Rocket -->
      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px" id="drag-activity-3">
        <h2 style="color:#8b5cf6;margin-top:0"> Build a Rocket!</h2>
        <p style="color:#cbd5e1;margin-bottom:16px">Drag each part to its correct position (top to bottom):</p>

        <div style="display:flex;flex-wrap:wrap;gap:10px;margin-bottom:20px;justify-content:center">
          <div class="drag-item" draggable="true" data-id="engines" data-value="pos4" style="background:linear-gradient(135deg,#f9731633,#f9731611);border:1px solid #f9731644;border-radius:12px;padding:10px 18px;cursor:grab;color:#e2e8f0"> Engines</div>
          <div class="drag-item" draggable="true" data-id="nose" data-value="pos1" style="background:linear-gradient(135deg,#ef444433,#ef444411);border:1px solid #ef444444;border-radius:12px;padding:10px 18px;cursor:grab;color:#e2e8f0"> Nose Cone</div>
          <div class="drag-item" draggable="true" data-id="fuel" data-value="pos3" style="background:linear-gradient(135deg,#eab30833,#eab30811);border:1px solid #eab30844;border-radius:12px;padding:10px 18px;cursor:grab;color:#e2e8f0"> Fuel Tanks</div>
          <div class="drag-item" draggable="true" data-id="payload" data-value="pos2" style="background:linear-gradient(135deg,#3b82f633,#3b82f611);border:1px solid #3b82f644;border-radius:12px;padding:10px 18px;cursor:grab;color:#e2e8f0"> Payload</div>
        </div>

        <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:12px">
          <div class="drag-zone" data-accept="pos1" style="border:2px dashed rgba(239,68,68,0.4);border-radius:14px;padding:16px;min-height:80px;text-align:center">
            <div style="color:#ef4444;font-weight:bold">TOP </div>
          </div>
          <div class="drag-zone" data-accept="pos2" style="border:2px dashed rgba(59,130,246,0.4);border-radius:14px;padding:16px;min-height:80px;text-align:center">
            <div style="color:#3b82f6;font-weight:bold">2nd</div>
          </div>
          <div class="drag-zone" data-accept="pos3" style="border:2px dashed rgba(234,179,8,0.4);border-radius:14px;padding:16px;min-height:80px;text-align:center">
            <div style="color:#eab308;font-weight:bold">3rd</div>
          </div>
          <div class="drag-zone" data-accept="pos4" style="border:2px dashed rgba(249,115,22,0.4);border-radius:14px;padding:16px;min-height:80px;text-align:center">
            <div style="color:#f97316;font-weight:bold">BOTTOM </div>
          </div>
        </div>
      </div>

      <!-- Quiz -->
      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px" id="quiz-ch3">
        <h2 style="color:#8b5cf6;margin-top:0"> Quick Quiz!</h2>
        <p style="color:#e2e8f0;font-size:1.05rem;margin-bottom:16px"><strong>What law of physics makes rockets work?</strong></p>
        <div style="display:grid;gap:10px" id="quiz-options-3">
          <button onclick="checkQuiz3(this,'wrong')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px;color:#e2e8f0;font-size:1rem;cursor:pointer;text-align:left">A) Murphy's Law  anything that can go wrong, will!</button>
          <button onclick="checkQuiz3(this,'correct')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px;color:#e2e8f0;font-size:1rem;cursor:pointer;text-align:left">B) Newton's Third Law  every action has an equal opposite reaction!</button>
          <button onclick="checkQuiz3(this,'wrong')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px;color:#e2e8f0;font-size:1rem;cursor:pointer;text-align:left">C) The Law of Gravity  what goes up must come down</button>
        </div>
      </div>

      <div style="text-align:center;margin-top:24px">
        <button onclick="window.addPoints(25);window.completeChapter('space',2)" style="background:linear-gradient(135deg,#f97316,#8b5cf6);border:none;border-radius:14px;padding:16px 40px;color:white;font-size:1.15rem;font-weight:bold;cursor:pointer;transition:transform 0.2s" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
           Complete Chapter 3!
        </button>
      </div>
    `,window.checkQuiz3=function(a,o){const l=document.getElementById("quiz-ch3");document.getElementById("quiz-options-3").querySelectorAll("button").forEach(p=>p.disabled=!0),o==="correct"?(a.style.background="rgba(34,197,94,0.2)",a.style.borderColor="#22c55e",De(l,"correct"," Correct! Gas goes down, rocket goes up  Newton's Third Law!"),window.addPoints(25)):(a.style.background="rgba(239,68,68,0.2)",a.style.borderColor="#ef4444",De(l,"wrong"," It's Newton's Third Law! Every action (gas shooting down) creates an equal and opposite reaction (rocket going up)!"))},typeof ce=="function"&&ce()},function(r){r.innerHTML=`
      <img src="./infographics/space-ch4.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="Mission to Mars Infographic">

      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.4rem;margin:0;background:linear-gradient(135deg,#f97316,#8b5cf6);-webkit-background-clip:text;-webkit-text-fill-color:transparent"> Mission to Mars</h1>
        <p style="color:#94a3b8;font-size:1.1rem;margin-top:8px">The Red Planet awaits  are you ready for the ultimate road trip?</p>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> Mars Fact File</h2>
        <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:12px">
          ${[{label:"Distance",value:"225 million km",emoji:""},{label:"Travel Time",value:"7-9 months",emoji:""},{label:"Gravity",value:"38% of Earth",emoji:""},{label:"Temperature",value:"-60C average",emoji:""},{label:"Day Length",value:"24h 37min",emoji:""},{label:"Moons",value:"2 (Phobos & Deimos)",emoji:""}].map(a=>`
            <div style="background:rgba(239,68,68,0.08);border:1px solid rgba(239,68,68,0.15);border-radius:12px;padding:14px;text-align:center">
              <div style="font-size:1.5rem">${a.emoji}</div>
              <div style="color:#ef4444;font-weight:bold;font-size:0.95rem">${a.label}</div>
              <div style="color:#e2e8f0;font-size:0.9rem">${a.value}</div>
            </div>
          `).join("")}
        </div>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#8b5cf6;margin-top:0"> Mars Rovers  Our Robot Explorers!</h2>
        <p style="color:#e2e8f0;line-height:1.7">Since we can't visit Mars yet, we've sent <strong style="color:#f97316">robot explorers</strong> called rovers!</p>
        <div style="display:flex;flex-direction:column;gap:12px;margin-top:16px">
          ${[{name:"Sojourner (1997)",desc:"First rover! Size of a microwave ",color:"#94a3b8"},{name:"Spirit & Opportunity (2004)",desc:"Twin rovers  Opportunity lasted 15 YEARS! ",color:"#3b82f6"},{name:"Curiosity (2012)",desc:"Car-sized! Found ancient river beds ",color:"#eab308"},{name:"Perseverance (2021)",desc:"Looking for signs of ancient life + has a helicopter! ",color:"#f97316"}].map(a=>`
            <div style="display:flex;gap:14px;align-items:center;background:rgba(255,255,255,0.03);border-left:3px solid ${a.color};padding:12px 16px;border-radius:0 12px 12px 0">
              <div style="color:${a.color};font-weight:bold;min-width:200px">${a.name}</div>
              <div style="color:#94a3b8;font-size:0.9rem">${a.desc}</div>
            </div>
          `).join("")}
        </div>
      </div>

      <!-- Challenges -->
      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> Challenges of Living on Mars</h2>
        <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:12px">
          ${[{problem:"No breathable air",solution:"Build greenhouse domes & produce oxygen from CO",emoji:""},{problem:"Freezing temperatures",solution:"Heated habitats & insulated spacesuits",emoji:""},{problem:"No liquid water on surface",solution:"Melt underground ice reserves",emoji:""},{problem:"Dangerous radiation",solution:"Underground shelters & radiation shields",emoji:""}].map(a=>`
            <div style="background:rgba(255,255,255,0.04);border-radius:12px;padding:16px">
              <div style="font-size:1.5rem;margin-bottom:6px">${a.emoji}</div>
              <div style="color:#ef4444;font-weight:bold;font-size:0.95rem">Problem: ${a.problem}</div>
              <div style="color:#22c55e;font-size:0.9rem;margin-top:4px"> Solution: ${a.solution}</div>
            </div>
          `).join("")}
        </div>
      </div>

      <!-- Drag: Pack for Mars -->
      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px" id="drag-activity-4">
        <h2 style="color:#8b5cf6;margin-top:0"> Pack for Mars!</h2>
        <p style="color:#cbd5e1;margin-bottom:16px">Drag the <strong>essential items</strong> to the spaceship and leave the <strong>useless stuff</strong> behind!</p>

        <div style="display:flex;flex-wrap:wrap;gap:10px;margin-bottom:20px;justify-content:center">
          <div class="drag-item" draggable="true" data-id="o2" data-value="essential" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:10px 18px;cursor:grab;color:#e2e8f0"> Oxygen Supply</div>
          <div class="drag-item" draggable="true" data-id="umbrella" data-value="useless" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:10px 18px;cursor:grab;color:#e2e8f0"> Umbrella</div>
          <div class="drag-item" draggable="true" data-id="water" data-value="essential" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:10px 18px;cursor:grab;color:#e2e8f0"> Water Recycler</div>
          <div class="drag-item" draggable="true" data-id="surfboard" data-value="useless" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:10px 18px;cursor:grab;color:#e2e8f0"> Surfboard</div>
          <div class="drag-item" draggable="true" data-id="food" data-value="essential" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:10px 18px;cursor:grab;color:#e2e8f0"> Food Supply</div>
          <div class="drag-item" draggable="true" data-id="suit" data-value="essential" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:10px 18px;cursor:grab;color:#e2e8f0"> Spacesuit</div>
        </div>

        <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px">
          <div class="drag-zone" data-accept="essential" style="border:2px dashed rgba(34,197,94,0.4);border-radius:16px;padding:20px;min-height:100px;text-align:center">
            <div style="color:#22c55e;font-weight:bold;font-size:1.1rem"> Pack It!</div>
            <div style="color:#64748b;font-size:0.8rem">Essential items</div>
          </div>
          <div class="drag-zone" data-accept="useless" style="border:2px dashed rgba(239,68,68,0.4);border-radius:16px;padding:20px;min-height:100px;text-align:center">
            <div style="color:#ef4444;font-weight:bold;font-size:1.1rem"> Leave Behind</div>
            <div style="color:#64748b;font-size:0.8rem">Useless on Mars</div>
          </div>
        </div>
      </div>

      <!-- Quiz -->
      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px" id="quiz-ch4">
        <h2 style="color:#8b5cf6;margin-top:0"> Quick Quiz!</h2>
        <p style="color:#e2e8f0;font-size:1.05rem;margin-bottom:16px"><strong>How long does it take to travel from Earth to Mars?</strong></p>
        <div style="display:grid;gap:10px" id="quiz-options-4">
          <button onclick="checkQuiz4(this,'wrong')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px;color:#e2e8f0;font-size:1rem;cursor:pointer;text-align:left">A) 3 days (like going to the Moon)</button>
          <button onclick="checkQuiz4(this,'correct')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px;color:#e2e8f0;font-size:1rem;cursor:pointer;text-align:left">B) 7-9 months</button>
          <button onclick="checkQuiz4(this,'wrong')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px;color:#e2e8f0;font-size:1rem;cursor:pointer;text-align:left">C) 5 years</button>
          <button onclick="checkQuiz4(this,'wrong')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px;color:#e2e8f0;font-size:1rem;cursor:pointer;text-align:left">D) 2 weeks</button>
        </div>
      </div>

      <div style="text-align:center;margin-top:24px">
        <button onclick="window.addPoints(25);window.completeChapter('space',3)" style="background:linear-gradient(135deg,#f97316,#8b5cf6);border:none;border-radius:14px;padding:16px 40px;color:white;font-size:1.15rem;font-weight:bold;cursor:pointer;transition:transform 0.2s" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
           Complete Chapter 4!
        </button>
      </div>
    `,window.checkQuiz4=function(a,o){const l=document.getElementById("quiz-ch4");document.getElementById("quiz-options-4").querySelectorAll("button").forEach(p=>p.disabled=!0),o==="correct"?(a.style.background="rgba(34,197,94,0.2)",a.style.borderColor="#22c55e",De(l,"correct"," Right! It takes about 7-9 months to reach Mars  that's a LONG road trip! "),window.addPoints(25)):(a.style.background="rgba(239,68,68,0.2)",a.style.borderColor="#ef4444",De(l,"wrong"," It takes 7-9 months! Mars is really far  about 225 million km away!"))},typeof ce=="function"&&ce()},function(r){r.innerHTML=`
      <img src="./infographics/space-ch5.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="Gravity & Orbits Infographic">

      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.4rem;margin:0;background:linear-gradient(135deg,#f97316,#8b5cf6);-webkit-background-clip:text;-webkit-text-fill-color:transparent"> Gravity & Orbits</h1>
        <p style="color:#94a3b8;font-size:1.1rem;margin-top:8px">The invisible force that holds the entire universe together!</p>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> What IS Gravity?</h2>
        <p style="color:#e2e8f0;font-size:1.05rem;line-height:1.7">
          Imagine placing a heavy bowling ball  on a trampoline. It makes a dip in the middle, right?
          Now roll a marble near it  the marble rolls toward the bowling ball!
        </p>
        <p style="color:#cbd5e1;line-height:1.7">
          That's basically how gravity works! Heavy objects (like the Sun ) create a "dip" in space,
          and smaller objects (like Earth ) roll around them. We call this rolling an <strong style="color:#8b5cf6">orbit</strong>!
        </p>
      </div>

      <!-- Weight on different planets -->
      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#8b5cf6;margin-top:0"> Your Weight in Space!</h2>
        <p style="color:#cbd5e1;margin-bottom:16px">If you weigh <strong style="color:#f97316">40 kg on Earth</strong>, here's what you'd weigh elsewhere:</p>
        <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:10px">
          ${[{place:"Moon ",weight:"6.6 kg",bar:16},{place:"Mars ",weight:"15.2 kg",bar:38},{place:"Earth ",weight:"40 kg",bar:100},{place:"Jupiter ",weight:"94.8 kg",bar:237},{place:"Sun ",weight:"1,092 kg",bar:100}].map(a=>`
            <div style="background:rgba(255,255,255,0.04);border-radius:12px;padding:14px;text-align:center">
              <div style="font-size:1.2rem">${a.place}</div>
              <div style="color:#f97316;font-weight:bold;font-size:1.1rem;margin:6px 0">${a.weight}</div>
              <div style="height:6px;background:rgba(255,255,255,0.1);border-radius:3px;overflow:hidden">
                <div style="height:100%;width:${Math.min(a.bar,100)}%;background:linear-gradient(90deg,#f97316,#8b5cf6);border-radius:3px"></div>
              </div>
            </div>
          `).join("")}
        </div>
        <p style="color:#22c55e;text-align:center;margin-top:12px">On the Moon, you could jump 6x higher! </p>
      </div>

      <!-- Orbits explanation -->
      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> How Orbits Work</h2>
        <p style="color:#e2e8f0;line-height:1.7">
          An orbit is what happens when something moves fast enough to keep falling <em>around</em> something instead of <em>into</em> it!
        </p>
        <div style="background:rgba(139,92,246,0.1);border:1px solid rgba(139,92,246,0.2);border-radius:12px;padding:16px;margin-top:12px">
          <p style="color:#e2e8f0;margin:0;line-height:1.7">
             Imagine throwing a ball. Gravity pulls it down. Throw it FASTER  it goes farther before falling.
            Throw it <strong style="color:#f97316">fast enough</strong> and it falls all the way AROUND the Earth! That's an orbit!
          </p>
        </div>
        <div style="display:flex;gap:16px;flex-wrap:wrap;margin-top:16px">
          <div style="flex:1;min-width:200px;background:rgba(255,255,255,0.04);border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:2rem"></div>
            <div style="color:#e2e8f0;font-weight:bold">Moon orbits Earth</div>
            <div style="color:#94a3b8;font-size:0.85rem">Every 27.3 days</div>
          </div>
          <div style="flex:1;min-width:200px;background:rgba(255,255,255,0.04);border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:2rem"></div>
            <div style="color:#e2e8f0;font-weight:bold">Earth orbits Sun</div>
            <div style="color:#94a3b8;font-size:0.85rem">Every 365.25 days (1 year!)</div>
          </div>
          <div style="flex:1;min-width:200px;background:rgba(255,255,255,0.04);border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:2rem"></div>
            <div style="color:#e2e8f0;font-weight:bold">ISS orbits Earth</div>
            <div style="color:#94a3b8;font-size:0.85rem">Every 90 minutes! </div>
          </div>
        </div>
      </div>

      <!-- Drag: Match gravity facts -->
      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px" id="drag-activity-5">
        <h2 style="color:#8b5cf6;margin-top:0"> Gravity Match!</h2>
        <p style="color:#cbd5e1;margin-bottom:16px">Match each fact to: <strong>Stronger Gravity</strong> or <strong>Weaker Gravity</strong></p>

        <div style="display:flex;flex-wrap:wrap;gap:10px;margin-bottom:20px;justify-content:center">
          <div class="drag-item" draggable="true" data-id="jump" data-value="weak" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:10px 18px;cursor:grab;color:#e2e8f0"> You can jump super high</div>
          <div class="drag-item" draggable="true" data-id="heavy" data-value="strong" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:10px 18px;cursor:grab;color:#e2e8f0"> You feel very heavy</div>
          <div class="drag-item" draggable="true" data-id="float" data-value="weak" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:10px 18px;cursor:grab;color:#e2e8f0"> Things float around</div>
          <div class="drag-item" draggable="true" data-id="crush" data-value="strong" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:10px 18px;cursor:grab;color:#e2e8f0"> Objects feel crushed down</div>
        </div>

        <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px">
          <div class="drag-zone" data-accept="strong" style="border:2px dashed rgba(249,115,22,0.4);border-radius:16px;padding:20px;min-height:100px;text-align:center">
            <div style="color:#f97316;font-weight:bold"> Stronger Gravity</div>
          </div>
          <div class="drag-zone" data-accept="weak" style="border:2px dashed rgba(139,92,246,0.4);border-radius:16px;padding:20px;min-height:100px;text-align:center">
            <div style="color:#8b5cf6;font-weight:bold"> Weaker Gravity</div>
          </div>
        </div>
      </div>

      <!-- Quiz -->
      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px" id="quiz-ch5">
        <h2 style="color:#8b5cf6;margin-top:0"> Quick Quiz!</h2>
        <p style="color:#e2e8f0;font-size:1.05rem;margin-bottom:16px"><strong>Why don't astronauts on the ISS float away into space?</strong></p>
        <div style="display:grid;gap:10px" id="quiz-options-5">
          <button onclick="checkQuiz5(this,'wrong')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px;color:#e2e8f0;font-size:1rem;cursor:pointer;text-align:left">A) There's no gravity in space</button>
          <button onclick="checkQuiz5(this,'correct')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px;color:#e2e8f0;font-size:1rem;cursor:pointer;text-align:left">B) The ISS is constantly falling around Earth  it's in orbit!</button>
          <button onclick="checkQuiz5(this,'wrong')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px;color:#e2e8f0;font-size:1rem;cursor:pointer;text-align:left">C) They're held by magnetic boots</button>
        </div>
      </div>

      <div style="text-align:center;margin-top:24px">
        <button onclick="window.addPoints(25);window.completeChapter('space',4)" style="background:linear-gradient(135deg,#f97316,#8b5cf6);border:none;border-radius:14px;padding:16px 40px;color:white;font-size:1.15rem;font-weight:bold;cursor:pointer;transition:transform 0.2s" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
           Complete Chapter 5!
        </button>
      </div>
    `,window.checkQuiz5=function(a,o){const l=document.getElementById("quiz-ch5");document.getElementById("quiz-options-5").querySelectorAll("button").forEach(p=>p.disabled=!0),o==="correct"?(a.style.background="rgba(34,197,94,0.2)",a.style.borderColor="#22c55e",De(l,"correct"," Exactly! The ISS is falling around Earth at 28,000 km/h  that's what an orbit is! Astronauts float because they're falling at the same speed as the station."),window.addPoints(25)):(a.style.background="rgba(239,68,68,0.2)",a.style.borderColor="#ef4444",De(l,"wrong"," There IS gravity in space! The ISS is actually falling around Earth  it's moving so fast sideways that it keeps missing the ground!"))},typeof ce=="function"&&ce()},function(r){r.innerHTML=`
      <img src="./infographics/space-ch6.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="Space AI Infographic">

      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.4rem;margin:0;background:linear-gradient(135deg,#f97316,#8b5cf6);-webkit-background-clip:text;-webkit-text-fill-color:transparent"> Space AI</h1>
        <p style="color:#94a3b8;font-size:1.1rem;margin-top:8px">How artificial intelligence is conquering the final frontier!</p>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> Why Does Space Need AI?</h2>
        <p style="color:#e2e8f0;font-size:1.05rem;line-height:1.7">
          Space is SO far away that sending a message to Mars takes <strong style="color:#8b5cf6">4-24 minutes</strong>!
          Imagine playing a video game with a 24-minute delay   impossible!
        </p>
        <p style="color:#cbd5e1;line-height:1.7">
          That's why we need AI  robots that can <strong style="color:#f97316">think for themselves</strong> and make decisions
          without waiting for instructions from Earth!
        </p>
      </div>

      <!-- AI Applications -->
      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#8b5cf6;margin-top:0"> AI in Space  Real Examples!</h2>
        <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:14px">
          ${[{title:" AutoNav on Mars Rovers",desc:"Perseverance uses AI to drive itself around rocks and craters  no human needed!",color:"#f97316"},{title:" Finding Exoplanets",desc:"AI scans billions of star signals to find hidden planets  it found a solar system with 8 planets like ours!",color:"#8b5cf6"},{title:" Asteroid Defense",desc:"AI tracks 30,000+ space rocks to warn us if one is heading toward Earth!",color:"#ef4444"},{title:" Satellite Image Analysis",desc:"AI processes millions of satellite photos to track weather, forests, and oceans on Earth",color:"#22c55e"},{title:" CIMON  Astronaut Helper",desc:"A floating AI robot on the ISS that assists astronauts with experiments and even plays music! ",color:"#3b82f6"},{title:" Deep Space Navigation",desc:"AI helps spacecraft navigate through the solar system using star patterns  like a GPS for space!",color:"#eab308"}].map(a=>`
            <div style="background:rgba(255,255,255,0.04);border-left:3px solid ${a.color};border-radius:0 12px 12px 0;padding:16px">
              <div style="color:${a.color};font-weight:bold;font-size:1.05rem;margin-bottom:6px">${a.title}</div>
              <div style="color:#94a3b8;font-size:0.9rem;line-height:1.5">${a.desc}</div>
            </div>
          `).join("")}
        </div>
      </div>

      <!-- Drag: AI vs Human -->
      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px" id="drag-activity-6">
        <h2 style="color:#f97316;margin-top:0"> AI or Human? Who Does It Better?</h2>
        <p style="color:#cbd5e1;margin-bottom:16px">Drag each task to who handles it best in space:</p>

        <div style="display:flex;flex-wrap:wrap;gap:10px;margin-bottom:20px;justify-content:center">
          <div class="drag-item" draggable="true" data-id="data" data-value="ai" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:10px 18px;cursor:grab;color:#e2e8f0"> Analyzing millions of photos</div>
          <div class="drag-item" draggable="true" data-id="creative" data-value="human" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:10px 18px;cursor:grab;color:#e2e8f0"> Creative problem solving</div>
          <div class="drag-item" draggable="true" data-id="drive" data-value="ai" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:10px 18px;cursor:grab;color:#e2e8f0"> Driving a rover on Mars</div>
          <div class="drag-item" draggable="true" data-id="decide" data-value="human" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:10px 18px;cursor:grab;color:#e2e8f0"> Making big mission decisions</div>
        </div>

        <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px">
          <div class="drag-zone" data-accept="ai" style="border:2px dashed rgba(139,92,246,0.4);border-radius:16px;padding:20px;min-height:100px;text-align:center">
            <div style="color:#8b5cf6;font-weight:bold"> AI Does Better</div>
          </div>
          <div class="drag-zone" data-accept="human" style="border:2px dashed rgba(249,115,22,0.4);border-radius:16px;padding:20px;min-height:100px;text-align:center">
            <div style="color:#f97316;font-weight:bold"> Humans Do Better</div>
          </div>
        </div>
      </div>

      <!-- Quiz -->
      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px" id="quiz-ch6">
        <h2 style="color:#8b5cf6;margin-top:0"> Quick Quiz!</h2>
        <p style="color:#e2e8f0;font-size:1.05rem;margin-bottom:16px"><strong>Why can't we just remote-control Mars rovers in real-time?</strong></p>
        <div style="display:grid;gap:10px" id="quiz-options-6">
          <button onclick="checkQuiz6(this,'wrong')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px;color:#e2e8f0;font-size:1rem;cursor:pointer;text-align:left">A) The controllers are too expensive</button>
          <button onclick="checkQuiz6(this,'wrong')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px;color:#e2e8f0;font-size:1rem;cursor:pointer;text-align:left">B) Wi-Fi doesn't reach Mars</button>
          <button onclick="checkQuiz6(this,'correct')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px;color:#e2e8f0;font-size:1rem;cursor:pointer;text-align:left">C) Signals take 4-24 minutes to reach Mars  too slow!</button>
          <button onclick="checkQuiz6(this,'wrong')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px;color:#e2e8f0;font-size:1rem;cursor:pointer;text-align:left">D) Rovers don't have batteries</button>
        </div>
      </div>

      <div style="text-align:center;margin-top:24px">
        <button onclick="window.addPoints(25);window.completeChapter('space',5)" style="background:linear-gradient(135deg,#f97316,#8b5cf6);border:none;border-radius:14px;padding:16px 40px;color:white;font-size:1.15rem;font-weight:bold;cursor:pointer;transition:transform 0.2s" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
           Complete Chapter 6!
        </button>
      </div>
    `,window.checkQuiz6=function(a,o){const l=document.getElementById("quiz-ch6");document.getElementById("quiz-options-6").querySelectorAll("button").forEach(p=>p.disabled=!0),o==="correct"?(a.style.background="rgba(34,197,94,0.2)",a.style.borderColor="#22c55e",De(l,"correct"," Yes! Radio signals travel at the speed of light, but Mars is SO far that it takes 4-24 minutes each way. That's why rovers need AI to think for themselves!"),window.addPoints(25)):(a.style.background="rgba(239,68,68,0.2)",a.style.borderColor="#ef4444",De(l,"wrong"," It's the signal delay! Even at the speed of light, signals take 4-24 minutes to reach Mars. Imagine waiting 24 minutes just to tell the rover to stop!"))},typeof ce=="function"&&ce()},function(r){r.innerHTML=`
      <img src="./infographics/space-ch7.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="Astronaut Training Infographic">

      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.4rem;margin:0;background:linear-gradient(135deg,#f97316,#8b5cf6);-webkit-background-clip:text;-webkit-text-fill-color:transparent"> Astronaut Training</h1>
        <p style="color:#94a3b8;font-size:1.1rem;margin-top:8px">Think you've got what it takes? Let's find out!</p>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> The Numbers Are Insane!</h2>
        <p style="color:#e2e8f0;line-height:1.7">
          NASA gets about <strong style="color:#8b5cf6">18,300 applications</strong> every time they recruit astronauts.
          They pick only about <strong style="color:#f97316">12 people</strong>. That's a 0.065% acceptance rate 
          harder to get into than any university on Earth! 
        </p>
      </div>

      <!-- Training Steps -->
      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#8b5cf6;margin-top:0"> The Training Journey (2+ Years!)</h2>
        <div style="display:flex;flex-direction:column;gap:14px">
          ${[{emoji:"",title:"Underwater Training",desc:"Practice spacewalks in a giant pool (6 hours underwater for every 1 hour in space!)",color:"#3b82f6"},{emoji:"",title:"The Centrifuge",desc:"Spin in a machine that simulates 8x Earth's gravity  your face literally stretches!",color:"#f97316"},{emoji:"",title:"Zero-G Flights (Vomit Comet)",desc:"Fly in a special airplane that dives to simulate weightlessness  for 25 seconds at a time!",color:"#8b5cf6"},{emoji:"",title:"Wilderness Survival",desc:"Dropped in the wilderness with minimal supplies  what if your capsule lands off-target?",color:"#22c55e"},{emoji:"",title:"Language Training",desc:"All astronauts must learn Russian  the ISS uses both English and Russian!",color:"#eab308"},{emoji:"",title:"Science & Engineering",desc:"Master robotics, life support systems, medical procedures, and space experiments",color:"#ef4444"}].map((a,o)=>`
            <div style="display:flex;gap:16px;align-items:center;background:rgba(255,255,255,0.03);border-left:3px solid ${a.color};padding:14px 18px;border-radius:0 12px 12px 0">
              <div style="font-size:2rem">${a.emoji}</div>
              <div>
                <div style="color:${a.color};font-weight:bold;font-size:1.05rem">Step ${o+1}: ${a.title}</div>
                <div style="color:#94a3b8;font-size:0.9rem">${a.desc}</div>
              </div>
            </div>
          `).join("")}
        </div>
      </div>

      <!-- Spacesuit -->
      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> The Spacesuit  Your Personal Spaceship!</h2>
        <p style="color:#cbd5e1;margin-bottom:16px">A spacesuit costs about <strong style="color:#8b5cf6">$12 million</strong> and weighs 127 kg on Earth!</p>
        <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:10px">
          ${[{part:"Helmet",job:"Protects from radiation + has lights & camera",emoji:""},{part:"Oxygen System",job:"8 hours of breathable air",emoji:""},{part:"Temperature Control",job:"Handles -157C to +121C!",emoji:""},{part:"Drink Bag",job:"A straw inside the helmet for sipping water",emoji:""},{part:"Diaper",job:"Yes, really! EVAs can last 8+ hours",emoji:""},{part:"Gloves",job:"Heated fingertips + touchscreen compatible",emoji:""}].map(a=>`
            <div style="background:rgba(255,255,255,0.04);border-radius:12px;padding:14px;text-align:center">
              <div style="font-size:1.5rem">${a.emoji}</div>
              <div style="color:#f97316;font-weight:bold;font-size:0.95rem">${a.part}</div>
              <div style="color:#94a3b8;font-size:0.8rem">${a.job}</div>
            </div>
          `).join("")}
        </div>
      </div>

      <!-- Drag: Astronaut requirements -->
      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px" id="drag-activity-7">
        <h2 style="color:#8b5cf6;margin-top:0"> What Do You Need to Be an Astronaut?</h2>
        <p style="color:#cbd5e1;margin-bottom:16px">Drag each item: <strong>Required</strong> or <strong>Not Required</strong>?</p>

        <div style="display:flex;flex-wrap:wrap;gap:10px;margin-bottom:20px;justify-content:center">
          <div class="drag-item" draggable="true" data-id="degree" data-value="required" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:10px 18px;cursor:grab;color:#e2e8f0"> Science/Engineering degree</div>
          <div class="drag-item" draggable="true" data-id="tall" data-value="notrequired" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:10px 18px;cursor:grab;color:#e2e8f0"> Be super tall</div>
          <div class="drag-item" draggable="true" data-id="swim" data-value="required" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:10px 18px;cursor:grab;color:#e2e8f0"> Pass a swimming test</div>
          <div class="drag-item" draggable="true" data-id="rich" data-value="notrequired" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:10px 18px;cursor:grab;color:#e2e8f0"> Be very rich</div>
          <div class="drag-item" draggable="true" data-id="vision" data-value="required" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:10px 18px;cursor:grab;color:#e2e8f0"> Good eyesight</div>
          <div class="drag-item" draggable="true" data-id="game" data-value="notrequired" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:10px 18px;cursor:grab;color:#e2e8f0"> Beat every video game</div>
        </div>

        <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px">
          <div class="drag-zone" data-accept="required" style="border:2px dashed rgba(34,197,94,0.4);border-radius:16px;padding:20px;min-height:100px;text-align:center">
            <div style="color:#22c55e;font-weight:bold"> Required</div>
          </div>
          <div class="drag-zone" data-accept="notrequired" style="border:2px dashed rgba(239,68,68,0.4);border-radius:16px;padding:20px;min-height:100px;text-align:center">
            <div style="color:#ef4444;font-weight:bold"> Not Required</div>
          </div>
        </div>
      </div>

      <!-- Quiz -->
      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px" id="quiz-ch7">
        <h2 style="color:#8b5cf6;margin-top:0"> Quick Quiz!</h2>
        <p style="color:#e2e8f0;font-size:1.05rem;margin-bottom:16px"><strong>Why do astronauts train underwater?</strong></p>
        <div style="display:grid;gap:10px" id="quiz-options-7">
          <button onclick="checkQuiz7(this,'wrong')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px;color:#e2e8f0;font-size:1rem;cursor:pointer;text-align:left">A) To learn to swim in space</button>
          <button onclick="checkQuiz7(this,'correct')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px;color:#e2e8f0;font-size:1rem;cursor:pointer;text-align:left">B) Underwater simulates the weightlessness of space!</button>
          <button onclick="checkQuiz7(this,'wrong')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px;color:#e2e8f0;font-size:1rem;cursor:pointer;text-align:left">C) Space has a lot of water</button>
        </div>
      </div>

      <div style="text-align:center;margin-top:24px">
        <button onclick="window.addPoints(25);window.completeChapter('space',6)" style="background:linear-gradient(135deg,#f97316,#8b5cf6);border:none;border-radius:14px;padding:16px 40px;color:white;font-size:1.15rem;font-weight:bold;cursor:pointer;transition:transform 0.2s" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
           Complete Chapter 7!
        </button>
      </div>
    `,window.checkQuiz7=function(a,o){const l=document.getElementById("quiz-ch7");document.getElementById("quiz-options-7").querySelectorAll("button").forEach(p=>p.disabled=!0),o==="correct"?(a.style.background="rgba(34,197,94,0.2)",a.style.borderColor="#22c55e",De(l,"correct"," Correct! Being underwater with the right weights feels similar to floating in space  it's the closest we can get to zero gravity on Earth!"),window.addPoints(25)):(a.style.background="rgba(239,68,68,0.2)",a.style.borderColor="#ef4444",De(l,"wrong"," It's because being underwater simulates weightlessness! Astronauts practice spacewalks in NASA's giant pool called the Neutral Buoyancy Lab."))},typeof ce=="function"&&ce()},function(r){r.innerHTML=`
      <img src="./infographics/space-ch8.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="Design Your Space Mission Infographic">

      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.4rem;margin:0;background:linear-gradient(135deg,#f97316,#8b5cf6);-webkit-background-clip:text;-webkit-text-fill-color:transparent"> Design Your Space Mission</h1>
        <p style="color:#94a3b8;font-size:1.1rem;margin-top:8px">You're the Mission Director now! Plan humanity's next great adventure!</p>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> Mission Planning 101</h2>
        <p style="color:#e2e8f0;line-height:1.7">
          Every space mission starts years before launch with careful planning. NASA's Artemis program
          (to return humans to the Moon) has been in planning since <strong style="color:#8b5cf6">2017</strong>!
          Here are the key steps every mission director must follow:
        </p>
      </div>

      <!-- Mission Steps -->
      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#8b5cf6;margin-top:0"> The 5 Steps of Mission Design</h2>
        <div style="display:flex;flex-direction:column;gap:14px">
          ${[{emoji:"",step:"Choose Your Destination",desc:"Moon? Mars? Europa? An asteroid? Each has different challenges and travel times!",color:"#f97316"},{emoji:"",step:"Design Your Spacecraft",desc:"How big? What fuel? How many stages? Will it land or orbit? Capsule or shuttle?",color:"#8b5cf6"},{emoji:"",step:"Pick Your Crew",desc:"Scientists, engineers, pilots, doctors  you need a well-balanced team!",color:"#22c55e"},{emoji:"",step:"Plan Your Supplies",desc:"Food, water, oxygen, fuel, tools, medicine, experiments  every gram counts!",color:"#eab308"},{emoji:"",step:"Choose Your Launch Window",desc:"Planets move! You must launch when your destination is closest to Earth.",color:"#ef4444"}].map((a,o)=>`
            <div style="display:flex;gap:16px;align-items:center;background:linear-gradient(90deg,rgba(255,255,255,0.04),transparent);border-left:3px solid ${a.color};padding:16px 20px;border-radius:0 12px 12px 0">
              <div style="font-size:2.2rem">${a.emoji}</div>
              <div>
                <div style="color:${a.color};font-weight:bold;font-size:1.1rem">Step ${o+1}: ${a.step}</div>
                <div style="color:#94a3b8;font-size:0.9rem;line-height:1.5">${a.desc}</div>
              </div>
            </div>
          `).join("")}
        </div>
      </div>

      <!-- Famous Missions -->
      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> Legendary Space Missions</h2>
        <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:12px">
          ${[{name:"Apollo 11 (1969)",desc:"First humans on the Moon! ",emoji:"",color:"#f97316"},{name:"Voyager 1 (1977)",desc:"Farthest human-made object  24 BILLION km away!",emoji:"",color:"#8b5cf6"},{name:"Hubble (1990)",desc:"Space telescope that revealed the universe to us",emoji:"",color:"#3b82f6"},{name:"ISS (1998)",desc:"Humans living in space for 25+ years straight!",emoji:"",color:"#22c55e"},{name:"James Webb (2021)",desc:"Sees the first galaxies ever formed  13 billion years ago!",emoji:"",color:"#eab308"},{name:"Artemis (2025+)",desc:"Returning humans to the Moon  and eventually Mars!",emoji:"",color:"#ef4444"}].map(a=>`
            <div style="background:rgba(255,255,255,0.04);border:1px solid ${a.color}33;border-radius:12px;padding:14px;text-align:center">
              <div style="font-size:2rem">${a.emoji}</div>
              <div style="color:${a.color};font-weight:bold;font-size:0.95rem">${a.name}</div>
              <div style="color:#94a3b8;font-size:0.85rem;margin-top:4px">${a.desc}</div>
            </div>
          `).join("")}
        </div>
      </div>

      <!-- Drag: Mission Planning -->
      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px" id="drag-activity-8">
        <h2 style="color:#8b5cf6;margin-top:0"> Plan Your Mission Order!</h2>
        <p style="color:#cbd5e1;margin-bottom:16px">Put the mission steps in the correct order (1st to 4th):</p>

        <div style="display:flex;flex-wrap:wrap;gap:10px;margin-bottom:20px;justify-content:center">
          <div class="drag-item" draggable="true" data-id="launch" data-value="step4" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:10px 18px;cursor:grab;color:#e2e8f0"> Launch!</div>
          <div class="drag-item" draggable="true" data-id="dest" data-value="step1" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:10px 18px;cursor:grab;color:#e2e8f0"> Choose destination</div>
          <div class="drag-item" draggable="true" data-id="supply" data-value="step3" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:10px 18px;cursor:grab;color:#e2e8f0"> Pack supplies</div>
          <div class="drag-item" draggable="true" data-id="build" data-value="step2" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:10px 18px;cursor:grab;color:#e2e8f0"> Build spacecraft</div>
        </div>

        <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:12px">
          <div class="drag-zone" data-accept="step1" style="border:2px dashed rgba(249,115,22,0.4);border-radius:14px;padding:16px;min-height:80px;text-align:center">
            <div style="color:#f97316;font-weight:bold">1st</div>
          </div>
          <div class="drag-zone" data-accept="step2" style="border:2px dashed rgba(139,92,246,0.4);border-radius:14px;padding:16px;min-height:80px;text-align:center">
            <div style="color:#8b5cf6;font-weight:bold">2nd</div>
          </div>
          <div class="drag-zone" data-accept="step3" style="border:2px dashed rgba(34,197,94,0.4);border-radius:14px;padding:16px;min-height:80px;text-align:center">
            <div style="color:#22c55e;font-weight:bold">3rd</div>
          </div>
          <div class="drag-zone" data-accept="step4" style="border:2px dashed rgba(239,68,68,0.4);border-radius:14px;padding:16px;min-height:80px;text-align:center">
            <div style="color:#ef4444;font-weight:bold">4th</div>
          </div>
        </div>
      </div>

      <!-- Quiz -->
      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px" id="quiz-ch8">
        <h2 style="color:#8b5cf6;margin-top:0"> Final Quiz!</h2>
        <p style="color:#e2e8f0;font-size:1.05rem;margin-bottom:16px"><strong>What is a "launch window"?</strong></p>
        <div style="display:grid;gap:10px" id="quiz-options-8">
          <button onclick="checkQuiz8(this,'wrong')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px;color:#e2e8f0;font-size:1rem;cursor:pointer;text-align:left">A) A window on the rocket you can look out of</button>
          <button onclick="checkQuiz8(this,'wrong')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px;color:#e2e8f0;font-size:1rem;cursor:pointer;text-align:left">B) The window of the mission control room</button>
          <button onclick="checkQuiz8(this,'correct')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px;color:#e2e8f0;font-size:1rem;cursor:pointer;text-align:left">C) The best time to launch when planets are aligned right</button>
          <button onclick="checkQuiz8(this,'wrong')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px;color:#e2e8f0;font-size:1rem;cursor:pointer;text-align:left">D) When the weather is nice at the launch pad</button>
        </div>
      </div>

      <!-- Graduation -->
      <div style="background:linear-gradient(135deg,rgba(249,115,22,0.15),rgba(139,92,246,0.15));border:1px solid rgba(249,115,22,0.3);border-radius:16px;padding:32px;margin-bottom:20px;text-align:center">
        <div style="font-size:3rem;margin-bottom:12px"></div>
        <h2 style="color:#f97316;margin:0">Congratulations, Space Explorer!</h2>
        <p style="color:#e2e8f0;font-size:1.1rem;margin-top:12px;line-height:1.7">
          You've completed the entire <strong style="color:#8b5cf6">Space Explorers</strong> course!
          You now know about planets, stars, rockets, Mars, gravity, AI, astronaut training,
          and mission design. The universe is waiting for YOU! 
        </p>
      </div>

      <div style="text-align:center;margin-top:24px">
        <button onclick="window.addPoints(25);window.completeChapter('space',7)" style="background:linear-gradient(135deg,#f97316,#8b5cf6);border:none;border-radius:14px;padding:18px 48px;color:white;font-size:1.2rem;font-weight:bold;cursor:pointer;transition:transform 0.2s;box-shadow:0 4px 20px rgba(249,115,22,0.3)" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
           Graduate  Complete the Course!
        </button>
      </div>
    `,window.checkQuiz8=function(a,o){const l=document.getElementById("quiz-ch8");document.getElementById("quiz-options-8").querySelectorAll("button").forEach(p=>p.disabled=!0),o==="correct"?(a.style.background="rgba(34,197,94,0.2)",a.style.borderColor="#22c55e",De(l,"correct"," Perfect! A launch window is when the destination planet is in the right position. For Mars, this happens only every 26 months!"),window.addPoints(25)):(a.style.background="rgba(239,68,68,0.2)",a.style.borderColor="#ef4444",De(l,"wrong"," A launch window is the ideal time to launch based on planetary alignment. Miss it and you might wait 2+ years for the next one!"))},typeof ce=="function"&&ce()}],robotics:[function(r){r.innerHTML=`
      <img src="./infographics/robotics-ch1.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="What is a Robot infographic">
      
      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.5rem;margin:0"> What is a Robot?</h1>
        <p style="font-size:1.2rem;color:#94a3b8;margin-top:8px">Let's discover the amazing world of robots!</p>
      </div>

      <!-- Intro Card -->
      <div style="background:rgba(139,92,246,0.1);border:1px solid rgba(139,92,246,0.3);border-radius:16px;padding:24px;margin-bottom:24px">
        <h2 style="color:#8b5cf6;margin-top:0"> Robots Are Everywhere!</h2>
        <p style="font-size:1.1rem;line-height:1.7">
          A <strong style="color:#10b981">robot</strong> is a machine that can <em>sense</em> the world around it, 
          <em>think</em> about what to do, and <em>act</em> on its own! Think of it like a super-powered helper 
          that never gets tired. 
        </p>
        <div style="display:flex;gap:16px;flex-wrap:wrap;margin-top:16px">
          <div style="flex:1;min-width:150px;background:rgba(16,185,129,0.1);border:1px solid rgba(16,185,129,0.3);border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:2.5rem"></div>
            <div style="font-weight:bold;color:#10b981">SENSE</div>
            <div style="font-size:0.9rem;color:#94a3b8">See, hear, feel the world</div>
          </div>
          <div style="flex:1;min-width:150px;background:rgba(139,92,246,0.1);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:2.5rem"></div>
            <div style="font-weight:bold;color:#8b5cf6">THINK</div>
            <div style="font-size:0.9rem;color:#94a3b8">Process & decide</div>
          </div>
          <div style="flex:1;min-width:150px;background:rgba(16,185,129,0.1);border:1px solid rgba(16,185,129,0.3);border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:2.5rem"></div>
            <div style="font-weight:bold;color:#10b981">ACT</div>
            <div style="font-size:0.9rem;color:#94a3b8">Move & do things</div>
          </div>
        </div>
      </div>

      <!-- Fun Fact -->
      <div style="background:linear-gradient(135deg,rgba(139,92,246,0.15),rgba(16,185,129,0.15));border-radius:16px;padding:24px;margin-bottom:24px;border:1px solid rgba(139,92,246,0.2)">
        <h3 style="margin-top:0"> Fun Fact!</h3>
        <p style="font-size:1.1rem">The word <strong style="color:#8b5cf6">"robot"</strong> comes from the Czech word <em>"robota"</em> meaning <strong style="color:#10b981">"forced work"</strong>. It was first used in a play in 1920  over 100 years ago! </p>
      </div>

      <!-- Robot vs Not Robot -->
      <div style="background:rgba(15,23,42,0.6);border:1px solid rgba(139,92,246,0.2);border-radius:16px;padding:24px;margin-bottom:24px">
        <h2 style="color:#10b981;margin-top:0"> What Makes Something a Robot?</h2>
        <p style="margin-bottom:16px">A true robot needs ALL three superpowers: <strong>Sense + Think + Act</strong></p>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px">
          <div style="background:rgba(16,185,129,0.1);border:1px solid rgba(16,185,129,0.3);border-radius:12px;padding:16px">
            <h3 style="color:#10b981;margin-top:0"> IS a Robot</h3>
            <ul style="list-style:none;padding:0">
              <li style="padding:6px 0"> Robot vacuum (Roomba)</li>
              <li style="padding:6px 0"> Factory robot arm</li>
              <li style="padding:6px 0"> Self-driving car</li>
              <li style="padding:6px 0"> Robot dog (Spot)</li>
            </ul>
          </div>
          <div style="background:rgba(239,68,68,0.1);border:1px solid rgba(239,68,68,0.3);border-radius:12px;padding:16px">
            <h3 style="color:#ef4444;margin-top:0"> NOT a Robot</h3>
            <ul style="list-style:none;padding:0">
              <li style="padding:6px 0"> Flashlight (no brain)</li>
              <li style="padding:6px 0"> Stuffed animal (can't act)</li>
              <li style="padding:6px 0"> Regular TV (can't sense)</li>
              <li style="padding:6px 0"> Bicycle (you control it)</li>
            </ul>
          </div>
        </div>
      </div>

      <!-- DRAG AND DROP ACTIVITY -->
      <div id="ch1-activity" style="background:rgba(139,92,246,0.1);border:1px solid rgba(139,92,246,0.3);border-radius:16px;padding:24px;margin-bottom:24px">
        <h2 style="color:#8b5cf6;margin-top:0"> Activity: Sort the Robot Parts!</h2>
        <p>Drag each part to the correct robot superpower category!</p>
        
        <div style="display:flex;flex-wrap:wrap;gap:10px;margin-bottom:20px;min-height:50px;padding:12px;background:rgba(0,0,0,0.2);border-radius:12px" id="ch1-parts-bank">
          <div class="drag-item" data-id="cam" data-value="sense" draggable="true" style="background:#8b5cf6;padding:10px 18px;border-radius:25px;cursor:grab;font-weight:bold"> Camera</div>
          <div class="drag-item" data-id="cpu" data-value="think" draggable="true" style="background:#8b5cf6;padding:10px 18px;border-radius:25px;cursor:grab;font-weight:bold"> Computer Chip</div>
          <div class="drag-item" data-id="motor" data-value="act" draggable="true" style="background:#8b5cf6;padding:10px 18px;border-radius:25px;cursor:grab;font-weight:bold"> Motor</div>
          <div class="drag-item" data-id="mic" data-value="sense" draggable="true" style="background:#8b5cf6;padding:10px 18px;border-radius:25px;cursor:grab;font-weight:bold"> Microphone</div>
          <div class="drag-item" data-id="code" data-value="think" draggable="true" style="background:#8b5cf6;padding:10px 18px;border-radius:25px;cursor:grab;font-weight:bold"> Program</div>
          <div class="drag-item" data-id="wheel" data-value="act" draggable="true" style="background:#8b5cf6;padding:10px 18px;border-radius:25px;cursor:grab;font-weight:bold"> Wheels</div>
        </div>

        <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px">
          <div class="drag-zone" data-accept="sense" style="min-height:120px;background:rgba(16,185,129,0.1);border:2px dashed rgba(16,185,129,0.5);border-radius:12px;padding:12px;text-align:center">
            <div style="font-weight:bold;color:#10b981;margin-bottom:8px"> SENSE</div>
          </div>
          <div class="drag-zone" data-accept="think" style="min-height:120px;background:rgba(139,92,246,0.1);border:2px dashed rgba(139,92,246,0.5);border-radius:12px;padding:12px;text-align:center">
            <div style="font-weight:bold;color:#8b5cf6;margin-bottom:8px"> THINK</div>
          </div>
          <div class="drag-zone" data-accept="act" style="min-height:120px;background:rgba(16,185,129,0.1);border:2px dashed rgba(16,185,129,0.5);border-radius:12px;padding:12px;text-align:center">
            <div style="font-weight:bold;color:#10b981;margin-bottom:8px"> ACT</div>
          </div>
        </div>
      </div>

      <!-- QUIZ -->
      <div id="ch1-quiz" style="background:rgba(15,23,42,0.6);border:1px solid rgba(16,185,129,0.3);border-radius:16px;padding:24px;margin-bottom:24px">
        <h2 style="color:#10b981;margin-top:0"> Quiz Time!</h2>
        <p style="font-size:1.1rem;font-weight:bold">Which of these is a REAL robot?</p>
        <div style="display:grid;gap:12px;margin-top:16px">
          <button onclick="window._ch1Quiz(this,'wrong')" style="background:rgba(139,92,246,0.15);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:16px;color:white;font-size:1rem;cursor:pointer;text-align:left;transition:all 0.3s">
             A remote-controlled car (you steer it yourself)
          </button>
          <button onclick="window._ch1Quiz(this,'correct')" style="background:rgba(139,92,246,0.15);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:16px;color:white;font-size:1rem;cursor:pointer;text-align:left;transition:all 0.3s">
             A Roomba vacuum that maps your house and cleans by itself
          </button>
          <button onclick="window._ch1Quiz(this,'wrong')" style="background:rgba(139,92,246,0.15);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:16px;color:white;font-size:1rem;cursor:pointer;text-align:left;transition:all 0.3s">
             A toaster that pops up bread automatically
          </button>
          <button onclick="window._ch1Quiz(this,'wrong')" style="background:rgba(139,92,246,0.15);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:16px;color:white;font-size:1rem;cursor:pointer;text-align:left;transition:all 0.3s">
             A wind-up toy that walks forward
          </button>
        </div>
      </div>

      <!-- Complete Button -->
      <div style="text-align:center;margin-top:32px">
        <button id="ch1-complete" onclick="window.addPoints(25);window.completeChapter('robotics',0);this.textContent=' Chapter Complete!';this.style.background='#10b981'" style="background:linear-gradient(135deg,#8b5cf6,#10b981);border:none;color:white;padding:16px 48px;border-radius:25px;font-size:1.2rem;font-weight:bold;cursor:pointer;transition:all 0.3s">
           Complete Chapter 1
        </button>
      </div>
    `,window._ch1Quiz=function(a,o){const l=document.getElementById("ch1-quiz");o==="correct"?(a.style.background="rgba(16,185,129,0.3)",a.style.borderColor="#10b981",De(l,"correct"," Yes! A Roomba can sense, think, and act on its own!"),window.addPoints(25)):(a.style.background="rgba(239,68,68,0.3)",a.style.borderColor="#ef4444",De(l,"wrong"," Not quite! Remember: a robot must sense, think, AND act by itself."))},typeof ce=="function"&&ce()},function(r){r.innerHTML=`
      <img src="./infographics/robotics-ch2.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="Robot Senses infographic">
      
      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.5rem;margin:0"> Robot Senses</h1>
        <p style="font-size:1.2rem;color:#94a3b8;margin-top:8px">How do robots see, hear, and feel the world?</p>
      </div>

      <!-- Human vs Robot Senses -->
      <div style="background:rgba(139,92,246,0.1);border:1px solid rgba(139,92,246,0.3);border-radius:16px;padding:24px;margin-bottom:24px">
        <h2 style="color:#8b5cf6;margin-top:0"> Human Senses vs Robot Sensors</h2>
        <p style="font-size:1.05rem;line-height:1.7">Just like YOU have 5 senses, robots have <strong style="color:#10b981">sensors</strong>  electronic devices that detect things in the world!</p>
        
        <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px;margin-top:16px">
          <div style="background:rgba(16,185,129,0.1);border:1px solid rgba(16,185,129,0.3);border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:2rem">  </div>
            <div style="font-weight:bold;color:#10b981">Sight</div>
            <div style="font-size:0.85rem;color:#94a3b8">Eyes  Cameras & LiDAR</div>
          </div>
          <div style="background:rgba(139,92,246,0.1);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:2rem">  </div>
            <div style="font-weight:bold;color:#8b5cf6">Hearing</div>
            <div style="font-size:0.85rem;color:#94a3b8">Ears  Microphones</div>
          </div>
          <div style="background:rgba(16,185,129,0.1);border:1px solid rgba(16,185,129,0.3);border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:2rem">  </div>
            <div style="font-weight:bold;color:#10b981">Touch</div>
            <div style="font-size:0.85rem;color:#94a3b8">Skin  Pressure sensors</div>
          </div>
          <div style="background:rgba(139,92,246,0.1);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:2rem">  </div>
            <div style="font-weight:bold;color:#8b5cf6">Smell</div>
            <div style="font-size:0.85rem;color:#94a3b8">Nose  Gas detectors</div>
          </div>
          <div style="background:rgba(16,185,129,0.1);border:1px solid rgba(16,185,129,0.3);border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:2rem">  </div>
            <div style="font-weight:bold;color:#10b981">Temperature</div>
            <div style="font-size:0.85rem;color:#94a3b8">Skin  Thermal sensors</div>
          </div>
          <div style="background:rgba(139,92,246,0.1);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:2rem">  </div>
            <div style="font-weight:bold;color:#8b5cf6">Super Sense!</div>
            <div style="font-size:0.85rem;color:#94a3b8">Robots can sense GPS, WiFi, ultrasound!</div>
          </div>
        </div>
      </div>

      <!-- Superpower callout -->
      <div style="background:linear-gradient(135deg,rgba(139,92,246,0.2),rgba(16,185,129,0.2));border-radius:16px;padding:24px;margin-bottom:24px;border:1px solid rgba(139,92,246,0.3)">
        <h3 style="margin-top:0"> Robot Superpower!</h3>
        <p style="font-size:1.1rem">Robots have senses humans DON'T have! They can see in the dark with <strong style="color:#10b981">infrared cameras</strong>, measure exact distances with <strong style="color:#8b5cf6">LiDAR lasers</strong>, and detect gases we can't smell! </p>
      </div>

      <!-- LiDAR Explanation -->
      <div style="background:rgba(15,23,42,0.6);border:1px solid rgba(16,185,129,0.2);border-radius:16px;padding:24px;margin-bottom:24px">
        <h2 style="color:#10b981;margin-top:0"> How LiDAR Works (Robot Super-Vision!)</h2>
        <div style="text-align:center;font-size:1.2rem;line-height:2.5">
          <div style="background:rgba(139,92,246,0.15);border-radius:12px;padding:16px;display:inline-block">
             Shoots laser   Bounces off object   Measures time   Calculates distance!
          </div>
        </div>
        <p style="margin-top:16px;color:#94a3b8">Self-driving cars use LiDAR to "see" everything around them  even in fog or darkness! It creates a 3D map of the world. </p>
      </div>

      <!-- DRAG AND DROP ACTIVITY -->
      <div id="ch2-activity" style="background:rgba(139,92,246,0.1);border:1px solid rgba(139,92,246,0.3);border-radius:16px;padding:24px;margin-bottom:24px">
        <h2 style="color:#8b5cf6;margin-top:0"> Activity: Match the Sensor!</h2>
        <p>Drag each sensor to what it detects!</p>
        
        <div style="display:flex;flex-wrap:wrap;gap:10px;margin-bottom:20px;padding:12px;background:rgba(0,0,0,0.2);border-radius:12px">
          <div class="drag-item" data-id="s1" data-value="light" draggable="true" style="background:#10b981;padding:10px 18px;border-radius:25px;cursor:grab;font-weight:bold"> Camera</div>
          <div class="drag-item" data-id="s2" data-value="sound" draggable="true" style="background:#10b981;padding:10px 18px;border-radius:25px;cursor:grab;font-weight:bold"> Microphone</div>
          <div class="drag-item" data-id="s3" data-value="distance" draggable="true" style="background:#10b981;padding:10px 18px;border-radius:25px;cursor:grab;font-weight:bold"> Ultrasonic</div>
          <div class="drag-item" data-id="s4" data-value="heat" draggable="true" style="background:#10b981;padding:10px 18px;border-radius:25px;cursor:grab;font-weight:bold"> Thermometer</div>
        </div>

        <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
          <div class="drag-zone" data-accept="light" style="min-height:80px;background:rgba(139,92,246,0.1);border:2px dashed rgba(139,92,246,0.5);border-radius:12px;padding:12px;text-align:center">
            <div style="font-weight:bold;color:#8b5cf6"> Light & Images</div>
          </div>
          <div class="drag-zone" data-accept="sound" style="min-height:80px;background:rgba(16,185,129,0.1);border:2px dashed rgba(16,185,129,0.5);border-radius:12px;padding:12px;text-align:center">
            <div style="font-weight:bold;color:#10b981"> Sound Waves</div>
          </div>
          <div class="drag-zone" data-accept="distance" style="min-height:80px;background:rgba(139,92,246,0.1);border:2px dashed rgba(139,92,246,0.5);border-radius:12px;padding:12px;text-align:center">
            <div style="font-weight:bold;color:#8b5cf6"> Distance</div>
          </div>
          <div class="drag-zone" data-accept="heat" style="min-height:80px;background:rgba(16,185,129,0.1);border:2px dashed rgba(16,185,129,0.5);border-radius:12px;padding:12px;text-align:center">
            <div style="font-weight:bold;color:#10b981"> Temperature</div>
          </div>
        </div>
      </div>

      <!-- QUIZ -->
      <div id="ch2-quiz" style="background:rgba(15,23,42,0.6);border:1px solid rgba(16,185,129,0.3);border-radius:16px;padding:24px;margin-bottom:24px">
        <h2 style="color:#10b981;margin-top:0"> Quiz Time!</h2>
        <p style="font-size:1.1rem;font-weight:bold">What robot sensor can "see" in complete darkness?</p>
        <div style="display:grid;gap:12px;margin-top:16px">
          <button onclick="window._ch2Quiz(this,'wrong')" style="background:rgba(139,92,246,0.15);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:16px;color:white;font-size:1rem;cursor:pointer;text-align:left">
             A regular camera
          </button>
          <button onclick="window._ch2Quiz(this,'wrong')" style="background:rgba(139,92,246,0.15);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:16px;color:white;font-size:1rem;cursor:pointer;text-align:left">
             A microphone
          </button>
          <button onclick="window._ch2Quiz(this,'correct')" style="background:rgba(139,92,246,0.15);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:16px;color:white;font-size:1rem;cursor:pointer;text-align:left">
             An infrared / thermal sensor
          </button>
          <button onclick="window._ch2Quiz(this,'wrong')" style="background:rgba(139,92,246,0.15);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:16px;color:white;font-size:1rem;cursor:pointer;text-align:left">
             A GPS sensor
          </button>
        </div>
      </div>

      <div style="text-align:center;margin-top:32px">
        <button onclick="window.addPoints(25);window.completeChapter('robotics',1);this.textContent=' Chapter Complete!';this.style.background='#10b981'" style="background:linear-gradient(135deg,#8b5cf6,#10b981);border:none;color:white;padding:16px 48px;border-radius:25px;font-size:1.2rem;font-weight:bold;cursor:pointer">
           Complete Chapter 2
        </button>
      </div>
    `,window._ch2Quiz=function(a,o){const l=document.getElementById("ch2-quiz");o==="correct"?(a.style.background="rgba(16,185,129,0.3)",a.style.borderColor="#10b981",De(l,"correct"," Infrared sensors detect heat, so they work in total darkness!"),window.addPoints(25)):(a.style.background="rgba(239,68,68,0.3)",a.style.borderColor="#ef4444",De(l,"wrong"," Try again! Think about which sensor detects heat instead of light."))},typeof ce=="function"&&ce()},function(r){r.innerHTML=`
      <img src="./infographics/robotics-ch3.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="Robot Brain infographic">
      
      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.5rem;margin:0"> Robot Brain</h1>
        <p style="font-size:1.2rem;color:#94a3b8;margin-top:8px">How do robots think and make decisions?</p>
      </div>

      <!-- Brain comparison -->
      <div style="background:rgba(139,92,246,0.1);border:1px solid rgba(139,92,246,0.3);border-radius:16px;padding:24px;margin-bottom:24px">
        <h2 style="color:#8b5cf6;margin-top:0"> vs  Human Brain vs Robot Brain</h2>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-top:16px">
          <div style="background:rgba(16,185,129,0.1);border:1px solid rgba(16,185,129,0.3);border-radius:12px;padding:16px">
            <h3 style="color:#10b981;margin-top:0;text-align:center"> Human Brain</h3>
            <ul style="list-style:none;padding:0;font-size:0.95rem">
              <li style="padding:6px 0"> 86 billion neurons</li>
              <li style="padding:6px 0"> Creative & emotional</li>
              <li style="padding:6px 0"> Math: kinda slow</li>
              <li style="padding:6px 0"> Needs sleep!</li>
              <li style="padding:6px 0"> Can imagine new things</li>
            </ul>
          </div>
          <div style="background:rgba(139,92,246,0.1);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:16px">
            <h3 style="color:#8b5cf6;margin-top:0;text-align:center"> Robot Brain (CPU)</h3>
            <ul style="list-style:none;padding:0;font-size:0.95rem">
              <li style="padding:6px 0"> Billions of transistors</li>
              <li style="padding:6px 0"> Logical & precise</li>
              <li style="padding:6px 0"> Math: SUPER fast!</li>
              <li style="padding:6px 0"> Never gets tired</li>
              <li style="padding:6px 0"> Only follows instructions</li>
            </ul>
          </div>
        </div>
      </div>

      <!-- Sense-Think-Act Loop -->
      <div style="background:rgba(15,23,42,0.6);border:1px solid rgba(16,185,129,0.2);border-radius:16px;padding:24px;margin-bottom:24px">
        <h2 style="color:#10b981;margin-top:0"> The Sense-Think-Act Loop</h2>
        <p>A robot's brain runs this loop over and over, thousands of times per second!</p>
        <div style="display:flex;justify-content:center;align-items:center;gap:12px;flex-wrap:wrap;margin:20px 0;font-size:1.2rem">
          <div style="background:rgba(16,185,129,0.2);border:2px solid #10b981;border-radius:50%;width:100px;height:100px;display:flex;flex-direction:column;align-items:center;justify-content:center">
            <div style="font-size:1.5rem"></div>
            <div style="font-size:0.8rem;font-weight:bold">SENSE</div>
          </div>
          <div style="font-size:2rem;color:#8b5cf6"></div>
          <div style="background:rgba(139,92,246,0.2);border:2px solid #8b5cf6;border-radius:50%;width:100px;height:100px;display:flex;flex-direction:column;align-items:center;justify-content:center">
            <div style="font-size:1.5rem"></div>
            <div style="font-size:0.8rem;font-weight:bold">THINK</div>
          </div>
          <div style="font-size:2rem;color:#8b5cf6"></div>
          <div style="background:rgba(16,185,129,0.2);border:2px solid #10b981;border-radius:50%;width:100px;height:100px;display:flex;flex-direction:column;align-items:center;justify-content:center">
            <div style="font-size:1.5rem"></div>
            <div style="font-size:0.8rem;font-weight:bold">ACT</div>
          </div>
          <div style="font-size:2rem;color:#8b5cf6"></div>
        </div>
        <div style="background:rgba(139,92,246,0.1);border-radius:12px;padding:16px;margin-top:12px">
          <p style="margin:0;font-size:1rem"><strong>Example  Robot Vacuum:</strong></p>
          <p style="margin:8px 0 0 0;color:#94a3b8"> Sensor detects wall ahead   Brain says "turn right!"   Wheels turn right   Repeat!</p>
        </div>
      </div>

      <!-- If-Then Logic -->
      <div style="background:rgba(139,92,246,0.1);border:1px solid rgba(139,92,246,0.3);border-radius:16px;padding:24px;margin-bottom:24px">
        <h2 style="color:#8b5cf6;margin-top:0"> Robot Logic: IF-THEN Rules</h2>
        <p>Robots think using simple rules, stacked together!</p>
        <div style="font-family:monospace;background:rgba(0,0,0,0.3);border-radius:12px;padding:20px;font-size:1rem;line-height:2">
          <div><span style="color:#8b5cf6">IF</span> <span style="color:#10b981">obstacle ahead</span> <span style="color:#8b5cf6">THEN</span> turn right </div>
          <div><span style="color:#8b5cf6">IF</span> <span style="color:#10b981">battery low</span> <span style="color:#8b5cf6">THEN</span> go to charger </div>
          <div><span style="color:#8b5cf6">IF</span> <span style="color:#10b981">floor is dirty</span> <span style="color:#8b5cf6">THEN</span> vacuum harder </div>
          <div><span style="color:#8b5cf6">IF</span> <span style="color:#10b981">human says "stop"</span> <span style="color:#8b5cf6">THEN</span> stop moving </div>
        </div>
      </div>

      <!-- DRAG AND DROP -->
      <div id="ch3-activity" style="background:rgba(16,185,129,0.1);border:1px solid rgba(16,185,129,0.3);border-radius:16px;padding:24px;margin-bottom:24px">
        <h2 style="color:#10b981;margin-top:0"> Activity: Build the Robot Logic!</h2>
        <p>Drag each action to complete the IF-THEN rule!</p>
        
        <div style="display:flex;flex-wrap:wrap;gap:10px;margin-bottom:20px;padding:12px;background:rgba(0,0,0,0.2);border-radius:12px">
          <div class="drag-item" data-id="a1" data-value="turn" draggable="true" style="background:#8b5cf6;padding:10px 18px;border-radius:25px;cursor:grab;font-weight:bold"> Turn around</div>
          <div class="drag-item" data-id="a2" data-value="charge" draggable="true" style="background:#8b5cf6;padding:10px 18px;border-radius:25px;cursor:grab;font-weight:bold"> Go charge</div>
          <div class="drag-item" data-id="a3" data-value="grab" draggable="true" style="background:#8b5cf6;padding:10px 18px;border-radius:25px;cursor:grab;font-weight:bold"> Pick it up</div>
        </div>

        <div style="display:grid;gap:12px">
          <div style="display:flex;align-items:center;gap:12px">
            <span style="font-size:1rem;min-width:200px"><span style="color:#8b5cf6">IF</span> wall detected <span style="color:#8b5cf6">THEN</span></span>
            <div class="drag-zone" data-accept="turn" style="flex:1;min-height:50px;background:rgba(139,92,246,0.1);border:2px dashed rgba(139,92,246,0.5);border-radius:12px;padding:8px;text-align:center"></div>
          </div>
          <div style="display:flex;align-items:center;gap:12px">
            <span style="font-size:1rem;min-width:200px"><span style="color:#8b5cf6">IF</span> battery at 10% <span style="color:#8b5cf6">THEN</span></span>
            <div class="drag-zone" data-accept="charge" style="flex:1;min-height:50px;background:rgba(16,185,129,0.1);border:2px dashed rgba(16,185,129,0.5);border-radius:12px;padding:8px;text-align:center"></div>
          </div>
          <div style="display:flex;align-items:center;gap:12px">
            <span style="font-size:1rem;min-width:200px"><span style="color:#8b5cf6">IF</span> object found <span style="color:#8b5cf6">THEN</span></span>
            <div class="drag-zone" data-accept="grab" style="flex:1;min-height:50px;background:rgba(139,92,246,0.1);border:2px dashed rgba(139,92,246,0.5);border-radius:12px;padding:8px;text-align:center"></div>
          </div>
        </div>
      </div>

      <!-- QUIZ -->
      <div id="ch3-quiz" style="background:rgba(15,23,42,0.6);border:1px solid rgba(139,92,246,0.3);border-radius:16px;padding:24px;margin-bottom:24px">
        <h2 style="color:#8b5cf6;margin-top:0"> Quiz Time!</h2>
        <p style="font-size:1.1rem;font-weight:bold">What is the correct order of the robot loop?</p>
        <div style="display:grid;gap:12px;margin-top:16px">
          <button onclick="window._ch3Quiz(this,'wrong')" style="background:rgba(139,92,246,0.15);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:16px;color:white;font-size:1rem;cursor:pointer;text-align:left">
             Act  Think  Sense
          </button>
          <button onclick="window._ch3Quiz(this,'correct')" style="background:rgba(139,92,246,0.15);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:16px;color:white;font-size:1rem;cursor:pointer;text-align:left">
             Sense  Think  Act
          </button>
          <button onclick="window._ch3Quiz(this,'wrong')" style="background:rgba(139,92,246,0.15);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:16px;color:white;font-size:1rem;cursor:pointer;text-align:left">
             Think  Act  Sense
          </button>
          <button onclick="window._ch3Quiz(this,'wrong')" style="background:rgba(139,92,246,0.15);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:16px;color:white;font-size:1rem;cursor:pointer;text-align:left">
             Act  Sense  Think
          </button>
        </div>
      </div>

      <div style="text-align:center;margin-top:32px">
        <button onclick="window.addPoints(25);window.completeChapter('robotics',2);this.textContent=' Chapter Complete!';this.style.background='#10b981'" style="background:linear-gradient(135deg,#8b5cf6,#10b981);border:none;color:white;padding:16px 48px;border-radius:25px;font-size:1.2rem;font-weight:bold;cursor:pointer">
           Complete Chapter 3
        </button>
      </div>
    `,window._ch3Quiz=function(a,o){const l=document.getElementById("ch3-quiz");o==="correct"?(a.style.background="rgba(16,185,129,0.3)",a.style.borderColor="#10b981",De(l,"correct"," Correct! Sense  Think  Act, then repeat!"),window.addPoints(25)):(a.style.background="rgba(239,68,68,0.3)",a.style.borderColor="#ef4444",De(l,"wrong"," Not quite! Robots must SENSE first, then THINK, then ACT."))},typeof ce=="function"&&ce()},function(r){r.innerHTML=`
      <img src="./infographics/robotics-ch4.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="Robot Movement infographic">
      
      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.5rem;margin:0"> Robot Movement</h1>
        <p style="font-size:1.2rem;color:#94a3b8;margin-top:8px">How do robots walk, roll, fly, and swim?</p>
      </div>

      <!-- Movement Types -->
      <div style="background:rgba(139,92,246,0.1);border:1px solid rgba(139,92,246,0.3);border-radius:16px;padding:24px;margin-bottom:24px">
        <h2 style="color:#8b5cf6;margin-top:0"> Ways Robots Move</h2>
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:12px;margin-top:16px">
          <div style="background:rgba(16,185,129,0.15);border:1px solid rgba(16,185,129,0.3);border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:2.5rem"></div>
            <div style="font-weight:bold;color:#10b981">Wheels</div>
            <div style="font-size:0.85rem;color:#94a3b8">Fast on flat ground</div>
          </div>
          <div style="background:rgba(139,92,246,0.15);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:2.5rem"></div>
            <div style="font-weight:bold;color:#8b5cf6">Legs</div>
            <div style="font-size:0.85rem;color:#94a3b8">Great for rough terrain</div>
          </div>
          <div style="background:rgba(16,185,129,0.15);border:1px solid rgba(16,185,129,0.3);border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:2.5rem"></div>
            <div style="font-weight:bold;color:#10b981">Propellers</div>
            <div style="font-size:0.85rem;color:#94a3b8">Fly through the air</div>
          </div>
          <div style="background:rgba(139,92,246,0.15);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:2.5rem"></div>
            <div style="font-weight:bold;color:#8b5cf6">Tracks</div>
            <div style="font-size:0.85rem;color:#94a3b8">Like a tank  any surface</div>
          </div>
          <div style="background:rgba(16,185,129,0.15);border:1px solid rgba(16,185,129,0.3);border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:2.5rem"></div>
            <div style="font-weight:bold;color:#10b981">Soft Body</div>
            <div style="font-size:0.85rem;color:#94a3b8">Squeeze into tight spaces</div>
          </div>
          <div style="background:rgba(139,92,246,0.15);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:2.5rem"></div>
            <div style="font-weight:bold;color:#8b5cf6">Fins</div>
            <div style="font-size:0.85rem;color:#94a3b8">Swim underwater</div>
          </div>
        </div>
      </div>

      <!-- How Motors Work -->
      <div style="background:rgba(15,23,42,0.6);border:1px solid rgba(16,185,129,0.2);border-radius:16px;padding:24px;margin-bottom:24px">
        <h2 style="color:#10b981;margin-top:0"> The Magic of Motors</h2>
        <p style="font-size:1.05rem;line-height:1.7">Motors are the <strong style="color:#8b5cf6">muscles</strong> of a robot! They turn electricity into movement.</p>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-top:16px">
          <div style="background:rgba(139,92,246,0.1);border-radius:12px;padding:16px">
            <h3 style="color:#8b5cf6;margin-top:0"> DC Motor</h3>
            <p style="font-size:0.9rem;color:#94a3b8">Spins around and around. Great for wheels! Like the motor in a fan.</p>
          </div>
          <div style="background:rgba(16,185,129,0.1);border-radius:12px;padding:16px">
            <h3 style="color:#10b981;margin-top:0"> Servo Motor</h3>
            <p style="font-size:0.9rem;color:#94a3b8">Moves to an exact angle and holds it. Perfect for robot arms and fingers!</p>
          </div>
        </div>
      </div>

      <!-- Fun fact -->
      <div style="background:linear-gradient(135deg,rgba(139,92,246,0.15),rgba(16,185,129,0.15));border-radius:16px;padding:24px;margin-bottom:24px;border:1px solid rgba(139,92,246,0.2)">
        <h3 style="margin-top:0"> Speed Record!</h3>
        <p style="font-size:1.1rem">Boston Dynamics' robot <strong style="color:#10b981">Cheetah</strong> can run at <strong style="color:#8b5cf6">28.3 mph</strong>  faster than Usain Bolt! </p>
      </div>

      <!-- DRAG AND DROP -->
      <div id="ch4-activity" style="background:rgba(139,92,246,0.1);border:1px solid rgba(139,92,246,0.3);border-radius:16px;padding:24px;margin-bottom:24px">
        <h2 style="color:#8b5cf6;margin-top:0"> Activity: Match Robot to Movement!</h2>
        <p>Drag each robot to how it moves!</p>
        
        <div style="display:flex;flex-wrap:wrap;gap:10px;margin-bottom:20px;padding:12px;background:rgba(0,0,0,0.2);border-radius:12px">
          <div class="drag-item" data-id="r1" data-value="wheels" draggable="true" style="background:#10b981;padding:10px 18px;border-radius:25px;cursor:grab;font-weight:bold"> Mars Rover</div>
          <div class="drag-item" data-id="r2" data-value="propellers" draggable="true" style="background:#10b981;padding:10px 18px;border-radius:25px;cursor:grab;font-weight:bold"> Delivery Drone</div>
          <div class="drag-item" data-id="r3" data-value="legs" draggable="true" style="background:#10b981;padding:10px 18px;border-radius:25px;cursor:grab;font-weight:bold"> Robot Dog</div>
          <div class="drag-item" data-id="r4" data-value="fins" draggable="true" style="background:#10b981;padding:10px 18px;border-radius:25px;cursor:grab;font-weight:bold"> Ocean Explorer</div>
        </div>

        <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
          <div class="drag-zone" data-accept="wheels" style="min-height:80px;background:rgba(139,92,246,0.1);border:2px dashed rgba(139,92,246,0.5);border-radius:12px;padding:12px;text-align:center">
            <div style="font-weight:bold;color:#8b5cf6"> Wheels</div>
          </div>
          <div class="drag-zone" data-accept="propellers" style="min-height:80px;background:rgba(16,185,129,0.1);border:2px dashed rgba(16,185,129,0.5);border-radius:12px;padding:12px;text-align:center">
            <div style="font-weight:bold;color:#10b981"> Propellers</div>
          </div>
          <div class="drag-zone" data-accept="legs" style="min-height:80px;background:rgba(139,92,246,0.1);border:2px dashed rgba(139,92,246,0.5);border-radius:12px;padding:12px;text-align:center">
            <div style="font-weight:bold;color:#8b5cf6"> Legs</div>
          </div>
          <div class="drag-zone" data-accept="fins" style="min-height:80px;background:rgba(16,185,129,0.1);border:2px dashed rgba(16,185,129,0.5);border-radius:12px;padding:12px;text-align:center">
            <div style="font-weight:bold;color:#10b981"> Fins</div>
          </div>
        </div>
      </div>

      <!-- QUIZ -->
      <div id="ch4-quiz" style="background:rgba(15,23,42,0.6);border:1px solid rgba(16,185,129,0.3);border-radius:16px;padding:24px;margin-bottom:24px">
        <h2 style="color:#10b981;margin-top:0"> Quiz Time!</h2>
        <p style="font-size:1.1rem;font-weight:bold">Which motor type is best for a robot arm that needs to hold a specific position?</p>
        <div style="display:grid;gap:12px;margin-top:16px">
          <button onclick="window._ch4Quiz(this,'wrong')" style="background:rgba(139,92,246,0.15);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:16px;color:white;font-size:1rem;cursor:pointer;text-align:left">
             DC Motor  it spins fast!
          </button>
          <button onclick="window._ch4Quiz(this,'correct')" style="background:rgba(139,92,246,0.15);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:16px;color:white;font-size:1rem;cursor:pointer;text-align:left">
             Servo Motor  it holds exact angles!
          </button>
          <button onclick="window._ch4Quiz(this,'wrong')" style="background:rgba(139,92,246,0.15);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:16px;color:white;font-size:1rem;cursor:pointer;text-align:left">
             A battery  it gives power!
          </button>
        </div>
      </div>

      <div style="text-align:center;margin-top:32px">
        <button onclick="window.addPoints(25);window.completeChapter('robotics',3);this.textContent=' Chapter Complete!';this.style.background='#10b981'" style="background:linear-gradient(135deg,#8b5cf6,#10b981);border:none;color:white;padding:16px 48px;border-radius:25px;font-size:1.2rem;font-weight:bold;cursor:pointer">
           Complete Chapter 4
        </button>
      </div>
    `,window._ch4Quiz=function(a,o){const l=document.getElementById("ch4-quiz");o==="correct"?(a.style.background="rgba(16,185,129,0.3)",a.style.borderColor="#10b981",De(l,"correct"," Servo motors move to exact angles  perfect for robot arms!"),window.addPoints(25)):(a.style.background="rgba(239,68,68,0.3)",a.style.borderColor="#ef4444",De(l,"wrong"," Think about which motor can hold a specific position!"))},typeof ce=="function"&&ce()},function(r){r.innerHTML=`
      <img src="./infographics/robotics-ch5.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="Types of Robots infographic">
      
      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.5rem;margin:0"> Types of Robots</h1>
        <p style="font-size:1.2rem;color:#94a3b8;margin-top:8px">Robots come in ALL shapes and sizes!</p>
      </div>

      <!-- Robot Types Grid -->
      <div style="background:rgba(139,92,246,0.1);border:1px solid rgba(139,92,246,0.3);border-radius:16px;padding:24px;margin-bottom:24px">
        <h2 style="color:#8b5cf6;margin-top:0"> Robots Around the World</h2>
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;margin-top:16px">
          <div style="background:rgba(16,185,129,0.1);border:1px solid rgba(16,185,129,0.3);border-radius:12px;padding:16px">
            <div style="font-size:2rem"></div>
            <h3 style="color:#10b981;margin:8px 0 4px">Industrial</h3>
            <p style="font-size:0.85rem;color:#94a3b8;margin:0">Build cars, weld metal, paint products in factories. Super strong & precise!</p>
          </div>
          <div style="background:rgba(139,92,246,0.1);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:16px">
            <div style="font-size:2rem"></div>
            <h3 style="color:#8b5cf6;margin:8px 0 4px">Medical</h3>
            <p style="font-size:0.85rem;color:#94a3b8;margin:0">Help surgeons operate with tiny precise cuts. Save lives every day!</p>
          </div>
          <div style="background:rgba(16,185,129,0.1);border:1px solid rgba(16,185,129,0.3);border-radius:12px;padding:16px">
            <div style="font-size:2rem"></div>
            <h3 style="color:#10b981;margin:8px 0 4px">Home</h3>
            <p style="font-size:0.85rem;color:#94a3b8;margin:0">Vacuum, mow lawns, even cook! Your personal home helper.</p>
          </div>
          <div style="background:rgba(139,92,246,0.1);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:16px">
            <div style="font-size:2rem"></div>
            <h3 style="color:#8b5cf6;margin:8px 0 4px">Space</h3>
            <p style="font-size:0.85rem;color:#94a3b8;margin:0">Explore Mars, fix satellites, go where humans can't! Like Perseverance rover.</p>
          </div>
          <div style="background:rgba(16,185,129,0.1);border:1px solid rgba(16,185,129,0.3);border-radius:12px;padding:16px">
            <div style="font-size:2rem"></div>
            <h3 style="color:#10b981;margin:8px 0 4px">Underwater</h3>
            <p style="font-size:0.85rem;color:#94a3b8;margin:0">Explore deep ocean, find shipwrecks, study sea life. Can dive SUPER deep!</p>
          </div>
          <div style="background:rgba(139,92,246,0.1);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:16px">
            <div style="font-size:2rem"></div>
            <h3 style="color:#8b5cf6;margin:8px 0 4px">Social</h3>
            <p style="font-size:0.85rem;color:#94a3b8;margin:0">Talk, play, and be friends! Help kids learn and keep elderly company.</p>
          </div>
        </div>
      </div>

      <!-- Size comparison -->
      <div style="background:linear-gradient(135deg,rgba(139,92,246,0.15),rgba(16,185,129,0.15));border-radius:16px;padding:24px;margin-bottom:24px;border:1px solid rgba(139,92,246,0.2)">
        <h3 style="margin-top:0"> Size Matters!</h3>
        <div style="display:flex;align-items:end;justify-content:space-around;margin-top:16px;flex-wrap:wrap;gap:12px">
          <div style="text-align:center"><div style="font-size:1rem"></div><div style="font-size:0.75rem;color:#94a3b8">Nanobots<br>0.001mm</div></div>
          <div style="text-align:center"><div style="font-size:1.5rem"></div><div style="font-size:0.75rem;color:#94a3b8">Micro robots<br>1cm</div></div>
          <div style="text-align:center"><div style="font-size:2rem"></div><div style="font-size:0.75rem;color:#94a3b8">Humanoid<br>1.5m</div></div>
          <div style="text-align:center"><div style="font-size:3rem"></div><div style="font-size:0.75rem;color:#94a3b8">Industrial<br>3m+</div></div>
          <div style="text-align:center"><div style="font-size:4rem"></div><div style="font-size:0.75rem;color:#94a3b8">Mining robot<br>10m+</div></div>
        </div>
      </div>

      <!-- DRAG AND DROP -->
      <div id="ch5-activity" style="background:rgba(16,185,129,0.1);border:1px solid rgba(16,185,129,0.3);border-radius:16px;padding:24px;margin-bottom:24px">
        <h2 style="color:#10b981;margin-top:0"> Activity: Where Does This Robot Work?</h2>
        <p>Drag each robot to its workplace!</p>
        
        <div style="display:flex;flex-wrap:wrap;gap:10px;margin-bottom:20px;padding:12px;background:rgba(0,0,0,0.2);border-radius:12px">
          <div class="drag-item" data-id="t1" data-value="space" draggable="true" style="background:#8b5cf6;padding:10px 18px;border-radius:25px;cursor:grab;font-weight:bold"> Mars Rover</div>
          <div class="drag-item" data-id="t2" data-value="hospital" draggable="true" style="background:#8b5cf6;padding:10px 18px;border-radius:25px;cursor:grab;font-weight:bold"> Surgery Bot</div>
          <div class="drag-item" data-id="t3" data-value="factory" draggable="true" style="background:#8b5cf6;padding:10px 18px;border-radius:25px;cursor:grab;font-weight:bold"> Welding Arm</div>
          <div class="drag-item" data-id="t4" data-value="home" draggable="true" style="background:#8b5cf6;padding:10px 18px;border-radius:25px;cursor:grab;font-weight:bold"> Roomba</div>
        </div>

        <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
          <div class="drag-zone" data-accept="space" style="min-height:80px;background:rgba(139,92,246,0.1);border:2px dashed rgba(139,92,246,0.5);border-radius:12px;padding:12px;text-align:center">
            <div style="font-weight:bold;color:#8b5cf6"> Space</div>
          </div>
          <div class="drag-zone" data-accept="hospital" style="min-height:80px;background:rgba(16,185,129,0.1);border:2px dashed rgba(16,185,129,0.5);border-radius:12px;padding:12px;text-align:center">
            <div style="font-weight:bold;color:#10b981"> Hospital</div>
          </div>
          <div class="drag-zone" data-accept="factory" style="min-height:80px;background:rgba(139,92,246,0.1);border:2px dashed rgba(139,92,246,0.5);border-radius:12px;padding:12px;text-align:center">
            <div style="font-weight:bold;color:#8b5cf6"> Factory</div>
          </div>
          <div class="drag-zone" data-accept="home" style="min-height:80px;background:rgba(16,185,129,0.1);border:2px dashed rgba(16,185,129,0.5);border-radius:12px;padding:12px;text-align:center">
            <div style="font-weight:bold;color:#10b981"> Home</div>
          </div>
        </div>
      </div>

      <!-- QUIZ -->
      <div id="ch5-quiz" style="background:rgba(15,23,42,0.6);border:1px solid rgba(139,92,246,0.3);border-radius:16px;padding:24px;margin-bottom:24px">
        <h2 style="color:#8b5cf6;margin-top:0"> Quiz Time!</h2>
        <p style="font-size:1.1rem;font-weight:bold">Which type of robot explores the deep ocean?</p>
        <div style="display:grid;gap:12px;margin-top:16px">
          <button onclick="window._ch5Quiz(this,'wrong')" style="background:rgba(139,92,246,0.15);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:16px;color:white;font-size:1rem;cursor:pointer;text-align:left"> Industrial robot</button>
          <button onclick="window._ch5Quiz(this,'wrong')" style="background:rgba(139,92,246,0.15);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:16px;color:white;font-size:1rem;cursor:pointer;text-align:left"> Social robot</button>
          <button onclick="window._ch5Quiz(this,'correct')" style="background:rgba(139,92,246,0.15);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:16px;color:white;font-size:1rem;cursor:pointer;text-align:left"> Underwater / ROV robot</button>
          <button onclick="window._ch5Quiz(this,'wrong')" style="background:rgba(139,92,246,0.15);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:16px;color:white;font-size:1rem;cursor:pointer;text-align:left"> Home robot</button>
        </div>
      </div>

      <div style="text-align:center;margin-top:32px">
        <button onclick="window.addPoints(25);window.completeChapter('robotics',4);this.textContent=' Chapter Complete!';this.style.background='#10b981'" style="background:linear-gradient(135deg,#8b5cf6,#10b981);border:none;color:white;padding:16px 48px;border-radius:25px;font-size:1.2rem;font-weight:bold;cursor:pointer">
           Complete Chapter 5
        </button>
      </div>
    `,window._ch5Quiz=function(a,o){const l=document.getElementById("ch5-quiz");o==="correct"?(a.style.background="rgba(16,185,129,0.3)",a.style.borderColor="#10b981",De(l,"correct"," ROVs (Remotely Operated Vehicles) dive thousands of meters deep!"),window.addPoints(25)):(a.style.background="rgba(239,68,68,0.3)",a.style.borderColor="#ef4444",De(l,"wrong"," Think about which robot is designed for water!"))},typeof ce=="function"&&ce()},function(r){r.innerHTML=`
      <img src="./infographics/robotics-ch6.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="Robots and AI infographic">
      
      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.5rem;margin:0"> Robots & AI Together</h1>
        <p style="font-size:1.2rem;color:#94a3b8;margin-top:8px">When robots get SMART brains!</p>
      </div>

      <!-- AI vs Regular -->
      <div style="background:rgba(139,92,246,0.1);border:1px solid rgba(139,92,246,0.3);border-radius:16px;padding:24px;margin-bottom:24px">
        <h2 style="color:#8b5cf6;margin-top:0"> Regular Robot vs AI Robot</h2>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-top:16px">
          <div style="background:rgba(239,68,68,0.1);border:1px solid rgba(239,68,68,0.3);border-radius:12px;padding:16px">
            <h3 style="color:#ef4444;margin-top:0;text-align:center"> Regular Robot</h3>
            <ul style="list-style:none;padding:0;font-size:0.95rem">
              <li style="padding:6px 0"> Follows exact instructions</li>
              <li style="padding:6px 0"> Does the same thing every time</li>
              <li style="padding:6px 0"> Can't handle surprises</li>
              <li style="padding:6px 0"> Never gets better</li>
            </ul>
          </div>
          <div style="background:rgba(16,185,129,0.1);border:1px solid rgba(16,185,129,0.3);border-radius:12px;padding:16px">
            <h3 style="color:#10b981;margin-top:0;text-align:center"> AI Robot</h3>
            <ul style="list-style:none;padding:0;font-size:0.95rem">
              <li style="padding:6px 0"> Learns from experience</li>
              <li style="padding:6px 0"> Adapts to new situations</li>
              <li style="padding:6px 0"> Handles surprises!</li>
              <li style="padding:6px 0"> Gets better over time</li>
            </ul>
          </div>
        </div>
      </div>

      <!-- How AI Learning Works -->
      <div style="background:rgba(15,23,42,0.6);border:1px solid rgba(16,185,129,0.2);border-radius:16px;padding:24px;margin-bottom:24px">
        <h2 style="color:#10b981;margin-top:0"> How Do AI Robots Learn?</h2>
        <p>Just like you learn from practice, AI robots learn from <strong style="color:#8b5cf6">data</strong>!</p>
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:12px;margin-top:16px">
          <div style="background:rgba(139,92,246,0.15);border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:2rem"></div>
            <div style="font-weight:bold;color:#8b5cf6">See 1000s of cats</div>
          </div>
          <div style="background:rgba(16,185,129,0.15);border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:2rem"></div>
            <div style="font-weight:bold;color:#10b981">Find patterns</div>
          </div>
          <div style="background:rgba(139,92,246,0.15);border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:2rem"></div>
            <div style="font-weight:bold;color:#8b5cf6">Recognize new cats!</div>
          </div>
        </div>
        <p style="margin-top:16px;color:#94a3b8">This is called <strong style="color:#10b981">Machine Learning</strong>  the robot learns from examples instead of being programmed with every rule!</p>
      </div>

      <!-- Real Examples -->
      <div style="background:linear-gradient(135deg,rgba(139,92,246,0.15),rgba(16,185,129,0.15));border-radius:16px;padding:24px;margin-bottom:24px;border:1px solid rgba(139,92,246,0.2)">
        <h3 style="margin-top:0"> AI Robots in Action!</h3>
        <div style="display:grid;gap:8px;font-size:1.05rem">
          <div> <strong>Tesla cars</strong>  learn to drive better from millions of miles of data</div>
          <div> <strong>Alexa/Siri</strong>  understand your voice better over time</div>
          <div> <strong>Game AI</strong>  learns your play style and adapts</div>
          <div> <strong>Medical AI</strong>  spots diseases in X-rays better than some doctors!</div>
        </div>
      </div>

      <!-- DRAG AND DROP -->
      <div id="ch6-activity" style="background:rgba(139,92,246,0.1);border:1px solid rgba(139,92,246,0.3);border-radius:16px;padding:24px;margin-bottom:24px">
        <h2 style="color:#8b5cf6;margin-top:0"> Activity: AI or Not AI?</h2>
        <p>Drag each example to the correct category!</p>
        
        <div style="display:flex;flex-wrap:wrap;gap:10px;margin-bottom:20px;padding:12px;background:rgba(0,0,0,0.2);border-radius:12px">
          <div class="drag-item" data-id="ai1" data-value="ai" draggable="true" style="background:#10b981;padding:10px 18px;border-radius:25px;cursor:grab;font-weight:bold"> Voice assistant that learns</div>
          <div class="drag-item" data-id="ai2" data-value="notai" draggable="true" style="background:#10b981;padding:10px 18px;border-radius:25px;cursor:grab;font-weight:bold"> Alarm clock</div>
          <div class="drag-item" data-id="ai3" data-value="ai" draggable="true" style="background:#10b981;padding:10px 18px;border-radius:25px;cursor:grab;font-weight:bold"> Self-driving car</div>
          <div class="drag-item" data-id="ai4" data-value="notai" draggable="true" style="background:#10b981;padding:10px 18px;border-radius:25px;cursor:grab;font-weight:bold"> Traffic light timer</div>
        </div>

        <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
          <div class="drag-zone" data-accept="ai" style="min-height:100px;background:rgba(16,185,129,0.1);border:2px dashed rgba(16,185,129,0.5);border-radius:12px;padding:12px;text-align:center">
            <div style="font-weight:bold;color:#10b981"> Uses AI (Learns!)</div>
          </div>
          <div class="drag-zone" data-accept="notai" style="min-height:100px;background:rgba(239,68,68,0.1);border:2px dashed rgba(239,68,68,0.5);border-radius:12px;padding:12px;text-align:center">
            <div style="font-weight:bold;color:#ef4444"> No AI (Just follows rules)</div>
          </div>
        </div>
      </div>

      <!-- QUIZ -->
      <div id="ch6-quiz" style="background:rgba(15,23,42,0.6);border:1px solid rgba(16,185,129,0.3);border-radius:16px;padding:24px;margin-bottom:24px">
        <h2 style="color:#10b981;margin-top:0"> Quiz Time!</h2>
        <p style="font-size:1.1rem;font-weight:bold">What makes an AI robot different from a regular robot?</p>
        <div style="display:grid;gap:12px;margin-top:16px">
          <button onclick="window._ch6Quiz(this,'wrong')" style="background:rgba(139,92,246,0.15);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:16px;color:white;font-size:1rem;cursor:pointer;text-align:left"> It's bigger and stronger</button>
          <button onclick="window._ch6Quiz(this,'wrong')" style="background:rgba(139,92,246,0.15);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:16px;color:white;font-size:1rem;cursor:pointer;text-align:left"> It uses more electricity</button>
          <button onclick="window._ch6Quiz(this,'correct')" style="background:rgba(139,92,246,0.15);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:16px;color:white;font-size:1rem;cursor:pointer;text-align:left"> It can learn and improve from experience</button>
          <button onclick="window._ch6Quiz(this,'wrong')" style="background:rgba(139,92,246,0.15);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:16px;color:white;font-size:1rem;cursor:pointer;text-align:left"> It costs more money</button>
        </div>
      </div>

      <div style="text-align:center;margin-top:32px">
        <button onclick="window.addPoints(25);window.completeChapter('robotics',5);this.textContent=' Chapter Complete!';this.style.background='#10b981'" style="background:linear-gradient(135deg,#8b5cf6,#10b981);border:none;color:white;padding:16px 48px;border-radius:25px;font-size:1.2rem;font-weight:bold;cursor:pointer">
           Complete Chapter 6
        </button>
      </div>
    `,window._ch6Quiz=function(a,o){const l=document.getElementById("ch6-quiz");o==="correct"?(a.style.background="rgba(16,185,129,0.3)",a.style.borderColor="#10b981",De(l,"correct"," AI robots learn from data and get better over time!"),window.addPoints(25)):(a.style.background="rgba(239,68,68,0.3)",a.style.borderColor="#ef4444",De(l,"wrong"," Think about what AI means  Artificial INTELLIGENCE (learning)!"))},typeof ce=="function"&&ce()},function(r){r.innerHTML=`
      <img src="./infographics/robotics-ch7.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="Robot Ethics infographic">
      
      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.5rem;margin:0"> Robot Ethics</h1>
        <p style="font-size:1.2rem;color:#94a3b8;margin-top:8px">With great power comes great responsibility!</p>
      </div>

      <!-- What is Ethics -->
      <div style="background:rgba(139,92,246,0.1);border:1px solid rgba(139,92,246,0.3);border-radius:16px;padding:24px;margin-bottom:24px">
        <h2 style="color:#8b5cf6;margin-top:0"> What is Robot Ethics?</h2>
        <p style="font-size:1.1rem;line-height:1.7">
          <strong style="color:#10b981">Ethics</strong> means thinking about what's RIGHT and what's WRONG. 
          As robots get smarter, we need to ask important questions about how they should behave! 
        </p>
      </div>

      <!-- Big Questions -->
      <div style="background:rgba(15,23,42,0.6);border:1px solid rgba(16,185,129,0.2);border-radius:16px;padding:24px;margin-bottom:24px">
        <h2 style="color:#10b981;margin-top:0"> Big Questions About Robots</h2>
        <div style="display:grid;gap:16px;margin-top:16px">
          <div style="background:rgba(139,92,246,0.1);border-left:4px solid #8b5cf6;border-radius:0 12px 12px 0;padding:16px">
            <h3 style="color:#8b5cf6;margin:0"> Jobs: Will robots take our jobs?</h3>
            <p style="color:#94a3b8;margin:8px 0 0">Robots replace some jobs BUT create new ones! Someone needs to build, program, and fix all those robots. </p>
          </div>
          <div style="background:rgba(16,185,129,0.1);border-left:4px solid #10b981;border-radius:0 12px 12px 0;padding:16px">
            <h3 style="color:#10b981;margin:0"> Privacy: Should robots watch us?</h3>
            <p style="color:#94a3b8;margin:8px 0 0">Security cameras help keep us safe, but nobody wants to be watched ALL the time. Balance is key! </p>
          </div>
          <div style="background:rgba(139,92,246,0.1);border-left:4px solid #8b5cf6;border-radius:0 12px 12px 0;padding:16px">
            <h3 style="color:#8b5cf6;margin:0"> Fairness: Can robots be biased?</h3>
            <p style="color:#94a3b8;margin:8px 0 0">YES! If we teach AI with biased data, it learns those biases. We must train AI to be fair to everyone. </p>
          </div>
          <div style="background:rgba(16,185,129,0.1);border-left:4px solid #10b981;border-radius:0 12px 12px 0;padding:16px">
            <h3 style="color:#10b981;margin:0"> Safety: Who's responsible if a robot makes a mistake?</h3>
            <p style="color:#94a3b8;margin:8px 0 0">The humans who built and programmed it! That's why testing robots is SO important. </p>
          </div>
        </div>
      </div>

      <!-- Asimov's Laws -->
      <div style="background:linear-gradient(135deg,rgba(139,92,246,0.2),rgba(16,185,129,0.2));border-radius:16px;padding:24px;margin-bottom:24px;border:1px solid rgba(139,92,246,0.3)">
        <h2 style="margin-top:0"> Asimov's 3 Laws of Robotics</h2>
        <p style="color:#94a3b8;margin-bottom:16px">In 1942, writer Isaac Asimov created 3 famous rules for robots:</p>
        <div style="display:grid;gap:12px">
          <div style="background:rgba(0,0,0,0.2);border-radius:12px;padding:16px;display:flex;align-items:center;gap:12px">
            <span style="font-size:2rem;font-weight:bold;color:#10b981">1</span>
            <span>A robot may NOT <strong style="color:#ef4444">harm</strong> a human being </span>
          </div>
          <div style="background:rgba(0,0,0,0.2);border-radius:12px;padding:16px;display:flex;align-items:center;gap:12px">
            <span style="font-size:2rem;font-weight:bold;color:#8b5cf6">2</span>
            <span>A robot must <strong style="color:#10b981">obey</strong> humans (unless it breaks Rule 1) </span>
          </div>
          <div style="background:rgba(0,0,0,0.2);border-radius:12px;padding:16px;display:flex;align-items:center;gap:12px">
            <span style="font-size:2rem;font-weight:bold;color:#10b981">3</span>
            <span>A robot must <strong style="color:#8b5cf6">protect itself</strong> (unless it breaks Rules 1 or 2) </span>
          </div>
        </div>
      </div>

      <!-- DRAG AND DROP -->
      <div id="ch7-activity" style="background:rgba(139,92,246,0.1);border:1px solid rgba(139,92,246,0.3);border-radius:16px;padding:24px;margin-bottom:24px">
        <h2 style="color:#8b5cf6;margin-top:0"> Activity: Good Robot or Bad Robot?</h2>
        <p>Drag each scenario to whether it's ethical (good) or unethical (bad)!</p>
        
        <div style="display:flex;flex-wrap:wrap;gap:10px;margin-bottom:20px;padding:12px;background:rgba(0,0,0,0.2);border-radius:12px">
          <div class="drag-item" data-id="e1" data-value="good" draggable="true" style="background:#8b5cf6;padding:10px 16px;border-radius:25px;cursor:grab;font-weight:bold;font-size:0.9rem"> Robot helps surgeon save lives</div>
          <div class="drag-item" data-id="e2" data-value="bad" draggable="true" style="background:#8b5cf6;padding:10px 16px;border-radius:25px;cursor:grab;font-weight:bold;font-size:0.9rem"> Robot spies on people secretly</div>
          <div class="drag-item" data-id="e3" data-value="good" draggable="true" style="background:#8b5cf6;padding:10px 16px;border-radius:25px;cursor:grab;font-weight:bold;font-size:0.9rem"> Robot helps disabled people</div>
          <div class="drag-item" data-id="e4" data-value="bad" draggable="true" style="background:#8b5cf6;padding:10px 16px;border-radius:25px;cursor:grab;font-weight:bold;font-size:0.9rem"> AI only works for one skin color</div>
        </div>

        <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
          <div class="drag-zone" data-accept="good" style="min-height:100px;background:rgba(16,185,129,0.1);border:2px dashed rgba(16,185,129,0.5);border-radius:12px;padding:12px;text-align:center">
            <div style="font-weight:bold;color:#10b981"> Ethical (Good!)</div>
          </div>
          <div class="drag-zone" data-accept="bad" style="min-height:100px;background:rgba(239,68,68,0.1);border:2px dashed rgba(239,68,68,0.5);border-radius:12px;padding:12px;text-align:center">
            <div style="font-weight:bold;color:#ef4444"> Unethical (Bad!)</div>
          </div>
        </div>
      </div>

      <!-- QUIZ -->
      <div id="ch7-quiz" style="background:rgba(15,23,42,0.6);border:1px solid rgba(16,185,129,0.3);border-radius:16px;padding:24px;margin-bottom:24px">
        <h2 style="color:#10b981;margin-top:0"> Quiz Time!</h2>
        <p style="font-size:1.1rem;font-weight:bold">According to Asimov's Laws, what is a robot's #1 priority?</p>
        <div style="display:grid;gap:12px;margin-top:16px">
          <button onclick="window._ch7Quiz(this,'wrong')" style="background:rgba(139,92,246,0.15);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:16px;color:white;font-size:1rem;cursor:pointer;text-align:left"> Protect itself from damage</button>
          <button onclick="window._ch7Quiz(this,'wrong')" style="background:rgba(139,92,246,0.15);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:16px;color:white;font-size:1rem;cursor:pointer;text-align:left"> Obey all human commands</button>
          <button onclick="window._ch7Quiz(this,'correct')" style="background:rgba(139,92,246,0.15);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:16px;color:white;font-size:1rem;cursor:pointer;text-align:left"> Never harm a human being</button>
          <button onclick="window._ch7Quiz(this,'wrong')" style="background:rgba(139,92,246,0.15);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:16px;color:white;font-size:1rem;cursor:pointer;text-align:left"> Complete its task no matter what</button>
        </div>
      </div>

      <div style="text-align:center;margin-top:32px">
        <button onclick="window.addPoints(25);window.completeChapter('robotics',6);this.textContent=' Chapter Complete!';this.style.background='#10b981'" style="background:linear-gradient(135deg,#8b5cf6,#10b981);border:none;color:white;padding:16px 48px;border-radius:25px;font-size:1.2rem;font-weight:bold;cursor:pointer">
           Complete Chapter 7
        </button>
      </div>
    `,window._ch7Quiz=function(a,o){const l=document.getElementById("ch7-quiz");o==="correct"?(a.style.background="rgba(16,185,129,0.3)",a.style.borderColor="#10b981",De(l,"correct"," Rule #1: Never harm humans! Safety always comes first!"),window.addPoints(25)):(a.style.background="rgba(239,68,68,0.3)",a.style.borderColor="#ef4444",De(l,"wrong"," Remember: Rule #1 is the MOST important  human safety!"))},typeof ce=="function"&&ce()},function(r){r.innerHTML=`
      <img src="./infographics/robotics-ch8.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="Design Your Robot infographic">
      
      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.5rem;margin:0"> Design Your Robot!</h1>
        <p style="font-size:1.2rem;color:#94a3b8;margin-top:8px">Time to become a robot engineer!</p>
      </div>

      <!-- Design Process -->
      <div style="background:rgba(139,92,246,0.1);border:1px solid rgba(139,92,246,0.3);border-radius:16px;padding:24px;margin-bottom:24px">
        <h2 style="color:#8b5cf6;margin-top:0"> The Robot Design Process</h2>
        <p style="font-size:1.05rem">Real engineers follow these steps to create amazing robots!</p>
        <div style="display:flex;flex-wrap:wrap;gap:12px;margin-top:16px;justify-content:center">
          <div style="background:rgba(16,185,129,0.2);border:2px solid #10b981;border-radius:50%;width:90px;height:90px;display:flex;flex-direction:column;align-items:center;justify-content:center">
            <div style="font-size:1.3rem"></div>
            <div style="font-size:0.7rem;font-weight:bold">PROBLEM</div>
          </div>
          <div style="font-size:1.5rem;display:flex;align-items:center;color:#8b5cf6"></div>
          <div style="background:rgba(139,92,246,0.2);border:2px solid #8b5cf6;border-radius:50%;width:90px;height:90px;display:flex;flex-direction:column;align-items:center;justify-content:center">
            <div style="font-size:1.3rem"></div>
            <div style="font-size:0.7rem;font-weight:bold">IDEA</div>
          </div>
          <div style="font-size:1.5rem;display:flex;align-items:center;color:#8b5cf6"></div>
          <div style="background:rgba(16,185,129,0.2);border:2px solid #10b981;border-radius:50%;width:90px;height:90px;display:flex;flex-direction:column;align-items:center;justify-content:center">
            <div style="font-size:1.3rem"></div>
            <div style="font-size:0.7rem;font-weight:bold">DESIGN</div>
          </div>
          <div style="font-size:1.5rem;display:flex;align-items:center;color:#8b5cf6"></div>
          <div style="background:rgba(139,92,246,0.2);border:2px solid #8b5cf6;border-radius:50%;width:90px;height:90px;display:flex;flex-direction:column;align-items:center;justify-content:center">
            <div style="font-size:1.3rem"></div>
            <div style="font-size:0.7rem;font-weight:bold">BUILD</div>
          </div>
          <div style="font-size:1.5rem;display:flex;align-items:center;color:#8b5cf6"></div>
          <div style="background:rgba(16,185,129,0.2);border:2px solid #10b981;border-radius:50%;width:90px;height:90px;display:flex;flex-direction:column;align-items:center;justify-content:center">
            <div style="font-size:1.3rem"></div>
            <div style="font-size:0.7rem;font-weight:bold">TEST</div>
          </div>
        </div>
      </div>

      <!-- Build Your Robot -->
      <div style="background:rgba(15,23,42,0.6);border:1px solid rgba(16,185,129,0.2);border-radius:16px;padding:24px;margin-bottom:24px">
        <h2 style="color:#10b981;margin-top:0"> Your Robot Blueprint</h2>
        <p>Every robot needs these key ingredients:</p>
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:12px;margin-top:16px">
          <div style="background:rgba(139,92,246,0.15);border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:2rem"></div>
            <div style="font-weight:bold;color:#8b5cf6">Mission</div>
            <div style="font-size:0.8rem;color:#94a3b8">What problem does it solve?</div>
          </div>
          <div style="background:rgba(16,185,129,0.15);border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:2rem"></div>
            <div style="font-weight:bold;color:#10b981">Sensors</div>
            <div style="font-size:0.8rem;color:#94a3b8">What does it need to detect?</div>
          </div>
          <div style="background:rgba(139,92,246,0.15);border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:2rem"></div>
            <div style="font-weight:bold;color:#8b5cf6">Brain</div>
            <div style="font-size:0.8rem;color:#94a3b8">How smart should it be?</div>
          </div>
          <div style="background:rgba(16,185,129,0.15);border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:2rem"></div>
            <div style="font-weight:bold;color:#10b981">Movement</div>
            <div style="font-size:0.8rem;color:#94a3b8">How does it get around?</div>
          </div>
          <div style="background:rgba(139,92,246,0.15);border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:2rem"></div>
            <div style="font-weight:bold;color:#8b5cf6">Power</div>
            <div style="font-size:0.8rem;color:#94a3b8">Battery, solar, or plug-in?</div>
          </div>
          <div style="background:rgba(16,185,129,0.15);border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:2rem"></div>
            <div style="font-weight:bold;color:#10b981">Safety</div>
            <div style="font-size:0.8rem;color:#94a3b8">How do we keep people safe?</div>
          </div>
        </div>
      </div>

      <!-- Example Robots Kids Could Design -->
      <div style="background:linear-gradient(135deg,rgba(139,92,246,0.15),rgba(16,185,129,0.15));border-radius:16px;padding:24px;margin-bottom:24px;border:1px solid rgba(139,92,246,0.2)">
        <h3 style="margin-top:0"> Cool Robot Ideas to Inspire You!</h3>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:12px">
          <div style="background:rgba(0,0,0,0.2);border-radius:12px;padding:16px">
            <div style="font-size:1.5rem"></div>
            <strong style="color:#10b981">Pet-Care Bot</strong>
            <p style="font-size:0.85rem;color:#94a3b8;margin:4px 0 0">Feeds your pet, plays with them, sends you photos!</p>
          </div>
          <div style="background:rgba(0,0,0,0.2);border-radius:12px;padding:16px">
            <div style="font-size:1.5rem"></div>
            <strong style="color:#8b5cf6">Homework Helper</strong>
            <p style="font-size:0.85rem;color:#94a3b8;margin:4px 0 0">Organizes your desk, finds your books, times your study!</p>
          </div>
          <div style="background:rgba(0,0,0,0.2);border-radius:12px;padding:16px">
            <div style="font-size:1.5rem"></div>
            <strong style="color:#10b981">Garden Bot</strong>
            <p style="font-size:0.85rem;color:#94a3b8;margin:4px 0 0">Waters plants, checks soil, alerts you when veggies are ready!</p>
          </div>
          <div style="background:rgba(0,0,0,0.2);border-radius:12px;padding:16px">
            <div style="font-size:1.5rem"></div>
            <strong style="color:#8b5cf6">Room Cleaner 3000</strong>
            <p style="font-size:0.85rem;color:#94a3b8;margin:4px 0 0">Picks up toys, makes your bed, organizes your room!</p>
          </div>
        </div>
      </div>

      <!-- DRAG AND DROP -->
      <div id="ch8-activity" style="background:rgba(139,92,246,0.1);border:1px solid rgba(139,92,246,0.3);border-radius:16px;padding:24px;margin-bottom:24px">
        <h2 style="color:#8b5cf6;margin-top:0"> Activity: Build a Rescue Robot!</h2>
        <p>Your mission: Design a robot that rescues people from earthquakes!  Drag the right parts!</p>
        
        <div style="display:flex;flex-wrap:wrap;gap:10px;margin-bottom:20px;padding:12px;background:rgba(0,0,0,0.2);border-radius:12px">
          <div class="drag-item" data-id="p1" data-value="sensor" draggable="true" style="background:#10b981;padding:10px 16px;border-radius:25px;cursor:grab;font-weight:bold;font-size:0.9rem"> Heat sensor (find people)</div>
          <div class="drag-item" data-id="p2" data-value="movement" draggable="true" style="background:#10b981;padding:10px 16px;border-radius:25px;cursor:grab;font-weight:bold;font-size:0.9rem"> Tank tracks (climb rubble)</div>
          <div class="drag-item" data-id="p3" data-value="tool" draggable="true" style="background:#10b981;padding:10px 16px;border-radius:25px;cursor:grab;font-weight:bold;font-size:0.9rem"> Strong arm (lift debris)</div>
          <div class="drag-item" data-id="p4" data-value="comm" draggable="true" style="background:#10b981;padding:10px 16px;border-radius:25px;cursor:grab;font-weight:bold;font-size:0.9rem"> Radio (call for help)</div>
        </div>

        <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
          <div class="drag-zone" data-accept="sensor" style="min-height:80px;background:rgba(16,185,129,0.1);border:2px dashed rgba(16,185,129,0.5);border-radius:12px;padding:12px;text-align:center">
            <div style="font-weight:bold;color:#10b981"> Sensors</div>
          </div>
          <div class="drag-zone" data-accept="movement" style="min-height:80px;background:rgba(139,92,246,0.1);border:2px dashed rgba(139,92,246,0.5);border-radius:12px;padding:12px;text-align:center">
            <div style="font-weight:bold;color:#8b5cf6"> Movement</div>
          </div>
          <div class="drag-zone" data-accept="tool" style="min-height:80px;background:rgba(16,185,129,0.1);border:2px dashed rgba(16,185,129,0.5);border-radius:12px;padding:12px;text-align:center">
            <div style="font-weight:bold;color:#10b981"> Tools</div>
          </div>
          <div class="drag-zone" data-accept="comm" style="min-height:80px;background:rgba(139,92,246,0.1);border:2px dashed rgba(139,92,246,0.5);border-radius:12px;padding:12px;text-align:center">
            <div style="font-weight:bold;color:#8b5cf6"> Communication</div>
          </div>
        </div>
      </div>

      <!-- QUIZ -->
      <div id="ch8-quiz" style="background:rgba(15,23,42,0.6);border:1px solid rgba(16,185,129,0.3);border-radius:16px;padding:24px;margin-bottom:24px">
        <h2 style="color:#10b981;margin-top:0"> Final Quiz!</h2>
        <p style="font-size:1.1rem;font-weight:bold">What's the FIRST step when designing a robot?</p>
        <div style="display:grid;gap:12px;margin-top:16px">
          <button onclick="window._ch8Quiz(this,'wrong')" style="background:rgba(139,92,246,0.15);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:16px;color:white;font-size:1rem;cursor:pointer;text-align:left"> Choose what color to paint it</button>
          <button onclick="window._ch8Quiz(this,'wrong')" style="background:rgba(139,92,246,0.15);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:16px;color:white;font-size:1rem;cursor:pointer;text-align:left"> Buy the most expensive parts</button>
          <button onclick="window._ch8Quiz(this,'correct')" style="background:rgba(139,92,246,0.15);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:16px;color:white;font-size:1rem;cursor:pointer;text-align:left"> Identify the problem you want to solve</button>
          <button onclick="window._ch8Quiz(this,'wrong')" style="background:rgba(139,92,246,0.15);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:16px;color:white;font-size:1rem;cursor:pointer;text-align:left"> Start building right away</button>
        </div>
      </div>

      <!--  Course Complete! -->
      <div style="background:linear-gradient(135deg,rgba(139,92,246,0.3),rgba(16,185,129,0.3));border:2px solid rgba(139,92,246,0.5);border-radius:16px;padding:32px;margin-bottom:24px;text-align:center">
        <div style="font-size:4rem"></div>
        <h2 style="color:#10b981;margin:16px 0 8px">Congratulations, Robot Engineer!</h2>
        <p style="font-size:1.1rem;color:#94a3b8">You've completed the entire Robotics Lab course! You now know how robots sense, think, act, and how to design your own. The future of robotics is in YOUR hands! </p>
      </div>

      <div style="text-align:center;margin-top:32px">
        <button onclick="window.addPoints(25);window.completeChapter('robotics',7);this.textContent=' Course Complete!';this.style.background='#10b981'" style="background:linear-gradient(135deg,#8b5cf6,#10b981);border:none;color:white;padding:16px 48px;border-radius:25px;font-size:1.2rem;font-weight:bold;cursor:pointer">
           Complete Chapter 8 & Finish Course!
        </button>
      </div>
    `,window._ch8Quiz=function(a,o){const l=document.getElementById("ch8-quiz");o==="correct"?(a.style.background="rgba(16,185,129,0.3)",a.style.borderColor="#10b981",De(l,"correct"," Always start with the PROBLEM! Then design the solution. That's real engineering!"),window.addPoints(25)):(a.style.background="rgba(239,68,68,0.3)",a.style.borderColor="#ef4444",De(l,"wrong"," Engineers always start by understanding the PROBLEM first!"))},typeof ce=="function"&&ce()}],aiart:[function(r){r.innerHTML=`
      <img src="./infographics/aiart-ch1.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="What is AI Image Generation?">

      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.2rem;margin:0;background:linear-gradient(135deg,#fbbf24,#ec4899);-webkit-background-clip:text;-webkit-text-fill-color:transparent">
           What is AI Image Generation?
        </h1>
        <p style="color:#94a3b8;font-size:1.1rem;margin-top:8px">Welcome to the future of art, young creator!</p>
      </div>

      <!-- Intro Glass Card -->
      <div style="background:rgba(255,255,255,0.05);backdrop-filter:blur(12px);border:1px solid rgba(255,255,255,0.1);border-radius:16px;padding:28px;margin-bottom:24px">
        <h2 style="color:#fbbf24;margin-top:0"> Imagine This...</h2>
        <p style="color:#e2e8f0;font-size:1.05rem;line-height:1.7">
          What if you could type <strong style="color:#ec4899">"a golden dragon flying over a neon city at sunset"</strong> 
          and a computer would <em>paint it for you</em> in seconds? 
        </p>
        <p style="color:#e2e8f0;font-size:1.05rem;line-height:1.7">
          That's exactly what <strong style="color:#fbbf24">AI Image Generation</strong> does! It's like having a super-powered 
          paintbrush that understands your words and turns them into stunning pictures.
        </p>
      </div>

      <!-- How It Works -->
      <div style="background:rgba(255,255,255,0.05);backdrop-filter:blur(12px);border:1px solid rgba(255,255,255,0.1);border-radius:16px;padding:28px;margin-bottom:24px">
        <h2 style="color:#ec4899;margin-top:0"> How Does AI Learn to Paint?</h2>
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;margin:20px 0">
          <div style="background:rgba(251,191,36,0.1);border:1px solid rgba(251,191,36,0.3);border-radius:12px;padding:20px;text-align:center">
            <div style="font-size:2.5rem;margin-bottom:8px"></div>
            <h3 style="color:#fbbf24;margin:0 0 8px 0">Step 1: Study</h3>
            <p style="color:#cbd5e1;font-size:0.9rem;margin:0">AI looks at <strong>millions</strong> of pictures  cats, sunsets, castles, galaxies  and learns patterns!</p>
          </div>
          <div style="background:rgba(236,72,153,0.1);border:1px solid rgba(236,72,153,0.3);border-radius:12px;padding:20px;text-align:center">
            <div style="font-size:2.5rem;margin-bottom:8px"></div>
            <h3 style="color:#ec4899;margin:0 0 8px 0">Step 2: Learn Patterns</h3>
            <p style="color:#cbd5e1;font-size:0.9rem;margin:0">It figures out: "Okay, cats have pointy ears, fur, and whiskers!" It learns what things <em>look like</em>.</p>
          </div>
          <div style="background:rgba(139,92,246,0.1);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:20px;text-align:center">
            <div style="font-size:2.5rem;margin-bottom:8px"></div>
            <h3 style="color:#a78bfa;margin:0 0 8px 0">Step 3: Create!</h3>
            <p style="color:#cbd5e1;font-size:0.9rem;margin:0">When you give it words, it <strong>combines everything it learned</strong> to make a brand new image!</p>
          </div>
        </div>
        <div style="background:rgba(6,182,212,0.1);border:1px solid rgba(6,182,212,0.3);border-radius:12px;padding:16px;text-align:center;margin-top:16px">
          <p style="color:#67e8f9;margin:0;font-size:1rem">
             <strong>Fun Fact:</strong> AI doesn't copy existing images  it creates <em>brand new ones</em> that never existed before! It's like how YOU can imagine a purple elephant even though you've never seen one! 
          </p>
        </div>
      </div>

      <!-- The AI Art Pipeline -->
      <div style="background:rgba(255,255,255,0.05);backdrop-filter:blur(12px);border:1px solid rgba(255,255,255,0.1);border-radius:16px;padding:28px;margin-bottom:24px">
        <h2 style="color:#fbbf24;margin-top:0"> The AI Art Pipeline</h2>
        <div style="display:flex;align-items:center;justify-content:center;flex-wrap:wrap;gap:12px;margin:20px 0">
          <div style="background:linear-gradient(135deg,#fbbf24,#f59e0b);border-radius:12px;padding:16px 24px;text-align:center;min-width:120px">
            <div style="font-size:1.8rem"></div>
            <div style="color:#1a1a2e;font-weight:bold;font-size:0.9rem">YOUR WORDS</div>
          </div>
          <div style="font-size:1.5rem;color:#fbbf24"></div>
          <div style="background:linear-gradient(135deg,#ec4899,#be185d);border-radius:12px;padding:16px 24px;text-align:center;min-width:120px">
            <div style="font-size:1.8rem"></div>
            <div style="color:white;font-weight:bold;font-size:0.9rem">AI BRAIN</div>
          </div>
          <div style="font-size:1.5rem;color:#ec4899"></div>
          <div style="background:linear-gradient(135deg,#8b5cf6,#6d28d9);border-radius:12px;padding:16px 24px;text-align:center;min-width:120px">
            <div style="font-size:1.8rem"></div>
            <div style="color:white;font-weight:bold;font-size:0.9rem">MAGIC!</div>
          </div>
          <div style="font-size:1.5rem;color:#8b5cf6"></div>
          <div style="background:linear-gradient(135deg,#06b6d4,#0891b2);border-radius:12px;padding:16px 24px;text-align:center;min-width:120px">
            <div style="font-size:1.8rem"></div>
            <div style="color:white;font-weight:bold;font-size:0.9rem">YOUR ART!</div>
          </div>
        </div>
      </div>

      <!-- Drag & Drop Activity -->
      <div id="ch1-activity" style="background:rgba(255,255,255,0.05);backdrop-filter:blur(12px);border:1px solid rgba(251,191,36,0.3);border-radius:16px;padding:28px;margin-bottom:24px">
        <h2 style="color:#fbbf24;margin-top:0"> Activity: Match the AI Art Concept!</h2>
        <p style="color:#94a3b8;margin-bottom:20px">Drag each term to its correct description!</p>
        
        <div style="display:flex;flex-wrap:wrap;gap:12px;margin-bottom:24px;justify-content:center" id="ch1-drag-container">
          <div class="drag-item" draggable="true" data-id="1" data-value="prompt" style="background:linear-gradient(135deg,#fbbf24,#f59e0b);color:#1a1a2e;padding:12px 20px;border-radius:10px;cursor:grab;font-weight:bold;font-size:0.95rem"> Prompt</div>
          <div class="drag-item" draggable="true" data-id="2" data-value="training" style="background:linear-gradient(135deg,#ec4899,#be185d);color:white;padding:12px 20px;border-radius:10px;cursor:grab;font-weight:bold;font-size:0.95rem"> Training Data</div>
          <div class="drag-item" draggable="true" data-id="3" data-value="neural" style="background:linear-gradient(135deg,#8b5cf6,#6d28d9);color:white;padding:12px 20px;border-radius:10px;cursor:grab;font-weight:bold;font-size:0.95rem"> Neural Network</div>
          <div class="drag-item" draggable="true" data-id="4" data-value="output" style="background:linear-gradient(135deg,#06b6d4,#0891b2);color:white;padding:12px 20px;border-radius:10px;cursor:grab;font-weight:bold;font-size:0.95rem"> Generated Image</div>
        </div>

        <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px">
          <div class="drag-zone" data-accept="prompt" style="background:rgba(251,191,36,0.08);border:2px dashed rgba(251,191,36,0.4);border-radius:12px;padding:20px;min-height:70px;text-align:center;transition:all 0.3s">
            <p style="color:#94a3b8;margin:0;font-size:0.9rem">The words you type to tell AI what to create</p>
          </div>
          <div class="drag-zone" data-accept="training" style="background:rgba(236,72,153,0.08);border:2px dashed rgba(236,72,153,0.4);border-radius:12px;padding:20px;min-height:70px;text-align:center;transition:all 0.3s">
            <p style="color:#94a3b8;margin:0;font-size:0.9rem">Millions of images AI studied to learn</p>
          </div>
          <div class="drag-zone" data-accept="neural" style="background:rgba(139,92,246,0.08);border:2px dashed rgba(139,92,246,0.4);border-radius:12px;padding:20px;min-height:70px;text-align:center;transition:all 0.3s">
            <p style="color:#94a3b8;margin:0;font-size:0.9rem">The AI's "brain" that processes everything</p>
          </div>
          <div class="drag-zone" data-accept="output" style="background:rgba(6,182,212,0.08);border:2px dashed rgba(6,182,212,0.4);border-radius:12px;padding:20px;min-height:70px;text-align:center;transition:all 0.3s">
            <p style="color:#94a3b8;margin:0;font-size:0.9rem">The final picture AI creates for you</p>
          </div>
        </div>
      </div>

      <!-- Quiz -->
      <div id="ch1-quiz" style="background:rgba(255,255,255,0.05);backdrop-filter:blur(12px);border:1px solid rgba(236,72,153,0.3);border-radius:16px;padding:28px;margin-bottom:24px">
        <h2 style="color:#ec4899;margin-top:0"> Quiz Time!</h2>
        <p style="color:#e2e8f0;font-size:1.05rem;margin-bottom:20px">How does AI create images?</p>
        <div style="display:grid;gap:12px" id="ch1-quiz-options">
          <button onclick="window._ch1Quiz('wrong','Not quite! AI creates NEW images, it doesn\\'t just copy.')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.2);border-radius:12px;padding:16px;color:#e2e8f0;cursor:pointer;text-align:left;font-size:1rem;transition:all 0.3s">
            A) It copies images from the internet 
          </button>
          <button onclick="window._ch1Quiz('correct',' Exactly! AI learns patterns and creates new images!')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.2);border-radius:12px;padding:16px;color:#e2e8f0;cursor:pointer;text-align:left;font-size:1rem;transition:all 0.3s">
            B) It learns patterns from millions of images, then creates new ones 
          </button>
          <button onclick="window._ch1Quiz('wrong','Not quite! AI uses smart algorithms, not random pixels.')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.2);border-radius:12px;padding:16px;color:#e2e8f0;cursor:pointer;text-align:left;font-size:1rem;transition:all 0.3s">
            C) It randomly puts pixels together 
          </button>
          <button onclick="window._ch1Quiz('wrong','Nope! A human artist didn\\'t paint it  the AI generated it!')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.2);border-radius:12px;padding:16px;color:#e2e8f0;cursor:pointer;text-align:left;font-size:1rem;transition:all 0.3s">
            D) A human artist paints it behind the scenes 
          </button>
        </div>
        <div id="ch1-quiz-feedback" style="margin-top:16px"></div>
      </div>

      <!-- Complete Button -->
      <div style="text-align:center;margin-top:32px">
        <button onclick="window.addPoints(25);window.completeChapter('aiart',0)" style="background:linear-gradient(135deg,#fbbf24,#ec4899);color:#1a1a2e;border:none;border-radius:14px;padding:18px 48px;font-size:1.2rem;font-weight:bold;cursor:pointer;transition:transform 0.2s;box-shadow:0 4px 20px rgba(251,191,36,0.3)">
           Complete Chapter 1  Let's Go!
        </button>
      </div>
    `,window._ch1Quiz=function(a,o){const l=document.getElementById("ch1-quiz-feedback");a==="correct"?(l.innerHTML='<div style="background:rgba(34,197,94,0.15);border:1px solid rgba(34,197,94,0.4);border-radius:12px;padding:16px;color:#4ade80;font-size:1rem"> '+o+"</div>",window.addPoints(25)):l.innerHTML='<div style="background:rgba(239,68,68,0.15);border:1px solid rgba(239,68,68,0.4);border-radius:12px;padding:16px;color:#f87171;font-size:1rem"> '+o+"</div>"},typeof ce=="function"&&ce()},function(r){r.innerHTML=`
      <img src="./infographics/aiart-ch2.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="The Magic of Prompts">

      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.2rem;margin:0;background:linear-gradient(135deg,#fbbf24,#ec4899);-webkit-background-clip:text;-webkit-text-fill-color:transparent">
           The Magic of Prompts
        </h1>
        <p style="color:#94a3b8;font-size:1.1rem;margin-top:8px">Your words are the magic spell that creates art!</p>
      </div>

      <div style="background:rgba(255,255,255,0.05);backdrop-filter:blur(12px);border:1px solid rgba(255,255,255,0.1);border-radius:16px;padding:28px;margin-bottom:24px">
        <h2 style="color:#fbbf24;margin-top:0"> What's a Prompt?</h2>
        <p style="color:#e2e8f0;font-size:1.05rem;line-height:1.7">
          A <strong style="color:#ec4899">prompt</strong> is a set of words you give to the AI  like a magic spell!  
          The better your spell, the more amazing your art will be.
        </p>
        <div style="background:rgba(251,191,36,0.1);border-left:4px solid #fbbf24;border-radius:0 12px 12px 0;padding:16px 20px;margin:16px 0">
          <p style="color:#fbbf24;font-weight:bold;margin:0 0 4px 0"> Think of it like ordering food:</p>
          <p style="color:#cbd5e1;margin:0">"Food"  you get... something <br>
          "A warm chocolate brownie with vanilla ice cream and rainbow sprinkles"  DELICIOUS! </p>
        </div>
      </div>

      <!-- The Prompt Formula -->
      <div style="background:rgba(255,255,255,0.05);backdrop-filter:blur(12px);border:1px solid rgba(255,255,255,0.1);border-radius:16px;padding:28px;margin-bottom:24px">
        <h2 style="color:#ec4899;margin-top:0"> The Secret Prompt Formula</h2>
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:16px;margin:20px 0">
          <div style="background:rgba(251,191,36,0.1);border:1px solid rgba(251,191,36,0.3);border-radius:12px;padding:20px;text-align:center">
            <div style="font-size:2.5rem;margin-bottom:8px"></div>
            <h3 style="color:#fbbf24;margin:0 0 8px 0">Subject</h3>
            <p style="color:#cbd5e1;font-size:0.9rem;margin:0"><em>What</em> do you want?<br>"A dragon", "A castle"</p>
          </div>
          <div style="background:rgba(236,72,153,0.1);border:1px solid rgba(236,72,153,0.3);border-radius:12px;padding:20px;text-align:center">
            <div style="font-size:2.5rem;margin-bottom:8px"></div>
            <h3 style="color:#ec4899;margin:0 0 8px 0">Style</h3>
            <p style="color:#cbd5e1;font-size:0.9rem;margin:0"><em>How</em> should it look?<br>"Watercolor", "Pixel art"</p>
          </div>
          <div style="background:rgba(139,92,246,0.1);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:20px;text-align:center">
            <div style="font-size:2.5rem;margin-bottom:8px"></div>
            <h3 style="color:#a78bfa;margin:0 0 8px 0">Details</h3>
            <p style="color:#cbd5e1;font-size:0.9rem;margin:0"><em>What extras?</em><br>"Golden scales, glowing eyes"</p>
          </div>
          <div style="background:rgba(6,182,212,0.1);border:1px solid rgba(6,182,212,0.3);border-radius:12px;padding:20px;text-align:center">
            <div style="font-size:2.5rem;margin-bottom:8px"></div>
            <h3 style="color:#67e8f9;margin:0 0 8px 0">Mood</h3>
            <p style="color:#cbd5e1;font-size:0.9rem;margin:0"><em>What feeling?</em><br>"Magical", "Spooky"</p>
          </div>
        </div>

        <!-- Good vs Bad Examples -->
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-top:20px">
          <div style="background:rgba(239,68,68,0.1);border:1px solid rgba(239,68,68,0.3);border-radius:12px;padding:20px">
            <h3 style="color:#f87171;margin:0 0 8px 0"> Weak Prompt</h3>
            <p style="color:#cbd5e1;font-size:0.95rem;margin:0;font-style:italic">"a cat"</p>
            <p style="color:#94a3b8;font-size:0.85rem;margin:8px 0 0 0">Boring! Too vague. You'll get a basic cat.</p>
          </div>
          <div style="background:rgba(34,197,94,0.1);border:1px solid rgba(34,197,94,0.3);border-radius:12px;padding:20px">
            <h3 style="color:#4ade80;margin:0 0 8px 0"> Power Prompt</h3>
            <p style="color:#cbd5e1;font-size:0.95rem;margin:0;font-style:italic">"A fluffy orange cat wearing a wizard hat, sitting on a stack of ancient books, magical sparkles, watercolor painting style, cozy library background"</p>
            <p style="color:#94a3b8;font-size:0.85rem;margin:8px 0 0 0">WOW! Specific + detailed = amazing art! </p>
          </div>
        </div>
      </div>

      <!-- Drag & Drop: Build a Prompt -->
      <div id="ch2-activity" style="background:rgba(255,255,255,0.05);backdrop-filter:blur(12px);border:1px solid rgba(251,191,36,0.3);border-radius:16px;padding:28px;margin-bottom:24px">
        <h2 style="color:#fbbf24;margin-top:0"> Activity: Sort the Prompt Parts!</h2>
        <p style="color:#94a3b8;margin-bottom:20px">Drag each part to the correct prompt category!</p>
        
        <div style="display:flex;flex-wrap:wrap;gap:12px;margin-bottom:24px;justify-content:center">
          <div class="drag-item" draggable="true" data-id="1" data-value="subject" style="background:linear-gradient(135deg,#fbbf24,#f59e0b);color:#1a1a2e;padding:12px 20px;border-radius:10px;cursor:grab;font-weight:bold"> A fire-breathing dragon</div>
          <div class="drag-item" draggable="true" data-id="2" data-value="style" style="background:linear-gradient(135deg,#ec4899,#be185d);color:white;padding:12px 20px;border-radius:10px;cursor:grab;font-weight:bold"> In pixel art style</div>
          <div class="drag-item" draggable="true" data-id="3" data-value="details" style="background:linear-gradient(135deg,#8b5cf6,#6d28d9);color:white;padding:12px 20px;border-radius:10px;cursor:grab;font-weight:bold"> With rainbow wings</div>
          <div class="drag-item" draggable="true" data-id="4" data-value="mood" style="background:linear-gradient(135deg,#06b6d4,#0891b2);color:white;padding:12px 20px;border-radius:10px;cursor:grab;font-weight:bold"> Epic and heroic feeling</div>
        </div>

        <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px">
          <div class="drag-zone" data-accept="subject" style="background:rgba(251,191,36,0.08);border:2px dashed rgba(251,191,36,0.4);border-radius:12px;padding:20px;min-height:70px;text-align:center">
            <p style="color:#fbbf24;margin:0;font-weight:bold"> Subject</p>
          </div>
          <div class="drag-zone" data-accept="style" style="background:rgba(236,72,153,0.08);border:2px dashed rgba(236,72,153,0.4);border-radius:12px;padding:20px;min-height:70px;text-align:center">
            <p style="color:#ec4899;margin:0;font-weight:bold"> Style</p>
          </div>
          <div class="drag-zone" data-accept="details" style="background:rgba(139,92,246,0.08);border:2px dashed rgba(139,92,246,0.4);border-radius:12px;padding:20px;min-height:70px;text-align:center">
            <p style="color:#a78bfa;margin:0;font-weight:bold"> Details</p>
          </div>
          <div class="drag-zone" data-accept="mood" style="background:rgba(6,182,212,0.08);border:2px dashed rgba(6,182,212,0.4);border-radius:12px;padding:20px;min-height:70px;text-align:center">
            <p style="color:#67e8f9;margin:0;font-weight:bold"> Mood</p>
          </div>
        </div>
      </div>

      <!-- Quiz -->
      <div id="ch2-quiz" style="background:rgba(255,255,255,0.05);backdrop-filter:blur(12px);border:1px solid rgba(236,72,153,0.3);border-radius:16px;padding:28px;margin-bottom:24px">
        <h2 style="color:#ec4899;margin-top:0"> Quiz Time!</h2>
        <p style="color:#e2e8f0;font-size:1.05rem;margin-bottom:20px">Which prompt will create the BEST art?</p>
        <div style="display:grid;gap:12px" id="ch2-quiz-options">
          <button onclick="window._ch2Quiz('wrong','Too vague! Add more details for better art.')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.2);border-radius:12px;padding:16px;color:#e2e8f0;cursor:pointer;text-align:left;font-size:1rem">
            A) "A house" 
          </button>
          <button onclick="window._ch2Quiz('wrong','Better, but still missing style and mood!')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.2);border-radius:12px;padding:16px;color:#e2e8f0;cursor:pointer;text-align:left;font-size:1rem">
            B) "A big house with a garden" 
          </button>
          <button onclick="window._ch2Quiz('correct',' Perfect! Subject + Style + Details + Mood = AMAZING prompt!')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.2);border-radius:12px;padding:16px;color:#e2e8f0;cursor:pointer;text-align:left;font-size:1rem">
            C) "A cozy treehouse in an enchanted forest, fairy lights, watercolor, magical twilight" 
          </button>
          <button onclick="window._ch2Quiz('wrong','Whoa  too chaotic! Keep it focused and descriptive.')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.2);border-radius:12px;padding:16px;color:#e2e8f0;cursor:pointer;text-align:left;font-size:1rem">
            D) "House cat dog rainbow pizza flying car" 
          </button>
        </div>
        <div id="ch2-quiz-feedback" style="margin-top:16px"></div>
      </div>

      <div style="text-align:center;margin-top:32px">
        <button onclick="window.addPoints(25);window.completeChapter('aiart',1)" style="background:linear-gradient(135deg,#fbbf24,#ec4899);color:#1a1a2e;border:none;border-radius:14px;padding:18px 48px;font-size:1.2rem;font-weight:bold;cursor:pointer;box-shadow:0 4px 20px rgba(251,191,36,0.3)">
           Complete Chapter 2  Prompt Master!
        </button>
      </div>
    `,window._ch2Quiz=function(a,o){const l=document.getElementById("ch2-quiz-feedback");a==="correct"?(l.innerHTML='<div style="background:rgba(34,197,94,0.15);border:1px solid rgba(34,197,94,0.4);border-radius:12px;padding:16px;color:#4ade80"> '+o+"</div>",window.addPoints(25)):l.innerHTML='<div style="background:rgba(239,68,68,0.15);border:1px solid rgba(239,68,68,0.4);border-radius:12px;padding:16px;color:#f87171"> '+o+"</div>"},typeof ce=="function"&&ce()},function(r){r.innerHTML=`
      <img src="./infographics/aiart-ch3.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="Art Styles & Tools">

      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.2rem;margin:0;background:linear-gradient(135deg,#fbbf24,#ec4899);-webkit-background-clip:text;-webkit-text-fill-color:transparent">
           Art Styles & Tools
        </h1>
        <p style="color:#94a3b8;font-size:1.1rem;margin-top:8px">Explore the incredible world of AI art styles!</p>
      </div>

      <!-- Art Styles Gallery -->
      <div style="background:rgba(255,255,255,0.05);backdrop-filter:blur(12px);border:1px solid rgba(255,255,255,0.1);border-radius:16px;padding:28px;margin-bottom:24px">
        <h2 style="color:#fbbf24;margin-top:0"> Art Style Gallery</h2>
        <p style="color:#e2e8f0;line-height:1.7">AI can paint in ANY style! Here are the most popular ones:</p>
        
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:16px;margin:20px 0">
          <div style="background:linear-gradient(135deg,rgba(251,191,36,0.15),rgba(251,191,36,0.05));border:1px solid rgba(251,191,36,0.3);border-radius:14px;padding:20px;text-align:center">
            <div style="font-size:3rem;margin-bottom:8px"></div>
            <h3 style="color:#fbbf24;margin:0 0 6px 0;font-size:1rem">Pixel Art</h3>
            <p style="color:#94a3b8;font-size:0.8rem;margin:0">Retro game look with tiny squares</p>
          </div>
          <div style="background:linear-gradient(135deg,rgba(236,72,153,0.15),rgba(236,72,153,0.05));border:1px solid rgba(236,72,153,0.3);border-radius:14px;padding:20px;text-align:center">
            <div style="font-size:3rem;margin-bottom:8px"></div>
            <h3 style="color:#ec4899;margin:0 0 6px 0;font-size:1rem">Watercolor</h3>
            <p style="color:#94a3b8;font-size:0.8rem;margin:0">Soft, flowy, dreamy colors</p>
          </div>
          <div style="background:linear-gradient(135deg,rgba(139,92,246,0.15),rgba(139,92,246,0.05));border:1px solid rgba(139,92,246,0.3);border-radius:14px;padding:20px;text-align:center">
            <div style="font-size:3rem;margin-bottom:8px"></div>
            <h3 style="color:#a78bfa;margin:0 0 6px 0;font-size:1rem">Anime</h3>
            <p style="color:#94a3b8;font-size:0.8rem;margin:0">Japanese animation style, big eyes</p>
          </div>
          <div style="background:linear-gradient(135deg,rgba(6,182,212,0.15),rgba(6,182,212,0.05));border:1px solid rgba(6,182,212,0.3);border-radius:14px;padding:20px;text-align:center">
            <div style="font-size:3rem;margin-bottom:8px"></div>
            <h3 style="color:#67e8f9;margin:0 0 6px 0;font-size:1rem">3D Render</h3>
            <p style="color:#94a3b8;font-size:0.8rem;margin:0">Like Pixar movies, smooth and shiny</p>
          </div>
          <div style="background:linear-gradient(135deg,rgba(34,197,94,0.15),rgba(34,197,94,0.05));border:1px solid rgba(34,197,94,0.3);border-radius:14px;padding:20px;text-align:center">
            <div style="font-size:3rem;margin-bottom:8px"></div>
            <h3 style="color:#4ade80;margin:0 0 6px 0;font-size:1rem">Oil Painting</h3>
            <p style="color:#94a3b8;font-size:0.8rem;margin:0">Classic museum look, thick brush strokes</p>
          </div>
          <div style="background:linear-gradient(135deg,rgba(244,114,182,0.15),rgba(244,114,182,0.05));border:1px solid rgba(244,114,182,0.3);border-radius:14px;padding:20px;text-align:center">
            <div style="font-size:3rem;margin-bottom:8px"></div>
            <h3 style="color:#f472b6;margin:0 0 6px 0;font-size:1rem">Pencil Sketch</h3>
            <p style="color:#94a3b8;font-size:0.8rem;margin:0">Hand-drawn look, clean lines</p>
          </div>
        </div>
      </div>

      <!-- AI Art Tools -->
      <div style="background:rgba(255,255,255,0.05);backdrop-filter:blur(12px);border:1px solid rgba(255,255,255,0.1);border-radius:16px;padding:28px;margin-bottom:24px">
        <h2 style="color:#ec4899;margin-top:0"> Popular AI Art Tools</h2>
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:16px;margin:16px 0">
          <div style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.15);border-radius:12px;padding:20px">
            <h3 style="color:#fbbf24;margin:0 0 8px 0"> DALLE</h3>
            <p style="color:#cbd5e1;font-size:0.9rem;margin:0">Made by OpenAI. Super easy to use! Great for beginners. Type words  get art!</p>
          </div>
          <div style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.15);border-radius:12px;padding:20px">
            <h3 style="color:#ec4899;margin:0 0 8px 0"> Midjourney</h3>
            <p style="color:#cbd5e1;font-size:0.9rem;margin:0">Creates STUNNING realistic art. Used by professional artists. Works through Discord!</p>
          </div>
          <div style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.15);border-radius:12px;padding:20px">
            <h3 style="color:#a78bfa;margin:0 0 8px 0"> Stable Diffusion</h3>
            <p style="color:#cbd5e1;font-size:0.9rem;margin:0">Free & open source! Runs on your computer. Most customizable for tech-savvy artists.</p>
          </div>
        </div>
      </div>

      <!-- Drag & Drop: Match Style to Description -->
      <div id="ch3-activity" style="background:rgba(255,255,255,0.05);backdrop-filter:blur(12px);border:1px solid rgba(251,191,36,0.3);border-radius:16px;padding:28px;margin-bottom:24px">
        <h2 style="color:#fbbf24;margin-top:0"> Activity: Match the Art Style!</h2>
        <p style="color:#94a3b8;margin-bottom:20px">Drag each style to its description!</p>
        
        <div style="display:flex;flex-wrap:wrap;gap:12px;margin-bottom:24px;justify-content:center">
          <div class="drag-item" draggable="true" data-id="1" data-value="pixel" style="background:linear-gradient(135deg,#fbbf24,#f59e0b);color:#1a1a2e;padding:12px 20px;border-radius:10px;cursor:grab;font-weight:bold"> Pixel Art</div>
          <div class="drag-item" draggable="true" data-id="2" data-value="anime" style="background:linear-gradient(135deg,#ec4899,#be185d);color:white;padding:12px 20px;border-radius:10px;cursor:grab;font-weight:bold"> Anime</div>
          <div class="drag-item" draggable="true" data-id="3" data-value="3d" style="background:linear-gradient(135deg,#8b5cf6,#6d28d9);color:white;padding:12px 20px;border-radius:10px;cursor:grab;font-weight:bold"> 3D Render</div>
        </div>

        <div style="display:grid;gap:16px">
          <div class="drag-zone" data-accept="pixel" style="background:rgba(251,191,36,0.08);border:2px dashed rgba(251,191,36,0.4);border-radius:12px;padding:20px;text-align:center">
            <p style="color:#94a3b8;margin:0">Tiny squares make retro video game graphics </p>
          </div>
          <div class="drag-zone" data-accept="anime" style="background:rgba(236,72,153,0.08);border:2px dashed rgba(236,72,153,0.4);border-radius:12px;padding:20px;text-align:center">
            <p style="color:#94a3b8;margin:0">Big expressive eyes, colorful hair, Japanese style </p>
          </div>
          <div class="drag-zone" data-accept="3d" style="background:rgba(139,92,246,0.08);border:2px dashed rgba(139,92,246,0.4);border-radius:12px;padding:20px;text-align:center">
            <p style="color:#94a3b8;margin:0">Smooth, shiny, looks like a Pixar movie </p>
          </div>
        </div>
      </div>

      <!-- Quiz -->
      <div id="ch3-quiz" style="background:rgba(255,255,255,0.05);backdrop-filter:blur(12px);border:1px solid rgba(236,72,153,0.3);border-radius:16px;padding:28px;margin-bottom:24px">
        <h2 style="color:#ec4899;margin-top:0"> Quiz Time!</h2>
        <p style="color:#e2e8f0;font-size:1.05rem;margin-bottom:20px">Which AI tool is FREE and open source?</p>
        <div style="display:grid;gap:12px">
          <button onclick="window._ch3Quiz('wrong','DALLE is great but it\\'s made by OpenAI and has usage limits!')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.2);border-radius:12px;padding:16px;color:#e2e8f0;cursor:pointer;text-align:left;font-size:1rem">A) DALLE </button>
          <button onclick="window._ch3Quiz('wrong','Midjourney creates amazing art but requires a subscription!')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.2);border-radius:12px;padding:16px;color:#e2e8f0;cursor:pointer;text-align:left;font-size:1rem">B) Midjourney </button>
          <button onclick="window._ch3Quiz('correct',' Yes! Stable Diffusion is free and open source  anyone can use it!')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.2);border-radius:12px;padding:16px;color:#e2e8f0;cursor:pointer;text-align:left;font-size:1rem">C) Stable Diffusion </button>
          <button onclick="window._ch3Quiz('wrong','Photoshop is a paid editing tool, not an AI art generator!')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.2);border-radius:12px;padding:16px;color:#e2e8f0;cursor:pointer;text-align:left;font-size:1rem">D) Photoshop </button>
        </div>
        <div id="ch3-quiz-feedback" style="margin-top:16px"></div>
      </div>

      <div style="text-align:center;margin-top:32px">
        <button onclick="window.addPoints(25);window.completeChapter('aiart',2)" style="background:linear-gradient(135deg,#fbbf24,#ec4899);color:#1a1a2e;border:none;border-radius:14px;padding:18px 48px;font-size:1.2rem;font-weight:bold;cursor:pointer;box-shadow:0 4px 20px rgba(251,191,36,0.3)">
           Complete Chapter 3  Style Expert!
        </button>
      </div>
    `,window._ch3Quiz=function(a,o){const l=document.getElementById("ch3-quiz-feedback");l.innerHTML=a==="correct"?'<div style="background:rgba(34,197,94,0.15);border:1px solid rgba(34,197,94,0.4);border-radius:12px;padding:16px;color:#4ade80"> '+o+"</div>":'<div style="background:rgba(239,68,68,0.15);border:1px solid rgba(239,68,68,0.4);border-radius:12px;padding:16px;color:#f87171"> '+o+"</div>",a==="correct"&&window.addPoints(25)},typeof ce=="function"&&ce()},function(r){r.innerHTML=`
      <img src="./infographics/aiart-ch4.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="Create & Share Your Art">

      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.2rem;margin:0;background:linear-gradient(135deg,#fbbf24,#ec4899);-webkit-background-clip:text;-webkit-text-fill-color:transparent">
           Create & Share Your Art
        </h1>
        <p style="color:#94a3b8;font-size:1.1rem;margin-top:8px">Time to make your first AI masterpiece!</p>
      </div>

      <!-- Step by Step -->
      <div style="background:rgba(255,255,255,0.05);backdrop-filter:blur(12px);border:1px solid rgba(255,255,255,0.1);border-radius:16px;padding:28px;margin-bottom:24px">
        <h2 style="color:#fbbf24;margin-top:0"> Your Art Creation Workflow</h2>
        <div style="position:relative;margin:20px 0">
          <div style="display:grid;gap:20px">
            <div style="display:flex;align-items:flex-start;gap:16px">
              <div style="background:linear-gradient(135deg,#fbbf24,#f59e0b);color:#1a1a2e;width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:bold;flex-shrink:0">1</div>
              <div><h3 style="color:#fbbf24;margin:0 0 4px 0">Think of Your Idea </h3><p style="color:#cbd5e1;margin:0">What scene do you want to create? Close your eyes and imagine it!</p></div>
            </div>
            <div style="display:flex;align-items:flex-start;gap:16px">
              <div style="background:linear-gradient(135deg,#ec4899,#be185d);color:white;width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:bold;flex-shrink:0">2</div>
              <div><h3 style="color:#ec4899;margin:0 0 4px 0">Write Your Prompt </h3><p style="color:#cbd5e1;margin:0">Use the formula: Subject + Style + Details + Mood</p></div>
            </div>
            <div style="display:flex;align-items:flex-start;gap:16px">
              <div style="background:linear-gradient(135deg,#8b5cf6,#6d28d9);color:white;width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:bold;flex-shrink:0">3</div>
              <div><h3 style="color:#a78bfa;margin:0 0 4px 0">Generate & Refine </h3><p style="color:#cbd5e1;margin:0">Don't love it? Tweak your prompt! Add or remove words. Try different styles!</p></div>
            </div>
            <div style="display:flex;align-items:flex-start;gap:16px">
              <div style="background:linear-gradient(135deg,#06b6d4,#0891b2);color:white;width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:bold;flex-shrink:0">4</div>
              <div><h3 style="color:#67e8f9;margin:0 0 4px 0">Share Your Masterpiece </h3><p style="color:#cbd5e1;margin:0">Show friends, family, or post in art communities!</p></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Sharing Safety -->
      <div style="background:rgba(255,255,255,0.05);backdrop-filter:blur(12px);border:1px solid rgba(255,255,255,0.1);border-radius:16px;padding:28px;margin-bottom:24px">
        <h2 style="color:#ec4899;margin-top:0"> Sharing Safely Online</h2>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;margin:16px 0">
          <div style="background:rgba(34,197,94,0.1);border:1px solid rgba(34,197,94,0.3);border-radius:12px;padding:20px">
            <h3 style="color:#4ade80;margin:0 0 12px 0"> DO</h3>
            <ul style="color:#cbd5e1;font-size:0.9rem;margin:0;padding-left:16px;line-height:2">
              <li>Share with family & friends first</li>
              <li>Use a screen name (not real name)</li>
              <li>Credit the AI tool you used</li>
              <li>Ask a parent before posting online</li>
            </ul>
          </div>
          <div style="background:rgba(239,68,68,0.1);border:1px solid rgba(239,68,68,0.3);border-radius:12px;padding:20px">
            <h3 style="color:#f87171;margin:0 0 12px 0"> DON'T</h3>
            <ul style="color:#cbd5e1;font-size:0.9rem;margin:0;padding-left:16px;line-height:2">
              <li>Share personal info with art</li>
              <li>Claim AI art is hand-drawn</li>
              <li>Generate harmful or mean images</li>
              <li>Copy other people's exact prompts</li>
            </ul>
          </div>
        </div>
      </div>

      <!-- Drag & Drop: Sharing Steps -->
      <div id="ch4-activity" style="background:rgba(255,255,255,0.05);backdrop-filter:blur(12px);border:1px solid rgba(251,191,36,0.3);border-radius:16px;padding:28px;margin-bottom:24px">
        <h2 style="color:#fbbf24;margin-top:0"> Activity: Safe or Unsafe Sharing?</h2>
        <p style="color:#94a3b8;margin-bottom:20px">Drag each action to Safe  or Unsafe !</p>
        
        <div style="display:flex;flex-wrap:wrap;gap:12px;margin-bottom:24px;justify-content:center">
          <div class="drag-item" draggable="true" data-id="1" data-value="safe" style="background:linear-gradient(135deg,#fbbf24,#f59e0b);color:#1a1a2e;padding:10px 16px;border-radius:10px;cursor:grab;font-weight:bold;font-size:0.9rem">Using a screen name</div>
          <div class="drag-item" draggable="true" data-id="2" data-value="unsafe" style="background:linear-gradient(135deg,#ec4899,#be185d);color:white;padding:10px 16px;border-radius:10px;cursor:grab;font-weight:bold;font-size:0.9rem">Sharing your address</div>
          <div class="drag-item" draggable="true" data-id="3" data-value="safe" style="background:linear-gradient(135deg,#8b5cf6,#6d28d9);color:white;padding:10px 16px;border-radius:10px;cursor:grab;font-weight:bold;font-size:0.9rem">Crediting the AI tool</div>
          <div class="drag-item" draggable="true" data-id="4" data-value="unsafe" style="background:linear-gradient(135deg,#06b6d4,#0891b2);color:white;padding:10px 16px;border-radius:10px;cursor:grab;font-weight:bold;font-size:0.9rem">Saying AI art is hand-drawn</div>
        </div>

        <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px">
          <div class="drag-zone" data-accept="safe" style="background:rgba(34,197,94,0.08);border:2px dashed rgba(34,197,94,0.4);border-radius:12px;padding:20px;min-height:80px;text-align:center">
            <p style="color:#4ade80;margin:0;font-weight:bold;font-size:1.1rem"> Safe to Do</p>
          </div>
          <div class="drag-zone" data-accept="unsafe" style="background:rgba(239,68,68,0.08);border:2px dashed rgba(239,68,68,0.4);border-radius:12px;padding:20px;min-height:80px;text-align:center">
            <p style="color:#f87171;margin:0;font-weight:bold;font-size:1.1rem"> Unsafe  Avoid!</p>
          </div>
        </div>
      </div>

      <!-- Quiz -->
      <div id="ch4-quiz" style="background:rgba(255,255,255,0.05);backdrop-filter:blur(12px);border:1px solid rgba(236,72,153,0.3);border-radius:16px;padding:28px;margin-bottom:24px">
        <h2 style="color:#ec4899;margin-top:0"> Quiz Time!</h2>
        <p style="color:#e2e8f0;font-size:1.05rem;margin-bottom:20px">What should you do FIRST when your AI art doesn't look right?</p>
        <div style="display:grid;gap:12px">
          <button onclick="window._ch4Quiz('wrong','Don\\'t give up! You\\'re learning!')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.2);border-radius:12px;padding:16px;color:#e2e8f0;cursor:pointer;text-align:left;font-size:1rem">A) Give up and try tomorrow </button>
          <button onclick="window._ch4Quiz('correct',' Yes! Tweak your prompt  add details, change style, be more specific!')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.2);border-radius:12px;padding:16px;color:#e2e8f0;cursor:pointer;text-align:left;font-size:1rem">B) Tweak your prompt with more details </button>
          <button onclick="window._ch4Quiz('wrong','That\\'s not honest! Always credit AI tools.')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.2);border-radius:12px;padding:16px;color:#e2e8f0;cursor:pointer;text-align:left;font-size:1rem">C) Use someone else's art instead </button>
        </div>
        <div id="ch4-quiz-feedback" style="margin-top:16px"></div>
      </div>

      <div style="text-align:center;margin-top:32px">
        <button onclick="window.addPoints(25);window.completeChapter('aiart',3)" style="background:linear-gradient(135deg,#fbbf24,#ec4899);color:#1a1a2e;border:none;border-radius:14px;padding:18px 48px;font-size:1.2rem;font-weight:bold;cursor:pointer;box-shadow:0 4px 20px rgba(251,191,36,0.3)">
           Complete Chapter 4  Creator!
        </button>
      </div>
    `,window._ch4Quiz=function(a,o){const l=document.getElementById("ch4-quiz-feedback");l.innerHTML=a==="correct"?'<div style="background:rgba(34,197,94,0.15);border:1px solid rgba(34,197,94,0.4);border-radius:12px;padding:16px;color:#4ade80"> '+o+"</div>":'<div style="background:rgba(239,68,68,0.15);border:1px solid rgba(239,68,68,0.4);border-radius:12px;padding:16px;color:#f87171"> '+o+"</div>",a==="correct"&&window.addPoints(25)},typeof ce=="function"&&ce()},function(r){r.innerHTML=`
      <img src="./infographics/aiart-ch5.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="Advanced Prompt Engineering">

      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.2rem;margin:0;background:linear-gradient(135deg,#fbbf24,#ec4899);-webkit-background-clip:text;-webkit-text-fill-color:transparent">
           Advanced Prompt Engineering
        </h1>
        <p style="color:#94a3b8;font-size:1.1rem;margin-top:8px">Level up your prompts with pro techniques!</p>
      </div>

      <!-- Advanced Techniques -->
      <div style="background:rgba(255,255,255,0.05);backdrop-filter:blur(12px);border:1px solid rgba(255,255,255,0.1);border-radius:16px;padding:28px;margin-bottom:24px">
        <h2 style="color:#fbbf24;margin-top:0"> Pro Prompt Superpowers</h2>
        
        <div style="display:grid;gap:20px;margin:20px 0">
          <div style="background:rgba(251,191,36,0.1);border:1px solid rgba(251,191,36,0.3);border-radius:12px;padding:20px">
            <h3 style="color:#fbbf24;margin:0 0 8px 0"> Negative Prompts</h3>
            <p style="color:#cbd5e1;margin:0;font-size:0.95rem">Tell AI what you <strong>DON'T</strong> want! Like saying "no blurry, no extra fingers, no weird faces." It's like telling a chef "no onions please!" </p>
            <div style="background:rgba(0,0,0,0.3);border-radius:8px;padding:12px;margin-top:12px">
              <code style="color:#fbbf24;font-size:0.9rem">Negative: blurry, low quality, deformed, ugly</code>
            </div>
          </div>
          
          <div style="background:rgba(236,72,153,0.1);border:1px solid rgba(236,72,153,0.3);border-radius:12px;padding:20px">
            <h3 style="color:#ec4899;margin:0 0 8px 0"> Prompt Weights</h3>
            <p style="color:#cbd5e1;margin:0;font-size:0.95rem">Make some words MORE important! It's like shouting a word louder. Use (parentheses) or numbers to boost importance.</p>
            <div style="background:rgba(0,0,0,0.3);border-radius:8px;padding:12px;margin-top:12px">
              <code style="color:#ec4899;font-size:0.9rem">"A (magical:1.5) forest with (glowing:1.3) mushrooms"</code>
            </div>
          </div>

          <div style="background:rgba(139,92,246,0.1);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:20px">
            <h3 style="color:#a78bfa;margin:0 0 8px 0"> Aspect Ratios</h3>
            <p style="color:#cbd5e1;margin:0;font-size:0.95rem">Control the shape! Wide for landscapes (16:9), tall for portraits (9:16), square for social media (1:1).</p>
            <div style="display:flex;gap:12px;margin-top:12px;justify-content:center">
              <div style="background:rgba(0,0,0,0.3);border:1px solid #a78bfa;border-radius:4px;width:80px;height:45px;display:flex;align-items:center;justify-content:center;color:#a78bfa;font-size:0.75rem">16:9</div>
              <div style="background:rgba(0,0,0,0.3);border:1px solid #a78bfa;border-radius:4px;width:50px;height:50px;display:flex;align-items:center;justify-content:center;color:#a78bfa;font-size:0.75rem">1:1</div>
              <div style="background:rgba(0,0,0,0.3);border:1px solid #a78bfa;border-radius:4px;width:35px;height:60px;display:flex;align-items:center;justify-content:center;color:#a78bfa;font-size:0.75rem">9:16</div>
            </div>
          </div>

          <div style="background:rgba(6,182,212,0.1);border:1px solid rgba(6,182,212,0.3);border-radius:12px;padding:20px">
            <h3 style="color:#67e8f9;margin:0 0 8px 0"> Seed Numbers</h3>
            <p style="color:#cbd5e1;margin:0;font-size:0.95rem">A seed is like a recipe number. Same seed + same prompt = same image every time! Great for making small changes to the same picture.</p>
          </div>
        </div>
      </div>

      <!-- Drag & Drop -->
      <div id="ch5-activity" style="background:rgba(255,255,255,0.05);backdrop-filter:blur(12px);border:1px solid rgba(251,191,36,0.3);border-radius:16px;padding:28px;margin-bottom:24px">
        <h2 style="color:#fbbf24;margin-top:0"> Activity: Match the Technique!</h2>
        <p style="color:#94a3b8;margin-bottom:20px">Drag each technique to what it does!</p>
        
        <div style="display:flex;flex-wrap:wrap;gap:12px;margin-bottom:24px;justify-content:center">
          <div class="drag-item" draggable="true" data-id="1" data-value="negative" style="background:linear-gradient(135deg,#fbbf24,#f59e0b);color:#1a1a2e;padding:10px 16px;border-radius:10px;cursor:grab;font-weight:bold;font-size:0.9rem"> Negative Prompts</div>
          <div class="drag-item" draggable="true" data-id="2" data-value="weights" style="background:linear-gradient(135deg,#ec4899,#be185d);color:white;padding:10px 16px;border-radius:10px;cursor:grab;font-weight:bold;font-size:0.9rem"> Weights</div>
          <div class="drag-item" draggable="true" data-id="3" data-value="seed" style="background:linear-gradient(135deg,#8b5cf6,#6d28d9);color:white;padding:10px 16px;border-radius:10px;cursor:grab;font-weight:bold;font-size:0.9rem"> Seed Numbers</div>
        </div>

        <div style="display:grid;gap:16px">
          <div class="drag-zone" data-accept="negative" style="background:rgba(251,191,36,0.08);border:2px dashed rgba(251,191,36,0.4);border-radius:12px;padding:20px;text-align:center">
            <p style="color:#94a3b8;margin:0">Tells AI what to AVOID in the image</p>
          </div>
          <div class="drag-zone" data-accept="weights" style="background:rgba(236,72,153,0.08);border:2px dashed rgba(236,72,153,0.4);border-radius:12px;padding:20px;text-align:center">
            <p style="color:#94a3b8;margin:0">Makes certain words MORE important</p>
          </div>
          <div class="drag-zone" data-accept="seed" style="background:rgba(139,92,246,0.08);border:2px dashed rgba(139,92,246,0.4);border-radius:12px;padding:20px;text-align:center">
            <p style="color:#94a3b8;margin:0">Recreates the same image each time</p>
          </div>
        </div>
      </div>

      <!-- Quiz -->
      <div id="ch5-quiz" style="background:rgba(255,255,255,0.05);backdrop-filter:blur(12px);border:1px solid rgba(236,72,153,0.3);border-radius:16px;padding:28px;margin-bottom:24px">
        <h2 style="color:#ec4899;margin-top:0"> Quiz Time!</h2>
        <p style="color:#e2e8f0;font-size:1.05rem;margin-bottom:20px">Your AI image has blurry parts you don't want. What should you use?</p>
        <div style="display:grid;gap:12px">
          <button onclick="window._ch5Quiz('correct',' Exactly! Negative prompts tell AI what to EXCLUDE!')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.2);border-radius:12px;padding:16px;color:#e2e8f0;cursor:pointer;text-align:left;font-size:1rem">A) Add "no blurry" as a negative prompt </button>
          <button onclick="window._ch5Quiz('wrong','Seeds reproduce images, they don\\'t fix blur!')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.2);border-radius:12px;padding:16px;color:#e2e8f0;cursor:pointer;text-align:left;font-size:1rem">B) Change the seed number </button>
          <button onclick="window._ch5Quiz('wrong','That changes the shape, not the quality!')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.2);border-radius:12px;padding:16px;color:#e2e8f0;cursor:pointer;text-align:left;font-size:1rem">C) Make it 16:9 aspect ratio </button>
          <button onclick="window._ch5Quiz('wrong','Deleting the prompt means starting from scratch!')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.2);border-radius:12px;padding:16px;color:#e2e8f0;cursor:pointer;text-align:left;font-size:1rem">D) Delete the whole prompt and start over </button>
        </div>
        <div id="ch5-quiz-feedback" style="margin-top:16px"></div>
      </div>

      <div style="text-align:center;margin-top:32px">
        <button onclick="window.addPoints(25);window.completeChapter('aiart',4)" style="background:linear-gradient(135deg,#fbbf24,#ec4899);color:#1a1a2e;border:none;border-radius:14px;padding:18px 48px;font-size:1.2rem;font-weight:bold;cursor:pointer;box-shadow:0 4px 20px rgba(251,191,36,0.3)">
           Complete Chapter 5  Pro Engineer!
        </button>
      </div>
    `,window._ch5Quiz=function(a,o){const l=document.getElementById("ch5-quiz-feedback");l.innerHTML=a==="correct"?'<div style="background:rgba(34,197,94,0.15);border:1px solid rgba(34,197,94,0.4);border-radius:12px;padding:16px;color:#4ade80"> '+o+"</div>":'<div style="background:rgba(239,68,68,0.15);border:1px solid rgba(239,68,68,0.4);border-radius:12px;padding:16px;color:#f87171"> '+o+"</div>",a==="correct"&&window.addPoints(25)},typeof ce=="function"&&ce()},function(r){r.innerHTML=`
      <img src="./infographics/aiart-ch6.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="AI Art Ethics & Ownership">

      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.2rem;margin:0;background:linear-gradient(135deg,#fbbf24,#ec4899);-webkit-background-clip:text;-webkit-text-fill-color:transparent">
           AI Art Ethics & Ownership
        </h1>
        <p style="color:#94a3b8;font-size:1.1rem;margin-top:8px">Being a responsible AI artist!</p>
      </div>

      <!-- Big Questions -->
      <div style="background:rgba(255,255,255,0.05);backdrop-filter:blur(12px);border:1px solid rgba(255,255,255,0.1);border-radius:16px;padding:28px;margin-bottom:24px">
        <h2 style="color:#fbbf24;margin-top:0"> The Big Questions</h2>
        <p style="color:#e2e8f0;line-height:1.7;font-size:1.05rem">
          AI art is amazing, but it raises some important questions that even grown-ups are still figuring out! Let's explore them together. 
        </p>
        
        <div style="display:grid;gap:16px;margin:20px 0">
          <div style="background:rgba(251,191,36,0.1);border-left:4px solid #fbbf24;border-radius:0 12px 12px 0;padding:20px">
            <h3 style="color:#fbbf24;margin:0 0 8px 0"> Who owns AI art?</h3>
            <p style="color:#cbd5e1;margin:0;font-size:0.95rem">If you wrote the prompt and AI made the image  who's the artist? YOU directed it, like a movie director tells actors what to do!  Most people say: <strong>the prompt writer is the creator</strong>, but always credit the AI tool!</p>
          </div>
          <div style="background:rgba(236,72,153,0.1);border-left:4px solid #ec4899;border-radius:0 12px 12px 0;padding:20px">
            <h3 style="color:#ec4899;margin:0 0 8px 0"> Is AI art "real" art?</h3>
            <p style="color:#cbd5e1;margin:0;font-size:0.95rem">YES!  Photography was questioned too when cameras were invented. AI is a <strong>new tool</strong>, and your creativity is what makes the art special. The ideas come from YOUR brain!</p>
          </div>
          <div style="background:rgba(139,92,246,0.1);border-left:4px solid #8b5cf6;border-radius:0 12px 12px 0;padding:20px">
            <h3 style="color:#a78bfa;margin:0 0 8px 0"> What about human artists?</h3>
            <p style="color:#cbd5e1;margin:0;font-size:0.95rem">AI should be a <strong>helper, not a replacement</strong>! Human artists are amazing. The best approach: learn BOTH traditional art AND AI art. They make each other better! </p>
          </div>
        </div>
      </div>

      <!-- The Ethics Code -->
      <div style="background:rgba(255,255,255,0.05);backdrop-filter:blur(12px);border:1px solid rgba(255,255,255,0.1);border-radius:16px;padding:28px;margin-bottom:24px">
        <h2 style="color:#ec4899;margin-top:0"> The Young AI Artist's Code</h2>
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;margin:16px 0">
          <div style="background:rgba(34,197,94,0.1);border:1px solid rgba(34,197,94,0.3);border-radius:12px;padding:20px;text-align:center">
            <div style="font-size:2.5rem"></div>
            <h3 style="color:#4ade80;margin:8px 0">Always Credit</h3>
            <p style="color:#94a3b8;font-size:0.85rem;margin:0">Say "Made with [AI Tool]" when sharing</p>
          </div>
          <div style="background:rgba(34,197,94,0.1);border:1px solid rgba(34,197,94,0.3);border-radius:12px;padding:20px;text-align:center">
            <div style="font-size:2.5rem"></div>
            <h3 style="color:#4ade80;margin:8px 0">Be Original</h3>
            <p style="color:#94a3b8;font-size:0.85rem;margin:0">Write your OWN prompts, don't just copy</p>
          </div>
          <div style="background:rgba(34,197,94,0.1);border:1px solid rgba(34,197,94,0.3);border-radius:12px;padding:20px;text-align:center">
            <div style="font-size:2.5rem"></div>
            <h3 style="color:#4ade80;margin:8px 0">Respect Artists</h3>
            <p style="color:#94a3b8;font-size:0.85rem;margin:0">Don't try to copy a specific artist's style</p>
          </div>
          <div style="background:rgba(34,197,94,0.1);border:1px solid rgba(34,197,94,0.3);border-radius:12px;padding:20px;text-align:center">
            <div style="font-size:2.5rem"></div>
            <h3 style="color:#4ade80;margin:8px 0">Be Kind</h3>
            <p style="color:#94a3b8;font-size:0.85rem;margin:0">Only create positive, helpful images</p>
          </div>
        </div>
      </div>

      <!-- Drag & Drop -->
      <div id="ch6-activity" style="background:rgba(255,255,255,0.05);backdrop-filter:blur(12px);border:1px solid rgba(251,191,36,0.3);border-radius:16px;padding:28px;margin-bottom:24px">
        <h2 style="color:#fbbf24;margin-top:0"> Activity: Ethical or Not?</h2>
        <p style="color:#94a3b8;margin-bottom:20px">Drag each action to Ethical  or Unethical !</p>
        
        <div style="display:flex;flex-wrap:wrap;gap:12px;margin-bottom:24px;justify-content:center">
          <div class="drag-item" draggable="true" data-id="1" data-value="ethical" style="background:linear-gradient(135deg,#fbbf24,#f59e0b);color:#1a1a2e;padding:10px 16px;border-radius:10px;cursor:grab;font-weight:bold;font-size:0.9rem">Saying "Made with DALLE"</div>
          <div class="drag-item" draggable="true" data-id="2" data-value="unethical" style="background:linear-gradient(135deg,#ec4899,#be185d);color:white;padding:10px 16px;border-radius:10px;cursor:grab;font-weight:bold;font-size:0.9rem">Claiming AI art is hand-painted</div>
          <div class="drag-item" draggable="true" data-id="3" data-value="ethical" style="background:linear-gradient(135deg,#8b5cf6,#6d28d9);color:white;padding:10px 16px;border-radius:10px;cursor:grab;font-weight:bold;font-size:0.9rem">Writing your own creative prompt</div>
          <div class="drag-item" draggable="true" data-id="4" data-value="unethical" style="background:linear-gradient(135deg,#06b6d4,#0891b2);color:white;padding:10px 16px;border-radius:10px;cursor:grab;font-weight:bold;font-size:0.9rem">Copying a famous artist's exact style</div>
        </div>

        <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px">
          <div class="drag-zone" data-accept="ethical" style="background:rgba(34,197,94,0.08);border:2px dashed rgba(34,197,94,0.4);border-radius:12px;padding:20px;min-height:80px;text-align:center">
            <p style="color:#4ade80;margin:0;font-weight:bold"> Ethical  Good!</p>
          </div>
          <div class="drag-zone" data-accept="unethical" style="background:rgba(239,68,68,0.08);border:2px dashed rgba(239,68,68,0.4);border-radius:12px;padding:20px;min-height:80px;text-align:center">
            <p style="color:#f87171;margin:0;font-weight:bold"> Unethical  Avoid!</p>
          </div>
        </div>
      </div>

      <!-- Quiz -->
      <div id="ch6-quiz" style="background:rgba(255,255,255,0.05);backdrop-filter:blur(12px);border:1px solid rgba(236,72,153,0.3);border-radius:16px;padding:28px;margin-bottom:24px">
        <h2 style="color:#ec4899;margin-top:0"> Quiz Time!</h2>
        <p style="color:#e2e8f0;font-size:1.05rem;margin-bottom:20px">You made amazing AI art for a school project. What should you do?</p>
        <div style="display:grid;gap:12px">
          <button onclick="window._ch6Quiz('wrong','Not honest! Always be truthful about how art was made.')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.2);border-radius:12px;padding:16px;color:#e2e8f0;cursor:pointer;text-align:left;font-size:1rem">A) Say you painted it by hand </button>
          <button onclick="window._ch6Quiz('correct',' Perfect! Honesty + crediting the tool = responsible AI artist!')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.2);border-radius:12px;padding:16px;color:#e2e8f0;cursor:pointer;text-align:left;font-size:1rem">B) Credit the AI tool and explain you wrote the prompt </button>
          <button onclick="window._ch6Quiz('wrong','You should be proud of your AI art skills!')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.2);border-radius:12px;padding:16px;color:#e2e8f0;cursor:pointer;text-align:left;font-size:1rem">C) Don't tell anyone how you made it </button>
        </div>
        <div id="ch6-quiz-feedback" style="margin-top:16px"></div>
      </div>

      <div style="text-align:center;margin-top:32px">
        <button onclick="window.addPoints(25);window.completeChapter('aiart',5)" style="background:linear-gradient(135deg,#fbbf24,#ec4899);color:#1a1a2e;border:none;border-radius:14px;padding:18px 48px;font-size:1.2rem;font-weight:bold;cursor:pointer;box-shadow:0 4px 20px rgba(251,191,36,0.3)">
           Complete Chapter 6  Ethics Hero!
        </button>
      </div>
    `,window._ch6Quiz=function(a,o){const l=document.getElementById("ch6-quiz-feedback");l.innerHTML=a==="correct"?'<div style="background:rgba(34,197,94,0.15);border:1px solid rgba(34,197,94,0.4);border-radius:12px;padding:16px;color:#4ade80"> '+o+"</div>":'<div style="background:rgba(239,68,68,0.15);border:1px solid rgba(239,68,68,0.4);border-radius:12px;padding:16px;color:#f87171"> '+o+"</div>",a==="correct"&&window.addPoints(25)},typeof ce=="function"&&ce()},function(r){r.innerHTML=`
      <img src="./infographics/aiart-ch7.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="Building an Art Portfolio">

      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.2rem;margin:0;background:linear-gradient(135deg,#fbbf24,#ec4899);-webkit-background-clip:text;-webkit-text-fill-color:transparent">
           Building an Art Portfolio
        </h1>
        <p style="color:#94a3b8;font-size:1.1rem;margin-top:8px">Collect your best work like a real artist!</p>
      </div>

      <!-- What is a Portfolio -->
      <div style="background:rgba(255,255,255,0.05);backdrop-filter:blur(12px);border:1px solid rgba(255,255,255,0.1);border-radius:16px;padding:28px;margin-bottom:24px">
        <h2 style="color:#fbbf24;margin-top:0"> What's an Art Portfolio?</h2>
        <p style="color:#e2e8f0;font-size:1.05rem;line-height:1.7">
          A portfolio is like your <strong style="color:#ec4899">greatest hits album</strong>   but for art! It's a collection of your BEST work that shows off your skills and style.
        </p>
        <div style="background:rgba(251,191,36,0.1);border-left:4px solid #fbbf24;border-radius:0 12px 12px 0;padding:16px 20px;margin-top:16px">
          <p style="color:#fbbf24;font-weight:bold;margin:0 0 4px 0"> Why do artists have portfolios?</p>
          <p style="color:#cbd5e1;margin:0">To show schools, companies, or clients what they can create! Even kid artists can start building one now! </p>
        </div>
      </div>

      <!-- Portfolio Tips -->
      <div style="background:rgba(255,255,255,0.05);backdrop-filter:blur(12px);border:1px solid rgba(255,255,255,0.1);border-radius:16px;padding:28px;margin-bottom:24px">
        <h2 style="color:#ec4899;margin-top:0"> Portfolio Building Tips</h2>
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;margin:16px 0">
          <div style="background:rgba(251,191,36,0.1);border:1px solid rgba(251,191,36,0.3);border-radius:12px;padding:20px;text-align:center">
            <div style="font-size:2.5rem"></div>
            <h3 style="color:#fbbf24;margin:8px 0">Quality Over Quantity</h3>
            <p style="color:#94a3b8;font-size:0.85rem;margin:0">Pick your 10-15 BEST pieces, not every image you ever made!</p>
          </div>
          <div style="background:rgba(236,72,153,0.1);border:1px solid rgba(236,72,153,0.3);border-radius:12px;padding:20px;text-align:center">
            <div style="font-size:2.5rem"></div>
            <h3 style="color:#ec4899;margin:8px 0">Organize by Theme</h3>
            <p style="color:#94a3b8;font-size:0.85rem;margin:0">Group art by category: Fantasy, Nature, Characters, Abstract</p>
          </div>
          <div style="background:rgba(139,92,246,0.1);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:20px;text-align:center">
            <div style="font-size:2.5rem"></div>
            <h3 style="color:#a78bfa;margin:8px 0">Add Descriptions</h3>
            <p style="color:#94a3b8;font-size:0.85rem;margin:0">Write the prompt you used and why you made each piece!</p>
          </div>
          <div style="background:rgba(6,182,212,0.1);border:1px solid rgba(6,182,212,0.3);border-radius:12px;padding:20px;text-align:center">
            <div style="font-size:2.5rem"></div>
            <h3 style="color:#67e8f9;margin:8px 0">Show Growth</h3>
            <p style="color:#94a3b8;font-size:0.85rem;margin:0">Include early work vs recent work to show how you've improved!</p>
          </div>
        </div>
      </div>

      <!-- Drag & Drop: Portfolio Categories -->
      <div id="ch7-activity" style="background:rgba(255,255,255,0.05);backdrop-filter:blur(12px);border:1px solid rgba(251,191,36,0.3);border-radius:16px;padding:28px;margin-bottom:24px">
        <h2 style="color:#fbbf24;margin-top:0"> Activity: Sort Art Into Categories!</h2>
        <p style="color:#94a3b8;margin-bottom:20px">Drag each artwork to the right portfolio section!</p>
        
        <div style="display:flex;flex-wrap:wrap;gap:12px;margin-bottom:24px;justify-content:center">
          <div class="drag-item" draggable="true" data-id="1" data-value="fantasy" style="background:linear-gradient(135deg,#fbbf24,#f59e0b);color:#1a1a2e;padding:10px 16px;border-radius:10px;cursor:grab;font-weight:bold;font-size:0.9rem"> Dragon in a crystal cave</div>
          <div class="drag-item" draggable="true" data-id="2" data-value="nature" style="background:linear-gradient(135deg,#ec4899,#be185d);color:white;padding:10px 16px;border-radius:10px;cursor:grab;font-weight:bold;font-size:0.9rem"> Sunset over the ocean</div>
          <div class="drag-item" draggable="true" data-id="3" data-value="fantasy" style="background:linear-gradient(135deg,#8b5cf6,#6d28d9);color:white;padding:10px 16px;border-radius:10px;cursor:grab;font-weight:bold;font-size:0.9rem"> Wizard's magical tower</div>
          <div class="drag-item" draggable="true" data-id="4" data-value="nature" style="background:linear-gradient(135deg,#06b6d4,#0891b2);color:white;padding:10px 16px;border-radius:10px;cursor:grab;font-weight:bold;font-size:0.9rem"> Cherry blossom garden</div>
        </div>

        <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px">
          <div class="drag-zone" data-accept="fantasy" style="background:rgba(251,191,36,0.08);border:2px dashed rgba(251,191,36,0.4);border-radius:12px;padding:20px;min-height:80px;text-align:center">
            <p style="color:#fbbf24;margin:0;font-weight:bold"> Fantasy Section</p>
          </div>
          <div class="drag-zone" data-accept="nature" style="background:rgba(34,197,94,0.08);border:2px dashed rgba(34,197,94,0.4);border-radius:12px;padding:20px;min-height:80px;text-align:center">
            <p style="color:#4ade80;margin:0;font-weight:bold"> Nature Section</p>
          </div>
        </div>
      </div>

      <!-- Quiz -->
      <div id="ch7-quiz" style="background:rgba(255,255,255,0.05);backdrop-filter:blur(12px);border:1px solid rgba(236,72,153,0.3);border-radius:16px;padding:28px;margin-bottom:24px">
        <h2 style="color:#ec4899;margin-top:0"> Quiz Time!</h2>
        <p style="color:#e2e8f0;font-size:1.05rem;margin-bottom:20px">How many pieces should a good starter portfolio have?</p>
        <div style="display:grid;gap:12px">
          <button onclick="window._ch7Quiz('wrong','Just 1 isn\\'t enough to show your range!')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.2);border-radius:12px;padding:16px;color:#e2e8f0;cursor:pointer;text-align:left;font-size:1rem">A) Just 1 amazing piece </button>
          <button onclick="window._ch7Quiz('correct',' Quality over quantity! 10-15 of your BEST work is perfect!')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.2);border-radius:12px;padding:16px;color:#e2e8f0;cursor:pointer;text-align:left;font-size:1rem">B) 10-15 of your best pieces </button>
          <button onclick="window._ch7Quiz('wrong','Too many! Quality is better than quantity.')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.2);border-radius:12px;padding:16px;color:#e2e8f0;cursor:pointer;text-align:left;font-size:1rem">C) Every single image you ever made (500+) </button>
        </div>
        <div id="ch7-quiz-feedback" style="margin-top:16px"></div>
      </div>

      <div style="text-align:center;margin-top:32px">
        <button onclick="window.addPoints(25);window.completeChapter('aiart',6)" style="background:linear-gradient(135deg,#fbbf24,#ec4899);color:#1a1a2e;border:none;border-radius:14px;padding:18px 48px;font-size:1.2rem;font-weight:bold;cursor:pointer;box-shadow:0 4px 20px rgba(251,191,36,0.3)">
           Complete Chapter 7  Portfolio Pro!
        </button>
      </div>
    `,window._ch7Quiz=function(a,o){const l=document.getElementById("ch7-quiz-feedback");l.innerHTML=a==="correct"?'<div style="background:rgba(34,197,94,0.15);border:1px solid rgba(34,197,94,0.4);border-radius:12px;padding:16px;color:#4ade80"> '+o+"</div>":'<div style="background:rgba(239,68,68,0.15);border:1px solid rgba(239,68,68,0.4);border-radius:12px;padding:16px;color:#f87171"> '+o+"</div>",a==="correct"&&window.addPoints(25)},typeof ce=="function"&&ce()},function(r){r.innerHTML=`
      <img src="./infographics/aiart-ch8.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="Be a Digital Artist!">

      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.2rem;margin:0;background:linear-gradient(135deg,#fbbf24,#ec4899);-webkit-background-clip:text;-webkit-text-fill-color:transparent">
           Be a Digital Artist!
        </h1>
        <p style="color:#94a3b8;font-size:1.1rem;margin-top:8px">Your journey to becoming a pro starts NOW!</p>
      </div>

      <!-- Celebration -->
      <div style="background:linear-gradient(135deg,rgba(251,191,36,0.15),rgba(236,72,153,0.15));backdrop-filter:blur(12px);border:1px solid rgba(251,191,36,0.3);border-radius:16px;padding:28px;margin-bottom:24px;text-align:center">
        <div style="font-size:4rem;margin-bottom:12px"></div>
        <h2 style="color:#fbbf24;margin:0 0 8px 0">Congratulations, Young Artist!</h2>
        <p style="color:#e2e8f0;font-size:1.1rem;margin:0">You've learned so much! Let's look at the exciting paths ahead!</p>
      </div>

      <!-- Career Paths -->
      <div style="background:rgba(255,255,255,0.05);backdrop-filter:blur(12px);border:1px solid rgba(255,255,255,0.1);border-radius:16px;padding:28px;margin-bottom:24px">
        <h2 style="color:#fbbf24;margin-top:0"> Cool Careers in Digital Art</h2>
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;margin:16px 0">
          <div style="background:rgba(251,191,36,0.1);border:1px solid rgba(251,191,36,0.3);border-radius:14px;padding:20px;text-align:center">
            <div style="font-size:3rem;margin-bottom:8px"></div>
            <h3 style="color:#fbbf24;margin:0 0 6px 0">Game Designer</h3>
            <p style="color:#94a3b8;font-size:0.85rem;margin:0">Create worlds, characters & visual effects for video games!</p>
          </div>
          <div style="background:rgba(236,72,153,0.1);border:1px solid rgba(236,72,153,0.3);border-radius:14px;padding:20px;text-align:center">
            <div style="font-size:3rem;margin-bottom:8px"></div>
            <h3 style="color:#ec4899;margin:0 0 6px 0">Animator</h3>
            <p style="color:#94a3b8;font-size:0.85rem;margin:0">Bring characters to life in movies, shows & YouTube!</p>
          </div>
          <div style="background:rgba(139,92,246,0.1);border:1px solid rgba(139,92,246,0.3);border-radius:14px;padding:20px;text-align:center">
            <div style="font-size:3rem;margin-bottom:8px"></div>
            <h3 style="color:#a78bfa;margin:0 0 6px 0">Illustrator</h3>
            <p style="color:#94a3b8;font-size:0.85rem;margin:0">Design book covers, posters, and magazine art!</p>
          </div>
          <div style="background:rgba(6,182,212,0.1);border:1px solid rgba(6,182,212,0.3);border-radius:14px;padding:20px;text-align:center">
            <div style="font-size:3rem;margin-bottom:8px"></div>
            <h3 style="color:#67e8f9;margin:0 0 6px 0">Concept Artist</h3>
            <p style="color:#94a3b8;font-size:0.85rem;margin:0">Design the look of sci-fi movies & fantasy worlds!</p>
          </div>
        </div>
      </div>

      <!-- What You Learned -->
      <div style="background:rgba(255,255,255,0.05);backdrop-filter:blur(12px);border:1px solid rgba(255,255,255,0.1);border-radius:16px;padding:28px;margin-bottom:24px">
        <h2 style="color:#ec4899;margin-top:0"> Everything You Learned!</h2>
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:12px;margin:16px 0">
          <div style="background:rgba(255,255,255,0.05);border-radius:10px;padding:14px;text-align:center;border:1px solid rgba(255,255,255,0.1)">
            <span style="color:#fbbf24;font-weight:bold">Ch 1</span><br><span style="color:#cbd5e1;font-size:0.85rem">How AI generates images </span>
          </div>
          <div style="background:rgba(255,255,255,0.05);border-radius:10px;padding:14px;text-align:center;border:1px solid rgba(255,255,255,0.1)">
            <span style="color:#ec4899;font-weight:bold">Ch 2</span><br><span style="color:#cbd5e1;font-size:0.85rem">Writing magic prompts </span>
          </div>
          <div style="background:rgba(255,255,255,0.05);border-radius:10px;padding:14px;text-align:center;border:1px solid rgba(255,255,255,0.1)">
            <span style="color:#a78bfa;font-weight:bold">Ch 3</span><br><span style="color:#cbd5e1;font-size:0.85rem">Art styles & AI tools </span>
          </div>
          <div style="background:rgba(255,255,255,0.05);border-radius:10px;padding:14px;text-align:center;border:1px solid rgba(255,255,255,0.1)">
            <span style="color:#67e8f9;font-weight:bold">Ch 4</span><br><span style="color:#cbd5e1;font-size:0.85rem">Creating & sharing safely </span>
          </div>
          <div style="background:rgba(255,255,255,0.05);border-radius:10px;padding:14px;text-align:center;border:1px solid rgba(255,255,255,0.1)">
            <span style="color:#fbbf24;font-weight:bold">Ch 5</span><br><span style="color:#cbd5e1;font-size:0.85rem">Advanced prompts </span>
          </div>
          <div style="background:rgba(255,255,255,0.05);border-radius:10px;padding:14px;text-align:center;border:1px solid rgba(255,255,255,0.1)">
            <span style="color:#ec4899;font-weight:bold">Ch 6</span><br><span style="color:#cbd5e1;font-size:0.85rem">Ethics & ownership </span>
          </div>
          <div style="background:rgba(255,255,255,0.05);border-radius:10px;padding:14px;text-align:center;border:1px solid rgba(255,255,255,0.1)">
            <span style="color:#a78bfa;font-weight:bold">Ch 7</span><br><span style="color:#cbd5e1;font-size:0.85rem">Building a portfolio </span>
          </div>
          <div style="background:rgba(255,255,255,0.05);border-radius:10px;padding:14px;text-align:center;border:1px solid rgba(255,255,255,0.1)">
            <span style="color:#67e8f9;font-weight:bold">Ch 8</span><br><span style="color:#cbd5e1;font-size:0.85rem">Being a digital artist </span>
          </div>
        </div>
      </div>

      <!-- Drag & Drop: Match Career to Skill -->
      <div id="ch8-activity" style="background:rgba(255,255,255,0.05);backdrop-filter:blur(12px);border:1px solid rgba(251,191,36,0.3);border-radius:16px;padding:28px;margin-bottom:24px">
        <h2 style="color:#fbbf24;margin-top:0"> Activity: Match the Career!</h2>
        <p style="color:#94a3b8;margin-bottom:20px">Drag each career to what they create!</p>
        
        <div style="display:flex;flex-wrap:wrap;gap:12px;margin-bottom:24px;justify-content:center">
          <div class="drag-item" draggable="true" data-id="1" data-value="games" style="background:linear-gradient(135deg,#fbbf24,#f59e0b);color:#1a1a2e;padding:10px 16px;border-radius:10px;cursor:grab;font-weight:bold;font-size:0.9rem"> Game Designer</div>
          <div class="drag-item" draggable="true" data-id="2" data-value="movies" style="background:linear-gradient(135deg,#ec4899,#be185d);color:white;padding:10px 16px;border-radius:10px;cursor:grab;font-weight:bold;font-size:0.9rem"> Animator</div>
          <div class="drag-item" draggable="true" data-id="3" data-value="books" style="background:linear-gradient(135deg,#8b5cf6,#6d28d9);color:white;padding:10px 16px;border-radius:10px;cursor:grab;font-weight:bold;font-size:0.9rem"> Illustrator</div>
        </div>

        <div style="display:grid;gap:16px">
          <div class="drag-zone" data-accept="games" style="background:rgba(251,191,36,0.08);border:2px dashed rgba(251,191,36,0.4);border-radius:12px;padding:20px;text-align:center">
            <p style="color:#94a3b8;margin:0">Creates characters & worlds for video games </p>
          </div>
          <div class="drag-zone" data-accept="movies" style="background:rgba(236,72,153,0.08);border:2px dashed rgba(236,72,153,0.4);border-radius:12px;padding:20px;text-align:center">
            <p style="color:#94a3b8;margin:0">Brings characters to life with movement </p>
          </div>
          <div class="drag-zone" data-accept="books" style="background:rgba(139,92,246,0.08);border:2px dashed rgba(139,92,246,0.4);border-radius:12px;padding:20px;text-align:center">
            <p style="color:#94a3b8;margin:0">Designs beautiful book covers & artwork </p>
          </div>
        </div>
      </div>

      <!-- Final Quiz -->
      <div id="ch8-quiz" style="background:rgba(255,255,255,0.05);backdrop-filter:blur(12px);border:1px solid rgba(236,72,153,0.3);border-radius:16px;padding:28px;margin-bottom:24px">
        <h2 style="color:#ec4899;margin-top:0"> Final Quiz!</h2>
        <p style="color:#e2e8f0;font-size:1.05rem;margin-bottom:20px">What's the MOST important thing to become a great AI artist?</p>
        <div style="display:grid;gap:12px">
          <button onclick="window._ch8Quiz('wrong','Expensive tools help, but creativity is more important!')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.2);border-radius:12px;padding:16px;color:#e2e8f0;cursor:pointer;text-align:left;font-size:1rem">A) Having the most expensive computer </button>
          <button onclick="window._ch8Quiz('wrong','Copying won\\'t help you grow as an artist!')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.2);border-radius:12px;padding:16px;color:#e2e8f0;cursor:pointer;text-align:left;font-size:1rem">B) Copying other people's prompts </button>
          <button onclick="window._ch8Quiz('correct',' YES! Practice, experiment, and never stop creating! You are an AI Artist now!')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.2);border-radius:12px;padding:16px;color:#e2e8f0;cursor:pointer;text-align:left;font-size:1rem">C) Practice, creativity, and never giving up! </button>
          <button onclick="window._ch8Quiz('wrong','Keeping art to yourself means nobody sees your talent!')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.2);border-radius:12px;padding:16px;color:#e2e8f0;cursor:pointer;text-align:left;font-size:1rem">D) Never sharing your work with anyone </button>
        </div>
        <div id="ch8-quiz-feedback" style="margin-top:16px"></div>
      </div>

      <!-- Final Completion -->
      <div style="text-align:center;margin-top:32px">
        <div style="background:linear-gradient(135deg,rgba(251,191,36,0.2),rgba(236,72,153,0.2));border:2px solid rgba(251,191,36,0.4);border-radius:20px;padding:32px;margin-bottom:24px">
          <div style="font-size:4rem;margin-bottom:12px"></div>
          <h2 style="color:#fbbf24;margin:0 0 8px 0">You're Now an AI Artist!</h2>
          <p style="color:#e2e8f0;font-size:1.1rem;margin:0">Keep creating, keep learning, keep being awesome! The art world needs YOUR creativity! </p>
        </div>
        <button onclick="window.addPoints(25);window.completeChapter('aiart',7)" style="background:linear-gradient(135deg,#fbbf24,#ec4899);color:#1a1a2e;border:none;border-radius:14px;padding:18px 48px;font-size:1.3rem;font-weight:bold;cursor:pointer;box-shadow:0 4px 20px rgba(251,191,36,0.4);animation:pulse 2s infinite">
           Complete the AI Art Studio Course! 
        </button>
        <style>@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}</style>
      </div>
    `,window._ch8Quiz=function(a,o){const l=document.getElementById("ch8-quiz-feedback");l.innerHTML=a==="correct"?'<div style="background:rgba(34,197,94,0.15);border:1px solid rgba(34,197,94,0.4);border-radius:12px;padding:16px;color:#4ade80"> '+o+"</div>":'<div style="background:rgba(239,68,68,0.15);border:1px solid rgba(239,68,68,0.4);border-radius:12px;padding:16px;color:#f87171"> '+o+"</div>",a==="correct"&&window.addPoints(25)},typeof ce=="function"&&ce()}],mangalyaan:[function(r){r.innerHTML=`
      <img src="./infographics/mangalyaan-ch1.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="India's Dream of Mars infographic">

      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.2rem;margin:0"> India's Dream of Mars</h1>
        <p style="color:#94a3b8;font-size:1.1rem;margin-top:8px">How a young nation dared to reach the Red Planet!</p>
      </div>
      <div class="karaoke-container" style="background:linear-gradient(180deg,rgba(255,153,51,0.08) 0%,rgba(0,0,0,0.6) 40%,rgba(19,136,8,0.08) 100%);border:2px solid rgba(255,153,51,0.25);border-radius:24px;padding:28px 20px;margin-bottom:28px;text-align:center;position:relative;overflow:hidden">
        <div style="position:absolute;top:0;left:0;right:0;height:4px;background:linear-gradient(90deg,#ff9933,#ffffff,#138808)"></div>
        <div style="position:absolute;bottom:0;left:0;right:0;height:4px;background:linear-gradient(90deg,#138808,#ffffff,#ff9933)"></div>
        <div style="position:absolute;left:0;top:0;bottom:0;width:4px;background:linear-gradient(180deg,#ff9933,#138808)"></div>
        <div style="position:absolute;right:0;top:0;bottom:0;width:4px;background:linear-gradient(180deg,#138808,#ff9933)"></div>
        <audio class="karaoke-audio" src="./audio/jana-gana-mana.mp3" preload="auto"></audio>
        <div style="margin-bottom:20px">
          <div style="font-size:2rem;margin-bottom:4px"></div>
          <div style="font-size:1.3rem;font-weight:800;background:linear-gradient(90deg,#ff9933,#ffffff,#138808);-webkit-background-clip:text;-webkit-text-fill-color:transparent;letter-spacing:3px">JANA GANA MANA</div>
          <div style="font-size:0.8rem;color:rgba(255,255,255,0.4);margin-top:4px;letter-spacing:1px">India's National Anthem</div>
        </div>
        <div style="display:flex;justify-content:center;align-items:flex-end;gap:4px;height:40px;margin-bottom:20px">
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#ff9933,#ff993366);border-radius:3px;animation:kBar 0.8s ease-in-out infinite;animation-play-state:paused;height:10px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#ff9933,#ff993366);border-radius:3px;animation:kBar 0.6s ease-in-out infinite 0.1s;animation-play-state:paused;height:14px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#fff,#ffffff66);border-radius:3px;animation:kBar 0.7s ease-in-out infinite 0.2s;animation-play-state:paused;height:18px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#fff,#ffffff66);border-radius:3px;animation:kBar 0.5s ease-in-out infinite 0.15s;animation-play-state:paused;height:24px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#138808,#13880866);border-radius:3px;animation:kBar 0.9s ease-in-out infinite 0.05s;animation-play-state:paused;height:16px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#138808,#13880866);border-radius:3px;animation:kBar 0.65s ease-in-out infinite 0.25s;animation-play-state:paused;height:12px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#ff9933,#ff993366);border-radius:3px;animation:kBar 0.75s ease-in-out infinite 0.3s;animation-play-state:paused;height:20px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#fff,#ffffff66);border-radius:3px;animation:kBar 0.55s ease-in-out infinite 0.12s;animation-play-state:paused;height:28px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#138808,#13880866);border-radius:3px;animation:kBar 0.85s ease-in-out infinite 0.08s;animation-play-state:paused;height:18px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#ff9933,#ff993366);border-radius:3px;animation:kBar 0.6s ease-in-out infinite 0.2s;animation-play-state:paused;height:14px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#fff,#ffffff66);border-radius:3px;animation:kBar 0.7s ease-in-out infinite 0.18s;animation-play-state:paused;height:22px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#138808,#13880866);border-radius:3px;animation:kBar 0.58s ease-in-out infinite 0.22s;animation-play-state:paused;height:16px"></div>
        </div>
        <div style="position:relative;height:6px;background:rgba(255,255,255,0.06);border-radius:3px;margin-bottom:20px;overflow:hidden">
          <div class="karaoke-progress" style="position:absolute;left:0;top:0;height:100%;width:0%;background:linear-gradient(90deg,#ff9933,#ffffff,#138808);border-radius:3px;transition:width 0.3s linear;box-shadow:0 0 10px rgba(255,153,51,0.5)"></div>
        </div>
        <div class="karaoke-lyrics" style="max-height:240px;overflow-y:auto;margin-bottom:20px;padding:12px;scrollbar-width:thin;scrollbar-color:rgba(255,153,51,0.3) transparent;background:rgba(0,0,0,0.3);border-radius:16px;border:1px solid rgba(255,255,255,0.05)"></div>
        <div style="position:relative;display:inline-block;margin:8px 0">
          <div style="position:absolute;inset:-14px;border-radius:50%;background:conic-gradient(#ff9933,#ff993300,#ffffff,#ffffff00,#138808,#13880800,#ff9933);animation:kSpin 2.5s linear infinite;opacity:0.7"></div>
          <div style="position:absolute;inset:-7px;border-radius:50%;background:conic-gradient(#138808,#13880800,#ff9933,#ff993300,#ffffff,#ffffff00,#138808);animation:kSpin 4s linear infinite reverse;opacity:0.4"></div>
          <button class="karaoke-play" style="position:relative;width:80px;height:80px;border-radius:50%;background:radial-gradient(circle at 35% 35%,#2a1f3d,#0f0f1a 70%);border:2px solid rgba(255,153,51,0.4);color:white;font-size:1.8rem;cursor:pointer;box-shadow:0 0 40px rgba(255,153,51,0.25),0 0 80px rgba(255,153,51,0.1),inset 0 2px 4px rgba(255,255,255,0.1);transition:all 0.3s ease;display:flex;align-items:center;justify-content:center;animation:kPulse 2s ease-in-out infinite"></button>
        </div>
        <div style="margin-top:14px;font-size:0.75rem;color:rgba(255,153,51,0.6);letter-spacing:3px;text-transform:uppercase;font-weight:600"> tap to play </div>
      </div>

      <div style="background:rgba(249,115,22,0.08);border:1px solid rgba(249,115,22,0.3);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> The Birth of ISRO</h2>
        <p style="font-size:1.05rem;line-height:1.7">In <strong style="color:#f97316">1962</strong>, a visionary scientist named <strong>Vikram Sarabhai</strong>  the father of India's space program  convinced the government that India needed its own space research.</p>
        <p style="font-size:1.05rem;line-height:1.7">On <strong style="color:#f97316">August 15, 1969</strong>  India's Independence Day  <strong>ISRO (Indian Space Research Organisation)</strong> was officially born! </p>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#FF9933;margin-top:0"> India's Amazing Space Journey</h2>
        <div style="display:grid;gap:12px;margin-top:16px">
          <div style="background:rgba(249,115,22,0.1);border-left:4px solid #FF9933;border-radius:0 12px 12px 0;padding:14px 18px">
            <strong style="color:#FF9933">1975  Aryabhata </strong><br>India's FIRST satellite! Named after the ancient Indian mathematician.
          </div>
          <div style="background:rgba(255,255,255,0.05);border-left:4px solid #fff;border-radius:0 12px 12px 0;padding:14px 18px">
            <strong>1980  SLV-3 </strong><br>India built its OWN rocket! Dr. APJ Abdul Kalam led this project.
          </div>
          <div style="background:rgba(19,136,8,0.1);border-left:4px solid #138808;border-radius:0 12px 12px 0;padding:14px 18px">
            <strong style="color:#4ade80">2008  Chandrayaan-1 </strong><br>India's first Moon mission! It discovered WATER on the Moon!
          </div>
          <div style="background:rgba(249,115,22,0.15);border-left:4px solid #f97316;border-radius:0 12px 12px 0;padding:14px 18px">
            <strong style="color:#f97316">2013  Mangalyaan </strong><br>India's Mars mission! We'll learn ALL about this incredible journey!
          </div>
        </div>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> AI Connection: How AI Helps Plan Space Missions</h2>
        <p style="font-size:1.05rem;line-height:1.7">Before any rocket launches, scientists use <strong style="color:#f97316">AI and computers</strong> to plan routes, test designs virtually, and predict problems. Just like Google Maps finds the fastest route to school, AI finds the best path to Mars! </p>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> Activity: ISRO Timeline Challenge!</h2>
        <p>Drag each milestone to the correct year! </p>
        <div style="display:flex;flex-wrap:wrap;gap:10px;margin:16px 0">
          <div class="drag-item" data-id="m1" data-value="1975" style="background:linear-gradient(135deg,#431407,#7c2d12);border:1px solid rgba(249,115,22,0.3);border-radius:12px;padding:12px 18px;cursor:grab;font-size:1rem"> Aryabhata (First Satellite)</div>
          <div class="drag-item" data-id="m2" data-value="2013" style="background:linear-gradient(135deg,#431407,#7c2d12);border:1px solid rgba(249,115,22,0.3);border-radius:12px;padding:12px 18px;cursor:grab;font-size:1rem"> Mangalyaan (Mars!)</div>
          <div class="drag-item" data-id="m3" data-value="2008" style="background:linear-gradient(135deg,#431407,#7c2d12);border:1px solid rgba(249,115,22,0.3);border-radius:12px;padding:12px 18px;cursor:grab;font-size:1rem"> Chandrayaan-1 (Moon)</div>
          <div class="drag-item" data-id="m4" data-value="1969" style="background:linear-gradient(135deg,#431407,#7c2d12);border:1px solid rgba(249,115,22,0.3);border-radius:12px;padding:12px 18px;cursor:grab;font-size:1rem"> ISRO Founded</div>
        </div>
        <div style="display:flex;gap:12px;flex-wrap:wrap">
          <div class="drag-zone" data-accept="1969" data-on-drop="handleBucketDrop" style="flex:1;min-width:120px;min-height:80px;border:2px dashed #f97316;border-radius:12px;padding:12px;text-align:center"><div style="color:#f97316;font-weight:bold">1969</div></div>
          <div class="drag-zone" data-accept="1975" data-on-drop="handleBucketDrop" style="flex:1;min-width:120px;min-height:80px;border:2px dashed #f97316;border-radius:12px;padding:12px;text-align:center"><div style="color:#f97316;font-weight:bold">1975</div></div>
          <div class="drag-zone" data-accept="2008" data-on-drop="handleBucketDrop" style="flex:1;min-width:120px;min-height:80px;border:2px dashed #f97316;border-radius:12px;padding:12px;text-align:center"><div style="color:#f97316;font-weight:bold">2008</div></div>
          <div class="drag-zone" data-accept="2013" data-on-drop="handleBucketDrop" style="flex:1;min-width:120px;min-height:80px;border:2px dashed #f97316;border-radius:12px;padding:12px;text-align:center"><div style="color:#f97316;font-weight:bold">2013</div></div>
        </div>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> Quick Quiz!</h2>
        <p style="font-size:1.05rem;margin-bottom:16px">What makes India's Mars mission special?</p>
        <div id="mq1" style="display:flex;flex-direction:column;gap:10px">
          <button onclick="document.querySelectorAll('#mq1 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #ef4444';showFeedback(document.getElementById('mq1'),'wrong','Not quite! ')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">A) Second country to reach Mars</button>
          <button onclick="document.querySelectorAll('#mq1 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #10b981';showFeedback(document.getElementById('mq1'),'correct',' YES! India was the FIRST nation to reach Mars orbit on its very first attempt!');window.addPoints(25)" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">B) First nation to succeed on its FIRST attempt! </button>
          <button onclick="document.querySelectorAll('#mq1 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #ef4444';showFeedback(document.getElementById('mq1'),'wrong','Not this one! ')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">C) Most expensive Mars mission</button>
        </div>
      </div>

      <div style="background:linear-gradient(135deg,rgba(249,115,22,0.1),rgba(249,115,22,0.05));border:1px solid rgba(249,115,22,0.2);border-radius:16px;padding:24px;margin-bottom:20px;text-align:center">
        <h2 style="margin-top:0"> Key Takeaway</h2>
        <p style="font-size:1.15rem;line-height:1.7">India's journey to space started with a dream. ISRO proved that with <strong style="color:#f97316">hard work and innovation</strong>, even a developing nation can reach Mars! </p>
      </div>

      <button onclick="window.completeChapter('mangalyaan', 0)" style="width:100%;padding:16px;background:linear-gradient(135deg,#f97316,#ea580c);border:none;border-radius:12px;color:white;font-size:1.1rem;font-weight:bold;cursor:pointer;margin-top:12px"> Complete Chapter 1!</button>
    `,typeof ce=="function"&&ce(),vi(r.querySelector(".karaoke-container"))},function(r){r.innerHTML=`
      <img src="./infographics/mangalyaan-ch2.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="Building Mangalyaan infographic">
      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.2rem;margin:0"> Building Mangalyaan</h1>
        <p style="color:#94a3b8;font-size:1.1rem;margin-top:8px">How ISRO built a Mars spacecraft in record time!</p>
      </div>
      <div class="karaoke-container" style="background:linear-gradient(180deg,rgba(255,153,51,0.08) 0%,rgba(0,0,0,0.6) 40%,rgba(19,136,8,0.08) 100%);border:2px solid rgba(255,153,51,0.25);border-radius:24px;padding:28px 20px;margin-bottom:28px;text-align:center;position:relative;overflow:hidden">
        <div style="position:absolute;top:0;left:0;right:0;height:4px;background:linear-gradient(90deg,#ff9933,#ffffff,#138808)"></div>
        <div style="position:absolute;bottom:0;left:0;right:0;height:4px;background:linear-gradient(90deg,#138808,#ffffff,#ff9933)"></div>
        <div style="position:absolute;left:0;top:0;bottom:0;width:4px;background:linear-gradient(180deg,#ff9933,#138808)"></div>
        <div style="position:absolute;right:0;top:0;bottom:0;width:4px;background:linear-gradient(180deg,#138808,#ff9933)"></div>
        <audio class="karaoke-audio" src="./audio/jana-gana-mana.mp3" preload="auto"></audio>
        <div style="margin-bottom:20px">
          <div style="font-size:2rem;margin-bottom:4px"></div>
          <div style="font-size:1.3rem;font-weight:800;background:linear-gradient(90deg,#ff9933,#ffffff,#138808);-webkit-background-clip:text;-webkit-text-fill-color:transparent;letter-spacing:3px">JANA GANA MANA</div>
          <div style="font-size:0.8rem;color:rgba(255,255,255,0.4);margin-top:4px;letter-spacing:1px">India's National Anthem</div>
        </div>
        <div style="display:flex;justify-content:center;align-items:flex-end;gap:4px;height:40px;margin-bottom:20px">
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#ff9933,#ff993366);border-radius:3px;animation:kBar 0.8s ease-in-out infinite;animation-play-state:paused;height:10px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#ff9933,#ff993366);border-radius:3px;animation:kBar 0.6s ease-in-out infinite 0.1s;animation-play-state:paused;height:14px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#fff,#ffffff66);border-radius:3px;animation:kBar 0.7s ease-in-out infinite 0.2s;animation-play-state:paused;height:18px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#fff,#ffffff66);border-radius:3px;animation:kBar 0.5s ease-in-out infinite 0.15s;animation-play-state:paused;height:24px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#138808,#13880866);border-radius:3px;animation:kBar 0.9s ease-in-out infinite 0.05s;animation-play-state:paused;height:16px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#138808,#13880866);border-radius:3px;animation:kBar 0.65s ease-in-out infinite 0.25s;animation-play-state:paused;height:12px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#ff9933,#ff993366);border-radius:3px;animation:kBar 0.75s ease-in-out infinite 0.3s;animation-play-state:paused;height:20px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#fff,#ffffff66);border-radius:3px;animation:kBar 0.55s ease-in-out infinite 0.12s;animation-play-state:paused;height:28px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#138808,#13880866);border-radius:3px;animation:kBar 0.85s ease-in-out infinite 0.08s;animation-play-state:paused;height:18px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#ff9933,#ff993366);border-radius:3px;animation:kBar 0.6s ease-in-out infinite 0.2s;animation-play-state:paused;height:14px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#fff,#ffffff66);border-radius:3px;animation:kBar 0.7s ease-in-out infinite 0.18s;animation-play-state:paused;height:22px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#138808,#13880866);border-radius:3px;animation:kBar 0.58s ease-in-out infinite 0.22s;animation-play-state:paused;height:16px"></div>
        </div>
        <div style="position:relative;height:6px;background:rgba(255,255,255,0.06);border-radius:3px;margin-bottom:20px;overflow:hidden">
          <div class="karaoke-progress" style="position:absolute;left:0;top:0;height:100%;width:0%;background:linear-gradient(90deg,#ff9933,#ffffff,#138808);border-radius:3px;transition:width 0.3s linear;box-shadow:0 0 10px rgba(255,153,51,0.5)"></div>
        </div>
        <div class="karaoke-lyrics" style="max-height:240px;overflow-y:auto;margin-bottom:20px;padding:12px;scrollbar-width:thin;scrollbar-color:rgba(255,153,51,0.3) transparent;background:rgba(0,0,0,0.3);border-radius:16px;border:1px solid rgba(255,255,255,0.05)"></div>
        <div style="position:relative;display:inline-block;margin:8px 0">
          <div style="position:absolute;inset:-14px;border-radius:50%;background:conic-gradient(#ff9933,#ff993300,#ffffff,#ffffff00,#138808,#13880800,#ff9933);animation:kSpin 2.5s linear infinite;opacity:0.7"></div>
          <div style="position:absolute;inset:-7px;border-radius:50%;background:conic-gradient(#138808,#13880800,#ff9933,#ff993300,#ffffff,#ffffff00,#138808);animation:kSpin 4s linear infinite reverse;opacity:0.4"></div>
          <button class="karaoke-play" style="position:relative;width:80px;height:80px;border-radius:50%;background:radial-gradient(circle at 35% 35%,#2a1f3d,#0f0f1a 70%);border:2px solid rgba(255,153,51,0.4);color:white;font-size:1.8rem;cursor:pointer;box-shadow:0 0 40px rgba(255,153,51,0.25),0 0 80px rgba(255,153,51,0.1),inset 0 2px 4px rgba(255,255,255,0.1);transition:all 0.3s ease;display:flex;align-items:center;justify-content:center;animation:kPulse 2s ease-in-out infinite"></button>
        </div>
        <div style="margin-top:14px;font-size:0.75rem;color:rgba(255,153,51,0.6);letter-spacing:3px;text-transform:uppercase;font-weight:600"> tap to play </div>
      </div>

      <div style="background:rgba(249,115,22,0.08);border:1px solid rgba(249,115,22,0.3);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> The Incredible Timeline</h2>
        <p style="font-size:1.05rem;line-height:1.7">ISRO built Mangalyaan in just <strong style="color:#f97316">15 months</strong>! Most space agencies take 5-10 years. Launched on <strong style="color:#f97316">November 5, 2013</strong> from Satish Dhawan Space Centre, Sriharikota. </p>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> Meet the Spacecraft</h2>
        <p style="font-size:1.05rem;line-height:1.7">Mangalyaan was about the size of a <strong>refrigerator</strong>! </p>
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:12px;margin:16px 0">
          <div style="background:rgba(249,115,22,0.1);border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:1.8rem"></div><div style="color:#f97316;font-weight:bold;font-size:1.2rem">1,337 kg</div><div style="font-size:0.85rem;color:#94a3b8">Like a small car!</div>
          </div>
          <div style="background:rgba(249,115,22,0.1);border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:1.8rem"></div><div style="color:#f97316;font-weight:bold;font-size:1.2rem">3 Solar Panels</div><div style="font-size:0.85rem;color:#94a3b8">Powered by sunlight</div>
          </div>
          <div style="background:rgba(249,115,22,0.1);border-radius:12px;padding:16px;text-align:center">
            <div style="font-size:1.8rem"></div><div style="color:#f97316;font-weight:bold;font-size:1.2rem">5 Instruments</div><div style="font-size:0.85rem;color:#94a3b8">Eyes & brain of mission</div>
          </div>
        </div>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> The 5 Scientific Instruments</h2>
        <div style="display:grid;gap:10px;margin-top:14px">
          <div style="background:rgba(249,115,22,0.08);border-radius:12px;padding:14px 18px;display:flex;gap:12px;align-items:center"><span style="font-size:1.5rem"></span><div><strong style="color:#f97316">Mars Colour Camera (MCC)</strong><br><span style="color:#94a3b8">Takes photos of Mars surface</span></div></div>
          <div style="background:rgba(255,255,255,0.05);border-radius:12px;padding:14px 18px;display:flex;gap:12px;align-items:center"><span style="font-size:1.5rem"></span><div><strong style="color:#f97316">Methane Sensor (MSM)</strong><br><span style="color:#94a3b8">Sniffs for methane  could hint at life! </span></div></div>
          <div style="background:rgba(249,115,22,0.08);border-radius:12px;padding:14px 18px;display:flex;gap:12px;align-items:center"><span style="font-size:1.5rem"></span><div><strong style="color:#f97316">Thermal Infrared Spectrometer (TIS)</strong><br><span style="color:#94a3b8">Measures temperature and minerals</span></div></div>
          <div style="background:rgba(255,255,255,0.05);border-radius:12px;padding:14px 18px;display:flex;gap:12px;align-items:center"><span style="font-size:1.5rem"></span><div><strong style="color:#f97316">Lyman Alpha Photometer (LAP)</strong><br><span style="color:#94a3b8">Studies hydrogen in Mars atmosphere</span></div></div>
          <div style="background:rgba(249,115,22,0.08);border-radius:12px;padding:14px 18px;display:flex;gap:12px;align-items:center"><span style="font-size:1.5rem"></span><div><strong style="color:#f97316">MENCA</strong><br><span style="color:#94a3b8">Analyzes gases escaping Mars atmosphere</span></div></div>
        </div>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> The Rocket: PSLV-XL C25</h2>
        <p style="font-size:1.05rem;line-height:1.7">PSLV is 44 meters tall  a <strong>15-story building</strong>! Nicknamed <strong>"the reliable workhorse of ISRO"</strong> . This was its 25th flight with a perfect record!</p>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> AI Connection: AI in Spacecraft Design</h2>
        <p style="font-size:1.05rem;line-height:1.7">Engineers use AI to run millions of virtual tests, find the lightest materials, predict what could break during launch, and ensure survival from -150C to +150C! </p>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> Activity: Match the Instrument!</h2>
        <p>Drag each instrument to what it measures! </p>
        <div style="display:flex;flex-wrap:wrap;gap:10px;margin:16px 0">
          <div class="drag-item" data-id="i1" data-value="photos" style="background:linear-gradient(135deg,#431407,#7c2d12);border:1px solid rgba(249,115,22,0.3);border-radius:12px;padding:12px 18px;cursor:grab;font-size:0.95rem"> Mars Colour Camera</div>
          <div class="drag-item" data-id="i2" data-value="methane" style="background:linear-gradient(135deg,#431407,#7c2d12);border:1px solid rgba(249,115,22,0.3);border-radius:12px;padding:12px 18px;cursor:grab;font-size:0.95rem"> Methane Sensor</div>
          <div class="drag-item" data-id="i3" data-value="temperature" style="background:linear-gradient(135deg,#431407,#7c2d12);border:1px solid rgba(249,115,22,0.3);border-radius:12px;padding:12px 18px;cursor:grab;font-size:0.95rem"> TIS</div>
          <div class="drag-item" data-id="i4" data-value="hydrogen" style="background:linear-gradient(135deg,#431407,#7c2d12);border:1px solid rgba(249,115,22,0.3);border-radius:12px;padding:12px 18px;cursor:grab;font-size:0.95rem"> LAP</div>
          <div class="drag-item" data-id="i5" data-value="gases" style="background:linear-gradient(135deg,#431407,#7c2d12);border:1px solid rgba(249,115,22,0.3);border-radius:12px;padding:12px 18px;cursor:grab;font-size:0.95rem"> MENCA</div>
        </div>
        <div style="display:flex;flex-wrap:wrap;gap:12px">
          <div class="drag-zone" data-accept="photos" data-on-drop="handleBucketDrop" style="flex:1;min-width:110px;min-height:70px;border:2px dashed #f97316;border-radius:12px;padding:10px;text-align:center"><div style="color:#f97316;font-weight:bold;font-size:0.85rem"> Takes photos</div></div>
          <div class="drag-zone" data-accept="methane" data-on-drop="handleBucketDrop" style="flex:1;min-width:110px;min-height:70px;border:2px dashed #f97316;border-radius:12px;padding:10px;text-align:center"><div style="color:#f97316;font-weight:bold;font-size:0.85rem"> Sniffs for gas</div></div>
          <div class="drag-zone" data-accept="temperature" data-on-drop="handleBucketDrop" style="flex:1;min-width:110px;min-height:70px;border:2px dashed #f97316;border-radius:12px;padding:10px;text-align:center"><div style="color:#f97316;font-weight:bold;font-size:0.85rem"> Measures heat</div></div>
          <div class="drag-zone" data-accept="hydrogen" data-on-drop="handleBucketDrop" style="flex:1;min-width:110px;min-height:70px;border:2px dashed #f97316;border-radius:12px;padding:10px;text-align:center"><div style="color:#f97316;font-weight:bold;font-size:0.85rem"> Studies UV</div></div>
          <div class="drag-zone" data-accept="gases" data-on-drop="handleBucketDrop" style="flex:1;min-width:110px;min-height:70px;border:2px dashed #f97316;border-radius:12px;padding:10px;text-align:center"><div style="color:#f97316;font-weight:bold;font-size:0.85rem"> Escaping gas</div></div>
        </div>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> Quick Quiz!</h2>
        <p style="font-size:1.05rem;margin-bottom:16px">How many scientific instruments did Mangalyaan carry?</p>
        <div id="mq2" style="display:flex;flex-direction:column;gap:10px">
          <button onclick="document.querySelectorAll('#mq2 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #ef4444';showFeedback(document.getElementById('mq2'),'wrong','Count again! ')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">A) 3 instruments</button>
          <button onclick="document.querySelectorAll('#mq2 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #10b981';showFeedback(document.getElementById('mq2'),'correct',' Correct! MCC, MSM, TIS, LAP, and MENCA!');window.addPoints(25)" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">B) 5 instruments </button>
          <button onclick="document.querySelectorAll('#mq2 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #ef4444';showFeedback(document.getElementById('mq2'),'wrong','Too many! ')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">C) 10 instruments</button>
        </div>
      </div>

      <div style="background:linear-gradient(135deg,rgba(249,115,22,0.1),rgba(249,115,22,0.05));border:1px solid rgba(249,115,22,0.2);border-radius:16px;padding:24px;margin-bottom:20px;text-align:center">
        <h2 style="margin-top:0"> Key Takeaway</h2>
        <p style="font-size:1.15rem;line-height:1.7">Built in 15 months with 5 instruments, weighing 1,337 kg. <strong style="color:#f97316">Smart engineering beats big budgets</strong>! </p>
      </div>

      <button onclick="window.completeChapter('mangalyaan', 1)" style="width:100%;padding:16px;background:linear-gradient(135deg,#f97316,#ea580c);border:none;border-radius:12px;color:white;font-size:1.1rem;font-weight:bold;cursor:pointer;margin-top:12px"> Complete Chapter 2!</button>
    `,typeof ce=="function"&&ce(),vi(r.querySelector(".karaoke-container"))},function(r){r.innerHTML=`
      <img src="./infographics/mangalyaan-ch3.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="The Slingshot Journey infographic">
      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.2rem;margin:0"> The Slingshot Journey</h1>
        <p style="color:#94a3b8;font-size:1.1rem;margin-top:8px">How Mangalyaan used a clever trick to reach Mars!</p>
      </div>
      <div class="karaoke-container" style="background:linear-gradient(180deg,rgba(255,153,51,0.08) 0%,rgba(0,0,0,0.6) 40%,rgba(19,136,8,0.08) 100%);border:2px solid rgba(255,153,51,0.25);border-radius:24px;padding:28px 20px;margin-bottom:28px;text-align:center;position:relative;overflow:hidden">
        <div style="position:absolute;top:0;left:0;right:0;height:4px;background:linear-gradient(90deg,#ff9933,#ffffff,#138808)"></div>
        <div style="position:absolute;bottom:0;left:0;right:0;height:4px;background:linear-gradient(90deg,#138808,#ffffff,#ff9933)"></div>
        <div style="position:absolute;left:0;top:0;bottom:0;width:4px;background:linear-gradient(180deg,#ff9933,#138808)"></div>
        <div style="position:absolute;right:0;top:0;bottom:0;width:4px;background:linear-gradient(180deg,#138808,#ff9933)"></div>
        <audio class="karaoke-audio" src="./audio/jana-gana-mana.mp3" preload="auto"></audio>
        <div style="margin-bottom:20px">
          <div style="font-size:2rem;margin-bottom:4px"></div>
          <div style="font-size:1.3rem;font-weight:800;background:linear-gradient(90deg,#ff9933,#ffffff,#138808);-webkit-background-clip:text;-webkit-text-fill-color:transparent;letter-spacing:3px">JANA GANA MANA</div>
          <div style="font-size:0.8rem;color:rgba(255,255,255,0.4);margin-top:4px;letter-spacing:1px">India's National Anthem</div>
        </div>
        <div style="display:flex;justify-content:center;align-items:flex-end;gap:4px;height:40px;margin-bottom:20px">
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#ff9933,#ff993366);border-radius:3px;animation:kBar 0.8s ease-in-out infinite;animation-play-state:paused;height:10px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#ff9933,#ff993366);border-radius:3px;animation:kBar 0.6s ease-in-out infinite 0.1s;animation-play-state:paused;height:14px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#fff,#ffffff66);border-radius:3px;animation:kBar 0.7s ease-in-out infinite 0.2s;animation-play-state:paused;height:18px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#fff,#ffffff66);border-radius:3px;animation:kBar 0.5s ease-in-out infinite 0.15s;animation-play-state:paused;height:24px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#138808,#13880866);border-radius:3px;animation:kBar 0.9s ease-in-out infinite 0.05s;animation-play-state:paused;height:16px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#138808,#13880866);border-radius:3px;animation:kBar 0.65s ease-in-out infinite 0.25s;animation-play-state:paused;height:12px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#ff9933,#ff993366);border-radius:3px;animation:kBar 0.75s ease-in-out infinite 0.3s;animation-play-state:paused;height:20px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#fff,#ffffff66);border-radius:3px;animation:kBar 0.55s ease-in-out infinite 0.12s;animation-play-state:paused;height:28px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#138808,#13880866);border-radius:3px;animation:kBar 0.85s ease-in-out infinite 0.08s;animation-play-state:paused;height:18px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#ff9933,#ff993366);border-radius:3px;animation:kBar 0.6s ease-in-out infinite 0.2s;animation-play-state:paused;height:14px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#fff,#ffffff66);border-radius:3px;animation:kBar 0.7s ease-in-out infinite 0.18s;animation-play-state:paused;height:22px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#138808,#13880866);border-radius:3px;animation:kBar 0.58s ease-in-out infinite 0.22s;animation-play-state:paused;height:16px"></div>
        </div>
        <div style="position:relative;height:6px;background:rgba(255,255,255,0.06);border-radius:3px;margin-bottom:20px;overflow:hidden">
          <div class="karaoke-progress" style="position:absolute;left:0;top:0;height:100%;width:0%;background:linear-gradient(90deg,#ff9933,#ffffff,#138808);border-radius:3px;transition:width 0.3s linear;box-shadow:0 0 10px rgba(255,153,51,0.5)"></div>
        </div>
        <div class="karaoke-lyrics" style="max-height:240px;overflow-y:auto;margin-bottom:20px;padding:12px;scrollbar-width:thin;scrollbar-color:rgba(255,153,51,0.3) transparent;background:rgba(0,0,0,0.3);border-radius:16px;border:1px solid rgba(255,255,255,0.05)"></div>
        <div style="position:relative;display:inline-block;margin:8px 0">
          <div style="position:absolute;inset:-14px;border-radius:50%;background:conic-gradient(#ff9933,#ff993300,#ffffff,#ffffff00,#138808,#13880800,#ff9933);animation:kSpin 2.5s linear infinite;opacity:0.7"></div>
          <div style="position:absolute;inset:-7px;border-radius:50%;background:conic-gradient(#138808,#13880800,#ff9933,#ff993300,#ffffff,#ffffff00,#138808);animation:kSpin 4s linear infinite reverse;opacity:0.4"></div>
          <button class="karaoke-play" style="position:relative;width:80px;height:80px;border-radius:50%;background:radial-gradient(circle at 35% 35%,#2a1f3d,#0f0f1a 70%);border:2px solid rgba(255,153,51,0.4);color:white;font-size:1.8rem;cursor:pointer;box-shadow:0 0 40px rgba(255,153,51,0.25),0 0 80px rgba(255,153,51,0.1),inset 0 2px 4px rgba(255,255,255,0.1);transition:all 0.3s ease;display:flex;align-items:center;justify-content:center;animation:kPulse 2s ease-in-out infinite"></button>
        </div>
        <div style="margin-top:14px;font-size:0.75rem;color:rgba(255,153,51,0.6);letter-spacing:3px;text-transform:uppercase;font-weight:600"> tap to play </div>
      </div>

      <!-- 3D MANGALYAAN MARS ORBIT -->
      <div id="threejs-container" style="position:relative;width:100%;height:500px;border-radius:20px;overflow:hidden;margin-bottom:28px;border:2px solid rgba(249,115,22,0.3);background:#000">
        <canvas id="mars-canvas" style="width:100%;height:100%;display:block"></canvas>
        <div style="position:absolute;bottom:16px;left:50%;transform:translateX(-50%);display:flex;gap:12px;z-index:10">
          <button id="btn-launch" style="padding:10px 20px;background:linear-gradient(135deg,#f97316,#ea580c);border:none;border-radius:10px;color:white;font-weight:700;cursor:pointer;font-size:0.9rem;box-shadow:0 4px 20px rgba(249,115,22,0.4);transition:all 0.3s"> Launch</button>
          <button id="btn-reset" style="padding:10px 20px;background:rgba(255,255,255,0.1);border:1px solid rgba(255,255,255,0.2);border-radius:10px;color:white;font-weight:600;cursor:pointer;font-size:0.9rem;backdrop-filter:blur(10px);transition:all 0.3s"> Reset</button>
        </div>
        <div id="orbit-info" style="position:absolute;top:16px;left:16px;background:rgba(0,0,0,0.7);backdrop-filter:blur(10px);border:1px solid rgba(249,115,22,0.3);border-radius:12px;padding:12px 16px;z-index:10;font-size:0.8rem;color:#94a3b8">
          <div style="color:#f97316;font-weight:700;margin-bottom:4px"> MANGALYAAN TRACKER</div>
          <div id="orbit-phase">Phase: Pre-Launch</div>
          <div id="orbit-dist">Distance: 0 km</div>
          <div id="orbit-speed">Speed: 0 km/s</div>
        </div>
        <div style="position:absolute;top:16px;right:16px;color:rgba(255,255,255,0.4);font-size:0.7rem;z-index:10"> Drag to rotate  Scroll to zoom</div>
      </div>

      <div style="background:rgba(249,115,22,0.08);border:1px solid rgba(249,115,22,0.3);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> Why Not Fly Straight?</h2>
        <p style="font-size:1.05rem;line-height:1.7">Mars is <strong style="color:#f97316">225 million km</strong> away. By car, that's 2,500 years!  PSLV wasn't powerful enough to go direct, so ISRO used Earth's gravity as a <strong style="color:#f97316">slingshot</strong>! </p>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> The 3-Phase Journey</h2>
        <div style="display:grid;gap:16px;margin-top:16px">
          <div style="background:linear-gradient(135deg,rgba(249,115,22,0.15),rgba(249,115,22,0.05));border-radius:16px;padding:20px;display:flex;gap:16px;align-items:start">
            <div style="background:#f97316;color:white;border-radius:50%;width:40px;height:40px;display:flex;align-items:center;justify-content:center;font-weight:bold;flex-shrink:0">1</div>
            <div><h3 style="color:#f97316;margin:0 0 8px 0"> Earth Orbit Phase (Nov 5 - Dec 1)</h3><p style="font-size:1rem;line-height:1.6;margin:0">Orbited Earth in bigger circles. Engine fired 6 times to raise orbit higher. </p></div>
          </div>
          <div style="background:rgba(255,255,255,0.05);border-radius:16px;padding:20px;display:flex;gap:16px;align-items:start">
            <div style="background:#f97316;color:white;border-radius:50%;width:40px;height:40px;display:flex;align-items:center;justify-content:center;font-weight:bold;flex-shrink:0">2</div>
            <div><h3 style="color:#f97316;margin:0 0 8px 0"> Trans-Mars Injection (Dec 1)</h3><p style="font-size:1rem;line-height:1.6;margin:0">Engine fired 23 minutes to escape Earth. Used a <strong style="color:#f97316">Hohmann Transfer Orbit</strong>  an energy-efficient curved path. Like throwing a ball in an arc! </p></div>
          </div>
          <div style="background:linear-gradient(135deg,rgba(249,115,22,0.15),rgba(249,115,22,0.05));border-radius:16px;padding:20px;display:flex;gap:16px;align-items:start">
            <div style="background:#f97316;color:white;border-radius:50%;width:40px;height:40px;display:flex;align-items:center;justify-content:center;font-weight:bold;flex-shrink:0">3</div>
            <div><h3 style="color:#f97316;margin:0 0 8px 0"> Cruise to Mars (300 days!)</h3><p style="font-size:1rem;line-height:1.6;margin:0">Sailed 680 million km at up to 32 km/second  faster than a bullet! 4 course corrections along the way. </p></div>
          </div>
        </div>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> AI Connection: AI Calculates Trajectories</h2>
        <p style="font-size:1.05rem;line-height:1.7">Getting to Mars = throwing a ball at a moving target while YOU move too! AI does millions of calculations for orbits, course corrections, and fuel optimization. </p>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> Activity: Order the Mission Phases!</h2>
        <p>Drag each phase into the correct order! </p>
        <div style="display:flex;flex-wrap:wrap;gap:10px;margin:16px 0">
          <div class="drag-item" data-id="p1" data-value="phase3" style="background:linear-gradient(135deg,#431407,#7c2d12);border:1px solid rgba(249,115,22,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> Mars Orbit Insertion</div>
          <div class="drag-item" data-id="p2" data-value="phase1" style="background:linear-gradient(135deg,#431407,#7c2d12);border:1px solid rgba(249,115,22,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> Launch from Sriharikota</div>
          <div class="drag-item" data-id="p3" data-value="phase4" style="background:linear-gradient(135deg,#431407,#7c2d12);border:1px solid rgba(249,115,22,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> Science begins</div>
          <div class="drag-item" data-id="p4" data-value="phase2" style="background:linear-gradient(135deg,#431407,#7c2d12);border:1px solid rgba(249,115,22,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> Orbit-raising</div>
        </div>
        <div style="display:flex;gap:12px;flex-wrap:wrap">
          <div class="drag-zone" data-accept="phase1" data-on-drop="handleBucketDrop" style="flex:1;min-width:80px;min-height:70px;border:2px dashed #f97316;border-radius:12px;padding:10px;text-align:center"><div style="color:#f97316;font-weight:bold">1st</div></div>
          <div class="drag-zone" data-accept="phase2" data-on-drop="handleBucketDrop" style="flex:1;min-width:80px;min-height:70px;border:2px dashed #f97316;border-radius:12px;padding:10px;text-align:center"><div style="color:#f97316;font-weight:bold">2nd</div></div>
          <div class="drag-zone" data-accept="phase3" data-on-drop="handleBucketDrop" style="flex:1;min-width:80px;min-height:70px;border:2px dashed #f97316;border-radius:12px;padding:10px;text-align:center"><div style="color:#f97316;font-weight:bold">3rd</div></div>
          <div class="drag-zone" data-accept="phase4" data-on-drop="handleBucketDrop" style="flex:1;min-width:80px;min-height:70px;border:2px dashed #f97316;border-radius:12px;padding:10px;text-align:center"><div style="color:#f97316;font-weight:bold">4th</div></div>
        </div>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> Quick Quiz!</h2>
        <p style="font-size:1.05rem;margin-bottom:16px">What is a Hohmann Transfer Orbit?</p>
        <div id="mq3" style="display:flex;flex-direction:column;gap:10px">
          <button onclick="document.querySelectorAll('#mq3 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #ef4444';showFeedback(document.getElementById('mq3'),'wrong','Not about speed! ')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">A) Flying straight at max speed</button>
          <button onclick="document.querySelectorAll('#mq3 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #10b981';showFeedback(document.getElementById('mq3'),'correct',' An energy-efficient curved path between planets!');window.addPoints(25)" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">B) Energy-efficient curved path between planets </button>
          <button onclick="document.querySelectorAll('#mq3 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #ef4444';showFeedback(document.getElementById('mq3'),'wrong','That was a different phase! ')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">C) Spinning around Earth forever</button>
        </div>
      </div>

      <div style="background:linear-gradient(135deg,rgba(249,115,22,0.1),rgba(249,115,22,0.05));border:1px solid rgba(249,115,22,0.2);border-radius:16px;padding:24px;margin-bottom:20px;text-align:center">
        <h2 style="margin-top:0"> Key Takeaway</h2>
        <p style="font-size:1.15rem;line-height:1.7">ISRO used the <strong style="color:#f97316">slingshot technique</strong> to save fuel  orbit Earth, then shoot to Mars on a curved path. AI calculates these trajectories! </p>
      </div>

      <button onclick="window.completeChapter('mangalyaan', 2)" style="width:100%;padding:16px;background:linear-gradient(135deg,#f97316,#ea580c);border:none;border-radius:12px;color:white;font-size:1.1rem;font-weight:bold;cursor:pointer;margin-top:12px"> Complete Chapter 3!</button>
    `,typeof ce=="function"&&ce(),vi(r.querySelector(".karaoke-container")),(function(){const o=document.getElementById("threejs-container"),l=document.getElementById("mars-canvas");if(!o||!l)return;if(window.THREE)p();else{const c=document.createElement("script");c.src="https://cdn.jsdelivr.net/npm/three@0.137.0/build/three.min.js",c.onload=()=>{const g=document.createElement("script");g.src="https://cdn.jsdelivr.net/npm/three@0.137.0/examples/js/controls/OrbitControls.js",g.onload=()=>p(),document.head.appendChild(g)},document.head.appendChild(c)}function p(){const c=window.THREE,g=o.clientWidth,h=o.clientHeight,b=new c.WebGLRenderer({canvas:l,antialias:!0,alpha:!0});b.setSize(g,h),b.setPixelRatio(Math.min(window.devicePixelRatio,2)),b.toneMapping=c.ACESFilmicToneMapping;const m=new c.Scene,v=new c.PerspectiveCamera(60,g/h,.1,1e3);v.position.set(0,8,18);const z=new c.OrbitControls(v,l);z.enableDamping=!0,z.dampingFactor=.05,z.minDistance=5,z.maxDistance=40,z.autoRotate=!0,z.autoRotateSpeed=.3;const k=new c.BufferGeometry,S=[];for(let Be=0;Be<3e3;Be++)S.push((Math.random()-.5)*200,(Math.random()-.5)*200,(Math.random()-.5)*200);k.setAttribute("position",new c.Float32BufferAttribute(S,3));const j=new c.PointsMaterial({color:16777215,size:.15,sizeAttenuation:!0});m.add(new c.Points(k,j));const R=new c.DirectionalLight(16774624,2);R.position.set(30,10,20),m.add(R),m.add(new c.AmbientLight(4210784,.5));const I=new c.SphereGeometry(.8,16,16),D=new c.MeshBasicMaterial({color:16768324}),U=new c.Mesh(I,D);U.position.set(30,10,20),m.add(U);const B=new c.SphereGeometry(1.2,32,32),E=new c.MeshPhongMaterial({color:2245802,emissive:1122884,specular:3355443,shininess:25}),N=new c.Mesh(B,E);N.position.set(-8,0,0),m.add(N);const M=new c.SphereGeometry(1.35,32,32),y=new c.MeshPhongMaterial({color:4491519,transparent:!0,opacity:.15,side:c.BackSide}),O=new c.Mesh(M,y);O.position.copy(N.position),m.add(O);const $=qe(" Earth");$.position.set(-8,2,0),m.add($);const ee=new c.SphereGeometry(.9,32,32),J=new c.MeshPhongMaterial({color:13386786,emissive:3346688,specular:2236962,shininess:15}),Q=new c.Mesh(ee,J);Q.position.set(8,0,0),m.add(Q);const re=new c.SphereGeometry(1.05,32,32),Z=new c.MeshPhongMaterial({color:16737860,transparent:!0,opacity:.1,side:c.BackSide}),se=new c.Mesh(re,Z);se.position.copy(Q.position),m.add(se);const w=qe(" Mars");w.position.set(8,1.8,0),m.add(w);const C=new c.Group,ne=new c.BoxGeometry(.3,.2,.4),F=new c.MeshPhongMaterial({color:13412932,emissive:3351040,metalness:.8});C.add(new c.Mesh(ne,F));const q=new c.BoxGeometry(.8,.02,.3),H=new c.MeshPhongMaterial({color:2250188,emissive:4403}),oe=new c.Mesh(q,H);oe.position.set(-.55,0,0),C.add(oe);const de=new c.Mesh(q,H);de.position.set(.55,0,0),C.add(de);const Se=new c.ConeGeometry(.15,.2,8),Le=new c.MeshPhongMaterial({color:15658734}),tt=new c.Mesh(Se,Le);tt.position.set(0,.2,0),C.add(tt);const Ye=new c.SphereGeometry(.08,8,8),gt=new c.MeshBasicMaterial({color:16737792,transparent:!0,opacity:0}),ot=new c.Mesh(Ye,gt);ot.position.set(0,0,.25),C.add(ot),C.position.copy(N.position),C.position.y=1.8,m.add(C);const ze=qe(" MOM");ze.position.set(0,.5,0),C.add(ze);const me=[],Te=new c.BufferGeometry,Ce=new c.LineBasicMaterial({color:16347926,transparent:!0,opacity:.6}),ct=new c.Line(Te,Ce);m.add(ct);const yt=new c.RingGeometry(1.6,1.65,64),V=new c.MeshBasicMaterial({color:4491519,transparent:!0,opacity:.2,side:c.DoubleSide}),ie=new c.Mesh(yt,V);ie.rotation.x=-Math.PI/2,ie.position.copy(N.position),m.add(ie);const je=new c.RingGeometry(1.3,1.35,64),Ae=new c.MeshBasicMaterial({color:16729122,transparent:!0,opacity:.2,side:c.DoubleSide}),le=new c.Mesh(je,Ae);le.rotation.x=-Math.PI/2,le.position.copy(Q.position),m.add(le);let ue=0,pe=0,Ue=!1;const ye=document.getElementById("orbit-phase"),W=document.getElementById("orbit-dist"),he=document.getElementById("orbit-speed");document.getElementById("btn-launch")?.addEventListener("click",()=>{Ue||(Ue=!0,ue=1,pe=0,me.length=0,ot.material.opacity=.8)}),document.getElementById("btn-reset")?.addEventListener("click",()=>{Ue=!1,ue=0,pe=0,me.length=0,C.position.set(N.position.x,1.8,N.position.z),ot.material.opacity=0,Te.setAttribute("position",new c.Float32BufferAttribute([],3)),ye&&(ye.textContent="Phase: Pre-Launch"),W&&(W.textContent="Distance: 0 km"),he&&(he.textContent="Speed: 0 km/s")});function qe(Be){const vt=document.createElement("canvas");vt.width=256,vt.height=64;const Fa=vt.getContext("2d");Fa.font="bold 28px Inter, Arial, sans-serif",Fa.fillStyle="#ffffff",Fa.textAlign="center",Fa.fillText(Be,128,40);const _a=new c.CanvasTexture(vt),jt=new c.SpriteMaterial({map:_a,transparent:!0,opacity:.9}),ua=new c.Sprite(jt);return ua.scale.set(2,.5,1),ua}function at(){if(document.getElementById("mars-canvas")){if(requestAnimationFrame(at),z.update(),N.rotation.y+=.003,Q.rotation.y+=.002,Ue){if(pe+=.003,ue===1){const Be=1.8+pe*2,vt=pe*8;C.position.x=N.position.x+Math.cos(vt)*Be,C.position.z=N.position.z+Math.sin(vt)*Be,C.position.y=Math.sin(vt*2)*.3,ye&&(ye.textContent="Phase:  Earth Orbit (Raising)"),W&&(W.textContent="Distance: "+Math.floor(Be*6371)+" km"),he&&(he.textContent="Speed: "+(7.5+pe*3).toFixed(1)+" km/s"),pe>1.2&&(ue=2,pe=0)}else if(ue===2){const Be=pe/2.5,vt=0,Fa=3,_a=(1-Be)*(1-Be)*N.position.x+2*(1-Be)*Be*vt+Be*Be*Q.position.x,jt=(1-Be)*(1-Be)*N.position.z+2*(1-Be)*Be*Fa+Be*Be*Q.position.z;C.position.x=_a,C.position.z=jt,C.position.y=Math.sin(Be*Math.PI)*1.5,ye&&(ye.textContent="Phase:  Trans-Mars Injection"),W&&(W.textContent="Distance: "+Math.floor(Be*225e6/1e3)+",000 km"),he&&(he.textContent="Speed: "+(11.5-Be*3).toFixed(1)+" km/s"),ot.material.opacity=.3+Math.sin(pe*10)*.3,Be>=1&&(ue=3,pe=0,ot.material.opacity=0)}else if(ue===3){const Be=1.3+Math.sin(pe*2)*.2,vt=pe*4;C.position.x=Q.position.x+Math.cos(vt)*Be,C.position.z=Q.position.z+Math.sin(vt)*Be,C.position.y=Math.sin(vt)*.2,ye&&(ye.textContent="Phase:  Mars Orbit Achieved!"),W&&(W.textContent="Altitude: "+Math.floor(Be*500)+" km"),he&&(he.textContent="Speed: 4.3 km/s")}me.push(C.position.x,C.position.y,C.position.z),me.length>3e3&&me.splice(0,3),Te.setAttribute("position",new c.Float32BufferAttribute(me,3))}b.render(m,v)}}at(),new ResizeObserver(()=>{const Be=o.clientWidth,vt=o.clientHeight;b.setSize(Be,vt),v.aspect=Be/vt,v.updateProjectionMatrix()}).observe(o)}})()},function(r){r.innerHTML=`
      <img src="./infographics/mangalyaan-ch4.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="Arriving at Mars infographic">
      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.2rem;margin:0"> Arriving at Mars</h1>
        <p style="color:#94a3b8;font-size:1.1rem;margin-top:8px">The most terrifying 4 minutes in ISRO's history!</p>
      </div>
      <div class="karaoke-container" style="background:linear-gradient(180deg,rgba(255,153,51,0.08) 0%,rgba(0,0,0,0.6) 40%,rgba(19,136,8,0.08) 100%);border:2px solid rgba(255,153,51,0.25);border-radius:24px;padding:28px 20px;margin-bottom:28px;text-align:center;position:relative;overflow:hidden">
        <div style="position:absolute;top:0;left:0;right:0;height:4px;background:linear-gradient(90deg,#ff9933,#ffffff,#138808)"></div>
        <div style="position:absolute;bottom:0;left:0;right:0;height:4px;background:linear-gradient(90deg,#138808,#ffffff,#ff9933)"></div>
        <div style="position:absolute;left:0;top:0;bottom:0;width:4px;background:linear-gradient(180deg,#ff9933,#138808)"></div>
        <div style="position:absolute;right:0;top:0;bottom:0;width:4px;background:linear-gradient(180deg,#138808,#ff9933)"></div>
        <audio class="karaoke-audio" src="./audio/jana-gana-mana.mp3" preload="auto"></audio>
        <div style="margin-bottom:20px">
          <div style="font-size:2rem;margin-bottom:4px"></div>
          <div style="font-size:1.3rem;font-weight:800;background:linear-gradient(90deg,#ff9933,#ffffff,#138808);-webkit-background-clip:text;-webkit-text-fill-color:transparent;letter-spacing:3px">JANA GANA MANA</div>
          <div style="font-size:0.8rem;color:rgba(255,255,255,0.4);margin-top:4px;letter-spacing:1px">India's National Anthem</div>
        </div>
        <div style="display:flex;justify-content:center;align-items:flex-end;gap:4px;height:40px;margin-bottom:20px">
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#ff9933,#ff993366);border-radius:3px;animation:kBar 0.8s ease-in-out infinite;animation-play-state:paused;height:10px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#ff9933,#ff993366);border-radius:3px;animation:kBar 0.6s ease-in-out infinite 0.1s;animation-play-state:paused;height:14px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#fff,#ffffff66);border-radius:3px;animation:kBar 0.7s ease-in-out infinite 0.2s;animation-play-state:paused;height:18px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#fff,#ffffff66);border-radius:3px;animation:kBar 0.5s ease-in-out infinite 0.15s;animation-play-state:paused;height:24px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#138808,#13880866);border-radius:3px;animation:kBar 0.9s ease-in-out infinite 0.05s;animation-play-state:paused;height:16px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#138808,#13880866);border-radius:3px;animation:kBar 0.65s ease-in-out infinite 0.25s;animation-play-state:paused;height:12px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#ff9933,#ff993366);border-radius:3px;animation:kBar 0.75s ease-in-out infinite 0.3s;animation-play-state:paused;height:20px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#fff,#ffffff66);border-radius:3px;animation:kBar 0.55s ease-in-out infinite 0.12s;animation-play-state:paused;height:28px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#138808,#13880866);border-radius:3px;animation:kBar 0.85s ease-in-out infinite 0.08s;animation-play-state:paused;height:18px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#ff9933,#ff993366);border-radius:3px;animation:kBar 0.6s ease-in-out infinite 0.2s;animation-play-state:paused;height:14px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#fff,#ffffff66);border-radius:3px;animation:kBar 0.7s ease-in-out infinite 0.18s;animation-play-state:paused;height:22px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#138808,#13880866);border-radius:3px;animation:kBar 0.58s ease-in-out infinite 0.22s;animation-play-state:paused;height:16px"></div>
        </div>
        <div style="position:relative;height:6px;background:rgba(255,255,255,0.06);border-radius:3px;margin-bottom:20px;overflow:hidden">
          <div class="karaoke-progress" style="position:absolute;left:0;top:0;height:100%;width:0%;background:linear-gradient(90deg,#ff9933,#ffffff,#138808);border-radius:3px;transition:width 0.3s linear;box-shadow:0 0 10px rgba(255,153,51,0.5)"></div>
        </div>
        <div class="karaoke-lyrics" style="max-height:240px;overflow-y:auto;margin-bottom:20px;padding:12px;scrollbar-width:thin;scrollbar-color:rgba(255,153,51,0.3) transparent;background:rgba(0,0,0,0.3);border-radius:16px;border:1px solid rgba(255,255,255,0.05)"></div>
        <div style="position:relative;display:inline-block;margin:8px 0">
          <div style="position:absolute;inset:-14px;border-radius:50%;background:conic-gradient(#ff9933,#ff993300,#ffffff,#ffffff00,#138808,#13880800,#ff9933);animation:kSpin 2.5s linear infinite;opacity:0.7"></div>
          <div style="position:absolute;inset:-7px;border-radius:50%;background:conic-gradient(#138808,#13880800,#ff9933,#ff993300,#ffffff,#ffffff00,#138808);animation:kSpin 4s linear infinite reverse;opacity:0.4"></div>
          <button class="karaoke-play" style="position:relative;width:80px;height:80px;border-radius:50%;background:radial-gradient(circle at 35% 35%,#2a1f3d,#0f0f1a 70%);border:2px solid rgba(255,153,51,0.4);color:white;font-size:1.8rem;cursor:pointer;box-shadow:0 0 40px rgba(255,153,51,0.25),0 0 80px rgba(255,153,51,0.1),inset 0 2px 4px rgba(255,255,255,0.1);transition:all 0.3s ease;display:flex;align-items:center;justify-content:center;animation:kPulse 2s ease-in-out infinite"></button>
        </div>
        <div style="margin-top:14px;font-size:0.75rem;color:rgba(255,153,51,0.6);letter-spacing:3px;text-transform:uppercase;font-weight:600"> tap to play </div>
      </div>

      <div style="background:rgba(249,115,22,0.08);border:1px solid rgba(249,115,22,0.3);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> September 24, 2014</h2>
        <p style="font-size:1.05rem;line-height:1.7">After <strong style="color:#f97316">300 days and 680 million km</strong>, Mangalyaan reached Mars! The spacecraft had to slow down with a <strong style="color:#f97316">24-minute engine burn</strong>. Too fast = fly past forever. Too slow = crash! </p>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> The 12-Minute Terror</h2>
        <p style="font-size:1.05rem;line-height:1.7">Radio signals take <strong style="color:#f97316">12 minutes 28 seconds</strong> between Mars and Earth!</p>
        <div style="background:rgba(249,115,22,0.15);border-radius:16px;padding:20px;margin:16px 0;text-align:center">
          <div style="display:flex;align-items:center;justify-content:center;gap:20px;flex-wrap:wrap">
            <div><div style="font-size:2.5rem"></div><div style="font-weight:bold;color:#f97316">Earth</div></div>
            <div style="color:#f97316;font-size:1.2rem"> ~~~ 12 min ~~~ </div>
            <div><div style="font-size:2.5rem"></div><div style="font-weight:bold;color:#f97316">Mars</div></div>
          </div>
          <p style="margin-top:12px;color:#fbbf24">By the time ISRO sees a problem, it happened 12 minutes ago! </p>
        </div>
        <p style="font-size:1.05rem;line-height:1.7">So Mangalyaan made <strong>critical decisions BY ITSELF</strong>  this is <strong style="color:#f97316">autonomous decision-making</strong>! </p>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> SUCCESS!</h2>
        <p style="font-size:1.05rem;line-height:1.7">At <strong style="color:#f97316">7:30 AM IST</strong>, the signal came  Mangalyaan was in Mars orbit! India became:</p>
        <ul style="font-size:1.05rem;line-height:2">
          <li> <strong style="color:#f97316">FIRST Asian nation</strong> to reach Mars</li>
          <li> <strong style="color:#f97316">FIRST country</strong> to succeed on its FIRST attempt</li>
          <li>4th space agency to reach Mars (after Roscosmos, NASA, ESA)</li>
        </ul>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> Activity: Human vs AI Decisions!</h2>
        <p>Drag each decision to Human or AI! </p>
        <div style="display:flex;flex-wrap:wrap;gap:10px;margin:16px 0">
          <div class="drag-item" data-id="d1" data-value="ai" style="background:linear-gradient(135deg,#431407,#7c2d12);border:1px solid rgba(249,115,22,0.3);border-radius:12px;padding:12px 16px;cursor:grab;font-size:0.9rem"> Emergency engine shutdown</div>
          <div class="drag-item" data-id="d2" data-value="human" style="background:linear-gradient(135deg,#431407,#7c2d12);border:1px solid rgba(249,115,22,0.3);border-radius:12px;padding:12px 16px;cursor:grab;font-size:0.9rem"> Choose next planet to explore</div>
          <div class="drag-item" data-id="d3" data-value="ai" style="background:linear-gradient(135deg,#431407,#7c2d12);border:1px solid rgba(249,115,22,0.3);border-radius:12px;padding:12px 16px;cursor:grab;font-size:0.9rem"> Adjust temperature every second</div>
          <div class="drag-item" data-id="d4" data-value="human" style="background:linear-gradient(135deg,#431407,#7c2d12);border:1px solid rgba(249,115,22,0.3);border-radius:12px;padding:12px 16px;cursor:grab;font-size:0.9rem"> Decide mission budget</div>
        </div>
        <div style="display:flex;gap:16px;flex-wrap:wrap">
          <div class="drag-zone" data-accept="human" data-on-drop="handleBucketDrop" style="flex:1;min-width:160px;min-height:100px;border:2px dashed #f97316;border-radius:12px;padding:14px;text-align:center"><div style="color:#f97316;font-weight:bold"> Human Decides</div></div>
          <div class="drag-zone" data-accept="ai" data-on-drop="handleBucketDrop" style="flex:1;min-width:160px;min-height:100px;border:2px dashed #f97316;border-radius:12px;padding:14px;text-align:center"><div style="color:#f97316;font-weight:bold"> AI Decides</div></div>
        </div>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> Quick Quiz!</h2>
        <p style="font-size:1.05rem;margin-bottom:16px">Why did Mangalyaan need to act by itself?</p>
        <div id="mq4" style="display:flex;flex-direction:column;gap:10px">
          <button onclick="document.querySelectorAll('#mq4 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #ef4444';showFeedback(document.getElementById('mq4'),'wrong','Scientists were awake! Signals are just slow ')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">A) Scientists were sleeping</button>
          <button onclick="document.querySelectorAll('#mq4 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #10b981';showFeedback(document.getElementById('mq4'),'correct',' The 12-minute delay meant it had to act alone!');window.addPoints(25)" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">B) 12+ minute signal delay between Earth and Mars </button>
          <button onclick="document.querySelectorAll('#mq4 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #ef4444';showFeedback(document.getElementById('mq4'),'wrong','It had fuel, timing was the issue! ')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">C) Ran out of fuel</button>
        </div>
      </div>

      <div style="background:linear-gradient(135deg,rgba(249,115,22,0.1),rgba(249,115,22,0.05));border:1px solid rgba(249,115,22,0.2);border-radius:16px;padding:24px;margin-bottom:20px;text-align:center">
        <h2 style="margin-top:0"> Key Takeaway</h2>
        <p style="font-size:1.15rem;line-height:1.7">The 12-minute delay forced Mangalyaan to be <strong style="color:#f97316">autonomous</strong>  just like AI in self-driving cars! India became first to reach Mars on its first try! </p>
      </div>

      <button onclick="window.completeChapter('mangalyaan', 3)" style="width:100%;padding:16px;background:linear-gradient(135deg,#f97316,#ea580c);border:none;border-radius:12px;color:white;font-size:1.1rem;font-weight:bold;cursor:pointer;margin-top:12px"> Complete Chapter 4!</button>
    `,typeof ce=="function"&&ce(),vi(r.querySelector(".karaoke-container"))},function(r){r.innerHTML=`
      <img src="./infographics/mangalyaan-ch5.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="Eyes on Mars infographic">
      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.2rem;margin:0"> Eyes on Mars</h1>
        <p style="color:#94a3b8;font-size:1.1rem;margin-top:8px">What Mangalyaan discovered about the Red Planet!</p>
      </div>
      <div class="karaoke-container" style="background:linear-gradient(180deg,rgba(255,153,51,0.08) 0%,rgba(0,0,0,0.6) 40%,rgba(19,136,8,0.08) 100%);border:2px solid rgba(255,153,51,0.25);border-radius:24px;padding:28px 20px;margin-bottom:28px;text-align:center;position:relative;overflow:hidden">
        <div style="position:absolute;top:0;left:0;right:0;height:4px;background:linear-gradient(90deg,#ff9933,#ffffff,#138808)"></div>
        <div style="position:absolute;bottom:0;left:0;right:0;height:4px;background:linear-gradient(90deg,#138808,#ffffff,#ff9933)"></div>
        <div style="position:absolute;left:0;top:0;bottom:0;width:4px;background:linear-gradient(180deg,#ff9933,#138808)"></div>
        <div style="position:absolute;right:0;top:0;bottom:0;width:4px;background:linear-gradient(180deg,#138808,#ff9933)"></div>
        <audio class="karaoke-audio" src="./audio/jana-gana-mana.mp3" preload="auto"></audio>
        <div style="margin-bottom:20px">
          <div style="font-size:2rem;margin-bottom:4px"></div>
          <div style="font-size:1.3rem;font-weight:800;background:linear-gradient(90deg,#ff9933,#ffffff,#138808);-webkit-background-clip:text;-webkit-text-fill-color:transparent;letter-spacing:3px">JANA GANA MANA</div>
          <div style="font-size:0.8rem;color:rgba(255,255,255,0.4);margin-top:4px;letter-spacing:1px">India's National Anthem</div>
        </div>
        <div style="display:flex;justify-content:center;align-items:flex-end;gap:4px;height:40px;margin-bottom:20px">
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#ff9933,#ff993366);border-radius:3px;animation:kBar 0.8s ease-in-out infinite;animation-play-state:paused;height:10px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#ff9933,#ff993366);border-radius:3px;animation:kBar 0.6s ease-in-out infinite 0.1s;animation-play-state:paused;height:14px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#fff,#ffffff66);border-radius:3px;animation:kBar 0.7s ease-in-out infinite 0.2s;animation-play-state:paused;height:18px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#fff,#ffffff66);border-radius:3px;animation:kBar 0.5s ease-in-out infinite 0.15s;animation-play-state:paused;height:24px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#138808,#13880866);border-radius:3px;animation:kBar 0.9s ease-in-out infinite 0.05s;animation-play-state:paused;height:16px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#138808,#13880866);border-radius:3px;animation:kBar 0.65s ease-in-out infinite 0.25s;animation-play-state:paused;height:12px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#ff9933,#ff993366);border-radius:3px;animation:kBar 0.75s ease-in-out infinite 0.3s;animation-play-state:paused;height:20px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#fff,#ffffff66);border-radius:3px;animation:kBar 0.55s ease-in-out infinite 0.12s;animation-play-state:paused;height:28px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#138808,#13880866);border-radius:3px;animation:kBar 0.85s ease-in-out infinite 0.08s;animation-play-state:paused;height:18px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#ff9933,#ff993366);border-radius:3px;animation:kBar 0.6s ease-in-out infinite 0.2s;animation-play-state:paused;height:14px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#fff,#ffffff66);border-radius:3px;animation:kBar 0.7s ease-in-out infinite 0.18s;animation-play-state:paused;height:22px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#138808,#13880866);border-radius:3px;animation:kBar 0.58s ease-in-out infinite 0.22s;animation-play-state:paused;height:16px"></div>
        </div>
        <div style="position:relative;height:6px;background:rgba(255,255,255,0.06);border-radius:3px;margin-bottom:20px;overflow:hidden">
          <div class="karaoke-progress" style="position:absolute;left:0;top:0;height:100%;width:0%;background:linear-gradient(90deg,#ff9933,#ffffff,#138808);border-radius:3px;transition:width 0.3s linear;box-shadow:0 0 10px rgba(255,153,51,0.5)"></div>
        </div>
        <div class="karaoke-lyrics" style="max-height:240px;overflow-y:auto;margin-bottom:20px;padding:12px;scrollbar-width:thin;scrollbar-color:rgba(255,153,51,0.3) transparent;background:rgba(0,0,0,0.3);border-radius:16px;border:1px solid rgba(255,255,255,0.05)"></div>
        <div style="position:relative;display:inline-block;margin:8px 0">
          <div style="position:absolute;inset:-14px;border-radius:50%;background:conic-gradient(#ff9933,#ff993300,#ffffff,#ffffff00,#138808,#13880800,#ff9933);animation:kSpin 2.5s linear infinite;opacity:0.7"></div>
          <div style="position:absolute;inset:-7px;border-radius:50%;background:conic-gradient(#138808,#13880800,#ff9933,#ff993300,#ffffff,#ffffff00,#138808);animation:kSpin 4s linear infinite reverse;opacity:0.4"></div>
          <button class="karaoke-play" style="position:relative;width:80px;height:80px;border-radius:50%;background:radial-gradient(circle at 35% 35%,#2a1f3d,#0f0f1a 70%);border:2px solid rgba(255,153,51,0.4);color:white;font-size:1.8rem;cursor:pointer;box-shadow:0 0 40px rgba(255,153,51,0.25),0 0 80px rgba(255,153,51,0.1),inset 0 2px 4px rgba(255,255,255,0.1);transition:all 0.3s ease;display:flex;align-items:center;justify-content:center;animation:kPulse 2s ease-in-out infinite"></button>
        </div>
        <div style="margin-top:14px;font-size:0.75rem;color:rgba(255,153,51,0.6);letter-spacing:3px;text-transform:uppercase;font-weight:600"> tap to play </div>
      </div>

      <!-- 3D Solar System Explorer -->
      <style>#solar-explorer{height:600px}@media(max-width:768px){#solar-explorer{height:400px}#solar-hud{font-size:0.75rem;padding:10px 12px!important;min-width:auto!important}#planet-bar span{font-size:0.6rem!important}}</style>
      <div id="solar-explorer" style="position:relative;width:100%;height:600px;border-radius:20px;overflow:hidden;margin-bottom:28px;background:#050510;border:2px solid rgba(249,115,22,0.3)">
        <canvas id="solar-canvas" style="width:100%;height:100%;display:block"></canvas>
        <!-- HUD: Mission Tracker -->
        <div id="solar-hud" style="position:absolute;top:16px;left:16px;background:rgba(10,10,30,0.75);backdrop-filter:blur(12px);border:1px solid rgba(249,115,22,0.3);border-radius:14px;padding:16px 20px;color:#fff;font-family:system-ui;z-index:10;min-width:220px">
          <div style="font-size:0.75rem;letter-spacing:3px;color:#f97316;font-weight:700;margin-bottom:8px"> ISRO MISSION TRACKER</div>
          <div id="hud-phase" style="font-size:0.9rem;margin-bottom:4px">Phase: <span style="color:#f97316">Earth Orbit</span></div>
          <div id="hud-dist" style="font-size:0.85rem;color:#94a3b8">Distance: 0 km</div>
          <div id="hud-speed" style="font-size:0.85rem;color:#94a3b8">Speed: 32.8 km/s</div>
        </div>
        <!-- Controls -->
        <div style="position:absolute;top:16px;right:16px;display:flex;flex-direction:column;gap:8px;z-index:10">
          <button id="btn-follow" style="padding:10px 16px;background:rgba(249,115,22,0.2);backdrop-filter:blur(8px);border:1px solid rgba(249,115,22,0.4);border-radius:10px;color:#f97316;font-size:0.8rem;font-weight:700;cursor:pointer;letter-spacing:1px"> Follow Mangalyaan</button>
          <button id="btn-reset" style="padding:10px 16px;background:rgba(255,255,255,0.08);backdrop-filter:blur(8px);border:1px solid rgba(255,255,255,0.15);border-radius:10px;color:#fff;font-size:0.8rem;font-weight:700;cursor:pointer;letter-spacing:1px"> Reset View</button>
        </div>
        <!-- Planet info popup -->
        <div id="planet-info" style="display:none;position:absolute;bottom:60px;left:50%;transform:translateX(-50%);background:rgba(10,10,30,0.85);backdrop-filter:blur(16px);border:1px solid rgba(249,115,22,0.4);border-radius:16px;padding:20px 28px;color:#fff;font-family:system-ui;z-index:10;text-align:center;min-width:240px">
          <div id="pi-name" style="font-size:1.3rem;font-weight:800;color:#f97316"></div>
          <div id="pi-fact" style="font-size:0.9rem;color:#cbd5e1;margin-top:6px;line-height:1.5"></div>
          <div id="pi-dist" style="font-size:0.8rem;color:#94a3b8;margin-top:6px"></div>
        </div>
        <!-- Bottom planet bar -->
        <div id="planet-bar" style="position:absolute;bottom:0;left:0;right:0;background:rgba(10,10,30,0.7);backdrop-filter:blur(8px);padding:8px 16px;display:flex;justify-content:center;gap:16px;z-index:10;border-top:1px solid rgba(255,255,255,0.06)">
          <span style="color:#fbbf24;font-size:0.75rem"> Sun</span>
          <span style="color:#9ca3af;font-size:0.75rem">Mercury</span>
          <span style="color:#fde68a;font-size:0.75rem">Venus</span>
          <span style="color:#60a5fa;font-size:0.75rem"> Earth</span>
          <span id="bar-mars" style="color:#f97316;font-size:0.75rem"> Mars</span>
          <span style="color:#c2956a;font-size:0.75rem">Jupiter</span>
          <span style="color:#d4a843;font-size:0.75rem">Saturn</span>
          <span style="color:#7dd3fc;font-size:0.75rem">Uranus</span>
          <span style="color:#6366f1;font-size:0.75rem">Neptune</span>
        </div>
        <!-- Celebration overlay -->
        <div id="solar-celebrate" style="display:none;position:absolute;inset:0;background:rgba(0,0,0,0.6);z-index:20;display:none;align-items:center;justify-content:center;flex-direction:column">
          <div style="font-size:3rem"></div>
          <div style="font-size:1.5rem;font-weight:800;color:#f97316;margin-top:12px">Mars Orbit Achieved!</div>
          <div style="color:#94a3b8;margin-top:6px">Mangalyaan enters Mars orbit  September 24, 2014</div>
        </div>
      </div>

      <div style="background:rgba(249,115,22,0.08);border:1px solid rgba(249,115,22,0.3);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> 8+ Years of Discovery!</h2>
        <p style="font-size:1.05rem;line-height:1.7">Designed for <strong style="color:#f97316">6 months</strong>, lasted over <strong style="color:#f97316">8 YEARS</strong> until 2022! Like a phone with 6-month warranty lasting 8 years! </p>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> Key Discoveries</h2>
        <div style="display:grid;gap:14px;margin-top:16px">
          <div style="background:rgba(249,115,22,0.1);border-radius:14px;padding:18px;display:flex;gap:14px;align-items:start">
            <span style="font-size:2rem"></span>
            <div><h3 style="color:#f97316;margin:0 0 6px 0">1,000+ Stunning Photos</h3><p style="font-size:0.95rem;color:#94a3b8;margin:0">Full-disc Mars image went viral! Captured craters, Valles Marineris (10x Grand Canyon!), dust storms.</p></div>
          </div>
          <div style="background:rgba(255,255,255,0.05);border-radius:14px;padding:18px;display:flex;gap:14px;align-items:start">
            <span style="font-size:2rem"></span>
            <div><h3 style="color:#f97316;margin:0 0 6px 0">Temperature Maps</h3><p style="font-size:0.95rem;color:#94a3b8;margin:0">Mars ranges from -140C to +20C. FREEZING most of the time! </p></div>
          </div>
          <div style="background:rgba(249,115,22,0.1);border-radius:14px;padding:18px;display:flex;gap:14px;align-items:start">
            <span style="font-size:2rem"></span>
            <div><h3 style="color:#f97316;margin:0 0 6px 0">Atmosphere Studies</h3><p style="font-size:0.95rem;color:#94a3b8;margin:0">Mars atmosphere is 100x thinner than Earth's! Mostly CO. Scientists tracked how gases escape into space.</p></div>
          </div>
          <div style="background:rgba(255,255,255,0.05);border-radius:14px;padding:18px;display:flex;gap:14px;align-items:start">
            <span style="font-size:2rem"></span>
            <div><h3 style="color:#f97316;margin:0 0 6px 0">Dust Storm Tracking</h3><p style="font-size:0.95rem;color:#94a3b8;margin:0">Captured massive storms covering entire continents! Can last months!</p></div>
          </div>
        </div>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> AI Connection: Pattern Recognition</h2>
        <p style="font-size:1.05rem;line-height:1.7">AI analyzes thousands of space images automatically: counting craters, predicting dust storms, and stitching photos into 3D maps. Like how your phone recognizes faces  but on Mars! </p>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> Activity: Match Mars Features!</h2>
        <p>Drag each feature to what it tells scientists! </p>
        <div style="display:flex;flex-wrap:wrap;gap:10px;margin:16px 0">
          <div class="drag-item" data-id="f1" data-value="geology" style="background:linear-gradient(135deg,#431407,#7c2d12);border:1px solid rgba(249,115,22,0.3);border-radius:12px;padding:12px 16px;cursor:grab"> Craters everywhere</div>
          <div class="drag-item" data-id="f2" data-value="weather" style="background:linear-gradient(135deg,#431407,#7c2d12);border:1px solid rgba(249,115,22,0.3);border-radius:12px;padding:12px 16px;cursor:grab"> Giant dust storms</div>
          <div class="drag-item" data-id="f3" data-value="water" style="background:linear-gradient(135deg,#431407,#7c2d12);border:1px solid rgba(249,115,22,0.3);border-radius:12px;padding:12px 16px;cursor:grab"> Deep canyons</div>
          <div class="drag-item" data-id="f4" data-value="atmosphere" style="background:linear-gradient(135deg,#431407,#7c2d12);border:1px solid rgba(249,115,22,0.3);border-radius:12px;padding:12px 16px;cursor:grab"> Thin CO air</div>
        </div>
        <div style="display:flex;flex-wrap:wrap;gap:12px">
          <div class="drag-zone" data-accept="geology" data-on-drop="handleBucketDrop" style="flex:1;min-width:120px;min-height:70px;border:2px dashed #f97316;border-radius:12px;padding:10px;text-align:center"><div style="color:#f97316;font-weight:bold;font-size:0.85rem"> Ancient impacts</div></div>
          <div class="drag-zone" data-accept="weather" data-on-drop="handleBucketDrop" style="flex:1;min-width:120px;min-height:70px;border:2px dashed #f97316;border-radius:12px;padding:10px;text-align:center"><div style="color:#f97316;font-weight:bold;font-size:0.85rem"> Active weather</div></div>
          <div class="drag-zone" data-accept="water" data-on-drop="handleBucketDrop" style="flex:1;min-width:120px;min-height:70px;border:2px dashed #f97316;border-radius:12px;padding:10px;text-align:center"><div style="color:#f97316;font-weight:bold;font-size:0.85rem"> Water once flowed</div></div>
          <div class="drag-zone" data-accept="atmosphere" data-on-drop="handleBucketDrop" style="flex:1;min-width:120px;min-height:70px;border:2px dashed #f97316;border-radius:12px;padding:10px;text-align:center"><div style="color:#f97316;font-weight:bold;font-size:0.85rem"> Can't breathe</div></div>
        </div>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> Quick Quiz!</h2>
        <p style="font-size:1.05rem;margin-bottom:16px">How long did Mangalyaan actually work?</p>
        <div id="mq5" style="display:flex;flex-direction:column;gap:10px">
          <button onclick="document.querySelectorAll('#mq5 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #ef4444';showFeedback(document.getElementById('mq5'),'wrong','That was the plan! It lasted way longer! ')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">A) 6 months</button>
          <button onclick="document.querySelectorAll('#mq5 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #10b981';showFeedback(document.getElementById('mq5'),'correct',' Over 8 YEARS! ISRO engineering excellence!');window.addPoints(25)" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">B) Over 8 years! </button>
          <button onclick="document.querySelectorAll('#mq5 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #ef4444';showFeedback(document.getElementById('mq5'),'wrong','Even longer! ')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">C) 2 years</button>
        </div>
      </div>

      <div style="background:linear-gradient(135deg,rgba(249,115,22,0.1),rgba(249,115,22,0.05));border:1px solid rgba(249,115,22,0.2);border-radius:16px;padding:24px;margin-bottom:20px;text-align:center">
        <h2 style="margin-top:0"> Key Takeaway</h2>
        <p style="font-size:1.15rem;line-height:1.7">Mangalyaan gave us 8+ years of Mars data! <strong style="color:#f97316">AI pattern recognition</strong> helps analyze thousands of images automatically. </p>
      </div>

      <button onclick="window.completeChapter('mangalyaan', 4)" style="width:100%;padding:16px;background:linear-gradient(135deg,#f97316,#ea580c);border:none;border-radius:12px;color:white;font-size:1.1rem;font-weight:bold;cursor:pointer;margin-top:12px"> Complete Chapter 5!</button>
    `,typeof ce=="function"&&ce(),vi(r.querySelector(".karaoke-container")),(function(){const o=document.getElementById("solar-explorer"),l=document.getElementById("solar-canvas");if(!o||!l)return;function p(){const c=window.THREE,g=o.clientWidth,h=o.clientHeight,b=new c.WebGLRenderer({canvas:l,antialias:!0,alpha:!1});b.setSize(g,h),b.setPixelRatio(Math.min(window.devicePixelRatio,2)),b.setClearColor(328976);const m=new c.Scene,v=new c.PerspectiveCamera(55,g/h,.1,2e3);v.position.set(0,60,100);const z=new c.OrbitControls(v,b.domElement);z.enableDamping=!0,z.dampingFactor=.05,z.autoRotate=!0,z.autoRotateSpeed=.3,z.minDistance=15,z.maxDistance=400;const k=new c.BufferGeometry,S=new Float32Array(3e3*3);for(let ze=0;ze<9e3;ze++)S[ze]=(Math.random()-.5)*1e3;k.setAttribute("position",new c.BufferAttribute(S,3)),m.add(new c.Points(k,new c.PointsMaterial({color:16777215,size:.3}))),m.add(new c.AmbientLight(3355460,.5));const j=new c.PointLight(16774624,2,500);m.add(j);const R=new c.MeshBasicMaterial({color:16763955}),I=new c.Mesh(new c.SphereGeometry(5,32,32),R);m.add(I);const D=(()=>{const ze=document.createElement("canvas");ze.width=ze.height=128;const me=ze.getContext("2d"),Te=me.createRadialGradient(64,64,8,64,64,64);return Te.addColorStop(0,"rgba(255,204,51,0.6)"),Te.addColorStop(.4,"rgba(255,150,30,0.2)"),Te.addColorStop(1,"rgba(255,100,0,0)"),me.fillStyle=Te,me.fillRect(0,0,128,128),new c.CanvasTexture(ze)})(),U=new c.Sprite(new c.SpriteMaterial({map:D,transparent:!0,blending:c.AdditiveBlending}));U.scale.set(22,22,1),I.add(U);const B=[["Mercury",.5,10,11579568,4.1,"Closest to the Sun. No atmosphere!","57.9M km"],["Venus",.9,15,16113331,1.6,"Hottest planet at 465C! Spins backwards.","108.2M km"],["Earth",1,22,4491519,1,"Our home! Only planet with liquid water.","149.6M km"],["Mars",.8,30,15228204,.53,"The Red Planet! Mangalyaan orbits here. ","227.9M km"],["Jupiter",3.5,46,12752234,.084,"Biggest planet! 1,300 Earths could fit inside.","778.5M km"],["Saturn",2.8,62,13936707,.034,"Beautiful rings made of ice & rock!","1.43B km"],["Uranus",1.8,76,8246268,.012,"Tilted 98! Rolls around the Sun.","2.87B km"],["Neptune",1.7,88,5592541,.006,"Windiest planet  2,100 km/h winds!","4.5B km"]],E=[],N=[];B.forEach(([ze,me,Te,Ce,ct,yt,V])=>{const ie=new c.Mesh(new c.RingGeometry(Te-.08,Te+.08,128),new c.MeshBasicMaterial({color:16777215,transparent:!0,opacity:.06,side:c.DoubleSide}));ie.rotation.x=-Math.PI/2,m.add(ie);const je=new c.Mesh(new c.SphereGeometry(me,24,24),new c.MeshStandardMaterial({color:Ce,roughness:.7,metalness:.1}));if(m.add(je),ze==="Saturn"){const ye=new c.Mesh(new c.RingGeometry(me*1.4,me*2.2,64),new c.MeshBasicMaterial({color:15259043,transparent:!0,opacity:.5,side:c.DoubleSide}));ye.rotation.x=-Math.PI/2.5,je.add(ye)}if(ze==="Earth"){const ye=new c.Mesh(new c.SphereGeometry(me*1.15,24,24),new c.MeshBasicMaterial({color:8961023,transparent:!0,opacity:.15}));je.add(ye)}const Ae=document.createElement("canvas");Ae.width=256,Ae.height=64;const le=Ae.getContext("2d");le.font="bold 28px system-ui",le.fillStyle="#ffffff",le.textAlign="center",le.fillText(ze,128,40);const ue=new c.CanvasTexture(Ae),pe=new c.Sprite(new c.SpriteMaterial({map:ue,transparent:!0,opacity:.7}));pe.scale.set(6,1.5,1),pe.position.y=me+2,je.add(pe);const Ue=Math.random()*Math.PI*2;E.push({name:ze,mesh:je,orbit:Te,speed:ct,angle:Ue,fact:yt,dist:V}),N.push(je)});const M=new c.Group;M.add(new c.Mesh(new c.BoxGeometry(.8,.5,.5),new c.MeshStandardMaterial({color:16347926,metalness:.6,roughness:.3})));const y=new c.Mesh(new c.BoxGeometry(1.8,.05,.6),new c.MeshStandardMaterial({color:2245802,metalness:.4})),O=y.clone();O.position.x=1.3,M.add(O);const $=y.clone();$.position.x=-1.3,M.add($),M.add(new c.Mesh(new c.SphereGeometry(.3,12,8,0,Math.PI),new c.MeshStandardMaterial({color:13421772,metalness:.5}))),M.children[3].position.set(0,.35,0),M.children[3].rotation.x=-Math.PI/2,m.add(M);const ee=600,J=new c.BufferGeometry,Q=new Float32Array(ee*3);J.setAttribute("position",new c.BufferAttribute(Q,3)),J.setDrawRange(0,0);const re=new c.Line(J,new c.LineBasicMaterial({color:16347926,transparent:!0,opacity:.6}));m.add(re);let Z=0,se=0,w=!1,C=!1;const ne=22,F=30,q=new c.Raycaster,H=new c.Vector2,oe=document.getElementById("planet-info");l.addEventListener("click",ze=>{const me=l.getBoundingClientRect();H.x=(ze.clientX-me.left)/me.width*2-1,H.y=-((ze.clientY-me.top)/me.height)*2+1,q.setFromCamera(H,v);const Te=q.intersectObjects(N);if(Te.length>0){const Ce=E.find(ct=>ct.mesh===Te[0].object);Ce&&(document.getElementById("pi-name").textContent=(Ce.name==="Earth"?" ":Ce.name==="Mars"?" ":"")+Ce.name,document.getElementById("pi-fact").textContent=Ce.fact,document.getElementById("pi-dist").textContent=" Distance from Sun: "+Ce.dist,oe.style.display="block",setTimeout(()=>{oe.style.display="none"},5e3))}}),document.getElementById("btn-follow").addEventListener("click",()=>{w=!w,document.getElementById("btn-follow").style.background=w?"rgba(249,115,22,0.5)":"rgba(249,115,22,0.2)"}),document.getElementById("btn-reset").addEventListener("click",()=>{w=!1,v.position.set(0,60,100),z.target.set(0,0,0)});const de=document.getElementById("hud-phase"),Se=document.getElementById("hud-dist"),Le=document.getElementById("hud-speed"),tt=document.getElementById("solar-celebrate");function Ye(ze){if(ze<.3){const me=ze/.3*Math.PI*2*2;return{x:Math.cos(me)*ne,z:Math.sin(me)*ne,y:Math.sin(me*3)*.3}}else if(ze<.7){const me=(ze-.3)/.4,Te=ne+(F-ne)*me,Ce=Math.PI*.5+me*Math.PI;return{x:Math.cos(Ce)*Te,z:Math.sin(Ce)*Te,y:Math.sin(me*Math.PI)*3}}else{const me=(ze-.7)/.3,Te=Math.PI*1.5+me*Math.PI*2*2;return{x:Math.cos(Te)*F,z:Math.sin(Te)*F,y:Math.sin(Te*2)*.2}}}function gt(){if(!document.getElementById("solar-canvas"))return;requestAnimationFrame(gt),E.forEach(Ce=>{Ce.angle+=Ce.speed*.002,Ce.mesh.position.x=Math.cos(Ce.angle)*Ce.orbit,Ce.mesh.position.z=Math.sin(Ce.angle)*Ce.orbit,Ce.mesh.rotation.y+=.005});const ze=1+Math.sin(Date.now()*.002)*.03;I.scale.set(ze,ze,ze),Z+=3e-4,Z>1&&(Z=0,se=0,C=!1);const me=Ye(Z);M.position.set(me.x,me.y,me.z),M.rotation.y+=.02,se<ee&&(Q[se*3]=me.x,Q[se*3+1]=me.y,Q[se*3+2]=me.z,se++,J.attributes.position.needsUpdate=!0,J.setDrawRange(0,se));const Te=Math.round(Z*68e4);Se.innerHTML='Distance: <span style="color:#f97316">'+Te.toLocaleString()+" km</span>",Le.innerHTML='Speed: <span style="color:#94a3b8">'+(Z<.3?"32.8":Z<.7?"24.5":"4.4")+" km/s</span>",Z<.3?de.innerHTML='Phase: <span style="color:#60a5fa">Earth Orbit</span>':Z<.7?de.innerHTML='Phase: <span style="color:#f97316">Hohmann Transfer</span>':(de.innerHTML='Phase: <span style="color:#ef4444">Mars Orbit! </span>',C||(C=!0,tt.style.display="flex",setTimeout(()=>{tt.style.display="none"},4e3))),w&&z.target.set(me.x,me.y,me.z),z.update(),b.render(m,v)}gt(),new ResizeObserver(()=>{const ze=o.clientWidth,me=o.clientHeight;b.setSize(ze,me),v.aspect=ze/me,v.updateProjectionMatrix()}).observe(o)}if(window.THREE&&window.THREE.OrbitControls)p();else if(window.THREE){const c=document.createElement("script");c.src="https://cdn.jsdelivr.net/npm/three@0.137.0/examples/js/controls/OrbitControls.js",c.onload=p,document.head.appendChild(c)}else{const c=document.createElement("script");c.src="https://cdn.jsdelivr.net/npm/three@0.137.0/build/three.min.js",c.onload=()=>{const g=document.createElement("script");g.src="https://cdn.jsdelivr.net/npm/three@0.137.0/examples/js/controls/OrbitControls.js",g.onload=p,document.head.appendChild(g)},document.head.appendChild(c)}})()},function(r){r.innerHTML=`
      <img src="./infographics/mangalyaan-ch6.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="Budget Mission infographic">
      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.2rem;margin:0"> The 7-per-km Mission</h1>
        <p style="color:#94a3b8;font-size:1.1rem;margin-top:8px">Cheaper than an auto-rickshaw ride!</p>
      </div>
      <div class="karaoke-container" style="background:linear-gradient(180deg,rgba(255,153,51,0.08) 0%,rgba(0,0,0,0.6) 40%,rgba(19,136,8,0.08) 100%);border:2px solid rgba(255,153,51,0.25);border-radius:24px;padding:28px 20px;margin-bottom:28px;text-align:center;position:relative;overflow:hidden">
        <div style="position:absolute;top:0;left:0;right:0;height:4px;background:linear-gradient(90deg,#ff9933,#ffffff,#138808)"></div>
        <div style="position:absolute;bottom:0;left:0;right:0;height:4px;background:linear-gradient(90deg,#138808,#ffffff,#ff9933)"></div>
        <div style="position:absolute;left:0;top:0;bottom:0;width:4px;background:linear-gradient(180deg,#ff9933,#138808)"></div>
        <div style="position:absolute;right:0;top:0;bottom:0;width:4px;background:linear-gradient(180deg,#138808,#ff9933)"></div>
        <audio class="karaoke-audio" src="./audio/jana-gana-mana.mp3" preload="auto"></audio>
        <div style="margin-bottom:20px">
          <div style="font-size:2rem;margin-bottom:4px"></div>
          <div style="font-size:1.3rem;font-weight:800;background:linear-gradient(90deg,#ff9933,#ffffff,#138808);-webkit-background-clip:text;-webkit-text-fill-color:transparent;letter-spacing:3px">JANA GANA MANA</div>
          <div style="font-size:0.8rem;color:rgba(255,255,255,0.4);margin-top:4px;letter-spacing:1px">India's National Anthem</div>
        </div>
        <div style="display:flex;justify-content:center;align-items:flex-end;gap:4px;height:40px;margin-bottom:20px">
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#ff9933,#ff993366);border-radius:3px;animation:kBar 0.8s ease-in-out infinite;animation-play-state:paused;height:10px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#ff9933,#ff993366);border-radius:3px;animation:kBar 0.6s ease-in-out infinite 0.1s;animation-play-state:paused;height:14px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#fff,#ffffff66);border-radius:3px;animation:kBar 0.7s ease-in-out infinite 0.2s;animation-play-state:paused;height:18px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#fff,#ffffff66);border-radius:3px;animation:kBar 0.5s ease-in-out infinite 0.15s;animation-play-state:paused;height:24px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#138808,#13880866);border-radius:3px;animation:kBar 0.9s ease-in-out infinite 0.05s;animation-play-state:paused;height:16px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#138808,#13880866);border-radius:3px;animation:kBar 0.65s ease-in-out infinite 0.25s;animation-play-state:paused;height:12px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#ff9933,#ff993366);border-radius:3px;animation:kBar 0.75s ease-in-out infinite 0.3s;animation-play-state:paused;height:20px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#fff,#ffffff66);border-radius:3px;animation:kBar 0.55s ease-in-out infinite 0.12s;animation-play-state:paused;height:28px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#138808,#13880866);border-radius:3px;animation:kBar 0.85s ease-in-out infinite 0.08s;animation-play-state:paused;height:18px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#ff9933,#ff993366);border-radius:3px;animation:kBar 0.6s ease-in-out infinite 0.2s;animation-play-state:paused;height:14px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#fff,#ffffff66);border-radius:3px;animation:kBar 0.7s ease-in-out infinite 0.18s;animation-play-state:paused;height:22px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#138808,#13880866);border-radius:3px;animation:kBar 0.58s ease-in-out infinite 0.22s;animation-play-state:paused;height:16px"></div>
        </div>
        <div style="position:relative;height:6px;background:rgba(255,255,255,0.06);border-radius:3px;margin-bottom:20px;overflow:hidden">
          <div class="karaoke-progress" style="position:absolute;left:0;top:0;height:100%;width:0%;background:linear-gradient(90deg,#ff9933,#ffffff,#138808);border-radius:3px;transition:width 0.3s linear;box-shadow:0 0 10px rgba(255,153,51,0.5)"></div>
        </div>
        <div class="karaoke-lyrics" style="max-height:240px;overflow-y:auto;margin-bottom:20px;padding:12px;scrollbar-width:thin;scrollbar-color:rgba(255,153,51,0.3) transparent;background:rgba(0,0,0,0.3);border-radius:16px;border:1px solid rgba(255,255,255,0.05)"></div>
        <div style="position:relative;display:inline-block;margin:8px 0">
          <div style="position:absolute;inset:-14px;border-radius:50%;background:conic-gradient(#ff9933,#ff993300,#ffffff,#ffffff00,#138808,#13880800,#ff9933);animation:kSpin 2.5s linear infinite;opacity:0.7"></div>
          <div style="position:absolute;inset:-7px;border-radius:50%;background:conic-gradient(#138808,#13880800,#ff9933,#ff993300,#ffffff,#ffffff00,#138808);animation:kSpin 4s linear infinite reverse;opacity:0.4"></div>
          <button class="karaoke-play" style="position:relative;width:80px;height:80px;border-radius:50%;background:radial-gradient(circle at 35% 35%,#2a1f3d,#0f0f1a 70%);border:2px solid rgba(255,153,51,0.4);color:white;font-size:1.8rem;cursor:pointer;box-shadow:0 0 40px rgba(255,153,51,0.25),0 0 80px rgba(255,153,51,0.1),inset 0 2px 4px rgba(255,255,255,0.1);transition:all 0.3s ease;display:flex;align-items:center;justify-content:center;animation:kPulse 2s ease-in-out infinite"></button>
        </div>
        <div style="margin-top:14px;font-size:0.75rem;color:rgba(255,153,51,0.6);letter-spacing:3px;text-transform:uppercase;font-weight:600"> tap to play </div>
      </div>

      <div style="background:rgba(249,115,22,0.08);border:1px solid rgba(249,115,22,0.3);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> The Unbelievable Budget</h2>
        <p style="font-size:1.05rem;line-height:1.7">Mangalyaan cost <strong style="color:#f97316">450 crore ($74 million)</strong>:</p>
        <div style="background:rgba(249,115,22,0.15);border-radius:16px;padding:20px;margin:16px 0;display:grid;gap:10px">
          <div style="display:flex;align-items:center;gap:12px"><span style="font-size:1.5rem"></span><span><strong style="color:#f97316">Mangalyaan:</strong> $74M</span></div>
          <div style="display:flex;align-items:center;gap:12px"><span style="font-size:1.5rem"></span><span><strong>Movie "Gravity":</strong> $100M (a movie cost MORE!) </span></div>
          <div style="display:flex;align-items:center;gap:12px"><span style="font-size:1.5rem"></span><span><strong>NASA MAVEN:</strong> $671M (9x more!)</span></div>
          <div style="display:flex;align-items:center;gap:12px"><span style="font-size:1.5rem"></span><span><strong>ESA Mars Express:</strong> $386M (5x more!)</span></div>
        </div>
        <p style="font-size:1.05rem;line-height:1.7">That's <strong style="color:#f97316">7 per km</strong>  less than an auto ride! </p>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> Jugaad Engineering!</h2>
        <p style="font-size:1.05rem;line-height:1.7"><strong style="color:#f97316">Jugaad</strong> () = creative problem-solving:</p>
        <div style="display:grid;gap:12px;margin-top:14px">
          <div style="background:rgba(249,115,22,0.08);border-radius:12px;padding:16px;display:flex;gap:12px"><span style="font-size:1.5rem"></span><div><strong style="color:#f97316">Reused proven tech</strong><br><span style="color:#94a3b8">PSLV rocket and existing satellite designs</span></div></div>
          <div style="background:rgba(255,255,255,0.05);border-radius:12px;padding:16px;display:flex;gap:12px"><span style="font-size:1.5rem"></span><div><strong style="color:#f97316">Kept it light</strong><br><span style="color:#94a3b8">1,337 kg = less fuel = less cost!</span></div></div>
          <div style="background:rgba(249,115,22,0.08);border-radius:12px;padding:16px;display:flex;gap:12px"><span style="font-size:1.5rem"></span><div><strong style="color:#f97316">Small expert team</strong><br><span style="color:#94a3b8">Focused team, 18-hour days</span></div></div>
          <div style="background:rgba(255,255,255,0.05);border-radius:12px;padding:16px;display:flex;gap:12px"><span style="font-size:1.5rem"></span><div><strong style="color:#f97316">Made in India</strong><br><span style="color:#94a3b8">No expensive foreign parts!</span></div></div>
        </div>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> AI Connection: Resource Optimization</h2>
        <p style="font-size:1.05rem;line-height:1.7">AI optimizes fuel paths, material selection, schedules, and budget predictions  making expensive missions possible on tight budgets! </p>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> Activity: Rank Mission Costs!</h2>
        <p>Drag from CHEAPEST to MOST EXPENSIVE! </p>
        <div style="display:flex;flex-wrap:wrap;gap:10px;margin:16px 0">
          <div class="drag-item" data-id="c1" data-value="cheapest" style="background:linear-gradient(135deg,#431407,#7c2d12);border:1px solid rgba(249,115,22,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> Mangalyaan $74M</div>
          <div class="drag-item" data-id="c2" data-value="expensive" style="background:linear-gradient(135deg,#431407,#7c2d12);border:1px solid rgba(249,115,22,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> MAVEN $671M</div>
          <div class="drag-item" data-id="c3" data-value="medium" style="background:linear-gradient(135deg,#431407,#7c2d12);border:1px solid rgba(249,115,22,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> Mars Express $386M</div>
          <div class="drag-item" data-id="c4" data-value="mid-low" style="background:linear-gradient(135deg,#431407,#7c2d12);border:1px solid rgba(249,115,22,0.3);border-radius:12px;padding:12px 18px;cursor:grab"> Gravity $100M</div>
        </div>
        <div style="display:grid;gap:10px">
          <div class="drag-zone" data-accept="cheapest" data-on-drop="handleBucketDrop" style="min-height:55px;border:2px dashed #22c55e;border-radius:12px;padding:10px;text-align:center"><div style="color:#22c55e;font-weight:bold"> CHEAPEST</div></div>
          <div class="drag-zone" data-accept="mid-low" data-on-drop="handleBucketDrop" style="min-height:55px;border:2px dashed #f97316;border-radius:12px;padding:10px;text-align:center"><div style="color:#f97316;font-weight:bold"> 2nd</div></div>
          <div class="drag-zone" data-accept="medium" data-on-drop="handleBucketDrop" style="min-height:55px;border:2px dashed #f97316;border-radius:12px;padding:10px;text-align:center"><div style="color:#f97316;font-weight:bold"> 3rd</div></div>
          <div class="drag-zone" data-accept="expensive" data-on-drop="handleBucketDrop" style="min-height:55px;border:2px dashed #ef4444;border-radius:12px;padding:10px;text-align:center"><div style="color:#ef4444;font-weight:bold"> MOST EXPENSIVE</div></div>
        </div>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> Quick Quiz!</h2>
        <p style="font-size:1.05rem;margin-bottom:16px">Mangalyaan cost less than which movie?</p>
        <div id="mq6" style="display:flex;flex-direction:column;gap:10px">
          <button onclick="document.querySelectorAll('#mq6 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #ef4444';showFeedback(document.getElementById('mq6'),'wrong','Try again! ')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">A) Avengers: Endgame</button>
          <button onclick="document.querySelectorAll('#mq6 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #10b981';showFeedback(document.getElementById('mq6'),'correct',' Gravity cost $100M, Mangalyaan only $74M! Real Mars mission < space movie!');window.addPoints(25)" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">B) Gravity </button>
          <button onclick="document.querySelectorAll('#mq6 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #ef4444';showFeedback(document.getElementById('mq6'),'wrong','Think space-themed! ')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">C) The Lion King</button>
        </div>
      </div>

      <div style="background:linear-gradient(135deg,rgba(249,115,22,0.1),rgba(249,115,22,0.05));border:1px solid rgba(249,115,22,0.2);border-radius:16px;padding:24px;margin-bottom:20px;text-align:center">
        <h2 style="margin-top:0"> Key Takeaway</h2>
        <p style="font-size:1.15rem;line-height:1.7">7 per km to Mars! <strong style="color:#f97316">Innovation beats big budgets</strong>. AI helps optimize resources to make impossible missions possible! </p>
      </div>

      <button onclick="window.completeChapter('mangalyaan', 5)" style="width:100%;padding:16px;background:linear-gradient(135deg,#f97316,#ea580c);border:none;border-radius:12px;color:white;font-size:1.1rem;font-weight:bold;cursor:pointer;margin-top:12px"> Complete Chapter 6!</button>
    `,typeof ce=="function"&&ce(),vi(r.querySelector(".karaoke-container"))},function(r){r.innerHTML=`
      <img src="./infographics/mangalyaan-ch7.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="Space Heroes infographic">
      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.2rem;margin:0"> India's Space Heroes</h1>
        <p style="color:#94a3b8;font-size:1.1rem;margin-top:8px">Meet the brilliant scientists behind Mangalyaan!</p>
      </div>
      <div class="karaoke-container" style="background:linear-gradient(180deg,rgba(255,153,51,0.08) 0%,rgba(0,0,0,0.6) 40%,rgba(19,136,8,0.08) 100%);border:2px solid rgba(255,153,51,0.25);border-radius:24px;padding:28px 20px;margin-bottom:28px;text-align:center;position:relative;overflow:hidden">
        <div style="position:absolute;top:0;left:0;right:0;height:4px;background:linear-gradient(90deg,#ff9933,#ffffff,#138808)"></div>
        <div style="position:absolute;bottom:0;left:0;right:0;height:4px;background:linear-gradient(90deg,#138808,#ffffff,#ff9933)"></div>
        <div style="position:absolute;left:0;top:0;bottom:0;width:4px;background:linear-gradient(180deg,#ff9933,#138808)"></div>
        <div style="position:absolute;right:0;top:0;bottom:0;width:4px;background:linear-gradient(180deg,#138808,#ff9933)"></div>
        <audio class="karaoke-audio" src="./audio/jana-gana-mana.mp3" preload="auto"></audio>
        <div style="margin-bottom:20px">
          <div style="font-size:2rem;margin-bottom:4px"></div>
          <div style="font-size:1.3rem;font-weight:800;background:linear-gradient(90deg,#ff9933,#ffffff,#138808);-webkit-background-clip:text;-webkit-text-fill-color:transparent;letter-spacing:3px">JANA GANA MANA</div>
          <div style="font-size:0.8rem;color:rgba(255,255,255,0.4);margin-top:4px;letter-spacing:1px">India's National Anthem</div>
        </div>
        <div style="display:flex;justify-content:center;align-items:flex-end;gap:4px;height:40px;margin-bottom:20px">
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#ff9933,#ff993366);border-radius:3px;animation:kBar 0.8s ease-in-out infinite;animation-play-state:paused;height:10px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#ff9933,#ff993366);border-radius:3px;animation:kBar 0.6s ease-in-out infinite 0.1s;animation-play-state:paused;height:14px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#fff,#ffffff66);border-radius:3px;animation:kBar 0.7s ease-in-out infinite 0.2s;animation-play-state:paused;height:18px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#fff,#ffffff66);border-radius:3px;animation:kBar 0.5s ease-in-out infinite 0.15s;animation-play-state:paused;height:24px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#138808,#13880866);border-radius:3px;animation:kBar 0.9s ease-in-out infinite 0.05s;animation-play-state:paused;height:16px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#138808,#13880866);border-radius:3px;animation:kBar 0.65s ease-in-out infinite 0.25s;animation-play-state:paused;height:12px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#ff9933,#ff993366);border-radius:3px;animation:kBar 0.75s ease-in-out infinite 0.3s;animation-play-state:paused;height:20px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#fff,#ffffff66);border-radius:3px;animation:kBar 0.55s ease-in-out infinite 0.12s;animation-play-state:paused;height:28px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#138808,#13880866);border-radius:3px;animation:kBar 0.85s ease-in-out infinite 0.08s;animation-play-state:paused;height:18px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#ff9933,#ff993366);border-radius:3px;animation:kBar 0.6s ease-in-out infinite 0.2s;animation-play-state:paused;height:14px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#fff,#ffffff66);border-radius:3px;animation:kBar 0.7s ease-in-out infinite 0.18s;animation-play-state:paused;height:22px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#138808,#13880866);border-radius:3px;animation:kBar 0.58s ease-in-out infinite 0.22s;animation-play-state:paused;height:16px"></div>
        </div>
        <div style="position:relative;height:6px;background:rgba(255,255,255,0.06);border-radius:3px;margin-bottom:20px;overflow:hidden">
          <div class="karaoke-progress" style="position:absolute;left:0;top:0;height:100%;width:0%;background:linear-gradient(90deg,#ff9933,#ffffff,#138808);border-radius:3px;transition:width 0.3s linear;box-shadow:0 0 10px rgba(255,153,51,0.5)"></div>
        </div>
        <div class="karaoke-lyrics" style="max-height:240px;overflow-y:auto;margin-bottom:20px;padding:12px;scrollbar-width:thin;scrollbar-color:rgba(255,153,51,0.3) transparent;background:rgba(0,0,0,0.3);border-radius:16px;border:1px solid rgba(255,255,255,0.05)"></div>
        <div style="position:relative;display:inline-block;margin:8px 0">
          <div style="position:absolute;inset:-14px;border-radius:50%;background:conic-gradient(#ff9933,#ff993300,#ffffff,#ffffff00,#138808,#13880800,#ff9933);animation:kSpin 2.5s linear infinite;opacity:0.7"></div>
          <div style="position:absolute;inset:-7px;border-radius:50%;background:conic-gradient(#138808,#13880800,#ff9933,#ff993300,#ffffff,#ffffff00,#138808);animation:kSpin 4s linear infinite reverse;opacity:0.4"></div>
          <button class="karaoke-play" style="position:relative;width:80px;height:80px;border-radius:50%;background:radial-gradient(circle at 35% 35%,#2a1f3d,#0f0f1a 70%);border:2px solid rgba(255,153,51,0.4);color:white;font-size:1.8rem;cursor:pointer;box-shadow:0 0 40px rgba(255,153,51,0.25),0 0 80px rgba(255,153,51,0.1),inset 0 2px 4px rgba(255,255,255,0.1);transition:all 0.3s ease;display:flex;align-items:center;justify-content:center;animation:kPulse 2s ease-in-out infinite"></button>
        </div>
        <div style="margin-top:14px;font-size:0.75rem;color:rgba(255,153,51,0.6);letter-spacing:3px;text-transform:uppercase;font-weight:600"> tap to play </div>
      </div>

      <div style="background:rgba(249,115,22,0.08);border:1px solid rgba(249,115,22,0.3);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> The Leaders</h2>
        <div style="display:grid;gap:14px;margin-top:14px">
          <div style="background:rgba(249,115,22,0.1);border-radius:14px;padding:18px;display:flex;gap:14px;align-items:start">
            <div style="font-size:2.5rem"></div>
            <div><h3 style="color:#f97316;margin:0 0 6px 0">K. Radhakrishnan</h3><p style="font-size:0.95rem;color:#94a3b8;margin:0"><strong>ISRO Chairman</strong> who led both Chandrayaan-1 and Mangalyaan! </p></div>
          </div>
          <div style="background:rgba(255,255,255,0.05);border-radius:14px;padding:18px;display:flex;gap:14px;align-items:start">
            <div style="font-size:2.5rem"></div>
            <div><h3 style="color:#f97316;margin:0 0 6px 0">S. Arunan</h3><p style="font-size:0.95rem;color:#94a3b8;margin:0"><strong>Project Director</strong>  designed, built, and operated Mangalyaan. 18-hour days! </p></div>
          </div>
          <div style="background:rgba(249,115,22,0.1);border-radius:14px;padding:18px;display:flex;gap:14px;align-items:start">
            <div style="font-size:2.5rem"></div>
            <div><h3 style="color:#f97316;margin:0 0 6px 0">M. Annadurai</h3><p style="font-size:0.95rem;color:#94a3b8;margin:0"><strong>"Moon Man of India"</strong>  led Chandrayaan-1, guided Mars mission. </p></div>
          </div>
        </div>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> Women Power at ISRO!</h2>
        <p style="font-size:1.05rem;line-height:1.7">The iconic photo of <strong style="color:#f97316">women scientists celebrating in saris</strong> at Mission Control went VIRAL and inspired millions! </p>
        <div style="display:grid;gap:14px;margin-top:14px">
          <div style="background:rgba(236,72,153,0.1);border-radius:14px;padding:18px;display:flex;gap:14px;align-items:start">
            <div style="font-size:2.5rem"></div>
            <div><h3 style="color:#ec4899;margin:0 0 6px 0">Ritu Karidhal</h3><p style="font-size:0.95rem;color:#94a3b8;margin:0"><strong>"Rocket Woman of India"</strong>  Deputy Operations Director. Later Mission Director for Chandrayaan-2! </p></div>
          </div>
          <div style="background:rgba(139,92,246,0.1);border-radius:14px;padding:18px;display:flex;gap:14px;align-items:start">
            <div style="font-size:2.5rem"></div>
            <div><h3 style="color:#8b5cf6;margin:0 0 6px 0">Nandini Harinath</h3><p style="font-size:0.95rem;color:#94a3b8;margin:0">Navigation expert inspired by Star Trek!  Worked on 14 space missions!</p></div>
          </div>
          <div style="background:rgba(6,182,212,0.1);border-radius:14px;padding:18px;display:flex;gap:14px;align-items:start">
            <div style="font-size:2.5rem"></div>
            <div><h3 style="color:#06b6d4;margin:0 0 6px 0">Minal Sampath</h3><p style="font-size:0.95rem;color:#94a3b8;margin:0">Systems engineer who designed Mangalyaan's structure! </p></div>
          </div>
        </div>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> AI Connection: AI in Teamwork</h2>
        <p style="font-size:1.05rem;line-height:1.7">AI helps big teams schedule tasks, spot risks early, and track progress. But human creativity and courage make the impossible possible! </p>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> Activity: Match the Hero!</h2>
        <p>Drag each scientist to their role! </p>
        <div style="display:flex;flex-wrap:wrap;gap:10px;margin:16px 0">
          <div class="drag-item" data-id="h1" data-value="chairman" style="background:linear-gradient(135deg,#431407,#7c2d12);border:1px solid rgba(249,115,22,0.3);border-radius:12px;padding:12px 16px;cursor:grab"> K. Radhakrishnan</div>
          <div class="drag-item" data-id="h2" data-value="rocketwoman" style="background:linear-gradient(135deg,#431407,#7c2d12);border:1px solid rgba(249,115,22,0.3);border-radius:12px;padding:12px 16px;cursor:grab"> Ritu Karidhal</div>
          <div class="drag-item" data-id="h3" data-value="director" style="background:linear-gradient(135deg,#431407,#7c2d12);border:1px solid rgba(249,115,22,0.3);border-radius:12px;padding:12px 16px;cursor:grab"> S. Arunan</div>
          <div class="drag-item" data-id="h4" data-value="moonman" style="background:linear-gradient(135deg,#431407,#7c2d12);border:1px solid rgba(249,115,22,0.3);border-radius:12px;padding:12px 16px;cursor:grab"> M. Annadurai</div>
        </div>
        <div style="display:flex;flex-wrap:wrap;gap:12px">
          <div class="drag-zone" data-accept="chairman" data-on-drop="handleBucketDrop" style="flex:1;min-width:120px;min-height:70px;border:2px dashed #f97316;border-radius:12px;padding:10px;text-align:center"><div style="color:#f97316;font-weight:bold;font-size:0.85rem"> ISRO Chairman</div></div>
          <div class="drag-zone" data-accept="rocketwoman" data-on-drop="handleBucketDrop" style="flex:1;min-width:120px;min-height:70px;border:2px dashed #f97316;border-radius:12px;padding:10px;text-align:center"><div style="color:#f97316;font-weight:bold;font-size:0.85rem"> Rocket Woman</div></div>
          <div class="drag-zone" data-accept="director" data-on-drop="handleBucketDrop" style="flex:1;min-width:120px;min-height:70px;border:2px dashed #f97316;border-radius:12px;padding:10px;text-align:center"><div style="color:#f97316;font-weight:bold;font-size:0.85rem"> Project Director</div></div>
          <div class="drag-zone" data-accept="moonman" data-on-drop="handleBucketDrop" style="flex:1;min-width:120px;min-height:70px;border:2px dashed #f97316;border-radius:12px;padding:10px;text-align:center"><div style="color:#f97316;font-weight:bold;font-size:0.85rem"> Moon Man</div></div>
        </div>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> Quick Quiz!</h2>
        <p style="font-size:1.05rem;margin-bottom:16px">Who is the "Rocket Woman of India"?</p>
        <div id="mq7" style="display:flex;flex-direction:column;gap:10px">
          <button onclick="document.querySelectorAll('#mq7 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #ef4444';showFeedback(document.getElementById('mq7'),'wrong','He is Moon Man! ')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">A) M. Annadurai</button>
          <button onclick="document.querySelectorAll('#mq7 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #10b981';showFeedback(document.getElementById('mq7'),'correct',' Ritu Karidhal  Deputy Operations Director for Mangalyaan!');window.addPoints(25)" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">B) Ritu Karidhal </button>
          <button onclick="document.querySelectorAll('#mq7 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #ef4444';showFeedback(document.getElementById('mq7'),'wrong','He was ISRO Chairman! ')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">C) K. Radhakrishnan</button>
        </div>
      </div>

      <div style="background:linear-gradient(135deg,rgba(249,115,22,0.1),rgba(249,115,22,0.05));border:1px solid rgba(249,115,22,0.2);border-radius:16px;padding:24px;margin-bottom:20px;text-align:center">
        <h2 style="margin-top:0"> Key Takeaway</h2>
        <p style="font-size:1.15rem;line-height:1.7">Behind Mangalyaan are <strong style="color:#f97316">incredible people</strong>  including inspiring women scientists! Talent and determination matter most. </p>
      </div>

      <button onclick="window.completeChapter('mangalyaan', 6)" style="width:100%;padding:16px;background:linear-gradient(135deg,#f97316,#ea580c);border:none;border-radius:12px;color:white;font-size:1.1rem;font-weight:bold;cursor:pointer;margin-top:12px"> Complete Chapter 7!</button>
    `,typeof ce=="function"&&ce(),vi(r.querySelector(".karaoke-container"))},function(r){r.innerHTML=`
      <img src="./infographics/mangalyaan-ch8.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="Your Mission Begins infographic">
      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.2rem;margin:0"> Your Mission Begins!</h1>
        <p style="color:#94a3b8;font-size:1.1rem;margin-top:8px">India's future in space  and YOUR role in it!</p>
      </div>
      <div class="karaoke-container" style="background:linear-gradient(180deg,rgba(255,153,51,0.08) 0%,rgba(0,0,0,0.6) 40%,rgba(19,136,8,0.08) 100%);border:2px solid rgba(255,153,51,0.25);border-radius:24px;padding:28px 20px;margin-bottom:28px;text-align:center;position:relative;overflow:hidden">
        <div style="position:absolute;top:0;left:0;right:0;height:4px;background:linear-gradient(90deg,#ff9933,#ffffff,#138808)"></div>
        <div style="position:absolute;bottom:0;left:0;right:0;height:4px;background:linear-gradient(90deg,#138808,#ffffff,#ff9933)"></div>
        <div style="position:absolute;left:0;top:0;bottom:0;width:4px;background:linear-gradient(180deg,#ff9933,#138808)"></div>
        <div style="position:absolute;right:0;top:0;bottom:0;width:4px;background:linear-gradient(180deg,#138808,#ff9933)"></div>
        <audio class="karaoke-audio" src="./audio/jana-gana-mana.mp3" preload="auto"></audio>
        <div style="margin-bottom:20px">
          <div style="font-size:2rem;margin-bottom:4px"></div>
          <div style="font-size:1.3rem;font-weight:800;background:linear-gradient(90deg,#ff9933,#ffffff,#138808);-webkit-background-clip:text;-webkit-text-fill-color:transparent;letter-spacing:3px">JANA GANA MANA</div>
          <div style="font-size:0.8rem;color:rgba(255,255,255,0.4);margin-top:4px;letter-spacing:1px">India's National Anthem</div>
        </div>
        <div style="display:flex;justify-content:center;align-items:flex-end;gap:4px;height:40px;margin-bottom:20px">
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#ff9933,#ff993366);border-radius:3px;animation:kBar 0.8s ease-in-out infinite;animation-play-state:paused;height:10px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#ff9933,#ff993366);border-radius:3px;animation:kBar 0.6s ease-in-out infinite 0.1s;animation-play-state:paused;height:14px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#fff,#ffffff66);border-radius:3px;animation:kBar 0.7s ease-in-out infinite 0.2s;animation-play-state:paused;height:18px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#fff,#ffffff66);border-radius:3px;animation:kBar 0.5s ease-in-out infinite 0.15s;animation-play-state:paused;height:24px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#138808,#13880866);border-radius:3px;animation:kBar 0.9s ease-in-out infinite 0.05s;animation-play-state:paused;height:16px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#138808,#13880866);border-radius:3px;animation:kBar 0.65s ease-in-out infinite 0.25s;animation-play-state:paused;height:12px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#ff9933,#ff993366);border-radius:3px;animation:kBar 0.75s ease-in-out infinite 0.3s;animation-play-state:paused;height:20px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#fff,#ffffff66);border-radius:3px;animation:kBar 0.55s ease-in-out infinite 0.12s;animation-play-state:paused;height:28px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#138808,#13880866);border-radius:3px;animation:kBar 0.85s ease-in-out infinite 0.08s;animation-play-state:paused;height:18px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#ff9933,#ff993366);border-radius:3px;animation:kBar 0.6s ease-in-out infinite 0.2s;animation-play-state:paused;height:14px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#fff,#ffffff66);border-radius:3px;animation:kBar 0.7s ease-in-out infinite 0.18s;animation-play-state:paused;height:22px"></div>
          <div class="karaoke-bar" style="width:5px;background:linear-gradient(180deg,#138808,#13880866);border-radius:3px;animation:kBar 0.58s ease-in-out infinite 0.22s;animation-play-state:paused;height:16px"></div>
        </div>
        <div style="position:relative;height:6px;background:rgba(255,255,255,0.06);border-radius:3px;margin-bottom:20px;overflow:hidden">
          <div class="karaoke-progress" style="position:absolute;left:0;top:0;height:100%;width:0%;background:linear-gradient(90deg,#ff9933,#ffffff,#138808);border-radius:3px;transition:width 0.3s linear;box-shadow:0 0 10px rgba(255,153,51,0.5)"></div>
        </div>
        <div class="karaoke-lyrics" style="max-height:240px;overflow-y:auto;margin-bottom:20px;padding:12px;scrollbar-width:thin;scrollbar-color:rgba(255,153,51,0.3) transparent;background:rgba(0,0,0,0.3);border-radius:16px;border:1px solid rgba(255,255,255,0.05)"></div>
        <div style="position:relative;display:inline-block;margin:8px 0">
          <div style="position:absolute;inset:-14px;border-radius:50%;background:conic-gradient(#ff9933,#ff993300,#ffffff,#ffffff00,#138808,#13880800,#ff9933);animation:kSpin 2.5s linear infinite;opacity:0.7"></div>
          <div style="position:absolute;inset:-7px;border-radius:50%;background:conic-gradient(#138808,#13880800,#ff9933,#ff993300,#ffffff,#ffffff00,#138808);animation:kSpin 4s linear infinite reverse;opacity:0.4"></div>
          <button class="karaoke-play" style="position:relative;width:80px;height:80px;border-radius:50%;background:radial-gradient(circle at 35% 35%,#2a1f3d,#0f0f1a 70%);border:2px solid rgba(255,153,51,0.4);color:white;font-size:1.8rem;cursor:pointer;box-shadow:0 0 40px rgba(255,153,51,0.25),0 0 80px rgba(255,153,51,0.1),inset 0 2px 4px rgba(255,255,255,0.1);transition:all 0.3s ease;display:flex;align-items:center;justify-content:center;animation:kPulse 2s ease-in-out infinite"></button>
        </div>
        <div style="margin-top:14px;font-size:0.75rem;color:rgba(255,153,51,0.6);letter-spacing:3px;text-transform:uppercase;font-weight:600"> tap to play </div>
      </div>

      <!-- 3D BUILD & LAUNCH MANGALYAAN INTERACTIVE -->
      <div id="mission-builder" style="position:relative;width:100%;margin-bottom:28px;border-radius:20px;overflow:hidden;background:linear-gradient(180deg,#0a0a1a 0%,#0d1117 50%,#0a0a1a 100%);border:1px solid rgba(249,115,22,0.2);box-shadow:0 0 60px rgba(249,115,22,0.1)">
        <div id="mb-header" style="text-align:center;padding:24px 20px 8px;position:relative;z-index:2">
          <div style="font-size:0.75rem;letter-spacing:4px;color:rgba(249,115,22,0.6);text-transform:uppercase;font-weight:600;margin-bottom:6px">Interactive Experience</div>
          <h2 style="margin:0;font-size:1.6rem;background:linear-gradient(135deg,#f97316,#fb923c,#fbbf24);-webkit-background-clip:text;-webkit-text-fill-color:transparent;font-weight:800"> Build & Launch Mangalyaan</h2>
          <p style="color:#64748b;font-size:0.9rem;margin:6px 0 0">Drag components onto the satellite, then launch your mission to Mars!</p>
        </div>
        <div id="mb-scene" style="position:relative;width:100%;height:420px;cursor:grab">
          <canvas id="mb-canvas" style="width:100%;height:100%;display:block"></canvas>
          <div id="mb-dropzone" style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:160px;height:160px;border:2px dashed rgba(249,115,22,0.3);border-radius:50%;pointer-events:none;transition:all 0.3s"></div>
          <div id="mb-info-popup" style="position:absolute;top:16px;left:50%;transform:translateX(-50%);background:rgba(0,0,0,0.85);backdrop-filter:blur(12px);border:1px solid rgba(249,115,22,0.4);border-radius:12px;padding:12px 20px;color:white;font-size:0.9rem;opacity:0;transition:opacity 0.4s;pointer-events:none;white-space:nowrap;z-index:10"></div>
        </div>
        <div id="mb-progress" style="padding:0 20px 8px;position:relative;z-index:2">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px">
            <span style="font-size:0.8rem;color:#94a3b8;font-weight:600">Components Installed</span>
            <span id="mb-count" style="font-size:0.8rem;color:#f97316;font-weight:700">0 / 5</span>
          </div>
          <div style="height:6px;background:rgba(255,255,255,0.06);border-radius:3px;overflow:hidden">
            <div id="mb-bar" style="height:100%;width:0%;background:linear-gradient(90deg,#f97316,#fbbf24);border-radius:3px;transition:width 0.5s ease"></div>
          </div>
        </div>
        <div id="mb-cards" style="display:flex;flex-wrap:wrap;justify-content:center;gap:10px;padding:12px 16px 20px;position:relative;z-index:5">
          <div class="mb-card" data-comp="solar" draggable="true" style="background:linear-gradient(135deg,rgba(59,130,246,0.2),rgba(59,130,246,0.05));border:1px solid rgba(59,130,246,0.3);border-radius:12px;padding:12px 16px;cursor:grab;user-select:none;transition:all 0.3s;min-width:140px;text-align:center;touch-action:none">
            <div style="font-size:1.8rem"></div>
            <div style="font-weight:700;color:#60a5fa;font-size:0.85rem">Solar Panels</div>
            <div style="font-size:0.7rem;color:#64748b;margin-top:2px">Powers for 6 months</div>
          </div>
          <div class="mb-card" data-comp="dish" draggable="true" style="background:linear-gradient(135deg,rgba(226,232,240,0.15),rgba(226,232,240,0.03));border:1px solid rgba(226,232,240,0.2);border-radius:12px;padding:12px 16px;cursor:grab;user-select:none;transition:all 0.3s;min-width:140px;text-align:center;touch-action:none">
            <div style="font-size:1.8rem"></div>
            <div style="font-weight:700;color:#e2e8f0;font-size:0.85rem">Comm Dish</div>
            <div style="font-size:0.7rem;color:#64748b;margin-top:2px">225M km range</div>
          </div>
          <div class="mb-card" data-comp="camera" draggable="true" style="background:linear-gradient(135deg,rgba(249,115,22,0.2),rgba(249,115,22,0.05));border:1px solid rgba(249,115,22,0.3);border-radius:12px;padding:12px 16px;cursor:grab;user-select:none;transition:all 0.3s;min-width:140px;text-align:center;touch-action:none">
            <div style="font-size:1.8rem"></div>
            <div style="font-weight:700;color:#fb923c;font-size:0.85rem">Mars Camera</div>
            <div style="font-size:0.7rem;color:#64748b;margin-top:2px">Stunning Mars photos</div>
          </div>
          <div class="mb-card" data-comp="engine" draggable="true" style="background:linear-gradient(135deg,rgba(239,68,68,0.2),rgba(239,68,68,0.05));border:1px solid rgba(239,68,68,0.3);border-radius:12px;padding:12px 16px;cursor:grab;user-select:none;transition:all 0.3s;min-width:140px;text-align:center;touch-action:none">
            <div style="font-size:1.8rem"></div>
            <div style="font-weight:700;color:#f87171;font-size:0.85rem">LAM Engine</div>
            <div style="font-size:0.7rem;color:#64748b;margin-top:2px">440N thruster</div>
          </div>
          <div class="mb-card" data-comp="shield" draggable="true" style="background:linear-gradient(135deg,rgba(251,191,36,0.2),rgba(251,191,36,0.05));border:1px solid rgba(251,191,36,0.3);border-radius:12px;padding:12px 16px;cursor:grab;user-select:none;transition:all 0.3s;min-width:140px;text-align:center;touch-action:none">
            <div style="font-size:1.8rem"></div>
            <div style="font-weight:700;color:#fbbf24;font-size:0.85rem">Thermal Shield</div>
            <div style="font-size:0.7rem;color:#64748b;margin-top:2px">-150C to +300C</div>
          </div>
        </div>
        <!-- Launch Overlay -->
        <div id="mb-launch-overlay" style="display:none;position:absolute;inset:0;background:rgba(0,0,0,0.95);z-index:20;flex-direction:column;align-items:center;justify-content:center">
          <div id="mb-countdown" style="font-size:5rem;font-weight:900;color:#f97316;text-shadow:0 0 40px rgba(249,115,22,0.5)"></div>
          <canvas id="mb-launch-canvas" style="position:absolute;inset:0;width:100%;height:100%"></canvas>
          <div id="mb-launch-text" style="position:absolute;top:20px;left:50%;transform:translateX(-50%);color:white;font-size:1rem;font-weight:600;text-align:center;z-index:22;opacity:0;transition:opacity 0.5s"></div>
          <div id="mb-celebration" style="display:none;position:absolute;inset:0;z-index:25;flex-direction:column;align-items:center;justify-content:center;text-align:center">
            <div style="font-size:3rem;margin-bottom:12px"></div>
            <div style="font-size:1.8rem;font-weight:900;background:linear-gradient(135deg,#f97316,#fbbf24);-webkit-background-clip:text;-webkit-text-fill-color:transparent">Mission Launched!</div>
            <div id="mb-stats" style="margin-top:20px;background:rgba(249,115,22,0.1);border:1px solid rgba(249,115,22,0.3);border-radius:16px;padding:20px;display:inline-block;text-align:left">
              <div style="font-weight:700;color:#f97316;margin-bottom:10px;text-align:center"> Mission Stats</div>
              <div style="color:#94a3b8;font-size:0.9rem;line-height:2">
                <div> Cost: <strong style="color:#fbbf24">450 Crore</strong> ($73M)</div>
                <div> Weight: <strong style="color:#e2e8f0">1,350 kg</strong></div>
                <div> Distance: <strong style="color:#fb923c">225 Million km</strong></div>
                <div> Launch: <strong style="color:#e2e8f0">Nov 5, 2013</strong></div>
                <div> Mars Orbit: <strong style="color:#22c55e">Sep 24, 2014</strong></div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- END 3D BUILD & LAUNCH -->

      <div style="background:rgba(249,115,22,0.08);border:1px solid rgba(249,115,22,0.3);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> India's Exciting Space Future</h2>
        <div style="display:grid;gap:14px;margin-top:14px">
          <div style="background:linear-gradient(135deg,rgba(249,115,22,0.15),rgba(249,115,22,0.05));border-radius:14px;padding:18px;display:flex;gap:14px;align-items:start">
            <span style="font-size:2.5rem"></span>
            <div><h3 style="color:#f97316;margin:0 0 6px 0">Gaganyaan  Indian Astronauts!</h3><p style="font-size:0.95rem;color:#94a3b8;margin:0">India will send <strong style="color:#e2e8f0">Gagannauts</strong> to space! 4th country for human spaceflight! </p></div>
          </div>
          <div style="background:rgba(255,255,255,0.05);border-radius:14px;padding:18px;display:flex;gap:14px;align-items:start">
            <span style="font-size:2.5rem"></span>
            <div><h3 style="color:#f97316;margin:0 0 6px 0">Chandrayaan-3  SUCCESS!</h3><p style="font-size:0.95rem;color:#94a3b8;margin:0">August 2023: <strong style="color:#f97316">FIRST to land near Moon's South Pole!</strong> Pragyan rover drove on the Moon! </p></div>
          </div>
          <div style="background:linear-gradient(135deg,rgba(249,115,22,0.15),rgba(249,115,22,0.05));border-radius:14px;padding:18px;display:flex;gap:14px;align-items:start">
            <span style="font-size:2.5rem"></span>
            <div><h3 style="color:#f97316;margin:0 0 6px 0">Shukrayaan  Venus!</h3><p style="font-size:0.95rem;color:#94a3b8;margin:0">ISRO plans a Venus mission to study its thick, mysterious atmosphere! </p></div>
          </div>
          <div style="background:rgba(255,255,255,0.05);border-radius:14px;padding:18px;display:flex;gap:14px;align-items:start">
            <span style="font-size:2.5rem"></span>
            <div><h3 style="color:#f97316;margin:0 0 6px 0">Aditya-L1  The Sun!</h3><p style="font-size:0.95rem;color:#94a3b8;margin:0">Launched Sep 2023  India's first solar observatory! </p></div>
          </div>
        </div>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> AI Careers in Space</h2>
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:12px;margin:14px 0">
          <div style="background:rgba(249,115,22,0.1);border-radius:12px;padding:16px;text-align:center"><div style="font-size:2rem"></div><div style="font-weight:bold;color:#f97316">Space AI Engineer</div><div style="font-size:0.85rem;color:#94a3b8">Build AI for navigation</div></div>
          <div style="background:rgba(249,115,22,0.1);border-radius:12px;padding:16px;text-align:center"><div style="font-size:2rem"></div><div style="font-weight:bold;color:#f97316">Data Scientist</div><div style="font-size:0.85rem;color:#94a3b8">Analyze mission data</div></div>
          <div style="background:rgba(249,115,22,0.1);border-radius:12px;padding:16px;text-align:center"><div style="font-size:2rem"></div><div style="font-weight:bold;color:#f97316">Robotics Engineer</div><div style="font-size:0.85rem;color:#94a3b8">Design Mars rovers</div></div>
          <div style="background:rgba(249,115,22,0.1);border-radius:12px;padding:16px;text-align:center"><div style="font-size:2rem"></div><div style="font-weight:bold;color:#f97316">Image Analyst</div><div style="font-size:0.85rem;color:#94a3b8">Study space photos with AI</div></div>
        </div>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> What YOU Can Do Today!</h2>
        <div style="display:grid;gap:10px;margin-top:12px">
          <div style="background:rgba(34,197,94,0.1);border-left:4px solid #22c55e;border-radius:0 12px 12px 0;padding:14px 18px"><strong style="color:#22c55e"> Stay Curious!</strong><br>Read about ISRO, watch launches!</div>
          <div style="background:rgba(6,182,212,0.1);border-left:4px solid #06b6d4;border-radius:0 12px 12px 0;padding:14px 18px"><strong style="color:#06b6d4"> Science Projects!</strong><br>Build model rockets, track planets!</div>
          <div style="background:rgba(139,92,246,0.1);border-left:4px solid #8b5cf6;border-radius:0 12px 12px 0;padding:14px 18px"><strong style="color:#8b5cf6"> Learn AI!</strong><br>Start with Scratch, explore AI projects!</div>
          <div style="background:rgba(249,115,22,0.1);border-left:4px solid #f97316;border-radius:0 12px 12px 0;padding:14px 18px"><strong style="color:#f97316"> Dream BIG!</strong><br>ISRO scientists were once kids just like YOU! </div>
        </div>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> Activity: Design Your Mission!</h2>
        <p>Build your space mission  drag parts in order! </p>
        <div style="display:flex;flex-wrap:wrap;gap:10px;margin:16px 0">
          <div class="drag-item" data-id="s1" data-value="destination" style="background:linear-gradient(135deg,#431407,#7c2d12);border:1px solid rgba(249,115,22,0.3);border-radius:12px;padding:12px 16px;cursor:grab"> Destination: Mars</div>
          <div class="drag-item" data-id="s2" data-value="rocket" style="background:linear-gradient(135deg,#431407,#7c2d12);border:1px solid rgba(249,115,22,0.3);border-radius:12px;padding:12px 16px;cursor:grab"> Rocket: PSLV</div>
          <div class="drag-item" data-id="s3" data-value="instrument" style="background:linear-gradient(135deg,#431407,#7c2d12);border:1px solid rgba(249,115,22,0.3);border-radius:12px;padding:12px 16px;cursor:grab"> Camera + Sensors</div>
          <div class="drag-item" data-id="s4" data-value="ai" style="background:linear-gradient(135deg,#431407,#7c2d12);border:1px solid rgba(249,115,22,0.3);border-radius:12px;padding:12px 16px;cursor:grab"> AI Navigation</div>
          <div class="drag-item" data-id="s5" data-value="power" style="background:linear-gradient(135deg,#431407,#7c2d12);border:1px solid rgba(249,115,22,0.3);border-radius:12px;padding:12px 16px;cursor:grab"> Solar Panels</div>
        </div>
        <div style="display:grid;gap:10px">
          <div class="drag-zone" data-accept="destination" data-on-drop="handleBucketDrop" style="min-height:50px;border:2px dashed #f97316;border-radius:12px;padding:10px;text-align:center"><div style="color:#f97316;font-weight:bold;font-size:0.9rem"> Step 1: Destination</div></div>
          <div class="drag-zone" data-accept="rocket" data-on-drop="handleBucketDrop" style="min-height:50px;border:2px dashed #f97316;border-radius:12px;padding:10px;text-align:center"><div style="color:#f97316;font-weight:bold;font-size:0.9rem"> Step 2: Rocket</div></div>
          <div class="drag-zone" data-accept="instrument" data-on-drop="handleBucketDrop" style="min-height:50px;border:2px dashed #f97316;border-radius:12px;padding:10px;text-align:center"><div style="color:#f97316;font-weight:bold;font-size:0.9rem"> Step 3: Instruments</div></div>
          <div class="drag-zone" data-accept="ai" data-on-drop="handleBucketDrop" style="min-height:50px;border:2px dashed #f97316;border-radius:12px;padding:10px;text-align:center"><div style="color:#f97316;font-weight:bold;font-size:0.9rem"> Step 4: AI Brain</div></div>
          <div class="drag-zone" data-accept="power" data-on-drop="handleBucketDrop" style="min-height:50px;border:2px dashed #f97316;border-radius:12px;padding:10px;text-align:center"><div style="color:#f97316;font-weight:bold;font-size:0.9rem"> Step 5: Power</div></div>
        </div>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#f97316;margin-top:0"> Final Quiz!</h2>
        <p style="font-size:1.05rem;margin-bottom:16px">Chandrayaan-3's historic achievement in 2023?</p>
        <div id="mq8" style="display:flex;flex-direction:column;gap:10px">
          <button onclick="document.querySelectorAll('#mq8 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #ef4444';showFeedback(document.getElementById('mq8'),'wrong','That was Mangalyaan! ')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">A) First to orbit Mars</button>
          <button onclick="document.querySelectorAll('#mq8 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #10b981';showFeedback(document.getElementById('mq8'),'correct',' FIRST to land near Moon South Pole! Historic! ');window.addPoints(25)" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">B) First to land near Moon's South Pole! </button>
          <button onclick="document.querySelectorAll('#mq8 button').forEach(b=>b.style.opacity='0.5');this.style.opacity='1';this.style.border='2px solid #ef4444';showFeedback(document.getElementById('mq8'),'wrong','That is Gaganyaan  coming soon! ')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:14px 20px;color:white;cursor:pointer;text-align:left;font-size:1rem">C) Sent astronauts to space</button>
        </div>
      </div>

      <div style="background:linear-gradient(135deg,rgba(249,115,22,0.15),rgba(34,197,94,0.1));border:1px solid rgba(249,115,22,0.3);border-radius:16px;padding:24px;margin-bottom:20px;text-align:center">
        <h2 style="margin-top:0"> Congratulations, Space Explorer!</h2>
        <p style="font-size:1.15rem;line-height:1.7">You completed <strong style="color:#f97316">Mangalyaan AI Explorer</strong>! You know how India reached Mars, how AI powers space missions, and how YOU can be part of India's space future! </p>
        <p style="font-size:1.1rem;color:#f97316;font-weight:bold">ISRO scientists were once kids with big dreams  just like YOU! </p>
      </div>

      <button onclick="window.completeChapter('mangalyaan', 7)" style="width:100%;padding:16px;background:linear-gradient(135deg,#f97316,#ea580c);border:none;border-radius:12px;color:white;font-size:1.1rem;font-weight:bold;cursor:pointer;margin-top:12px"> Complete the Course!</button>
    `,(function(){var o=document.getElementById("mission-builder");if(!o)return;var l={},p=0,c,g,h,b,m,v={solar:3900150,dish:14870768,camera:16347926,engine:15680580,shield:16498468},z={solar:" Solar Panels",dish:" Communication Dish",camera:" Mars Color Camera",engine:" LAM Engine",shield:" Thermal Shield"},k={solar:"Powers the satellite for 6 months using sunlight!",dish:"Communicates with ISRO from 225 million km away!",camera:"Takes stunning color photos of Mars surface!",engine:"440 Newton thruster for critical orbit changes!",shield:"Protects from extreme -150C to +300C temperatures!"};function S(y,O){var $=document.createElement("script");$.src=y,$.onload=O,document.head.appendChild($)}S("https://cdn.jsdelivr.net/npm/three@0.137.0/build/three.min.js",function(){S("https://cdn.jsdelivr.net/npm/three@0.137.0/examples/js/controls/OrbitControls.js",function(){j()})});function j(){var y=document.getElementById("mb-canvas"),O=document.getElementById("mb-scene"),$=O.clientWidth,ee=O.clientHeight;c=new THREE.Scene,g=new THREE.PerspectiveCamera(50,$/ee,.1,1e3),g.position.set(0,2,6),h=new THREE.WebGLRenderer({canvas:y,antialias:!0,alpha:!0}),h.setSize($,ee),h.setPixelRatio(Math.min(window.devicePixelRatio,2)),h.setClearColor(657946,1);for(var J=new THREE.BufferGeometry,Q=[],re=0;re<500;re++)Q.push((Math.random()-.5)*100,(Math.random()-.5)*100,(Math.random()-.5)*100);J.setAttribute("position",new THREE.Float32BufferAttribute(Q,3)),c.add(new THREE.Points(J,new THREE.PointsMaterial({color:16777215,size:.15}))),c.add(new THREE.AmbientLight(4210784,.6));var Z=new THREE.DirectionalLight(16777215,1.2);Z.position.set(5,5,5),c.add(Z);var se=new THREE.PointLight(16347926,.8,20);se.position.set(-3,2,3),c.add(se);var w=new THREE.BoxGeometry(1.2,.8,1.2),C=new THREE.MeshPhongMaterial({color:14329120,shininess:100,specular:5592405});b=new THREE.Mesh(w,C);var ne=new THREE.EdgesGeometry(w);b.add(new THREE.LineSegments(ne,new THREE.LineBasicMaterial({color:16498468}))),c.add(b),m=new THREE.OrbitControls(g,h.domElement),m.enableDamping=!0,m.dampingFactor=.05,m.enableZoom=!1,m.autoRotate=!0,m.autoRotateSpeed=1.5;function F(){requestAnimationFrame(F),b.rotation.y+=.003,m.update(),h.render(c,g)}F(),window.addEventListener("resize",function(){var q=O.clientWidth,H=O.clientHeight;g.aspect=q/H,g.updateProjectionMatrix(),h.setSize(q,H)}),B()}function R(y){try{var O=new(window.AudioContext||window.webkitAudioContext),$=O.createOscillator(),ee=O.createGain();$.connect(ee),ee.connect(O.destination),$.frequency.value=y||880,$.type="sine",ee.gain.setValueAtTime(.3,O.currentTime),ee.gain.exponentialRampToValueAtTime(.001,O.currentTime+.3),$.start(O.currentTime),$.stop(O.currentTime+.3)}catch{}}function I(y){var O=v[y],$;if(y==="solar"){var ee=new THREE.BoxGeometry(2,.05,.6);$=new THREE.Mesh(ee,new THREE.MeshPhongMaterial({color:O,shininess:80,transparent:!0,opacity:.85})),$.position.set(0,.1,0);var J=new THREE.BoxGeometry(2,.05,.6),Q=new THREE.Mesh(J,new THREE.MeshPhongMaterial({color:O,shininess:80,transparent:!0,opacity:.85}));Q.position.set(0,.1,0),Q.rotation.y=Math.PI/2,b.add(Q)}else if(y==="dish"){var ee=new THREE.SphereGeometry(.35,16,8,0,Math.PI*2,0,Math.PI/2);$=new THREE.Mesh(ee,new THREE.MeshPhongMaterial({color:O,side:THREE.DoubleSide})),$.position.set(0,.7,0)}else if(y==="camera"){var ee=new THREE.CylinderGeometry(.12,.15,.3,8);$=new THREE.Mesh(ee,new THREE.MeshPhongMaterial({color:O})),$.position.set(.5,-.1,.5),$.rotation.x=Math.PI/4}else if(y==="engine"){var ee=new THREE.ConeGeometry(.25,.5,8);$=new THREE.Mesh(ee,new THREE.MeshPhongMaterial({color:O})),$.position.set(0,-.65,0),$.rotation.x=Math.PI}else if(y==="shield"){var ee=new THREE.BoxGeometry(1.3,.05,1.3);$=new THREE.Mesh(ee,new THREE.MeshPhongMaterial({color:O,shininess:120})),$.position.set(0,.45,0)}if($){b.add($),$.scale.set(0,0,0);var re=0,Z=function(){if(re+=.05,re>=1){$.scale.set(1,1,1);return}$.scale.set(re,re,re),requestAnimationFrame(Z)};Z()}D(v[y])}function D(y){for(var O=new THREE.BufferGeometry,$=[],ee=[],J=0;J<30;J++)$.push(0,0,0),ee.push((Math.random()-.5)*.15,(Math.random()-.5)*.15,(Math.random()-.5)*.15);O.setAttribute("position",new THREE.Float32BufferAttribute($,3));var Q=new THREE.PointsMaterial({color:y,size:.08,transparent:!0,opacity:1}),re=new THREE.Points(O,Q);c.add(re);var Z=0;function se(){if(Z++,Z>40){c.remove(re);return}for(var w=O.attributes.position.array,C=0;C<w.length;C+=3)w[C]+=ee[C/3*3],w[C+1]+=ee[C/3*3+1],w[C+2]+=ee[C/3*3+2];O.attributes.position.needsUpdate=!0,Q.opacity=1-Z/40,requestAnimationFrame(se)}se()}function U(y){var O=document.getElementById("mb-info-popup");O.textContent=z[y]+"  "+k[y],O.style.opacity="1",setTimeout(function(){O.style.opacity="0"},2500)}function B(){var y=document.querySelectorAll(".mb-card"),O=document.getElementById("mb-dropzone"),$=document.getElementById("mb-scene"),ee=null,J=null;y.forEach(function(Q){Q.addEventListener("dragstart",function(re){re.dataTransfer.setData("text/plain",Q.dataset.comp)}),Q.addEventListener("touchstart",function(re){if(!l[Q.dataset.comp]){ee=Q,J=Q.cloneNode(!0),J.style.position="fixed",J.style.zIndex="100",J.style.opacity="0.8",J.style.pointerEvents="none",J.style.width=Q.offsetWidth+"px",document.body.appendChild(J);var Z=re.touches[0];J.style.left=Z.clientX-50+"px",J.style.top=Z.clientY-30+"px",re.preventDefault()}},{passive:!1})}),document.addEventListener("touchmove",function(Q){if(J){var re=Q.touches[0];J.style.left=re.clientX-50+"px",J.style.top=re.clientY-30+"px",Q.preventDefault()}},{passive:!1}),document.addEventListener("touchend",function(Q){if(!(!ee||!J)){var re=Q.changedTouches[0],Z=$.getBoundingClientRect();re.clientX>=Z.left&&re.clientX<=Z.right&&re.clientY>=Z.top&&re.clientY<=Z.bottom&&E(ee.dataset.comp,ee),J.remove(),J=null,ee=null}}),$.addEventListener("dragover",function(Q){Q.preventDefault(),O.style.borderColor="rgba(249,115,22,0.8)",O.style.boxShadow="0 0 30px rgba(249,115,22,0.3)"}),$.addEventListener("dragleave",function(){O.style.borderColor="rgba(249,115,22,0.3)",O.style.boxShadow="none"}),$.addEventListener("drop",function(Q){Q.preventDefault(),O.style.borderColor="rgba(249,115,22,0.3)",O.style.boxShadow="none";var re=Q.dataTransfer.getData("text/plain"),Z=document.querySelector('.mb-card[data-comp="'+re+'"]');Z&&E(re,Z)})}function E(y,O){l[y]||(l[y]=!0,p++,O.style.opacity="0.3",O.style.pointerEvents="none",O.draggable=!1,O.style.transform="scale(0.9)",I(y),R(440+p*110),U(y),document.getElementById("mb-count").textContent=p+" / 5",document.getElementById("mb-bar").style.width=p*20+"%",p===5&&setTimeout(N,1200))}function N(){var y=document.getElementById("mb-launch-overlay");y.style.display="flex";var O=document.getElementById("mb-countdown"),$=document.getElementById("mb-launch-canvas"),ee=document.getElementById("mb-launch-text"),J=y.clientWidth,Q=y.clientHeight;$.width=J,$.height=Q;var re=$.getContext("2d"),Z=10,se=setInterval(function(){O.textContent=Z,R(600+Z*40),Z--,Z<0&&(clearInterval(se),O.style.display="none",M(re,J,Q,ee))},800)}function M(y,O,$,ee){var J=$*.7,Q=O/2,re=0,Z=0,se=[];ee.textContent="PSLV-XL C25  November 5, 2013  Sriharikota, India ",ee.style.opacity="1";function w(F,q){y.save(),y.fillStyle="#e2e8f0",y.fillRect(F-12,q,24,60),y.fillStyle="#f97316",y.beginPath(),y.moveTo(F-12,q),y.lineTo(F,q-25),y.lineTo(F+12,q),y.fill(),y.fillStyle="#94a3b8",y.beginPath(),y.moveTo(F-12,q+50),y.lineTo(F-22,q+65),y.lineTo(F-12,q+60),y.fill(),y.beginPath(),y.moveTo(F+12,q+50),y.lineTo(F+22,q+65),y.lineTo(F+12,q+60),y.fill(),y.fillStyle="#1e293b",y.font="bold 6px sans-serif",y.textAlign="center",y.fillText("ISRO",F,q+30),y.restore()}function C(F,q){for(var H=0;H<3;H++)se.push({x:F+(Math.random()-.5)*20,y:q,vx:(Math.random()-.5)*2,vy:Math.random()*2+1,life:40+Math.random()*20,r:Math.random()>.5?255:249,g:Math.random()>.5?Math.floor(Math.random()*150+100):115,b:Math.random()>.5?0:22,size:Math.random()*4+2})}function ne(){Z++,y.clearRect(0,0,O,$),y.fillStyle="#0a0a1a",y.fillRect(0,0,O,$);for(var F=0;F<80;F++)y.fillStyle="rgba(255,255,255,"+(.3+Math.random()*.5)+")",y.fillRect(F*137%O,F*251%$,1.5,1.5);if(re===0){var q=(Math.random()-.5)*2,H=(Math.random()-.5)*2;w(Q+q,J+H),C(Q,J+65),Z>60&&(re=1,Z=0)}else if(re===1){J-=2.5;var q=(Math.random()-.5)*3,H=0;w(Q+q,J),C(Q,J+65),y.fillStyle="#f97316",y.beginPath(),y.moveTo(Q-8,J+60),y.lineTo(Q,J+60+15+Math.random()*10),y.lineTo(Q+8,J+60),y.fill(),y.fillStyle="#fbbf24",y.beginPath(),y.moveTo(Q-4,J+60),y.lineTo(Q,J+60+10+Math.random()*8),y.lineTo(Q+4,J+60),y.fill(),J<-80&&(re=2,Z=0,ee.textContent="Mangalyaan separating from PSLV...")}else if(re===2)y.fillStyle="#daa520",y.fillRect(O/2-15,$/2-10+Math.sin(Z*.03)*5,30,20),y.fillStyle="#3b82f6",y.globalAlpha=.7,y.fillRect(O/2-55,$/2-6+Math.sin(Z*.03)*5,35,12),y.fillRect(O/2+20,$/2-6+Math.sin(Z*.03)*5,35,12),y.globalAlpha=1,y.fillStyle="#64748b",y.fillRect(O/2-8,$/2+60+Z*.5,16,30),Z>150&&(re=3,Z=0);else if(re===3){var oe=document.getElementById("mb-celebration");oe.style.display="flex",ee.style.opacity="0";for(var F=0;F<5;F++)se.push({x:Math.random()*O,y:-10,vx:(Math.random()-.5)*4,vy:Math.random()*3+2,life:100,r:[249,59,251,34,139][F%5],g:[115,130,191,197,92][F%5],b:[22,246,36,94,246][F%5],size:Math.random()*5+3})}for(var F=se.length-1;F>=0;F--){var de=se[F];if(de.x+=de.vx,de.y+=de.vy,de.life--,de.life<=0){se.splice(F,1);continue}y.fillStyle="rgba("+de.r+","+de.g+","+de.b+","+de.life/60+")",y.fillRect(de.x,de.y,de.size,de.size)}(re<3||Z<200)&&requestAnimationFrame(ne)}ne()}})(),typeof ce=="function"&&ce(),vi(r.querySelector(".karaoke-container"))}],nasa:[function(r){r.innerHTML=`
      <img src="./infographics/nasa-ch1.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="The Apollo Dream infographic">
      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.2rem;margin:0"> The Apollo Dream</h1>
        <p style="color:#94a3b8;font-size:1.1rem;margin-top:8px">Goal Planning & Decision Trees</p>
      </div>

      <div style="background:rgba(59,130,246,0.08);border:1px solid rgba(59,130,246,0.3);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#3b82f6;margin-top:0"> The Biggest Dream in History</h2>
        <p style="font-size:1.05rem;line-height:1.7">In <strong style="color:#3b82f6">1961</strong>, President John F. Kennedy made an incredible promise: America would land a man on the Moon before the end of the decade!</p>
        <p style="font-size:1.05rem;line-height:1.7">On <strong style="color:#3b82f6">July 20, 1969</strong>, Neil Armstrong became the first human to walk on the Moon. "That's one small step for man, one giant leap for mankind!" </p>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#3b82f6;margin-top:0"> AI Concept: Decision Trees</h2>
        <p style="font-size:1.05rem;line-height:1.7">NASA scientists had to make thousands of decisions to reach the Moon. A <strong style="color:#3b82f6">Decision Tree</strong> is how AI breaks big problems into smaller yes/no questions  just like NASA planned each step of the Apollo mission!</p>
        <p style="font-size:1.05rem;line-height:1.7">Think of it like a flowchart: "Is the weather safe?  Yes  Is the rocket fueled?  Yes  Launch! "</p>
      </div>

      <div style="background:rgba(59,130,246,0.06);border:1px solid rgba(59,130,246,0.2);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#3b82f6;margin-top:0"> Activity: Apollo Mission Planner!</h2>
        <p>Drag each Apollo mission step to the correct order! </p>
        <div style="display:flex;flex-wrap:wrap;gap:10px;margin:16px 0">
          <div class="drag-item" draggable="true" data-value="1" style="padding:10px 18px;background:rgba(59,130,246,0.15);border:2px solid #3b82f6;border-radius:12px;cursor:grab;font-weight:600"> Build the Saturn V rocket</div>
          <div class="drag-item" draggable="true" data-value="3" style="padding:10px 18px;background:rgba(59,130,246,0.15);border:2px solid #3b82f6;border-radius:12px;cursor:grab;font-weight:600"> Land on the Moon</div>
          <div class="drag-item" draggable="true" data-value="2" style="padding:10px 18px;background:rgba(59,130,246,0.15);border:2px solid #3b82f6;border-radius:12px;cursor:grab;font-weight:600"> Launch from Kennedy Space Center</div>
          <div class="drag-item" draggable="true" data-value="4" style="padding:10px 18px;background:rgba(59,130,246,0.15);border:2px solid #3b82f6;border-radius:12px;cursor:grab;font-weight:600"> Return safely to Earth</div>
        </div>
        <div style="display:grid;gap:10px;margin-top:16px">
          <div class="drop-zone" data-accept="1" style="padding:16px;border:2px dashed rgba(59,130,246,0.4);border-radius:12px;text-align:center;min-height:50px">Step 1: ___</div>
          <div class="drop-zone" data-accept="2" style="padding:16px;border:2px dashed rgba(59,130,246,0.4);border-radius:12px;text-align:center;min-height:50px">Step 2: ___</div>
          <div class="drop-zone" data-accept="3" style="padding:16px;border:2px dashed rgba(59,130,246,0.4);border-radius:12px;text-align:center;min-height:50px">Step 3: ___</div>
          <div class="drop-zone" data-accept="4" style="padding:16px;border:2px dashed rgba(59,130,246,0.4);border-radius:12px;text-align:center;min-height:50px">Step 4: ___</div>
        </div>
      </div>

      <div style="background:rgba(239,68,68,0.08);border:1px solid rgba(239,68,68,0.2);border-radius:16px;padding:20px;margin-bottom:20px">
        <h3 style="color:#ef4444;margin-top:0"> Fun Fact!</h3>
        <p>The Saturn V rocket was <strong>363 feet tall</strong>  taller than the Statue of Liberty! It's still the most powerful rocket ever flown. </p>
      </div>

      <button onclick="window.completeChapter('nasa', 0)" style="width:100%;padding:16px;background:linear-gradient(135deg,#3b82f6,#1d4ed8);border:none;border-radius:12px;color:white;font-size:1.1rem;font-weight:bold;cursor:pointer;margin-top:12px"> Complete Chapter 1!</button>
    `,ce()},function(r){r.innerHTML=`
      <img src="./infographics/nasa-ch2.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="Hubble's Eye infographic">
      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.2rem;margin:0"> Hubble's Eye</h1>
        <p style="color:#94a3b8;font-size:1.1rem;margin-top:8px">Computer Vision & Image Recognition</p>
      </div>

      <div style="background:rgba(59,130,246,0.08);border:1px solid rgba(59,130,246,0.3);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#3b82f6;margin-top:0"> The Eye in the Sky</h2>
        <p style="font-size:1.05rem;line-height:1.7">Launched in <strong style="color:#3b82f6">1990</strong>, the Hubble Space Telescope orbits Earth at 17,000 mph and has taken over <strong>1.5 million photos</strong> of the universe!</p>
        <p style="font-size:1.05rem;line-height:1.7">But here's the problem: how do scientists sort through millions of images? That's where <strong style="color:#3b82f6">Computer Vision</strong> comes in! </p>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#3b82f6;margin-top:0"> AI Concept: Image Recognition</h2>
        <p style="font-size:1.05rem;line-height:1.7"><strong style="color:#3b82f6">Computer Vision</strong> teaches computers to "see" and understand images  just like your brain recognizes a cat vs. a dog! NASA uses it to automatically classify galaxies, find asteroids, and spot new stars. </p>
      </div>

      <div style="background:rgba(59,130,246,0.06);border:1px solid rgba(59,130,246,0.2);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#3b82f6;margin-top:0"> Activity: Galaxy Classifier!</h2>
        <p>Drag each space object to the correct category! </p>
        <div style="display:flex;flex-wrap:wrap;gap:10px;margin:16px 0">
          <div class="drag-item" draggable="true" data-value="star" style="padding:10px 18px;background:rgba(59,130,246,0.15);border:2px solid #3b82f6;border-radius:12px;cursor:grab;font-weight:600"> Sun</div>
          <div class="drag-item" draggable="true" data-value="galaxy" style="padding:10px 18px;background:rgba(59,130,246,0.15);border:2px solid #3b82f6;border-radius:12px;cursor:grab;font-weight:600"> Milky Way</div>
          <div class="drag-item" draggable="true" data-value="planet" style="padding:10px 18px;background:rgba(59,130,246,0.15);border:2px solid #3b82f6;border-radius:12px;cursor:grab;font-weight:600"> Saturn</div>
          <div class="drag-item" draggable="true" data-value="nebula" style="padding:10px 18px;background:rgba(59,130,246,0.15);border:2px solid #3b82f6;border-radius:12px;cursor:grab;font-weight:600"> Eagle Nebula</div>
        </div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:16px">
          <div class="drop-zone" data-accept="star" style="padding:16px;border:2px dashed rgba(59,130,246,0.4);border-radius:12px;text-align:center;min-height:50px"> Stars</div>
          <div class="drop-zone" data-accept="galaxy" style="padding:16px;border:2px dashed rgba(59,130,246,0.4);border-radius:12px;text-align:center;min-height:50px"> Galaxies</div>
          <div class="drop-zone" data-accept="planet" style="padding:16px;border:2px dashed rgba(59,130,246,0.4);border-radius:12px;text-align:center;min-height:50px"> Planets</div>
          <div class="drop-zone" data-accept="nebula" style="padding:16px;border:2px dashed rgba(59,130,246,0.4);border-radius:12px;text-align:center;min-height:50px"> Nebulae</div>
        </div>
      </div>

      <div style="background:rgba(239,68,68,0.08);border:1px solid rgba(239,68,68,0.2);border-radius:16px;padding:20px;margin-bottom:20px">
        <h3 style="color:#ef4444;margin-top:0"> Fun Fact!</h3>
        <p>Hubble's mirror had a tiny flaw when first launched  off by just <strong>1/50th the thickness of a human hair</strong>! Astronauts had to fix it in space like the world's most extreme repair job. </p>
      </div>

      <button onclick="window.completeChapter('nasa', 1)" style="width:100%;padding:16px;background:linear-gradient(135deg,#3b82f6,#1d4ed8);border:none;border-radius:12px;color:white;font-size:1.1rem;font-weight:bold;cursor:pointer;margin-top:12px"> Complete Chapter 2!</button>
    `,ce()},function(r){r.innerHTML=`
      <img src="./infographics/nasa-ch3.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="Mars Rovers infographic">
      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.2rem;margin:0"> Mars Rovers</h1>
        <p style="color:#94a3b8;font-size:1.1rem;margin-top:8px">Autonomous Navigation & Robotics</p>
      </div>

      <div style="background:rgba(59,130,246,0.08);border:1px solid rgba(59,130,246,0.3);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#3b82f6;margin-top:0"> Robots on Mars!</h2>
        <p style="font-size:1.05rem;line-height:1.7">NASA has sent <strong style="color:#3b82f6">5 rovers</strong> to Mars! The latest, <strong>Perseverance</strong>, landed in 2021 and even brought a tiny helicopter called <strong>Ingenuity</strong>  the first aircraft to fly on another planet! </p>
        <p style="font-size:1.05rem;line-height:1.7">But here's the challenge: Mars is so far away that signals take <strong>4-24 minutes</strong> to travel each way. Rovers can't wait for instructions  they must think for themselves! </p>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#3b82f6;margin-top:0"> AI Concept: Autonomous Navigation</h2>
        <p style="font-size:1.05rem;line-height:1.7"><strong style="color:#3b82f6">AutoNav</strong> is the AI system that lets rovers drive themselves on Mars! Using cameras and AI, rovers scan the terrain, identify rocks and craters, and choose the safest path  all without human help. It's like a self-driving car on Mars! </p>
      </div>

      <div style="background:rgba(59,130,246,0.06);border:1px solid rgba(59,130,246,0.2);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#3b82f6;margin-top:0"> Activity: Rover Component Match!</h2>
        <p>Match each rover part to its function! </p>
        <div style="display:flex;flex-wrap:wrap;gap:10px;margin:16px 0">
          <div class="drag-item" draggable="true" data-value="camera" style="padding:10px 18px;background:rgba(59,130,246,0.15);border:2px solid #3b82f6;border-radius:12px;cursor:grab;font-weight:600"> Mastcam</div>
          <div class="drag-item" draggable="true" data-value="drill" style="padding:10px 18px;background:rgba(59,130,246,0.15);border:2px solid #3b82f6;border-radius:12px;cursor:grab;font-weight:600"> Drill Arm</div>
          <div class="drag-item" draggable="true" data-value="solar" style="padding:10px 18px;background:rgba(59,130,246,0.15);border:2px solid #3b82f6;border-radius:12px;cursor:grab;font-weight:600"> Solar Panels</div>
          <div class="drag-item" draggable="true" data-value="wheels" style="padding:10px 18px;background:rgba(59,130,246,0.15);border:2px solid #3b82f6;border-radius:12px;cursor:grab;font-weight:600"> 6 Wheels</div>
        </div>
        <div style="display:grid;gap:10px;margin-top:16px">
          <div class="drop-zone" data-accept="camera" style="padding:16px;border:2px dashed rgba(59,130,246,0.4);border-radius:12px;text-align:center;min-height:50px">Takes photos & videos of Mars</div>
          <div class="drop-zone" data-accept="drill" style="padding:16px;border:2px dashed rgba(59,130,246,0.4);border-radius:12px;text-align:center;min-height:50px">Collects rock samples</div>
          <div class="drop-zone" data-accept="solar" style="padding:16px;border:2px dashed rgba(59,130,246,0.4);border-radius:12px;text-align:center;min-height:50px">Generates power from sunlight</div>
          <div class="drop-zone" data-accept="wheels" style="padding:16px;border:2px dashed rgba(59,130,246,0.4);border-radius:12px;text-align:center;min-height:50px">Moves across rocky terrain</div>
        </div>
      </div>

      <div style="background:rgba(239,68,68,0.08);border:1px solid rgba(239,68,68,0.2);border-radius:16px;padding:20px;margin-bottom:20px">
        <h3 style="color:#ef4444;margin-top:0"> Fun Fact!</h3>
        <p>The Opportunity rover was designed to last <strong>90 days</strong> on Mars but kept going for <strong>15 YEARS</strong>! Its last message in 2018 was basically "My battery is low and it's getting dark." </p>
      </div>

      <button onclick="window.completeChapter('nasa', 2)" style="width:100%;padding:16px;background:linear-gradient(135deg,#3b82f6,#1d4ed8);border:none;border-radius:12px;color:white;font-size:1.1rem;font-weight:bold;cursor:pointer;margin-top:12px"> Complete Chapter 3!</button>
    `,ce()},function(r){r.innerHTML=`
      <img src="./infographics/nasa-ch4.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="Voyager's Journey infographic">
      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.2rem;margin:0"> Voyager's Journey</h1>
        <p style="color:#94a3b8;font-size:1.1rem;margin-top:8px">Data Transmission & Communication</p>
      </div>

      <div style="background:rgba(59,130,246,0.08);border:1px solid rgba(59,130,246,0.3);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#3b82f6;margin-top:0"> The Farthest Travelers</h2>
        <p style="font-size:1.05rem;line-height:1.7">Launched in <strong style="color:#3b82f6">1977</strong>, Voyager 1 and 2 are the farthest human-made objects ever! Voyager 1 is over <strong>15 billion miles</strong> from Earth and STILL sending data back! </p>
        <p style="font-size:1.05rem;line-height:1.7">Each Voyager carries a <strong>Golden Record</strong>  a disc with sounds and images from Earth, in case aliens find it! </p>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#3b82f6;margin-top:0"> AI Concept: Data Compression</h2>
        <p style="font-size:1.05rem;line-height:1.7">Voyager's radio signal is incredibly weak  <strong style="color:#3b82f6">20 watts</strong>, like a refrigerator light bulb! AI helps by <strong>compressing data</strong> (making files smaller) and using <strong>error correction</strong> (fixing mistakes in the signal). It's like whispering across a football stadium and still being understood! </p>
      </div>

      <div style="background:rgba(59,130,246,0.06);border:1px solid rgba(59,130,246,0.2);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#3b82f6;margin-top:0"> Activity: Golden Record Curator!</h2>
        <p>What would YOU put on a Golden Record for aliens? Drag items to the correct category! </p>
        <div style="display:flex;flex-wrap:wrap;gap:10px;margin:16px 0">
          <div class="drag-item" draggable="true" data-value="sound" style="padding:10px 18px;background:rgba(59,130,246,0.15);border:2px solid #3b82f6;border-radius:12px;cursor:grab;font-weight:600"> Beethoven Symphony</div>
          <div class="drag-item" draggable="true" data-value="image" style="padding:10px 18px;background:rgba(59,130,246,0.15);border:2px solid #3b82f6;border-radius:12px;cursor:grab;font-weight:600"> Photo of Earth</div>
          <div class="drag-item" draggable="true" data-value="sound" style="padding:10px 18px;background:rgba(59,130,246,0.15);border:2px solid #3b82f6;border-radius:12px;cursor:grab;font-weight:600"> Whale Songs</div>
          <div class="drag-item" draggable="true" data-value="image" style="padding:10px 18px;background:rgba(59,130,246,0.15);border:2px solid #3b82f6;border-radius:12px;cursor:grab;font-weight:600"> Human DNA Diagram</div>
        </div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:16px">
          <div class="drop-zone" data-accept="sound" style="padding:16px;border:2px dashed rgba(59,130,246,0.4);border-radius:12px;text-align:center;min-height:50px"> Sounds</div>
          <div class="drop-zone" data-accept="image" style="padding:16px;border:2px dashed rgba(59,130,246,0.4);border-radius:12px;text-align:center;min-height:50px"> Images</div>
        </div>
      </div>

      <div style="background:rgba(239,68,68,0.08);border:1px solid rgba(239,68,68,0.2);border-radius:16px;padding:20px;margin-bottom:20px">
        <h3 style="color:#ef4444;margin-top:0"> Fun Fact!</h3>
        <p>It takes <strong>22 hours</strong> for a signal from Voyager 1 to reach Earth! When you send a text, it arrives in milliseconds. Imagine waiting almost a full day for a reply! </p>
      </div>

      <button onclick="window.completeChapter('nasa', 3)" style="width:100%;padding:16px;background:linear-gradient(135deg,#3b82f6,#1d4ed8);border:none;border-radius:12px;color:white;font-size:1.1rem;font-weight:bold;cursor:pointer;margin-top:12px"> Complete Chapter 4!</button>
    `,ce()},function(r){r.innerHTML=`
      <img src="./infographics/nasa-ch5.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="James Webb Telescope infographic">
      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.2rem;margin:0"> James Webb Telescope</h1>
        <p style="color:#94a3b8;font-size:1.1rem;margin-top:8px">Deep Learning & Pattern Recognition</p>
      </div>

      <div style="background:rgba(59,130,246,0.08);border:1px solid rgba(59,130,246,0.3);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#3b82f6;margin-top:0"> The $10 Billion Time Machine</h2>
        <p style="font-size:1.05rem;line-height:1.7">Launched on <strong style="color:#3b82f6">Christmas Day 2021</strong>, the James Webb Space Telescope (JWST) can see galaxies that formed just <strong>300 million years</strong> after the Big Bang  that's like looking back in time! </p>
        <p style="font-size:1.05rem;line-height:1.7">Its golden mirror is <strong>21 feet wide</strong> and made of 18 hexagonal segments coated in gold! </p>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#3b82f6;margin-top:0"> AI Concept: Deep Learning</h2>
        <p style="font-size:1.05rem;line-height:1.7"><strong style="color:#3b82f6">Deep Learning</strong> uses layers of artificial "neurons" (like your brain!) to find patterns in data. JWST produces <strong>57 GB of data daily</strong>  AI helps scientists find exoplanets, detect galaxy types, and discover things no human could spot alone! </p>
      </div>

      <div style="background:rgba(59,130,246,0.06);border:1px solid rgba(59,130,246,0.2);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#3b82f6;margin-top:0"> Activity: JWST Mirror Builder!</h2>
        <p>The JWST mirror has 18 hexagonal segments. Match each mirror fact to the correct answer! </p>
        <div style="display:flex;flex-wrap:wrap;gap:10px;margin:16px 0">
          <div class="drag-item" draggable="true" data-value="gold" style="padding:10px 18px;background:rgba(59,130,246,0.15);border:2px solid #3b82f6;border-radius:12px;cursor:grab;font-weight:600"> Gold coating</div>
          <div class="drag-item" draggable="true" data-value="infrared" style="padding:10px 18px;background:rgba(59,130,246,0.15);border:2px solid #3b82f6;border-radius:12px;cursor:grab;font-weight:600"> Infrared light</div>
          <div class="drag-item" draggable="true" data-value="cold" style="padding:10px 18px;background:rgba(59,130,246,0.15);border:2px solid #3b82f6;border-radius:12px;cursor:grab;font-weight:600"> -370F</div>
        </div>
        <div style="display:grid;gap:10px;margin-top:16px">
          <div class="drop-zone" data-accept="gold" style="padding:16px;border:2px dashed rgba(59,130,246,0.4);border-radius:12px;text-align:center;min-height:50px">What reflects infrared light best?</div>
          <div class="drop-zone" data-accept="infrared" style="padding:16px;border:2px dashed rgba(59,130,246,0.4);border-radius:12px;text-align:center;min-height:50px">What type of light does JWST detect?</div>
          <div class="drop-zone" data-accept="cold" style="padding:16px;border:2px dashed rgba(59,130,246,0.4);border-radius:12px;text-align:center;min-height:50px">How cold must JWST's instruments stay?</div>
        </div>
      </div>

      <div style="background:rgba(239,68,68,0.08);border:1px solid rgba(239,68,68,0.2);border-radius:16px;padding:20px;margin-bottom:20px">
        <h3 style="color:#ef4444;margin-top:0"> Fun Fact!</h3>
        <p>JWST orbits the Sun at a point called <strong>L2</strong>, about 1 million miles from Earth. Its sunshield is the size of a tennis court and keeps the telescope at -370F! </p>
      </div>

      <button onclick="window.completeChapter('nasa', 4)" style="width:100%;padding:16px;background:linear-gradient(135deg,#3b82f6,#1d4ed8);border:none;border-radius:12px;color:white;font-size:1.1rem;font-weight:bold;cursor:pointer;margin-top:12px"> Complete Chapter 5!</button>
    `,ce()},function(r){r.innerHTML=`
      <img src="./infographics/nasa-ch6.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="Space Station Life infographic">
      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.2rem;margin:0"> Space Station Life</h1>
        <p style="color:#94a3b8;font-size:1.1rem;margin-top:8px">Automation & Life Support Systems</p>
      </div>

      <div style="background:rgba(59,130,246,0.08);border:1px solid rgba(59,130,246,0.3);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#3b82f6;margin-top:0"> A Home in Space</h2>
        <p style="font-size:1.05rem;line-height:1.7">The International Space Station (ISS) has been <strong style="color:#3b82f6">continuously occupied since 2000</strong>  that's over 20 years of humans living in space! It orbits Earth every <strong>90 minutes</strong>, meaning astronauts see 16 sunrises per day! </p>
        <p style="font-size:1.05rem;line-height:1.7">The ISS is as big as a <strong>football field</strong> and cost over $150 billion to build  the most expensive thing ever made! </p>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#3b82f6;margin-top:0"> AI Concept: Automation</h2>
        <p style="font-size:1.05rem;line-height:1.7">The ISS uses <strong style="color:#3b82f6">automated systems</strong> to control oxygen levels, water recycling, temperature, and power. AI assistants like <strong>CIMON</strong> (a floating robot ball!) help astronauts with experiments and daily tasks. It's like having Alexa in space! </p>
      </div>

      <div style="background:rgba(59,130,246,0.06);border:1px solid rgba(59,130,246,0.2);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#3b82f6;margin-top:0"> Activity: ISS System Sorter!</h2>
        <p>Sort each ISS system into the correct category! </p>
        <div style="display:flex;flex-wrap:wrap;gap:10px;margin:16px 0">
          <div class="drag-item" draggable="true" data-value="life" style="padding:10px 18px;background:rgba(59,130,246,0.15);border:2px solid #3b82f6;border-radius:12px;cursor:grab;font-weight:600"> Oxygen Generator</div>
          <div class="drag-item" draggable="true" data-value="power" style="padding:10px 18px;background:rgba(59,130,246,0.15);border:2px solid #3b82f6;border-radius:12px;cursor:grab;font-weight:600"> Solar Arrays</div>
          <div class="drag-item" draggable="true" data-value="life" style="padding:10px 18px;background:rgba(59,130,246,0.15);border:2px solid #3b82f6;border-radius:12px;cursor:grab;font-weight:600"> Water Recycler</div>
          <div class="drag-item" draggable="true" data-value="power" style="padding:10px 18px;background:rgba(59,130,246,0.15);border:2px solid #3b82f6;border-radius:12px;cursor:grab;font-weight:600"> Battery Storage</div>
        </div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:16px">
          <div class="drop-zone" data-accept="life" style="padding:16px;border:2px dashed rgba(59,130,246,0.4);border-radius:12px;text-align:center;min-height:50px"> Life Support</div>
          <div class="drop-zone" data-accept="power" style="padding:16px;border:2px dashed rgba(59,130,246,0.4);border-radius:12px;text-align:center;min-height:50px"> Power Systems</div>
        </div>
      </div>

      <div style="background:rgba(239,68,68,0.08);border:1px solid rgba(239,68,68,0.2);border-radius:16px;padding:20px;margin-bottom:20px">
        <h3 style="color:#ef4444;margin-top:0"> Fun Fact!</h3>
        <p>Astronauts on the ISS drink <strong>recycled urine</strong>! The water recovery system turns sweat, breath moisture, and yes  pee  back into clean drinking water. NASA says it's cleaner than most tap water! </p>
      </div>

      <button onclick="window.completeChapter('nasa', 5)" style="width:100%;padding:16px;background:linear-gradient(135deg,#3b82f6,#1d4ed8);border:none;border-radius:12px;color:white;font-size:1.1rem;font-weight:bold;cursor:pointer;margin-top:12px"> Complete Chapter 6!</button>
    `,ce()},function(r){r.innerHTML=`
      <img src="./infographics/nasa-ch7.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="SpaceX Reusable Rockets infographic">
      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.2rem;margin:0"> SpaceX Reusable Rockets</h1>
        <p style="color:#94a3b8;font-size:1.1rem;margin-top:8px">Reinforcement Learning</p>
      </div>

      <div style="background:rgba(59,130,246,0.08);border:1px solid rgba(59,130,246,0.3);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#3b82f6;margin-top:0"> Rockets That Come Back!</h2>
        <p style="font-size:1.05rem;line-height:1.7">Before SpaceX, every rocket was used <strong>once</strong> and thrown away  imagine buying a new airplane for every flight!  In <strong style="color:#3b82f6">2015</strong>, SpaceX landed a Falcon 9 booster for the first time. Now they routinely land and reuse rockets!</p>
        <p style="font-size:1.05rem;line-height:1.7">NASA partners with SpaceX to send astronauts to the ISS. The Starship rocket will one day take humans to <strong>Mars</strong>! </p>
      </div>

      <div style="background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#3b82f6;margin-top:0"> AI Concept: Reinforcement Learning</h2>
        <p style="font-size:1.05rem;line-height:1.7"><strong style="color:#3b82f6">Reinforcement Learning</strong> is how AI learns from trial and error  just like learning to ride a bike!  The rocket's AI tries different engine burns and adjustments. Good landing? +reward! Crash? -penalty! Over thousands of simulations, it learns to land perfectly. </p>
      </div>

      <div style="background:rgba(59,130,246,0.06);border:1px solid rgba(59,130,246,0.2);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#3b82f6;margin-top:0"> Activity: Rocket Landing Decisions!</h2>
        <p>Match each landing scenario to the correct AI response! </p>
        <div style="display:flex;flex-wrap:wrap;gap:10px;margin:16px 0">
          <div class="drag-item" draggable="true" data-value="boost" style="padding:10px 18px;background:rgba(59,130,246,0.15);border:2px solid #3b82f6;border-radius:12px;cursor:grab;font-weight:600"> Fire engines harder</div>
          <div class="drag-item" draggable="true" data-value="steer" style="padding:10px 18px;background:rgba(59,130,246,0.15);border:2px solid #3b82f6;border-radius:12px;cursor:grab;font-weight:600"> Adjust grid fins</div>
          <div class="drag-item" draggable="true" data-value="slow" style="padding:10px 18px;background:rgba(59,130,246,0.15);border:2px solid #3b82f6;border-radius:12px;cursor:grab;font-weight:600"> Landing burn</div>
        </div>
        <div style="display:grid;gap:10px;margin-top:16px">
          <div class="drop-zone" data-accept="steer" style="padding:16px;border:2px dashed rgba(59,130,246,0.4);border-radius:12px;text-align:center;min-height:50px">Rocket drifting off course  ___</div>
          <div class="drop-zone" data-accept="boost" style="padding:16px;border:2px dashed rgba(59,130,246,0.4);border-radius:12px;text-align:center;min-height:50px">Falling too fast  ___</div>
          <div class="drop-zone" data-accept="slow" style="padding:16px;border:2px dashed rgba(59,130,246,0.4);border-radius:12px;text-align:center;min-height:50px">Approaching landing pad  ___</div>
        </div>
      </div>

      <div style="background:rgba(239,68,68,0.08);border:1px solid rgba(239,68,68,0.2);border-radius:16px;padding:20px;margin-bottom:20px">
        <h3 style="color:#ef4444;margin-top:0"> Fun Fact!</h3>
        <p>SpaceX's Falcon 9 boosters have been reused up to <strong>19 times</strong>! Each reuse saves about <strong>$50 million</strong>. That's why SpaceX launches cost 10x less than old-school rockets! </p>
      </div>

      <button onclick="window.completeChapter('nasa', 6)" style="width:100%;padding:16px;background:linear-gradient(135deg,#3b82f6,#1d4ed8);border:none;border-radius:12px;color:white;font-size:1.1rem;font-weight:bold;cursor:pointer;margin-top:12px"> Complete Chapter 7!</button>
    `,ce()},function(r){r.innerHTML=`
      <img src="./infographics/nasa-ch8.png" style="width:100%;border-radius:16px;margin-bottom:24px" alt="Your NASA Mission infographic">
      <div style="text-align:center;margin-bottom:32px">
        <h1 style="font-size:2.2rem;margin:0"> Your NASA Mission</h1>
        <p style="color:#94a3b8;font-size:1.1rem;margin-top:8px">Putting It All Together!</p>
      </div>

      <div style="background:rgba(59,130,246,0.08);border:1px solid rgba(59,130,246,0.3);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#3b82f6;margin-top:0"> What You've Learned!</h2>
        <div style="display:grid;gap:12px;margin-top:16px">
          <div style="background:rgba(59,130,246,0.1);border-left:4px solid #3b82f6;border-radius:0 12px 12px 0;padding:14px 18px">
            <strong style="color:#3b82f6">Ch 1: Decision Trees</strong>  Breaking big goals into step-by-step plans 
          </div>
          <div style="background:rgba(59,130,246,0.08);border-left:4px solid #60a5fa;border-radius:0 12px 12px 0;padding:14px 18px">
            <strong style="color:#60a5fa">Ch 2: Computer Vision</strong>  Teaching computers to see and classify images 
          </div>
          <div style="background:rgba(59,130,246,0.1);border-left:4px solid #3b82f6;border-radius:0 12px 12px 0;padding:14px 18px">
            <strong style="color:#3b82f6">Ch 3: Autonomous Navigation</strong>  Self-driving robots on other planets 
          </div>
          <div style="background:rgba(59,130,246,0.08);border-left:4px solid #60a5fa;border-radius:0 12px 12px 0;padding:14px 18px">
            <strong style="color:#60a5fa">Ch 4: Data Compression</strong>  Sending info across billions of miles 
          </div>
          <div style="background:rgba(59,130,246,0.1);border-left:4px solid #3b82f6;border-radius:0 12px 12px 0;padding:14px 18px">
            <strong style="color:#3b82f6">Ch 5: Deep Learning</strong>  Finding patterns in massive datasets 
          </div>
          <div style="background:rgba(59,130,246,0.08);border-left:4px solid #60a5fa;border-radius:0 12px 12px 0;padding:14px 18px">
            <strong style="color:#60a5fa">Ch 6: Automation</strong>  Keeping humans alive in space 
          </div>
          <div style="background:rgba(59,130,246,0.1);border-left:4px solid #3b82f6;border-radius:0 12px 12px 0;padding:14px 18px">
            <strong style="color:#3b82f6">Ch 7: Reinforcement Learning</strong>  Learning from trial and error 
          </div>
        </div>
      </div>

      <div style="background:rgba(59,130,246,0.06);border:1px solid rgba(59,130,246,0.2);border-radius:16px;padding:24px;margin-bottom:20px">
        <h2 style="color:#3b82f6;margin-top:0"> Final Activity: Design Your Space Mission!</h2>
        <p>Match each AI technology to the mission phase where it's needed most! </p>
        <div style="display:flex;flex-wrap:wrap;gap:10px;margin:16px 0">
          <div class="drag-item" draggable="true" data-value="plan" style="padding:10px 18px;background:rgba(59,130,246,0.15);border:2px solid #3b82f6;border-radius:12px;cursor:grab;font-weight:600"> Decision Trees</div>
          <div class="drag-item" draggable="true" data-value="fly" style="padding:10px 18px;background:rgba(59,130,246,0.15);border:2px solid #3b82f6;border-radius:12px;cursor:grab;font-weight:600"> Reinforcement Learning</div>
          <div class="drag-item" draggable="true" data-value="explore" style="padding:10px 18px;background:rgba(59,130,246,0.15);border:2px solid #3b82f6;border-radius:12px;cursor:grab;font-weight:600"> Autonomous Nav</div>
          <div class="drag-item" draggable="true" data-value="analyze" style="padding:10px 18px;background:rgba(59,130,246,0.15);border:2px solid #3b82f6;border-radius:12px;cursor:grab;font-weight:600"> Deep Learning</div>
        </div>
        <div style="display:grid;gap:10px;margin-top:16px">
          <div class="drop-zone" data-accept="plan" style="padding:16px;border:2px dashed rgba(59,130,246,0.4);border-radius:12px;text-align:center;min-height:50px"> Mission Planning Phase</div>
          <div class="drop-zone" data-accept="fly" style="padding:16px;border:2px dashed rgba(59,130,246,0.4);border-radius:12px;text-align:center;min-height:50px"> Launch & Landing Phase</div>
          <div class="drop-zone" data-accept="explore" style="padding:16px;border:2px dashed rgba(59,130,246,0.4);border-radius:12px;text-align:center;min-height:50px"> Surface Exploration Phase</div>
          <div class="drop-zone" data-accept="analyze" style="padding:16px;border:2px dashed rgba(59,130,246,0.4);border-radius:12px;text-align:center;min-height:50px"> Data Analysis Phase</div>
        </div>
      </div>

      <div style="background:linear-gradient(135deg,rgba(59,130,246,0.15),rgba(239,68,68,0.15));border:2px solid rgba(59,130,246,0.3);border-radius:16px;padding:24px;margin-bottom:20px;text-align:center">
        <h2 style="margin-top:0"> You're a NASA AI Explorer! </h2>
        <p style="font-size:1.15rem;line-height:1.7">You've learned how AI powers America's greatest space adventures  from the Moon to Mars and beyond! The next giant leap might be YOURS. Ad astra per aspera  to the stars through hardships! </p>
      </div>

      <!-- NASA 3D Mission Explorer -->
      <div style="margin-bottom:24px">
        <h2 style="color:#3b82f6;text-align:center;margin-bottom:8px"> NASA Missions Explorer  3D</h2>
        <p style="text-align:center;color:#94a3b8;margin-bottom:16px">Explore iconic NASA missions in interactive 3D! Click missions, take a tour, and zoom around.</p>
        <div id="nasa-explorer" style="position:relative;width:100%;height:600px;border-radius:20px;overflow:hidden;border:2px solid rgba(59,130,246,0.3);background:#000">
          <div id="nasa-hud" style="position:absolute;top:16px;left:16px;z-index:10;background:rgba(10,15,30,0.85);backdrop-filter:blur(12px);border:1px solid rgba(59,130,246,0.3);border-radius:14px;padding:16px 20px;min-width:220px;pointer-events:none">
            <div style="font-size:0.75rem;color:#ef4444;font-weight:700;letter-spacing:2px;margin-bottom:8px"> NASA MISSION CONTROL</div>
            <div id="hud-name" style="font-size:1.1rem;font-weight:700;color:#fff">Select a mission</div>
            <div id="hud-year" style="font-size:0.85rem;color:#93c5fd"></div>
            <div id="hud-status" style="font-size:0.8rem;color:#86efac;margin-top:4px"></div>
            <div id="hud-dist" style="font-size:0.8rem;color:#94a3b8;margin-top:2px"></div>
          </div>
          <div id="nasa-btns" style="position:absolute;bottom:16px;left:50%;transform:translateX(-50%);z-index:10;display:flex;gap:8px;flex-wrap:wrap;justify-content:center">
            <button id="btn-tour" style="padding:8px 16px;background:linear-gradient(135deg,#ef4444,#dc2626);border:none;border-radius:10px;color:#fff;font-weight:700;cursor:pointer;font-size:0.85rem"> Tour</button>
            <button data-m="apollo" style="padding:8px 14px;background:rgba(59,130,246,0.25);border:1px solid rgba(59,130,246,0.4);border-radius:10px;color:#93c5fd;cursor:pointer;font-size:0.8rem"> Apollo 11</button>
            <button data-m="hubble" style="padding:8px 14px;background:rgba(59,130,246,0.25);border:1px solid rgba(59,130,246,0.4);border-radius:10px;color:#93c5fd;cursor:pointer;font-size:0.8rem"> Hubble</button>
            <button data-m="voyager" style="padding:8px 14px;background:rgba(59,130,246,0.25);border:1px solid rgba(59,130,246,0.4);border-radius:10px;color:#93c5fd;cursor:pointer;font-size:0.8rem"> Voyager 1</button>
            <button data-m="mars" style="padding:8px 14px;background:rgba(59,130,246,0.25);border:1px solid rgba(59,130,246,0.4);border-radius:10px;color:#93c5fd;cursor:pointer;font-size:0.8rem"> Mars Rover</button>
            <button data-m="jwst" style="padding:8px 14px;background:rgba(59,130,246,0.25);border:1px solid rgba(59,130,246,0.4);border-radius:10px;color:#93c5fd;cursor:pointer;font-size:0.8rem"> JWST</button>
          </div>
        </div>
      </div>

      <button onclick="window.completeChapter('nasa', 7)" style="width:100%;padding:16px;background:linear-gradient(135deg,#3b82f6,#1d4ed8);border:none;border-radius:12px;color:white;font-size:1.1rem;font-weight:bold;cursor:pointer;margin-top:12px"> Complete the Course!</button>
    `,ce(),(function(){const o=document.getElementById("nasa-explorer");if(!o)return;function l(){const p=o.clientWidth,c=o.clientHeight,g=new THREE.Scene,h=new THREE.PerspectiveCamera(55,p/c,.1,2e3);h.position.set(0,12,30);const b=new THREE.WebGLRenderer({antialias:!0,alpha:!0});b.setSize(p,c),b.setPixelRatio(Math.min(window.devicePixelRatio,2)),o.appendChild(b.domElement);const m=new THREE.OrbitControls(h,b.domElement);m.enableDamping=!0,m.dampingFactor=.08,m.autoRotate=!0,m.autoRotateSpeed=.3,m.minDistance=8,m.maxDistance=120;const v=new THREE.BufferGeometry,z=new Float32Array(3e3);for(let le=0;le<3e3;le++)z[le]=(Math.random()-.5)*800;v.setAttribute("position",new THREE.BufferAttribute(z,3)),g.add(new THREE.Points(v,new THREE.PointsMaterial({color:16777215,size:.4}))),g.add(new THREE.AmbientLight(3359846,.6));const k=new THREE.DirectionalLight(16777215,1.2);k.position.set(30,20,20),g.add(k),g.add(new THREE.PointLight(3900150,.5,100));const S=new THREE.SphereGeometry(3,48,48),j=new THREE.MeshPhongMaterial({color:2450411,emissive:661032,specular:6724095,shininess:25}),R=new THREE.Mesh(S,j);g.add(R);const I=new THREE.MeshBasicMaterial({color:3900150,transparent:!0,opacity:.12,side:THREE.BackSide}),D=new THREE.Mesh(new THREE.SphereGeometry(3.4,32,32),I);g.add(D);const U=new THREE.MeshPhongMaterial({color:2278750,transparent:!0,opacity:.3,wireframe:!0}),B=new THREE.Mesh(new THREE.SphereGeometry(3.02,16,16),U);R.add(B);const E=new THREE.Mesh(new THREE.SphereGeometry(.8,24,24),new THREE.MeshPhongMaterial({color:11184810,emissive:1118481}));g.add(E);function N(le,ue){const pe=[];for(let W=0;W<=128;W++){const he=W/128*Math.PI*2;pe.push(new THREE.Vector3(Math.cos(he)*le,0,Math.sin(he)*le))}const Ue=new THREE.BufferGeometry().setFromPoints(pe),ye=new THREE.Line(Ue,new THREE.LineBasicMaterial({color:ue,transparent:!0,opacity:.25}));return g.add(ye),ye}const M={apollo:{name:"Apollo 11",year:1969,status:"Complete  First Moon Landing",dist:"384,400 km",radius:8,speed:.4,color:16096779,fact:"Neil Armstrong was the first human to walk on the Moon  600 million people watched!"},hubble:{name:"Hubble Space Telescope",year:1990,status:"Active  Low Earth Orbit",dist:"547 km",radius:5,speed:.8,color:11032055,fact:"Hubble has made over 1.5 million observations and traveled over 4 billion miles!"},voyager:{name:"Voyager 1",year:1977,status:"Active  Interstellar Space!",dist:"24+ billion km",radius:40,speed:.05,color:440020,fact:"Voyager 1 carries a Golden Record with sounds of Earth for aliens to find!"},mars:{name:"Perseverance Rover",year:2020,status:"Active  Jezero Crater, Mars",dist:"225 million km",radius:22,speed:.15,color:15680580,fact:"Perseverance has a helicopter buddy named Ingenuity  first powered flight on another planet!"},jwst:{name:"James Webb Space Telescope",year:2021,status:"Active  L2 Lagrange Point",dist:"1.5 million km",radius:15,speed:.25,color:15381256,fact:"The JWST mirror is gold-coated and as big as a tennis court when unfolded!"}},y={};function O(){const le=new THREE.Group;le.add(new THREE.Mesh(new THREE.ConeGeometry(.5,1.2,8),new THREE.MeshPhongMaterial({color:16096779,emissive:3810560})));const ue=new THREE.Mesh(new THREE.CylinderGeometry(.5,.6,.8,8),new THREE.MeshPhongMaterial({color:13421772}));return ue.position.y=-.9,le.add(ue),le}function $(){const le=new THREE.Group;return le.add(new THREE.Mesh(new THREE.CylinderGeometry(.3,.3,1.8,12),new THREE.MeshPhongMaterial({color:11032055,emissive:2756688}))),[-1,1].forEach(ue=>{const pe=new THREE.Mesh(new THREE.BoxGeometry(1.5,.05,.6),new THREE.MeshPhongMaterial({color:3900150}));pe.position.set(ue*1.1,0,0),le.add(pe)}),le}function ee(){const le=new THREE.Group,ue=new THREE.Mesh(new THREE.SphereGeometry(.7,16,8,0,Math.PI*2,0,Math.PI/2),new THREE.MeshPhongMaterial({color:440020,emissive:339510,side:THREE.DoubleSide}));ue.rotation.x=Math.PI,le.add(ue),le.add(new THREE.Mesh(new THREE.CylinderGeometry(.05,.05,1.2,6),new THREE.MeshPhongMaterial({color:2730})));const pe=new THREE.Mesh(new THREE.BoxGeometry(2.5,.03,.15),new THREE.MeshPhongMaterial({color:2184}));return pe.position.y=-.5,le.add(pe),le}function J(){const le=new THREE.Group;le.add(new THREE.Mesh(new THREE.BoxGeometry(1,.5,.7),new THREE.MeshPhongMaterial({color:15680580,emissive:3803658})));const ue=new THREE.Mesh(new THREE.CylinderGeometry(.05,.05,.8,6),new THREE.MeshPhongMaterial({color:3276}));ue.position.set(.3,.6,0),le.add(ue);const pe=new THREE.Mesh(new THREE.BoxGeometry(.2,.15,.15),new THREE.MeshPhongMaterial({color:4095}));return pe.position.set(.3,1.05,0),le.add(pe),[-.4,.4].forEach(Ue=>[-.3,.3].forEach(ye=>{const W=new THREE.Mesh(new THREE.CylinderGeometry(.18,.18,.08,12),new THREE.MeshPhongMaterial({color:1365}));W.rotation.x=Math.PI/2,W.position.set(Ue,-.3,ye),le.add(W)})),le}function Q(){const le=new THREE.Group,ue=new THREE.Shape;for(let ye=0;ye<6;ye++){const W=ye/6*Math.PI*2-Math.PI/2;ue[ye===0?"moveTo":"lineTo"](Math.cos(W)*.9,Math.sin(W)*.9)}ue.closePath();const pe=new THREE.Mesh(new THREE.ExtrudeGeometry(ue,{depth:.05,bevelEnabled:!1}),new THREE.MeshPhongMaterial({color:15381256,emissive:4864e3,specular:16776960,shininess:80}));pe.rotation.x=-Math.PI/2,le.add(pe);const Ue=new THREE.Mesh(new THREE.BoxGeometry(2.2,.02,1.4),new THREE.MeshPhongMaterial({color:1638,transparent:!0,opacity:.6}));return Ue.position.y=-.6,le.add(Ue),le}const re=new THREE.Mesh(new THREE.SphereGeometry(1.5,24,24),new THREE.MeshPhongMaterial({color:13386786,emissive:3346688}));g.add(re);const Z={apollo:O,hubble:$,voyager:ee,mars:J,jwst:Q};Object.keys(M).forEach(le=>{const ue=M[le];N(ue.radius,ue.color);const pe=Z[le]();pe.userData={key:le,...ue},g.add(pe),y[le]=pe});const se=new THREE.BufferGeometry,w=new Float32Array(300);se.setAttribute("position",new THREE.BufferAttribute(w,3));const C=new THREE.Points(se,new THREE.PointsMaterial({color:440020,size:.15,transparent:!0,opacity:.5}));g.add(C);const ne=document.createElement("div");ne.style.cssText="position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;overflow:hidden",o.appendChild(ne);const F={};Object.keys(M).forEach(le=>{const ue=document.createElement("div");ue.style.cssText="position:absolute;color:#fff;font-size:0.7rem;font-weight:600;text-shadow:0 0 6px rgba(0,0,0,0.8);white-space:nowrap;transform:translate(-50%,-100%)",ue.textContent=M[le].name+" ("+M[le].year+")",ne.appendChild(ue),F[le]=ue});const q=document.createElement("div");q.style.cssText="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:20;background:rgba(10,15,30,0.92);backdrop-filter:blur(16px);border:1px solid rgba(59,130,246,0.4);border-radius:16px;padding:24px;max-width:320px;display:none;color:#fff;pointer-events:auto",q.innerHTML='<div id="popup-title" style="font-size:1.1rem;font-weight:700;color:#3b82f6"></div><div id="popup-year" style="font-size:0.85rem;color:#93c5fd;margin:4px 0"></div><div id="popup-fact" style="font-size:0.9rem;line-height:1.5;margin:12px 0;color:#e2e8f0"></div><button id="popup-close" style="padding:8px 20px;background:#3b82f6;border:none;border-radius:8px;color:#fff;cursor:pointer;font-weight:600">Close</button>',o.appendChild(q),document.getElementById("popup-close").onclick=()=>q.style.display="none";const H=document.getElementById("hud-name"),oe=document.getElementById("hud-year"),de=document.getElementById("hud-status"),Se=document.getElementById("hud-dist");function Le(le){const ue=M[le];H.textContent=ue.name,oe.textContent=" Launched: "+ue.year,de.textContent=" "+ue.status,Se.textContent=" "+ue.dist+" from Earth"}function tt(le){const ue=M[le];document.getElementById("popup-title").textContent=ue.name,document.getElementById("popup-year").textContent="Launched: "+ue.year+"  "+ue.status,document.getElementById("popup-fact").textContent=" "+ue.fact,q.style.display="block",Le(le)}const Ye=new THREE.Raycaster,gt=new THREE.Vector2;b.domElement.addEventListener("click",le=>{const ue=b.domElement.getBoundingClientRect();gt.x=(le.clientX-ue.left)/ue.width*2-1,gt.y=-((le.clientY-ue.top)/ue.height)*2+1,Ye.setFromCamera(gt,h);for(const pe of Object.keys(y)){const Ue=y[pe];if(Ye.intersectObject(Ue,!0).length>0){tt(pe),Ce(pe);break}}});let ot=null,ze=null,me=2e3,Te=0;function Ce(le){const pe=y[le].position.clone(),Ue=pe.clone().normalize().multiplyScalar(M[le].radius<10?5:8).add(new THREE.Vector3(0,3,0));ze=h.position.clone(),ot=pe.clone().add(Ue),Te=Date.now(),m.autoRotate=!1,Le(le)}document.querySelectorAll("#nasa-btns button[data-m]").forEach(le=>{le.addEventListener("click",()=>{const ue=le.dataset.m;Ce(ue),tt(ue)})});let ct=!1,yt=0;const V=["apollo","hubble","jwst","mars","voyager"];document.getElementById("btn-tour").addEventListener("click",()=>{ct=!0,yt=0,q.style.display="none",m.autoRotate=!1,Ce(V[0]),Le(V[0])});let ie=0;function je(){if(!document.getElementById("nasa-explorer"))return;requestAnimationFrame(je),ie+=.008,R.rotation.y+=.002,E.position.set(Math.cos(ie*.5)*8,.5,Math.sin(ie*.5)*8),re.position.set(Math.cos(ie*.12+2)*22,0,Math.sin(ie*.12+2)*22),Object.keys(M).forEach(pe=>{const Ue=M[pe],ye=y[pe];pe==="mars"?ye.position.copy(re.position).add(new THREE.Vector3(0,2,0)):pe==="apollo"?ye.position.copy(E.position).add(new THREE.Vector3(0,1.5,0)):ye.position.set(Math.cos(ie*Ue.speed)*Ue.radius,Math.sin(ie*Ue.speed*.3)*.5,Math.sin(ie*Ue.speed)*Ue.radius),ye.rotation.y+=.01});const le=y.voyager.position,ue=C.geometry.attributes.position.array;for(let pe=ue.length-3;pe>=3;pe-=3)ue[pe]=ue[pe-3],ue[pe+1]=ue[pe-2],ue[pe+2]=ue[pe-1];if(ue[0]=le.x,ue[1]=le.y,ue[2]=le.z,C.geometry.attributes.position.needsUpdate=!0,Object.keys(F).forEach(pe=>{const ye=y[pe].position.clone().add(new THREE.Vector3(0,1.5,0));ye.project(h);const W=F[pe];if(ye.z>1){W.style.display="none";return}W.style.display="block",W.style.left=(ye.x+1)/2*100+"%",W.style.top=(-ye.y+1)/2*100+"%"}),ot){const pe=Math.min((Date.now()-Te)/me,1),Ue=pe<.5?2*pe*pe:1-Math.pow(-2*pe+2,2)/2;h.position.lerpVectors(ze,ot,Ue),m.target.lerp(y[V[yt]||"apollo"].position,.05),pe>=1&&(ot=null,ct?setTimeout(()=>{yt++,yt<V.length?(Ce(V[yt]),Le(V[yt])):(ct=!1,m.autoRotate=!0)},3e3):setTimeout(()=>{m.autoRotate=!0},2e3))}m.update(),b.render(g,h)}je(),new ResizeObserver(()=>{const le=o.clientWidth,ue=o.clientHeight;h.aspect=le/ue,h.updateProjectionMatrix(),b.setSize(le,ue)}).observe(o)}if(typeof THREE<"u")l();else{const p=document.createElement("script");p.src="https://cdn.jsdelivr.net/npm/three@0.137.0/build/three.min.js",p.onload=()=>{const c=document.createElement("script");c.src="https://cdn.jsdelivr.net/npm/three@0.137.0/examples/js/controls/OrbitControls.js",c.onload=l,document.head.appendChild(c)},document.head.appendChild(p)}})()}]};function tb(r,a){const o=r.dataset.accept,l=a.dataset.value;o===l?(a.classList.add("placed"),a.style.opacity="0.5",r.classList.add("correct"),De(r.closest(".activity")||r.parentElement,"correct"," Correct!"),addPoints(5)):De(r.closest(".activity")||r.parentElement,"wrong"," Try again!")}window.save=()=>{};window.showFeedback=De;window.initDrag=ce;window.startDrag=Xn;window.moveDrag=Zs;window.endDrag=el;window.handleBucketDrop=tb;const ey=Object.freeze(Object.defineProperty({__proto__:null,LESSONS:Zx,endDrag:el,handleBucketDrop:tb,initDrag:ce,moveDrag:Zs,showFeedback:De,startDrag:Xn},Symbol.toStringTag,{value:"Module"}));function ty(r){return r>=500?{icon:"",name:"Creator",next:""}:r>=250?{icon:"",name:"Builder",next:500}:{icon:"",name:"Explorer",next:250}}function ay(r,a,o){const l=a,p=ty(o||0),c=new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),g="NGS-"+Date.now().toString(36).toUpperCase()+"-"+l.charCodeAt(0).toString(36).toUpperCase();if(typeof window<"u"&&window.jspdf&&window.jspdf.jsPDF){const h=new window.jspdf.jsPDF({orientation:"landscape",unit:"mm",format:"a4"});h.setFillColor(10,10,46),h.rect(0,0,297,210,"F"),h.setDrawColor(6,182,212),h.setLineWidth(2),h.roundedRect(8,8,281,194,5,5),h.setDrawColor(139,92,246),h.setLineWidth(1),h.roundedRect(12,12,273,186,4,4),h.setFont("helvetica","bold"),h.setFontSize(16),h.setTextColor(6,182,212),h.text(" NEXTGEN SCHOOL",148.5,30,{align:"center"}),h.setFontSize(28),h.setTextColor(251,191,36),h.text("Certificate of Completion",148.5,50,{align:"center"}),h.setDrawColor(251,191,36),h.setLineWidth(.5),h.line(80,55,217,55),h.setFontSize(12),h.setTextColor(148,163,184),h.text("This certifies that",148.5,68,{align:"center"}),h.setFontSize(32),h.setTextColor(251,191,36),h.text(l,148.5,84,{align:"center"}),h.setFontSize(14),h.setTextColor(226,232,240),h.text(`Has successfully completed ${r}`,148.5,98,{align:"center"}),h.setFontSize(10),h.setTextColor(148,163,184),h.text("Demonstrating critical thinking, creativity, and responsible AI awareness",148.5,110,{align:"center"}),h.setFontSize(12),h.setTextColor(139,92,246),h.text(`Level: ${p.icon} ${p.name} | XP: ${o||0}`,148.5,125,{align:"center"}),h.setFontSize(10),h.setTextColor(148,163,184),h.text(`Date: ${c}`,148.5,140,{align:"center"}),h.setFontSize(8),h.setTextColor(100,116,139),h.text(`Certificate ID: ${g}`,148.5,150,{align:"center"}),h.setFontSize(11),h.setTextColor(226,232,240),h.text("Founders: Rathish & Sathish",148.5,168,{align:"center"}),h.setFontSize(9),h.setTextColor(6,182,212),h.text("nextgenschool.aiupskills.com",148.5,178,{align:"center"}),h.save(`NextGen_Certificate_${r.replace(/[^a-zA-Z]/g,"_")}.pdf`)}else window.open("","_blank").document.write(`<!DOCTYPE html><html><head><title>Certificate</title><style>
      body{margin:0;display:flex;align-items:center;justify-content:center;min-height:100vh;background:#0a0a2e;font-family:Georgia,serif}
      .cert{background:#050510;border:3px solid #06b6d4;padding:60px;text-align:center;max-width:800px;position:relative}
      .cert::after{content:'';position:absolute;inset:8px;border:1px solid #8b5cf6;pointer-events:none}
      h1{color:#fbbf24;font-size:2.5rem;margin-bottom:20px}
      h2{color:#06b6d4;font-size:2rem;margin:10px 0}
      p{color:#e2e8f0;font-size:1.1rem;margin:8px 0}
      .course{color:#8b5cf6;font-size:1.5rem;margin:10px 0}
      .date{color:#94a3b8;margin-top:30px}
      button{margin-top:20px;padding:12px 30px;background:#06b6d4;color:#000;border:none;border-radius:8px;font-size:1rem;cursor:pointer}
    </style></head><body><div class="cert">
      <h1> Certificate of Completion</h1>
      <p>This certifies that</p><h2>${l}</h2>
      <p>has successfully completed</p><div class="course">${r}</div>
      <p>at NextGen School  Mind Over Machines</p>
      <div class="date">${c}</div>
      <button onclick="window.print()"> Print Certificate</button>
    </div></body></html>`);return g}function iy(){const r=[];for(const[a,o]of Object.entries(tr||{}))(o.chapters||[]).forEach((l,p)=>{r.push({id:`${a}_${p}`,emoji:l.emoji,name:l.title,course:a,courseTitle:o.title})});return r}function ry(r){const a={};for(const[o,l]of Object.entries(tr||{})){const p=l.chapters?.length||8;let c=0;for(let g=0;g<p;g++)r?.[`${o}_${g}`]&&c++;a[o]={done:c,total:p,complete:c>=p,title:l.title}}return a}function ny(){const{state:r,navigate:a}=lo(),{isLoggedIn:o}=ji(),l=iy(),p=l.filter(g=>r.completed?.[g.id]).length,c=ry(r.completed);return r.dataLoading?s.jsx("div",{id:"badge-gallery",style:{display:"block",padding:"40px 20px",position:"relative",zIndex:1},children:s.jsxs("div",{className:"container",style:{textAlign:"center"},children:[s.jsx("span",{className:"auth-spinner",style:{width:40,height:40}}),s.jsx("p",{style:{color:"var(--text2)",marginTop:16},children:"Loading badges..."})]})}):s.jsx("div",{id:"badge-gallery",style:{display:"block",padding:"40px 20px",position:"relative",zIndex:1},children:s.jsxs("div",{className:"container",children:[s.jsx("button",{className:"btn btn-back",onClick:()=>a("home"),children:" Back Home"}),s.jsx("h2",{style:{textAlign:"center",margin:"20px 0",fontSize:"2rem"},children:" Badge Gallery"}),s.jsx("p",{style:{textAlign:"center",color:"var(--text2)",marginBottom:"8px"},children:p>0?`You've earned ${p} of ${l.length} badges! Keep going!`:"Complete chapters to earn badges!"}),s.jsx("div",{className:"badges-grid",children:l.map(g=>{const h=r.completed?.[g.id];return s.jsxs("div",{className:`badge ${h?"earned":"locked"}`,title:h?`Earned: ${g.name}`:`Locked: Complete ${g.name}`,children:[s.jsx("span",{className:"emoji",children:h?g.emoji:""}),s.jsx("div",{className:"name",children:g.name}),h&&s.jsx("div",{style:{fontSize:".65rem",color:"var(--green)",marginTop:2},children:" Earned"})]},g.id)})}),Object.values(c).some(g=>g.complete)&&s.jsxs("div",{style:{marginTop:40},children:[s.jsx("h3",{style:{textAlign:"center",marginBottom:16},children:" Your Certificates"}),s.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:16,justifyContent:"center"},children:Object.entries(c).filter(([,g])=>g.complete).map(([g,h])=>s.jsxs("button",{className:"btn btn-gold",onClick:()=>ay(h.title,"Explorer",r.points),style:{padding:"12px 24px"},children:[" Download ",h.title," Certificate"]},g))})]})]})})}function oy({onBack:r}){const{isLoggedIn:a,isDemoMode:o,currentUser:l,openAuthModal:p,session:c}=ji(),[g,h]=_.useState([]),[b,m]=_.useState({}),[v,z]=_.useState([]),[k,S]=_.useState(!0),[j,R]=_.useState(!1),[I,D]=_.useState(null),[U,B]=_.useState(!1),[E,N]=_.useState({name:"",age:"",pin:""}),[M,y]=_.useState(""),O=a&&!o&&l?.role==="parent";_.useEffect(()=>{if(!O||!c?.id){S(!1);return}let w=!1;async function C(){try{const ne=await Dt.getChildrenByParent(c.id);if(w)return;h(ne);const F={};for(const oe of ne){const de=await Dt.getProgressByChild(oe.id);F[oe.id]={},de.forEach(Se=>{F[oe.id][`${Se.course_id}_${Se.chapter_index}`]=!0})}w||m(F);const H=(await Dt.getPurchases()).filter(oe=>oe.user_id===c.id);w||z(H)}catch(ne){console.error("Error loading parent data:",ne)}finally{w||S(!1)}}return C(),()=>{w=!0}},[O,c?.id]);const $=()=>{r?r():window.location.hash="#home"},ee=()=>{R(!0),setTimeout(()=>{alert(" Progress report feature coming soon! EmailJS integration pending."),R(!1)},500)},J=async()=>{if(y(""),!E.name||!E.pin||E.pin.length!==4){y("Name and 4-digit PIN are required");return}try{const w=await Dt.addChild({name:E.name,age:E.age||10,pin:E.pin,parentId:c.id});w?(h(C=>[...C,w]),m(C=>({...C,[w.id]:{}})),B(!1),N({name:"",age:"",pin:""})):y("Failed to add child. PIN may already be in use.")}catch(w){y(w.message||"Failed to add child")}},Q=async w=>{if(!confirm("Remove this child? Their progress will be deleted."))return;await Dt.deleteChild(w)&&(h(ne=>ne.filter(F=>F.id!==w)),m(ne=>{const F={...ne};return delete F[w],F}))},re=async(w,C)=>{const ne=await Dt.updateChild(w,C);ne&&(h(F=>F.map(q=>q.id===w?{...q,...ne}:q)),D(null))};if(!O)return s.jsx("div",{id:"parent-dashboard",children:s.jsxs("div",{className:"container",children:[s.jsxs("div",{className:"pd-header",children:[s.jsx("button",{className:"btn btn-back",onClick:$,children:" Back Home"}),s.jsx("h2",{style:{flex:1,fontSize:"1.4rem"},children:" Parent Dashboard"})]}),s.jsxs("div",{style:{textAlign:"center",padding:"60px 20px"},children:[s.jsx("span",{style:{fontSize:"4rem",display:"block",marginBottom:16},children:""}),s.jsx("h3",{style:{marginBottom:12},children:"Parent Portal"}),s.jsx("p",{style:{color:"var(--text2)",marginBottom:20},children:"Log in to access your family dashboard"}),s.jsx("button",{className:"btn btn-primary",onClick:()=>p("login"),children:"Log In "}),s.jsxs("div",{style:{marginTop:12},children:[s.jsx("span",{style:{color:"var(--text3)",fontSize:".9rem"},children:"Don't have an account? "}),s.jsx("a",{onClick:()=>p("signup"),style:{color:"var(--cyan)",cursor:"pointer",fontSize:".9rem"},children:"Sign up"})]})]})]})});if(k)return s.jsx("div",{id:"parent-dashboard",children:s.jsxs("div",{className:"container",children:[s.jsxs("div",{className:"pd-header",children:[s.jsx("button",{className:"btn btn-back",onClick:$,children:" Back Home"}),s.jsx("h2",{style:{flex:1,fontSize:"1.4rem"},children:" Parent Dashboard"})]}),s.jsxs("div",{style:{textAlign:"center",padding:"60px 20px"},children:[s.jsx("span",{className:"auth-spinner",style:{width:40,height:40}}),s.jsx("p",{style:{color:"var(--text2)",marginTop:16},children:"Loading your dashboard..."})]})]})});const Z=Object.values(b).reduce((w,C)=>w+Object.keys(C).length,0),se=Z*25;return s.jsxs("div",{id:"parent-dashboard",children:[s.jsxs("div",{className:"container",children:[s.jsxs("div",{className:"pd-header",children:[s.jsx("button",{className:"btn btn-back",onClick:$,children:" Back Home"}),s.jsx("h2",{style:{flex:1,fontSize:"1.4rem"},children:" Parent Dashboard"})]}),s.jsxs("div",{id:"pd-content",children:[s.jsxs("div",{className:"pd-stats",children:[s.jsxs("div",{className:"pd-stat",children:[s.jsx("div",{className:"stat-value",children:l?.name||"Parent"}),s.jsx("div",{className:"stat-label",children:"Account"})]}),s.jsxs("div",{className:"pd-stat",children:[s.jsx("div",{className:"stat-value",children:g.length}),s.jsx("div",{className:"stat-label",children:"Children"})]}),s.jsxs("div",{className:"pd-stat",children:[s.jsxs("div",{className:"stat-value",children:[Z,"/24"]}),s.jsx("div",{className:"stat-label",children:"Chapters Done"})]}),s.jsxs("div",{className:"pd-stat",children:[s.jsxs("div",{className:"stat-value",children:[se,""]}),s.jsx("div",{className:"stat-label",children:"Total XP"})]})]}),s.jsxs("div",{style:{margin:"30px 0"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[s.jsx("h3",{children:" Your Children"}),s.jsx("button",{className:"btn btn-primary",onClick:()=>B(!0),style:{fontSize:".85rem",padding:"8px 16px"},children:"+ Add Child"})]}),U&&s.jsxs("div",{className:"glass",style:{padding:20,marginBottom:16,borderRadius:12},children:[s.jsx("h4",{style:{marginBottom:12},children:"Add a Child"}),M&&s.jsx("p",{style:{color:"var(--red)",fontSize:".85rem",marginBottom:8},children:M}),s.jsx("input",{className:"auth-input",placeholder:"Child's name",value:E.name,onChange:w=>N(C=>({...C,name:w.target.value}))}),s.jsx("input",{className:"auth-input",placeholder:"Age (9-13)",type:"number",min:9,max:13,value:E.age,onChange:w=>N(C=>({...C,age:w.target.value}))}),s.jsx("input",{className:"auth-input",placeholder:"4-digit PIN",type:"password",maxLength:4,value:E.pin,onChange:w=>N(C=>({...C,pin:w.target.value.replace(/\D/g,"")}))}),s.jsxs("div",{style:{display:"flex",gap:8},children:[s.jsx("button",{className:"btn btn-primary",onClick:J,style:{fontSize:".85rem"},children:"Save"}),s.jsx("button",{className:"btn btn-back",onClick:()=>{B(!1),y("")},style:{fontSize:".85rem"},children:"Cancel"})]})]}),g.length===0?s.jsxs("div",{className:"glass",style:{padding:30,textAlign:"center",borderRadius:12},children:[s.jsx("span",{style:{fontSize:"2rem"},children:""}),s.jsx("p",{style:{color:"var(--text2)",marginTop:8},children:"No children added yet. Add one to get started!"})]}):g.map(w=>{const C=b[w.id]||{},ne=Object.keys(C).length;return s.jsxs("div",{className:"glass",style:{padding:20,marginBottom:12,borderRadius:12},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[s.jsxs("div",{children:[s.jsxs("h4",{style:{margin:0},children:[" ",w.name]}),s.jsxs("span",{style:{color:"var(--text3)",fontSize:".8rem"},children:["Age: ",w.age,"  PIN: ****"]})]}),s.jsxs("div",{style:{display:"flex",gap:8},children:[s.jsx("button",{onClick:()=>D(w),style:{background:"none",border:"none",color:"var(--cyan)",cursor:"pointer",fontSize:".8rem"},children:" Edit"}),s.jsx("button",{onClick:()=>Q(w.id),style:{background:"none",border:"none",color:"var(--red)",cursor:"pointer",fontSize:".8rem"},children:"Remove"})]})]}),s.jsxs("div",{style:{fontSize:".85rem",color:"var(--text2)",marginBottom:8},children:[ne," chapters completed  ",ne*25," XP"]}),["ai","space","robotics","aiart"].map(F=>{const q=tr[F];let H=0;for(let de=0;de<8;de++)C[`${F}_${de}`]&&H++;const oe=Math.round(H/8*100);return s.jsxs("div",{style:{marginBottom:8},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:".8rem",color:"var(--text2)"},children:[s.jsx("span",{children:q?.title}),s.jsxs("span",{children:[H,"/8 (",oe,"%)"]})]}),s.jsx("div",{className:"progress-bar",style:{maxWidth:"100%",margin:"4px 0"},children:s.jsx("div",{className:"progress-fill",style:{width:`${oe}%`}})})]},F)})]},w.id)})]}),s.jsxs("div",{style:{margin:"30px 0"},children:[s.jsx("h3",{style:{marginBottom:16},children:" Purchase History"}),v.length===0?s.jsx("div",{className:"glass",style:{padding:20,textAlign:"center",borderRadius:12},children:s.jsx("p",{style:{color:"var(--text2)"},children:"No purchases yet."})}):v.map(w=>s.jsxs("div",{className:"glass",style:{padding:16,marginBottom:8,borderRadius:12,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.jsxs("div",{children:[s.jsx("div",{style:{fontWeight:600},children:w.plan}),s.jsx("div",{style:{fontSize:".8rem",color:"var(--text3)"},children:new Date(w.created_at).toLocaleDateString()})]}),s.jsxs("div",{style:{textAlign:"right"},children:[s.jsxs("div",{style:{fontWeight:600,color:"var(--green)"},children:["$",w.amount]}),s.jsx("div",{style:{fontSize:".75rem",color:w.status==="completed"?"var(--green)":"var(--yellow)"},children:w.status})]})]},w.id))]}),s.jsx("div",{style:{textAlign:"center",margin:"20px 0"},children:s.jsx("button",{className:"btn btn-primary",onClick:ee,disabled:j,children:j?"Sending...":" Send Progress Report"})})]})]}),I&&s.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onClick:()=>D(null),children:s.jsxs("div",{className:"glass",style:{padding:24,borderRadius:16,width:360,maxWidth:"90vw"},onClick:w=>w.stopPropagation(),children:[s.jsxs("h3",{style:{margin:"0 0 16px"},children:[" Edit ",I.name]}),s.jsxs("div",{style:{marginBottom:12},children:[s.jsx("label",{style:{display:"block",fontSize:".8rem",color:"var(--text3)",marginBottom:4},children:"Name"}),s.jsx("input",{className:"auth-input",value:I.name,onChange:w=>D(C=>({...C,name:w.target.value}))})]}),s.jsxs("div",{style:{marginBottom:12},children:[s.jsx("label",{style:{display:"block",fontSize:".8rem",color:"var(--text3)",marginBottom:4},children:"Age"}),s.jsx("input",{className:"auth-input",type:"number",min:"5",max:"18",value:I.age,onChange:w=>D(C=>({...C,age:parseInt(w.target.value)||0}))})]}),s.jsxs("div",{style:{marginBottom:16},children:[s.jsx("label",{style:{display:"block",fontSize:".8rem",color:"var(--text3)",marginBottom:4},children:"New PIN (4 digits)"}),s.jsx("input",{className:"auth-input",type:"password",maxLength:4,placeholder:"Enter new 4-digit PIN",value:I.newPin||"",onChange:w=>D(C=>({...C,newPin:w.target.value.replace(/\D/g,"")}))}),s.jsx("span",{style:{fontSize:".75rem",color:"var(--text3)"},children:"Leave blank to keep current PIN"})]}),s.jsxs("div",{style:{display:"flex",gap:8},children:[s.jsx("button",{className:"btn btn-primary",style:{flex:1},onClick:async()=>{const w={name:I.name,age:I.age};I.newPin&&I.newPin.length===4&&(w.pin=I.newPin),await re(I.id,w)},children:"Save Changes"}),s.jsx("button",{className:"btn",style:{flex:1},onClick:()=>D(null),children:"Cancel"})]})]})})]})}function er({columns:r=[],data:a=[],total:o=0,page:l=1,pageSize:p=20,onPageChange:c,onSort:g,sortKey:h,sortDir:b,searchValue:m="",onSearch:v,searchPlaceholder:z="Search",onRowClick:k,selectable:S=!1,selectedIds:j=new Set,onSelectionChange:R,loading:I=!1,emptyMessage:D="No data found",emptyIcon:U="",actions:B,bulkActions:E=[],filters:N=[],headerExtra:M,onPageSizeChange:y,onExport:O,title:$,subtitle:ee,totalsRow:J}){const Q=Math.max(1,Math.ceil(o/p)),re=o===0?0:(l-1)*p+1,Z=Math.min(l*p,o),se=a.length>0&&a.every(H=>j.has(H.id)),w=_.useRef(null),C=()=>{if(R)if(se){const H=new Set(j);a.forEach(oe=>H.delete(oe.id)),R(H)}else{const H=new Set(j);a.forEach(oe=>H.add(oe.id)),R(H)}},ne=H=>{if(!R)return;const oe=new Set(j);oe.has(H)?oe.delete(H):oe.add(H),R(oe)},F=_.useMemo(()=>{const H=[];let de=Math.max(1,l-Math.floor(2.5)),Se=Math.min(Q,de+5-1);Se-de<4&&(de=Math.max(1,Se-5+1));for(let Le=de;Le<=Se;Le++)H.push(Le);return H},[l,Q]),q=H=>{if(!H.sortable||!g)return;const oe=h===H.key&&b==="asc"?"desc":"asc";g(H.key,oe)};return s.jsxs("div",{className:"dg-container",children:[($||ee)&&s.jsxs("div",{className:"dg-title-bar",children:[$&&s.jsx("h3",{className:"dg-title",children:$}),ee&&s.jsx("span",{className:"dg-subtitle",children:ee})]}),s.jsxs("div",{className:"dg-header",children:[s.jsxs("div",{className:"dg-header-left",children:[v&&s.jsxs("div",{className:"dg-search",children:[s.jsxs("svg",{className:"dg-search-svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[s.jsx("circle",{cx:"11",cy:"11",r:"8"}),s.jsx("path",{d:"m21 21-4.35-4.35"})]}),s.jsx("input",{type:"text",value:m,onChange:H=>v(H.target.value),placeholder:z,className:"dg-search-input"})]}),N.map(H=>s.jsx("div",{className:"dg-filter-group",children:H.options.map(oe=>s.jsxs("button",{className:`dg-filter-pill ${H.value===oe.value?"active":""}`,onClick:()=>H.onChange(oe.value),children:[oe.label,oe.count!=null&&s.jsx("span",{className:"dg-filter-count",children:oe.count})]},oe.value))},H.key))]}),s.jsxs("div",{className:"dg-header-right",children:[S&&j.size>0&&s.jsxs("span",{className:"dg-selected-count",children:[j.size," selected"]}),S&&j.size>0&&E.map((H,oe)=>s.jsxs("button",{className:`dg-bulk-btn ${H.variant||""}`,onClick:()=>H.onClick(j),children:[H.icon&&s.jsx("span",{children:H.icon})," ",H.label]},oe)),O&&s.jsxs("button",{className:"dg-bulk-btn",onClick:O,children:[s.jsx("span",{children:""})," Export"]}),M]})]}),s.jsx("div",{className:"dg-table-wrap",ref:w,children:s.jsxs("table",{className:"dg-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[S&&s.jsx("th",{className:"dg-th dg-th-check dg-sticky-col",children:s.jsxs("label",{className:"dg-checkbox",children:[s.jsx("input",{type:"checkbox",checked:se,onChange:C}),s.jsx("span",{className:"dg-checkmark"})]})}),r.map((H,oe)=>s.jsxs("th",{className:`dg-th ${H.sortable?"sortable":""} ${oe===0&&!S?"dg-sticky-col":""}`,style:H.width?{width:H.width,minWidth:H.width}:void 0,onClick:()=>q(H),children:[s.jsx("span",{className:"dg-th-label",children:H.label}),H.sortable&&s.jsx("span",{className:`dg-sort-icon ${h===H.key?"active":""}`,children:h===H.key?b==="asc"?"":"":""})]},H.key)),B&&s.jsx("th",{className:"dg-th dg-th-actions",children:"Actions"})]})}),s.jsxs("tbody",{children:[I?Array.from({length:Math.min(p,8)}).map((H,oe)=>s.jsxs("tr",{className:"dg-row dg-skeleton-row",children:[S&&s.jsx("td",{className:"dg-td",children:s.jsx("div",{className:"dg-skeleton dg-skel-check"})}),r.map(de=>s.jsx("td",{className:"dg-td",children:s.jsx("div",{className:"dg-skeleton",style:{width:`${50+Math.random()*40}%`}})},de.key)),B&&s.jsx("td",{className:"dg-td",children:s.jsx("div",{className:"dg-skeleton",style:{width:60}})})]},`skel-${oe}`)):a.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:r.length+(S?1:0)+(B?1:0),className:"dg-empty",children:s.jsxs("div",{className:"dg-empty-inner",children:[s.jsx("span",{className:"dg-empty-icon",children:U}),s.jsx("p",{className:"dg-empty-msg",children:D})]})})}):a.map((H,oe)=>s.jsxs("tr",{className:`dg-row ${oe%2===0?"dg-row-even":""} ${k?"clickable":""} ${j.has(H.id)?"selected":""}`,onClick:()=>k&&k(H),children:[S&&s.jsx("td",{className:"dg-td dg-td-check dg-sticky-col",onClick:de=>de.stopPropagation(),children:s.jsxs("label",{className:"dg-checkbox",children:[s.jsx("input",{type:"checkbox",checked:j.has(H.id),onChange:()=>ne(H.id)}),s.jsx("span",{className:"dg-checkmark"})]})}),r.map((de,Se)=>s.jsx("td",{className:`dg-td ${Se===0&&!S?"dg-sticky-col":""}`,children:de.render?de.render(H[de.key],H):H[de.key]??""},de.key)),B&&s.jsx("td",{className:"dg-td dg-td-actions",onClick:de=>de.stopPropagation(),children:B(H)})]},H.id||oe)),J&&!I&&a.length>0&&s.jsxs("tr",{className:"dg-row dg-totals-row",children:[S&&s.jsx("td",{className:"dg-td"}),r.map(H=>s.jsx("td",{className:"dg-td dg-td-total",children:J[H.key]??""},H.key)),B&&s.jsx("td",{className:"dg-td"})]})]})]})}),o>0&&s.jsxs("div",{className:"dg-pagination",children:[s.jsxs("div",{className:"dg-pagination-info",children:[s.jsxs("span",{className:"dg-pagination-text",children:["Showing ",s.jsx("strong",{children:re}),"",s.jsx("strong",{children:Z})," of ",s.jsx("strong",{children:o.toLocaleString()})]}),y&&s.jsx("select",{className:"dg-pagesize-select",value:p,onChange:H=>y(Number(H.target.value)),children:[10,25,50,100].map(H=>s.jsxs("option",{value:H,children:[H," / page"]},H))})]}),s.jsxs("div",{className:"dg-pagination-buttons",children:[s.jsx("button",{className:"dg-page-btn",disabled:l<=1,onClick:()=>c(1),title:"First",children:""}),s.jsx("button",{className:"dg-page-btn",disabled:l<=1,onClick:()=>c(l-1),children:""}),F[0]>1&&s.jsx("span",{className:"dg-page-dots",children:""}),F.map(H=>s.jsx("button",{className:`dg-page-btn ${H===l?"active":""}`,onClick:()=>c(H),children:H},H)),F[F.length-1]<Q&&s.jsx("span",{className:"dg-page-dots",children:""}),s.jsx("button",{className:"dg-page-btn",disabled:l>=Q,onClick:()=>c(l+1),children:""}),s.jsx("button",{className:"dg-page-btn",disabled:l>=Q,onClick:()=>c(Q),title:"Last",children:""})]})]})]})}function ja({status:r,size:a="sm"}){const l={active:"#10b981",success:"#10b981",completed:"#10b981",granted:"#10b981",failed:"#ef4444",error:"#ef4444",cancelled:"#ef4444",revoked:"#ef4444",pending:"#f59e0b",processing:"#f59e0b",depleted:"#f59e0b",inactive:"#6b7280",expired:"#6b7280",deactivated:"#6b7280",refunded:"#8b5cf6",admin:"#8b5cf6",parent:"#3b82f6",child:"#06b6d4"}[(r||"").toLowerCase()]||"#6b7280";return s.jsxs("span",{className:`dg-status-badge dg-badge-${a}`,style:{"--badge-color":l},children:[s.jsx("span",{className:"dg-badge-dot"}),r]})}function Si({icon:r,title:a,onClick:o,variant:l="",disabled:p=!1}){return s.jsx("button",{className:`dg-action-btn ${l}`,title:a,onClick:o,disabled:p,children:r})}function zi({open:r,onClose:a,title:o,children:l,width:p="520px"}){return r?s.jsx("div",{className:"admin-modal-overlay",onClick:a,children:s.jsxs("div",{className:"admin-modal glass-card",style:{maxWidth:p},onClick:c=>c.stopPropagation(),children:[s.jsxs("div",{className:"admin-modal-header",children:[s.jsx("h3",{style:{margin:0,fontSize:"16px",color:"#fff"},children:o}),s.jsx("button",{className:"admin-modal-close",onClick:a,children:""})]}),s.jsx("div",{className:"admin-modal-body",children:l})]})}):null}function Zn({value:r,prefix:a="",suffix:o="",duration:l=800}){const[p,c]=_.useState(0),g=_.useRef(null);return _.useEffect(()=>{const h=Number(r)||0,b=p,m=performance.now(),v=z=>{const k=z-m,S=Math.min(k/l,1),j=1-Math.pow(1-S,3);c(Math.round(b+(h-b)*j)),S<1&&(g.current=requestAnimationFrame(v))};return g.current=requestAnimationFrame(v),()=>cancelAnimationFrame(g.current)},[r]),s.jsxs("span",{className:"dg-animated-number",children:[a,p.toLocaleString(),o]})}kf.register(Sf,zf,jf,_f,Af,Ef,Cf,Tf,Nf,Rf);let Qi=null;Ze(()=>import("./admin.service-BC-t6ThH.js"),__vite__mapDeps([4,1,2,3])).then(r=>{Qi=r}).catch(()=>{});const sy=[{key:"totalFamilies",label:"Families",icon:"",color:"#8b5cf6",gradient:"linear-gradient(135deg, #8b5cf6, #6d28d9)"},{key:"totalChildren",label:"Children",icon:"",color:"#06b6d4",gradient:"linear-gradient(135deg, #06b6d4, #0891b2)"},{key:"totalRevenue",label:"Revenue",icon:"",color:"#10b981",gradient:"linear-gradient(135deg, #10b981, #059669)",prefix:"$"},{key:"totalPurchases",label:"Transactions",icon:"",color:"#f59e0b",gradient:"linear-gradient(135deg, #f59e0b, #d97706)"},{key:"chaptersCompleted",label:"Chapters Done",icon:"",color:"#ec4899",gradient:"linear-gradient(135deg, #ec4899, #db2777)"},{key:"failedPayments",label:"Failed Payments",icon:"",color:"#ef4444",gradient:"linear-gradient(135deg, #ef4444, #dc2626)"}],xf=r=>({responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!1},tooltip:{backgroundColor:"rgba(10,10,16,0.95)",borderColor:"rgba(255,255,255,0.1)",borderWidth:1,titleFont:{family:"Inter"},bodyFont:{family:"JetBrains Mono, monospace",size:12},padding:12,cornerRadius:10}},scales:{x:{grid:{color:"rgba(255,255,255,0.04)"},ticks:{color:"rgba(255,255,255,0.4)",font:{size:11,family:"Inter"}}},y:{grid:{color:"rgba(255,255,255,0.04)"},ticks:{color:"rgba(255,255,255,0.4)",font:{size:11,family:"JetBrains Mono, monospace"}}}}}),ly={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{color:"rgba(255,255,255,0.6)",font:{size:11,family:"Inter"},padding:16,usePointStyle:!0}},tooltip:{backgroundColor:"rgba(10,10,16,0.95)",borderColor:"rgba(255,255,255,0.1)",borderWidth:1,padding:12,cornerRadius:10}},cutout:"65%"};function ab(){const[r,a]=_.useState(null),[o,l]=_.useState(null),[p,c]=_.useState(null),[g,h]=_.useState(null),[b,m]=_.useState(!0),[v,z]=_.useState(null);_.useEffect(()=>{k()},[]);async function k(){m(!0),z(null);try{Qi||(Qi=await Ze(()=>import("./admin.service-BC-t6ThH.js"),__vite__mapDeps([4,1,2,3])));const[U,B,E,N]=await Promise.all([Qi.getStats(),Qi.getRevenueByDay(7),Qi.getEnrollmentsByDay(7),Qi.getCourseCompletion()]);U.data&&a(U.data),B.data&&l(B.data),E.data&&c(E.data),N.data&&h(N.data)}catch(U){z(U.message)}finally{m(!1)}}const S=Array.from({length:7},(U,B)=>new Date(Date.now()-(6-B)*864e5).toISOString().slice(0,10)),j=S.map(U=>new Date(U+"T12:00:00").toLocaleDateString("en",{weekday:"short",month:"short",day:"numeric"})),R=o?{labels:j,datasets:[{label:"Revenue",data:S.map(U=>o[U]||0),backgroundColor:"rgba(139,92,246,0.3)",borderColor:"#8b5cf6",borderWidth:2,borderRadius:8,hoverBackgroundColor:"rgba(139,92,246,0.5)"}]}:null,I=p?{labels:j,datasets:[{label:"Enrollments",data:S.map(U=>p[U]||0),borderColor:"#06b6d4",backgroundColor:"rgba(6,182,212,0.1)",borderWidth:2,fill:!0,tension:.4,pointBackgroundColor:"#06b6d4",pointBorderColor:"#050508",pointBorderWidth:2,pointRadius:4,pointHoverRadius:6}]}:null,D=g?{labels:g.map(U=>U.title||"Unknown"),datasets:[{data:g.map(U=>U.completionPct),backgroundColor:["#8b5cf6","#06b6d4","#ec4899","#10b981","#f59e0b","#ef4444"],borderColor:"#050508",borderWidth:3,hoverOffset:8}]}:null;return v?s.jsxs("div",{className:"admin-error-state",children:[s.jsx("span",{className:"admin-error-icon",children:""}),s.jsx("p",{children:"Failed to load dashboard data"}),s.jsx("button",{className:"admin-btn primary",onClick:k,children:"Retry"})]}):s.jsxs("div",{className:"admin-dashboard",children:[s.jsxs("div",{className:"admin-page-header",children:[s.jsx("h2",{className:"admin-page-title",children:"Dashboard"}),s.jsx("p",{className:"admin-page-subtitle",children:"Overview of your school's performance"})]}),s.jsx("div",{className:"admin-stats-grid-6",children:sy.map(U=>s.jsxs("div",{className:"admin-stat-card-pro glass-card",style:{"--stat-color":U.color},children:[s.jsx("div",{className:"admin-stat-card-icon",style:{background:U.gradient},children:U.icon}),s.jsxs("div",{className:"admin-stat-card-content",children:[s.jsx("div",{className:"admin-stat-card-value",style:{fontFamily:"JetBrains Mono, monospace"},children:b?s.jsx("div",{className:"dg-skeleton",style:{width:60,height:28}}):s.jsx(Zn,{value:r?.[U.key]||0,prefix:U.prefix||""})}),s.jsx("div",{className:"admin-stat-card-label",children:U.label})]})]},U.key))}),s.jsxs("div",{className:"admin-charts-row-3",children:[s.jsxs("div",{className:"admin-chart-card-pro glass-card",children:[s.jsx("h4",{className:"admin-chart-card-title",children:"Revenue (Last 7 Days)"}),s.jsx("div",{className:"admin-chart-area",children:b?s.jsx(Ac,{}):R&&s.jsx(Is,{data:R,options:xf()})})]}),s.jsxs("div",{className:"admin-chart-card-pro glass-card",children:[s.jsx("h4",{className:"admin-chart-card-title",children:"Enrollments (Last 7 Days)"}),s.jsx("div",{className:"admin-chart-area",children:b?s.jsx(Ac,{}):I&&s.jsx(Mf,{data:I,options:xf()})})]}),s.jsxs("div",{className:"admin-chart-card-pro glass-card",children:[s.jsx("h4",{className:"admin-chart-card-title",children:"Course Completion"}),s.jsx("div",{className:"admin-chart-area",children:b?s.jsx(Ac,{}):D&&s.jsx(Of,{data:D,options:ly})})]})]})]})}function Ac(){return s.jsx("div",{style:{display:"flex",alignItems:"flex-end",gap:8,height:"100%",padding:"20px 0"},children:Array.from({length:7}).map((r,a)=>s.jsx("div",{className:"dg-skeleton",style:{flex:1,height:`${30+Math.random()*60}%`,borderRadius:6}},a))})}let Ls=null;Ze(()=>import("./admin.service-BC-t6ThH.js"),__vite__mapDeps([4,1,2,3])).then(r=>{Ls=r}).catch(()=>{});function dy(){const[r,a]=_.useState([]),[o,l]=_.useState(0),[p,c]=_.useState(1),[g,h]=_.useState(20),[b,m]=_.useState(""),[v,z]=_.useState(!0),[k,S]=_.useState(new Set),[j,R]=_.useState(null),[I,D]=_.useState(null),U=_.useCallback(async()=>{z(!0);try{Ls||(Ls=await Ze(()=>import("./admin.service-BC-t6ThH.js"),__vite__mapDeps([4,1,2,3])));const M=await Ls.getEnrollments({page:p,pageSize:g,search:b});a((M.data||[]).map(y=>({id:y.id,name:y.name||"",email:y.email||"",children:y.children?.length||0,childrenList:y.children||[],plan:"Standard",status:"active",date:y.created_at?.slice(0,10)||"",raw:y}))),l(M.count||0)}catch(M){console.error(M)}finally{z(!1)}},[p,g,b]);_.useEffect(()=>{U()},[U]);const B=M=>{I&&clearTimeout(I);const y=setTimeout(()=>{m(M),c(1)},400);D(y)},E=()=>{const M=r.filter(ee=>k.has(ee.id));if(!M.length)return;const y=`Name,Email,Children,Status,Date
`+M.map(ee=>`"${ee.name}","${ee.email}",${ee.children},${ee.status},${ee.date}`).join(`
`),O=new Blob([y],{type:"text/csv"}),$=document.createElement("a");$.href=URL.createObjectURL(O),$.download=`enrollments-${new Date().toISOString().slice(0,10)}.csv`,$.click()},N=[{key:"name",label:"Name",sortable:!0,render:(M,y)=>s.jsxs("div",{className:"dg-cell-primary",children:[s.jsx("span",{className:"dg-avatar",children:(y.name||"?")[0].toUpperCase()}),s.jsx("span",{children:M})]})},{key:"email",label:"Email",sortable:!0,render:M=>s.jsx("span",{className:"dg-mono-text",children:M})},{key:"children",label:"Children",width:"100px",sortable:!0,render:M=>s.jsx("span",{className:"dg-number",children:M})},{key:"plan",label:"Plan",width:"120px"},{key:"status",label:"Status",width:"120px",render:M=>s.jsx(ja,{status:M})},{key:"date",label:"Joined",width:"120px",sortable:!0,render:M=>s.jsx("span",{className:"dg-mono-text",children:M})}];return s.jsxs("div",{children:[s.jsxs("div",{className:"admin-page-header",children:[s.jsx("h2",{className:"admin-page-title",children:"Enrollments"}),s.jsx("p",{className:"admin-page-subtitle",children:"Manage family enrollments and registrations"})]}),s.jsx(er,{columns:N,data:r,total:o,page:p,pageSize:g,onPageChange:c,onPageSizeChange:M=>{h(M),c(1)},onSearch:B,searchPlaceholder:"Search by name or email",loading:v,selectable:!0,selectedIds:k,onSelectionChange:S,onRowClick:R,emptyMessage:"No enrollments found",emptyIcon:"",bulkActions:[{label:"Export",icon:"",onClick:E}]}),s.jsx(zi,{open:!!j,onClose:()=>R(null),title:"Family Details",children:j&&s.jsxs("div",{className:"admin-detail-content",children:[s.jsxs("div",{className:"admin-detail-row",children:[s.jsx("span",{className:"admin-detail-label",children:"Name"}),s.jsx("span",{className:"admin-detail-value",children:j.name})]}),s.jsxs("div",{className:"admin-detail-row",children:[s.jsx("span",{className:"admin-detail-label",children:"Email"}),s.jsx("span",{className:"admin-detail-value dg-mono-text",children:j.email})]}),s.jsxs("div",{className:"admin-detail-row",children:[s.jsx("span",{className:"admin-detail-label",children:"Status"}),s.jsx(ja,{status:j.status})]}),s.jsxs("div",{className:"admin-detail-row",children:[s.jsx("span",{className:"admin-detail-label",children:"Joined"}),s.jsx("span",{className:"admin-detail-value",children:j.date})]}),j.childrenList?.length>0&&s.jsxs(s.Fragment,{children:[s.jsx("h4",{style:{color:"#fff",marginTop:16,marginBottom:8,fontSize:14},children:"Children"}),j.childrenList.map(M=>s.jsxs("div",{className:"admin-child-pill",children:[s.jsxs("span",{children:[" ",M.name]}),M.age&&s.jsxs("span",{className:"admin-child-age",children:["Age ",M.age]})]},M.id))]})]})})]})}let Us=null;Ze(()=>import("./admin.service-BC-t6ThH.js"),__vite__mapDeps([4,1,2,3])).then(r=>{Us=r}).catch(()=>{});function cy(){const[r,a]=_.useState([]),[o,l]=_.useState(0),[p,c]=_.useState(1),[g,h]=_.useState(20),[b,m]=_.useState(""),[v,z]=_.useState(!0),[k,S]=_.useState({completed:0,pending:0,failed:0}),j=_.useCallback(async()=>{z(!0);try{Us||(Us=await Ze(()=>import("./admin.service-BC-t6ThH.js"),__vite__mapDeps([4,1,2,3])));const D=await Us.getPayments({page:p,pageSize:g,status:b}),U=(D.data||[]).map(M=>({id:M.id,txId:M.id?.slice(0,8)||"",user:M.profiles?.name||M.profiles?.email||"",course:M.course_id||"N/A",amount:Number(M.amount)||0,method:M.method||"stripe",status:M.status||"pending",coupon:M.coupon_code||"",date:M.created_at?.slice(0,10)||""}));a(U),l(D.count||0);const B=U.filter(M=>M.status==="completed").reduce((M,y)=>M+y.amount,0),E=U.filter(M=>M.status==="pending").reduce((M,y)=>M+y.amount,0),N=U.filter(M=>M.status==="failed").reduce((M,y)=>M+y.amount,0);S({completed:B,pending:E,failed:N})}catch(D){console.error(D)}finally{z(!1)}},[p,g,b]);_.useEffect(()=>{j()},[j]);const R=[{key:"txId",label:"ID",width:"100px",render:D=>s.jsxs("span",{className:"dg-mono-text",style:{color:"#8b5cf6"},children:["#",D]})},{key:"user",label:"User",sortable:!0},{key:"course",label:"Course",width:"140px"},{key:"amount",label:"Amount",width:"120px",sortable:!0,render:D=>s.jsxs("span",{className:"dg-mono-text",style:{color:"#10b981",fontWeight:600},children:["$",D.toFixed(2)]})},{key:"method",label:"Method",width:"100px",render:D=>s.jsxs("span",{className:"dg-method-pill",children:[D==="stripe"?"":""," ",D]})},{key:"status",label:"Status",width:"120px",render:D=>s.jsx(ja,{status:D})},{key:"coupon",label:"Coupon",width:"120px",render:D=>D!==""?s.jsx("span",{className:"admin-coupon-code",children:D}):""},{key:"date",label:"Date",width:"110px",sortable:!0,render:D=>s.jsx("span",{className:"dg-mono-text",children:D})}],I={key:"status",value:b,onChange:D=>{m(D),c(1)},options:[{value:"",label:"All"},{value:"completed",label:"Completed"},{value:"pending",label:"Pending"},{value:"failed",label:"Failed"}]};return s.jsxs("div",{children:[s.jsxs("div",{className:"admin-page-header",children:[s.jsx("h2",{className:"admin-page-title",children:"Payments"}),s.jsx("p",{className:"admin-page-subtitle",children:"Track all payment transactions"})]}),s.jsxs("div",{className:"admin-mini-stats",children:[s.jsxs("div",{className:"admin-mini-stat glass-card",style:{"--stat-color":"#10b981"},children:[s.jsx("span",{className:"admin-mini-stat-label",children:"Completed"}),s.jsxs("span",{className:"admin-mini-stat-value dg-mono-text",style:{color:"#10b981"},children:["$",k.completed.toFixed(2)]})]}),s.jsxs("div",{className:"admin-mini-stat glass-card",style:{"--stat-color":"#f59e0b"},children:[s.jsx("span",{className:"admin-mini-stat-label",children:"Pending"}),s.jsxs("span",{className:"admin-mini-stat-value dg-mono-text",style:{color:"#f59e0b"},children:["$",k.pending.toFixed(2)]})]}),s.jsxs("div",{className:"admin-mini-stat glass-card",style:{"--stat-color":"#ef4444"},children:[s.jsx("span",{className:"admin-mini-stat-label",children:"Failed"}),s.jsxs("span",{className:"admin-mini-stat-value dg-mono-text",style:{color:"#ef4444"},children:["$",k.failed.toFixed(2)]})]})]}),s.jsx(er,{columns:R,data:r,total:o,page:p,pageSize:g,onPageChange:c,onPageSizeChange:D=>{h(D),c(1)},loading:v,emptyMessage:"No payments found",emptyIcon:"",filters:[I],totalsRow:{txId:s.jsx("strong",{style:{color:"rgba(255,255,255,0.6)"},children:"TOTAL"}),amount:s.jsxs("strong",{className:"dg-mono-text",style:{color:"#10b981"},children:["$",r.reduce((D,U)=>D+U.amount,0).toFixed(2)]})}})]})}kf.register(Sf,zf,jf,_f,Af,Ef,Cf,Tf,Nf,Rf);let Fi=null;Ze(()=>import("./admin.service-BC-t6ThH.js"),__vite__mapDeps([4,1,2,3])).then(r=>{Fi=r}).catch(()=>{});const uy=[{value:7,label:"7 days"},{value:30,label:"30 days"},{value:90,label:"90 days"},{value:365,label:"All time"}],yf=["#8b5cf6","#06b6d4","#ec4899","#10b981","#f59e0b","#ef4444","#3b82f6"],Qn={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:"rgba(10,10,16,0.95)",borderColor:"rgba(255,255,255,0.1)",borderWidth:1,padding:12,cornerRadius:10,bodyFont:{family:"JetBrains Mono, monospace",size:12}}},scales:{x:{grid:{color:"rgba(255,255,255,0.04)"},ticks:{color:"rgba(255,255,255,0.4)",font:{size:10,family:"Inter"}}},y:{grid:{color:"rgba(255,255,255,0.04)"},ticks:{color:"rgba(255,255,255,0.4)",font:{size:10,family:"JetBrains Mono, monospace"}}}}},py={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right",labels:{color:"rgba(255,255,255,0.6)",font:{size:11,family:"Inter"},padding:12,usePointStyle:!0}},tooltip:{backgroundColor:"rgba(10,10,16,0.95)",borderColor:"rgba(255,255,255,0.1)",borderWidth:1,padding:12,cornerRadius:10}},cutout:"60%"};function gy(){const[r,a]=_.useState(7),[o,l]=_.useState(!0),[p,c]=_.useState(null),[g,h]=_.useState(null),[b,m]=_.useState(null),[v,z]=_.useState(null);_.useEffect(()=>{k()},[r]);async function k(){l(!0);try{Fi||(Fi=await Ze(()=>import("./admin.service-BC-t6ThH.js"),__vite__mapDeps([4,1,2,3])));const[y,O,$,ee]=await Promise.all([Fi.getStats(),Fi.getRevenueByDay(r),Fi.getEnrollmentsByDay(r),Fi.getAnalytics()]);y.data&&c(y.data),O.data&&h(O.data),$.data&&m($.data),ee.data&&z(ee.data)}catch(y){console.error(y)}finally{l(!1)}}const S=Array.from({length:Math.min(r,30)},(y,O)=>new Date(Date.now()-(Math.min(r,30)-1-O)*864e5).toISOString().slice(0,10)),j=S.map(y=>{const O=new Date(y+"T12:00:00");return r<=7?O.toLocaleDateString("en",{weekday:"short"}):O.toLocaleDateString("en",{month:"short",day:"numeric"})}),R=g?{labels:j,datasets:[{label:"Revenue ($)",data:S.map(y=>g[y]||0),borderColor:"#8b5cf6",backgroundColor:"rgba(139,92,246,0.1)",borderWidth:2,fill:!0,tension:.4,pointRadius:r<=7?4:0,pointBackgroundColor:"#8b5cf6"}]}:null,I=b?{labels:j,datasets:[{label:"Enrollments",data:S.map(y=>b[y]||0),backgroundColor:"rgba(6,182,212,0.4)",borderColor:"#06b6d4",borderWidth:2,borderRadius:6}]}:null,D=v?.popularCourses?{labels:v.popularCourses.slice(0,6).map(y=>y.title||"Unknown"),datasets:[{label:"Students",data:v.popularCourses.slice(0,6).map(y=>y.students),backgroundColor:yf.slice(0,6).map(y=>y+"80"),borderColor:yf.slice(0,6),borderWidth:1,borderRadius:6}]}:null,U={...Qn,indexAxis:"y"},B=v?.completionFunnel?{labels:v.completionFunnel.map(y=>y.title||"Unknown"),datasets:[{label:"Started",data:v.completionFunnel.map(y=>y.started),backgroundColor:"rgba(139,92,246,0.4)",borderColor:"#8b5cf6",borderWidth:1,borderRadius:4},{label:"Completed",data:v.completionFunnel.map(y=>y.completed),backgroundColor:"rgba(16,185,129,0.4)",borderColor:"#10b981",borderWidth:1,borderRadius:4}]}:null,E={...Qn,plugins:{...Qn.plugins,legend:{display:!0,labels:{color:"rgba(255,255,255,0.6)",font:{size:11,family:"Inter"},usePointStyle:!0,padding:16}}}},N={labels:["Stripe","Razorpay","Free"],datasets:[{data:[65,25,10],backgroundColor:["rgba(139,92,246,0.6)","rgba(6,182,212,0.6)","rgba(16,185,129,0.6)"],borderColor:["#8b5cf6","#06b6d4","#10b981"],borderWidth:2}]},M=[{label:"Total Revenue",value:p?.totalRevenue||0,prefix:"$",color:"#10b981"},{label:"Total Users",value:p?.totalFamilies||0,color:"#8b5cf6"},{label:"Avg Revenue/User",value:p?.totalFamilies?Math.round((p.totalRevenue||0)/p.totalFamilies):0,prefix:"$",color:"#06b6d4"},{label:"Completion Rate",value:p?.chaptersCompleted||0,suffix:"",color:"#ec4899"}];return s.jsxs("div",{children:[s.jsxs("div",{className:"admin-page-header",style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",flexWrap:"wrap",gap:16},children:[s.jsxs("div",{children:[s.jsx("h2",{className:"admin-page-title",children:"Analytics"}),s.jsx("p",{className:"admin-page-subtitle",children:"Deep dive into your school's metrics"})]}),s.jsx("div",{className:"admin-range-selector",children:uy.map(y=>s.jsx("button",{className:`admin-range-btn ${r===y.value?"active":""}`,onClick:()=>a(y.value),children:y.label},y.value))})]}),s.jsx("div",{className:"admin-mini-stats",style:{marginBottom:24},children:M.map(y=>s.jsxs("div",{className:"admin-mini-stat glass-card",style:{"--stat-color":y.color},children:[s.jsx("span",{className:"admin-mini-stat-label",children:y.label}),s.jsx("span",{className:"admin-mini-stat-value dg-mono-text",style:{color:y.color},children:o?"":s.jsx(Zn,{value:y.value,prefix:y.prefix||"",suffix:y.suffix||""})})]},y.label))}),s.jsxs("div",{className:"admin-analytics-grid",children:[s.jsxs("div",{className:"admin-chart-card-pro glass-card admin-chart-wide",children:[s.jsx("h4",{className:"admin-chart-card-title",children:"Revenue Trend"}),s.jsx("div",{className:"admin-chart-area",children:o?s.jsx("div",{className:"admin-chart-loading",children:"Loading"}):R&&s.jsx(Mf,{data:R,options:Qn})})]}),s.jsxs("div",{className:"admin-chart-card-pro glass-card",children:[s.jsx("h4",{className:"admin-chart-card-title",children:"User Growth"}),s.jsx("div",{className:"admin-chart-area",children:o?s.jsx("div",{className:"admin-chart-loading",children:"Loading"}):I&&s.jsx(Is,{data:I,options:Qn})})]}),s.jsxs("div",{className:"admin-chart-card-pro glass-card",children:[s.jsx("h4",{className:"admin-chart-card-title",children:"Course Popularity"}),s.jsx("div",{className:"admin-chart-area",children:o?s.jsx("div",{className:"admin-chart-loading",children:"Loading"}):D&&s.jsx(Is,{data:D,options:U})})]}),s.jsxs("div",{className:"admin-chart-card-pro glass-card admin-chart-wide",children:[s.jsx("h4",{className:"admin-chart-card-title",children:"Completion Funnel"}),s.jsx("div",{className:"admin-chart-area",children:o?s.jsx("div",{className:"admin-chart-loading",children:"Loading"}):B&&s.jsx(Is,{data:B,options:E})})]}),s.jsxs("div",{className:"admin-chart-card-pro glass-card",children:[s.jsx("h4",{className:"admin-chart-card-title",children:"Payment Methods"}),s.jsx("div",{className:"admin-chart-area",children:o?s.jsx("div",{className:"admin-chart-loading",children:"Loading"}):s.jsx(Of,{data:N,options:py})})]})]})]})}let Sa=null;Ze(()=>import("./admin.service-BC-t6ThH.js"),__vite__mapDeps([4,1,2,3])).then(r=>{Sa=r}).catch(()=>{});function hy(){const[r,a]=_.useState([]),[o,l]=_.useState(!0),[p,c]=_.useState(null),[g,h]=_.useState([]),[b,m]=_.useState(!1),[v,z]=_.useState(null),[k,S]=_.useState({userId:"",reason:"",email:""}),[j,R]=_.useState([]),[I,D]=_.useState(""),[U,B]=_.useState(!1),[E,N]=_.useState(""),[M,y]=_.useState(""),[O,$]=_.useState(null);_.useEffect(()=>{ee()},[]);async function ee(){l(!0);try{Sa||(Sa=await Ze(()=>import("./admin.service-BC-t6ThH.js"),__vite__mapDeps([4,1,2,3])));const w=await Sa.getCourseOverview();a(w.data||[])}catch(w){$(w.message)}finally{l(!1)}}async function J(){m(!0);try{const w=await Sa.getCourseAccessLog({pageSize:50});h(w.data||[])}catch(w){console.error(w)}finally{m(!1)}}async function Q(){try{Sa||(Sa=await Ze(()=>import("./admin.service-BC-t6ThH.js"),__vite__mapDeps([4,1,2,3])));const w=await Sa.getUsers({pageSize:200});R(w.data||[])}catch(w){console.error(w)}}async function re(){if(!k.userId||!v){N("Select a user first");return}N(""),y("");try{const w=await Sa.grantCourseAccess(k.userId,v.id,k.reason);if(w.error){N(w.error.message||"Failed to grant access");return}y(`Access granted to ${k.email}!`),setTimeout(()=>{z(null),S({userId:"",reason:"",email:""}),y(""),ee()},1500)}catch(w){N(w.message||"Failed")}}async function Z(w){try{await Sa.revokeCourseAccess(w),J()}catch(C){console.error(C)}}const se=w=>{p===w?c(null):(c(w),J())};return o?s.jsxs("div",{children:[s.jsxs("div",{className:"admin-page-header",children:[s.jsx("h2",{className:"admin-page-title",children:"Courses"}),s.jsx("p",{className:"admin-page-subtitle",children:"Manage courses and access"})]}),s.jsx("div",{className:"admin-course-cards-pro",children:[1,2,3].map(w=>s.jsxs("div",{className:"admin-course-card-pro glass-card",children:[s.jsx("div",{className:"dg-skeleton",style:{width:"60%",height:24,marginBottom:16}}),s.jsx("div",{className:"dg-skeleton",style:{width:"100%",height:60}})]},w))})]}):s.jsxs("div",{children:[s.jsxs("div",{className:"admin-page-header",children:[s.jsx("h2",{className:"admin-page-title",children:"Courses"}),s.jsx("p",{className:"admin-page-subtitle",children:"Manage courses, enrollments, and access grants"})]}),s.jsxs("div",{className:"admin-course-cards-pro",children:[r.map(w=>s.jsxs("div",{className:`admin-course-card-pro glass-card ${p===w.id?"expanded":""}`,children:[s.jsxs("div",{className:"admin-course-card-top",onClick:()=>se(w.id),children:[s.jsxs("div",{className:"admin-course-card-title-row",children:[s.jsx("span",{className:"admin-course-emoji",children:w.emoji||""}),s.jsx("h3",{className:"admin-course-name",children:w.title}),s.jsx("span",{className:"admin-course-expand",children:p===w.id?"":""})]}),s.jsxs("div",{className:"admin-course-metrics",children:[s.jsxs("div",{className:"admin-course-metric",children:[s.jsx("span",{className:"admin-course-metric-value dg-mono-text",children:w.students}),s.jsx("span",{className:"admin-course-metric-label",children:"Students"})]}),s.jsxs("div",{className:"admin-course-metric",children:[s.jsxs("span",{className:"admin-course-metric-value dg-mono-text",children:[w.completionPct,"%"]}),s.jsx("span",{className:"admin-course-metric-label",children:"Completed"})]}),s.jsxs("div",{className:"admin-course-metric",children:[s.jsxs("span",{className:"admin-course-metric-value dg-mono-text",style:{color:"#10b981"},children:["$",w.revenue]}),s.jsx("span",{className:"admin-course-metric-label",children:"Revenue"})]}),s.jsxs("div",{className:"admin-course-metric",children:[s.jsx("span",{className:"admin-course-metric-value dg-mono-text",children:w.chaptersDone}),s.jsx("span",{className:"admin-course-metric-label",children:"Chapters"})]})]}),s.jsx("div",{className:"admin-course-progress-bar",children:s.jsx("div",{className:"admin-course-progress-fill",style:{width:`${w.completionPct}%`}})})]}),p===w.id&&s.jsxs("div",{className:"admin-course-expanded",children:[s.jsx("div",{className:"admin-course-actions-row",children:s.jsx("button",{className:"admin-btn primary",onClick:()=>{z(w),Q(),N(""),y("")},children:" Grant Access"})}),s.jsx("h4",{style:{color:"rgba(255,255,255,0.6)",fontSize:13,margin:"16px 0 8px",fontWeight:600},children:"Access Log"}),b?s.jsx("div",{style:{padding:16,textAlign:"center",color:"rgba(255,255,255,0.3)"},children:"Loading"}):s.jsx("div",{className:"admin-access-log",children:g.filter(C=>C.course_id===w.id).length===0?s.jsx("div",{style:{padding:16,textAlign:"center",color:"rgba(255,255,255,0.3)",fontSize:13},children:"No access grants for this course"}):s.jsxs("table",{className:"admin-mini-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"User"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Granted"}),s.jsx("th",{children:"Action"})]})}),s.jsx("tbody",{children:g.filter(C=>C.course_id===w.id).map(C=>s.jsxs("tr",{children:[s.jsx("td",{children:C.profiles?.name||C.profiles?.email||""}),s.jsx("td",{children:s.jsx(ja,{status:C.active!==!1?"granted":"revoked"})}),s.jsx("td",{className:"dg-mono-text",children:C.granted_at?.slice(0,10)||""}),s.jsx("td",{children:C.active!==!1&&s.jsx("button",{className:"admin-btn-sm danger",onClick:()=>Z(C.id),children:"Revoke"})})]},C.id))})]})})]})]},w.id)),r.length===0&&s.jsxs("div",{className:"admin-empty-state glass-card",children:[s.jsx("span",{style:{fontSize:48},children:""}),s.jsx("p",{children:"No courses found"})]})]}),s.jsxs(zi,{open:!!v,onClose:()=>{z(null),S({userId:"",reason:"",email:""})},title:`Grant Access  ${v?.emoji||""} ${v?.title||""}`,children:[s.jsxs("div",{className:"admin-form-group",children:[s.jsx("label",{className:"admin-form-label",children:"Select User"}),s.jsxs("div",{style:{position:"relative"},children:[s.jsx("input",{className:"admin-input",placeholder:"Search by name or email",value:k.email||I,onChange:w=>{D(w.target.value),S(C=>({...C,userId:"",email:""})),B(!0)},onFocus:()=>B(!0)}),U&&!k.userId&&s.jsxs("div",{style:{position:"absolute",top:"100%",left:0,right:0,zIndex:100,background:"#0a0a10",border:"1px solid rgba(255,255,255,0.1)",borderRadius:8,maxHeight:200,overflowY:"auto",marginTop:4},children:[j.filter(w=>{const C=I.toLowerCase();return!C||(w.name||"").toLowerCase().includes(C)||(w.email||"").toLowerCase().includes(C)}).map(w=>s.jsxs("div",{onClick:()=>{S(C=>({...C,userId:w.id,email:w.email})),D(""),B(!1)},style:{padding:"10px 14px",cursor:"pointer",borderBottom:"1px solid rgba(255,255,255,0.04)",display:"flex",justifyContent:"space-between",alignItems:"center"},onMouseEnter:C=>C.currentTarget.style.background="rgba(139,92,246,0.15)",onMouseLeave:C=>C.currentTarget.style.background="transparent",children:[s.jsxs("div",{children:[s.jsx("div",{style:{color:"#fff",fontSize:".9rem",fontWeight:500},children:w.name||"Unknown"}),s.jsx("div",{style:{color:"rgba(255,255,255,0.4)",fontSize:".75rem",fontFamily:"JetBrains Mono, monospace"},children:w.email})]}),s.jsx("span",{style:{fontSize:".7rem",color:w.role==="admin"?"#8b5cf6":"#06b6d4",textTransform:"uppercase",fontWeight:600},children:w.role})]},w.id)),j.filter(w=>{const C=I.toLowerCase();return!C||(w.name||"").toLowerCase().includes(C)||(w.email||"").toLowerCase().includes(C)}).length===0&&s.jsx("div",{style:{padding:"16px",textAlign:"center",color:"rgba(255,255,255,0.3)",fontSize:".85rem"},children:"No users found"})]})]}),k.userId&&s.jsxs("div",{style:{marginTop:6,fontSize:".8rem",color:"var(--green)"},children:[" Selected: ",k.email]})]}),s.jsxs("div",{className:"admin-form-group",children:[s.jsx("label",{className:"admin-form-label",children:"Reason (optional)"}),s.jsx("input",{className:"admin-input",placeholder:"e.g., Scholarship, Free trial, Support ticket",value:k.reason,onChange:w=>S(C=>({...C,reason:w.target.value}))})]}),E&&s.jsxs("div",{style:{color:"#ef4444",fontSize:".85rem",marginTop:8},children:[" ",E]}),M&&s.jsxs("div",{style:{color:"#10b981",fontSize:".85rem",marginTop:8},children:[" ",M]}),s.jsxs("div",{style:{display:"flex",gap:8,marginTop:16},onClick:()=>B(!1),children:[s.jsx("button",{className:"admin-btn primary",onClick:w=>{w.stopPropagation(),B(!1),re()},disabled:!k.userId,children:"Grant Access"}),s.jsx("button",{className:"admin-btn",onClick:()=>{z(null),S({userId:"",reason:"",email:""})},children:"Cancel"})]})]})]})}let qs=null;Ze(()=>import("./admin.service-BC-t6ThH.js"),__vite__mapDeps([4,1,2,3])).then(r=>{qs=r}).catch(()=>{});function fy(){const[r,a]=_.useState([]),[o,l]=_.useState(0),[p,c]=_.useState(1),[g,h]=_.useState(20),[b,m]=_.useState(""),[v,z]=_.useState(!0),[k,S]=_.useState(null),[j,R]=_.useState(!1),[I,D]=_.useState(null),U=_.useCallback(async()=>{z(!0);try{qs||(qs=await Ze(()=>import("./admin.service-BC-t6ThH.js"),__vite__mapDeps([4,1,2,3])));const N=await qs.getUsers({page:p,pageSize:g,search:b});a((N.data||[]).map(M=>({id:M.id,name:M.name||"",email:M.email||"",role:M.role||"parent",childrenCount:(M.children||[]).length,children:M.children||[],purchases:0,status:M.active!==!1?"active":"inactive",joined:M.created_at?.slice(0,10)||"",raw:M}))),l(N.count||0)}catch(N){console.error(N)}finally{z(!1)}},[p,g,b]);_.useEffect(()=>{U()},[U]);const B=N=>{I&&clearTimeout(I);const M=setTimeout(()=>{m(N),c(1)},400);D(M)},E=[{key:"name",label:"Name",sortable:!0,render:(N,M)=>s.jsxs("div",{className:"dg-cell-primary",children:[s.jsx("span",{className:"dg-avatar",style:{background:M.role==="admin"?"#8b5cf6":"#3b82f6"},children:(N||"?")[0].toUpperCase()}),s.jsx("div",{children:s.jsx("span",{style:{color:"#fff",fontWeight:500},children:N})})]})},{key:"email",label:"Email",sortable:!0,render:N=>s.jsx("span",{className:"dg-mono-text",children:N})},{key:"role",label:"Role",width:"100px",render:N=>s.jsx(ja,{status:N})},{key:"childrenCount",label:"Children",width:"90px",render:N=>s.jsx("span",{className:"dg-number",children:N})},{key:"status",label:"Status",width:"100px",render:N=>s.jsx(ja,{status:N})},{key:"joined",label:"Joined",width:"110px",sortable:!0,render:N=>s.jsx("span",{className:"dg-mono-text",children:N})}];return s.jsxs("div",{children:[s.jsxs("div",{className:"admin-page-header",style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",flexWrap:"wrap",gap:12},children:[s.jsxs("div",{children:[s.jsx("h2",{className:"admin-page-title",children:"Users"}),s.jsx("p",{className:"admin-page-subtitle",children:"Manage all registered users"})]}),s.jsx("button",{className:"admin-btn primary",onClick:()=>R(!0),children:"+ Create User"})]}),s.jsx(er,{columns:E,data:r,total:o,page:p,pageSize:g,onPageChange:c,onPageSizeChange:N=>{h(N),c(1)},onSearch:B,searchPlaceholder:"Search users",loading:v,onRowClick:S,emptyMessage:"No users found",emptyIcon:"",actions:N=>s.jsxs("div",{style:{display:"flex",gap:4},children:[s.jsx(Si,{icon:"",title:"View",onClick:()=>S(N)}),s.jsx(Si,{icon:"",title:"Edit",onClick:()=>{}}),s.jsx(Si,{icon:"",title:"Delete",variant:"danger",onClick:()=>{}})]})}),s.jsx(zi,{open:!!k,onClose:()=>S(null),title:"User Details",width:"560px",children:k&&s.jsxs("div",{className:"admin-detail-content",children:[s.jsxs("div",{className:"admin-detail-header-card glass-card",style:{display:"flex",alignItems:"center",gap:16,padding:20,marginBottom:16},children:[s.jsx("div",{className:"dg-avatar-lg",style:{background:"#8b5cf6"},children:(k.name||"?")[0].toUpperCase()}),s.jsxs("div",{children:[s.jsx("h3",{style:{color:"#fff",margin:0,fontSize:18},children:k.name}),s.jsx("p",{className:"dg-mono-text",style:{margin:"4px 0 0",opacity:.6},children:k.email})]})]}),s.jsxs("div",{className:"admin-detail-row",children:[s.jsx("span",{className:"admin-detail-label",children:"Role"}),s.jsx(ja,{status:k.role})]}),s.jsxs("div",{className:"admin-detail-row",children:[s.jsx("span",{className:"admin-detail-label",children:"Status"}),s.jsx(ja,{status:k.status})]}),s.jsxs("div",{className:"admin-detail-row",children:[s.jsx("span",{className:"admin-detail-label",children:"Joined"}),s.jsx("span",{className:"admin-detail-value dg-mono-text",children:k.joined})]}),k.children?.length>0&&s.jsxs(s.Fragment,{children:[s.jsxs("h4",{style:{color:"#fff",marginTop:20,marginBottom:8,fontSize:14},children:["Children (",k.children.length,")"]}),k.children.map(N=>s.jsxs("div",{className:"admin-child-pill",children:[s.jsxs("span",{children:[" ",N.name]}),N.age&&s.jsxs("span",{className:"admin-child-age",children:["Age ",N.age]})]},N.id))]})]})}),s.jsxs(zi,{open:j,onClose:()=>R(!1),title:"Create User",children:[s.jsxs("div",{className:"admin-form-group",children:[s.jsx("label",{className:"admin-form-label",children:"Name"}),s.jsx("input",{className:"admin-input",placeholder:"Full name"})]}),s.jsxs("div",{className:"admin-form-group",children:[s.jsx("label",{className:"admin-form-label",children:"Email"}),s.jsx("input",{className:"admin-input",type:"email",placeholder:"email@example.com"})]}),s.jsxs("div",{className:"admin-form-group",children:[s.jsx("label",{className:"admin-form-label",children:"Role"}),s.jsxs("select",{className:"admin-input",children:[s.jsx("option",{value:"parent",children:"Parent"}),s.jsx("option",{value:"admin",children:"Admin"})]})]}),s.jsxs("div",{style:{display:"flex",gap:8,marginTop:16},children:[s.jsx("button",{className:"admin-btn primary",children:"Create"}),s.jsx("button",{className:"admin-btn",onClick:()=>R(!1),children:"Cancel"})]})]})]})}let Hs=null;Ze(()=>import("./admin.service-BC-t6ThH.js"),__vite__mapDeps([4,1,2,3])).then(r=>{Hs=r}).catch(()=>{});function by(){const[r,a]=_.useState([]),[o,l]=_.useState(!0),[p,c]=_.useState(null),[g,h]=_.useState(""),[b,m]=_.useState(""),[v,z]=_.useState(1),[k,S]=_.useState(20),[j,R]=_.useState(null);_.useEffect(()=>{I()},[]);async function I(){l(!0);try{Hs||(Hs=await Ze(()=>import("./admin.service-BC-t6ThH.js"),__vite__mapDeps([4,1,2,3])));const N=await Hs.getStudentProgress();if(N.error){console.error("Students load error:",N.error),l(!1);return}const M=(N.data||[]).map(y=>{const O={};(y.progress||[]).forEach(ee=>{O[ee.course_id]||(O[ee.course_id]=[]),O[ee.course_id].push(ee)});const $=Object.values(O).reduce((ee,J)=>ee+J.length,0);return{id:y.id,name:y.name||"",age:y.age||"",parent:y.profiles?.name||y.profiles?.email||"",coursesProgress:O,totalChapters:$,badges:$>=10?"":$>=5?"":"",lastActive:y.progress?.length>0&&y.progress.sort((ee,J)=>(J.completed_at||"").localeCompare(ee.completed_at||""))[0]?.completed_at?.slice(0,10)||""}});a(M)}catch(N){console.error(N)}finally{l(!1)}}const D=r.filter(N=>{if(b){const M=b.toLowerCase();if(!N.name.toLowerCase().includes(M)&&!N.parent.toLowerCase().includes(M))return!1}return!0}),U=D.slice((v-1)*k,v*k),B=[{key:"name",label:"Name",sortable:!0,render:(N,M)=>s.jsxs("div",{className:"dg-cell-primary",children:[s.jsx("span",{className:"dg-avatar",style:{background:"#06b6d4"},children:(N||"?")[0].toUpperCase()}),s.jsx("span",{children:N})]})},{key:"age",label:"Age",width:"70px",render:N=>s.jsx("span",{className:"dg-number",children:N})},{key:"parent",label:"Parent",sortable:!0},{key:"totalChapters",label:"Progress",width:"200px",render:(N,M)=>s.jsxs("div",{className:"admin-progress-cell",children:[s.jsx("div",{className:"admin-progress-bar-mini",children:s.jsx("div",{className:"admin-progress-fill-mini",style:{width:`${Math.min(N*5,100)}%`,background:N>=10?"#10b981":N>=5?"#f59e0b":"#8b5cf6"}})}),s.jsxs("span",{className:"dg-mono-text",style:{fontSize:11,minWidth:40},children:[N," ch."]})]})},{key:"badges",label:"Badges",width:"80px",render:N=>N||""},{key:"lastActive",label:"Last Active",width:"110px",sortable:!0,render:N=>s.jsx("span",{className:"dg-mono-text",children:N})}],E=N=>{j&&clearTimeout(j);const M=setTimeout(()=>{m(N),z(1)},400);R(M)};return s.jsxs("div",{children:[s.jsxs("div",{className:"admin-page-header",children:[s.jsx("h2",{className:"admin-page-title",children:"Students"}),s.jsx("p",{className:"admin-page-subtitle",children:"Track student progress and achievements"})]}),s.jsx(er,{columns:B,data:U,total:D.length,page:v,pageSize:k,onPageChange:z,onPageSizeChange:N=>{S(N),z(1)},onSearch:E,searchPlaceholder:"Search students or parents",loading:o,onRowClick:c,emptyMessage:"No students found",emptyIcon:""}),s.jsx(zi,{open:!!p,onClose:()=>c(null),title:`${p?.name||"Student"}  Progress`,width:"600px",children:p&&s.jsxs("div",{className:"admin-detail-content",children:[s.jsxs("div",{className:"admin-detail-row",children:[s.jsx("span",{className:"admin-detail-label",children:"Name"}),s.jsx("span",{className:"admin-detail-value",children:p.name})]}),s.jsxs("div",{className:"admin-detail-row",children:[s.jsx("span",{className:"admin-detail-label",children:"Age"}),s.jsx("span",{className:"admin-detail-value",children:p.age})]}),s.jsxs("div",{className:"admin-detail-row",children:[s.jsx("span",{className:"admin-detail-label",children:"Parent"}),s.jsx("span",{className:"admin-detail-value",children:p.parent})]}),s.jsxs("div",{className:"admin-detail-row",children:[s.jsx("span",{className:"admin-detail-label",children:"Total Chapters"}),s.jsx("span",{className:"admin-detail-value dg-mono-text",children:p.totalChapters})]}),s.jsx("h4",{style:{color:"#fff",marginTop:20,marginBottom:12,fontSize:14},children:"Course Progress"}),Object.entries(p.coursesProgress).length===0?s.jsx("p",{style:{color:"rgba(255,255,255,0.3)",fontSize:13},children:"No progress recorded yet"}):Object.entries(p.coursesProgress).map(([N,M])=>s.jsxs("div",{className:"admin-course-progress-detail glass-card",style:{padding:12,marginBottom:8},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[s.jsxs("span",{style:{color:"#fff",fontSize:13,fontWeight:500},children:["Course ",N.slice(0,8)]}),s.jsxs("span",{className:"dg-mono-text",style:{fontSize:12,color:"#8b5cf6"},children:[M.length," chapters"]})]}),s.jsx("div",{style:{display:"flex",gap:4,flexWrap:"wrap"},children:M.sort((y,O)=>y.chapter_index-O.chapter_index).map(y=>s.jsx("span",{className:"admin-chapter-dot completed",title:`Chapter ${y.chapter_index+1}`,children:y.chapter_index+1},y.chapter_index))})]},N))]})})]})}let za=null;Ze(()=>import("./coupon.service-Cr-N3BwU.js"),__vite__mapDeps([0,1,2,3])).then(r=>{za=r}).catch(()=>{});function my(){const[r,a]=_.useState([]),[o,l]=_.useState(0),[p,c]=_.useState(1),[g,h]=_.useState(20),[b,m]=_.useState(""),[v,z]=_.useState(""),[k,S]=_.useState(!0),[j,R]=_.useState({active:0,totalRedeemed:0,revenueImpact:0}),[I,D]=_.useState("single"),[U,B]=_.useState(!1),[E,N]=_.useState(""),[M,y]=_.useState(null),[O,$]=_.useState([]),[ee,J]=_.useState(null),[Q,re]=_.useState({}),[Z,se]=_.useState({code:"",type:"percentage",value:"",courseScope:"global",selectedCourses:[],maxUses:1,expiresAt:""}),[w,C]=_.useState({prefix:"",count:10,type:"percentage",value:"",courseScope:"global",selectedCourses:[],maxUses:1,expiresAt:""}),[ne,F]=_.useState([]);_.useEffect(()=>{Ji.from("courses").select("id, title").then(({data:V})=>$(V||[]))},[]);const q=_.useCallback(async()=>{S(!0);try{za||(za=await Ze(()=>import("./coupon.service-Cr-N3BwU.js"),__vite__mapDeps([0,1,2,3])));const[V,ie]=await Promise.all([za.getCoupons({page:p,pageSize:g,search:b,status:v}),za.getCouponStats()]),je=new Date;a((V.data||[]).map(Ae=>{const le=Ae.expires_at?new Date(Ae.expires_at):null,ue=le&&le<je,pe=Ae.max_uses>0&&Ae.current_uses>=Ae.max_uses,Ue=le&&!ue&&le-je<3*864e5,ye=Ae.active?ue?"expired":pe?"depleted":Ue?"expiring":"active":"inactive";return{id:Ae.id,code:Ae.code,course:Ae.course_id||null,type:Ae.type,value:Ae.value,uses:`${Ae.current_uses||0}/${Ae.max_uses}`,currentUses:Ae.current_uses||0,maxUses:Ae.max_uses,expires:Ae.expires_at?.slice(0,10)||"Never",expiresAt:Ae.expires_at?.slice(0,10)||"",status:ye,active:Ae.active,raw:Ae}})),l(V.count||0),ie.data&&R(ie.data)}catch(V){console.error(V)}finally{S(!1)}},[p,g,b,v]);_.useEffect(()=>{q()},[q]);const H=V=>{M&&clearTimeout(M);const ie=setTimeout(()=>{m(V),c(1)},400);y(ie)},oe=()=>{const V="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let ie="";for(let je=0;je<8;je++)ie+=V[Math.floor(Math.random()*V.length)];se(je=>({...je,code:ie}))},de=(V,ie)=>V==="global"?null:ie.join(",")||null,Se=(V,ie,je)=>{V(Ae=>{const le=ie.includes(je)?ie.filter(ue=>ue!==je):[...ie,je];return{...Ae,selectedCourses:le}})},Le=async()=>{if(!(!Z.code||!Z.value)){if(Z.type==="percentage"&&Number(Z.value)>100){alert("Percentage discount cannot exceed 100%");return}B(!0);try{await za.createCoupon({code:Z.code,type:Z.type,value:Number(Z.value),courseId:de(Z.courseScope,Z.selectedCourses),maxUses:Number(Z.maxUses)||1,expiresAt:Z.expiresAt||null}),se({code:"",type:"percentage",value:"",courseScope:"global",selectedCourses:[],maxUses:1,expiresAt:""}),N("Coupon created!"),setTimeout(()=>N(""),3e3),q()}catch(V){console.error(V)}finally{B(!1)}}},tt=async()=>{if(!(!w.prefix||!w.value)){if(w.type==="percentage"&&Number(w.value)>100){alert("Percentage discount cannot exceed 100%");return}B(!0);try{const V=await za.generateBulkCoupons({prefix:w.prefix,count:Number(w.count)||10,type:w.type,value:Number(w.value),courseId:de(w.courseScope,w.selectedCourses),maxUses:Number(w.maxUses)||1,expiresAt:w.expiresAt||null});F((V.data||[]).map(ie=>ie.code)),N(`${V.data?.length||0} coupons created!`),setTimeout(()=>N(""),5e3),q()}catch(V){console.error(V)}finally{B(!1)}}},Ye=V=>{navigator.clipboard?.writeText(V)},gt=async V=>{try{await za.updateCoupon(V.id,{active:!V.active}),q()}catch(ie){console.error(ie)}},ot=async V=>{if(confirm(`Delete coupon ${V.code}?`))try{await za.deleteCoupon(V.id),q()}catch(ie){console.error(ie)}},ze=V=>{const ie=V.raw.course_id,je=!ie;re({type:V.type,value:V.value,maxUses:V.maxUses,expiresAt:V.expiresAt||"",active:V.active,courseScope:je?"global":"specific",selectedCourses:ie?ie.split(",").map(Ae=>Ae.trim()):[]}),J(V)},me=async()=>{if(ee){if(Q.type==="percentage"&&Number(Q.value)>100){alert("Percentage discount cannot exceed 100%");return}try{await za.updateCoupon(ee.id,{type:Q.type,value:Number(Q.value),max_uses:Number(Q.maxUses),expires_at:Q.expiresAt||null,active:Q.active,course_id:de(Q.courseScope,Q.selectedCourses)}),J(null),q()}catch(V){console.error(V)}}},Te=V=>{const ie=O.find(je=>je.id===V);return ie?ie.title:V},Ce=({scope:V,selectedCourses:ie,onScopeChange:je,onToggleCourse:Ae})=>s.jsxs("div",{style:{marginTop:8},children:[s.jsx("label",{className:"admin-form-label",children:"Course Assignment"}),s.jsxs("div",{style:{display:"flex",gap:16,marginBottom:8},children:[s.jsxs("label",{style:{color:"#ccc",cursor:"pointer",display:"flex",alignItems:"center",gap:4},children:[s.jsx("input",{type:"radio",checked:V==="global",onChange:()=>je("global")}),"  Global (All Courses)"]}),s.jsxs("label",{style:{color:"#ccc",cursor:"pointer",display:"flex",alignItems:"center",gap:4},children:[s.jsx("input",{type:"radio",checked:V==="specific",onChange:()=>je("specific")}),"  Specific Courses"]})]}),V==="specific"&&s.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:O.map(le=>s.jsxs("label",{style:{color:ie.includes(le.id)?"#10b981":"#999",cursor:"pointer",display:"flex",alignItems:"center",gap:4,background:ie.includes(le.id)?"rgba(16,185,129,0.1)":"rgba(255,255,255,0.05)",padding:"6px 12px",borderRadius:8,border:`1px solid ${ie.includes(le.id)?"rgba(16,185,129,0.3)":"rgba(255,255,255,0.1)"}`},children:[s.jsx("input",{type:"checkbox",checked:ie.includes(le.id),onChange:()=>Ae(le.id)}),le.title]},le.id))})]}),ct=[{key:"code",label:"Code",sortable:!0,render:V=>s.jsx("span",{className:"admin-coupon-code",style:{cursor:"pointer"},onClick:()=>Ye(V),title:"Click to copy",children:V})},{key:"course",label:"Course",width:"140px",render:V=>{if(!V)return s.jsx("span",{style:{color:"#8b5cf6"},children:" Global"});const ie=V.split(",");return ie.length>1?s.jsxs("span",{title:ie.map(Te).join(", "),children:[" ",ie.length," courses"]}):s.jsx("span",{children:Te(V)})}},{key:"type",label:"Type",width:"80px",render:V=>V==="percentage"?"%":"$"},{key:"value",label:"Value",width:"80px",render:(V,ie)=>s.jsx("span",{className:"dg-mono-text",style:{color:"#10b981",fontWeight:600},children:ie.type==="percentage"?`${V}%`:`$${V}`})},{key:"uses",label:"Uses",width:"100px",render:(V,ie)=>s.jsxs("div",{children:[s.jsx("span",{className:"dg-mono-text",children:V}),s.jsx("div",{className:"admin-progress-bar-mini",style:{marginTop:4},children:s.jsx("div",{className:"admin-progress-fill-mini",style:{width:`${ie.maxUses>0?ie.currentUses/ie.maxUses*100:0}%`}})})]})},{key:"expires",label:"Expires",width:"110px",render:V=>s.jsx("span",{className:"dg-mono-text",children:V})},{key:"status",label:"Status",width:"110px",render:V=>s.jsx(ja,{status:V})}],yt={key:"status",value:v,onChange:V=>{z(V),c(1)},options:[{value:"",label:"All"},{value:"active",label:"Active"},{value:"expired",label:"Expired"},{value:"depleted",label:"Depleted"}]};return s.jsxs("div",{children:[s.jsxs("div",{className:"admin-page-header",children:[s.jsx("h2",{className:"admin-page-title",children:"Coupons"}),s.jsx("p",{className:"admin-page-subtitle",children:"Generate, manage, and track discount codes"})]}),s.jsxs("div",{className:"admin-mini-stats",style:{marginBottom:24},children:[s.jsxs("div",{className:"admin-mini-stat glass-card",style:{"--stat-color":"#10b981"},children:[s.jsx("span",{className:"admin-mini-stat-label",children:"Active Coupons"}),s.jsx("span",{className:"admin-mini-stat-value dg-mono-text",style:{color:"#10b981"},children:s.jsx(Zn,{value:j.active})})]}),s.jsxs("div",{className:"admin-mini-stat glass-card",style:{"--stat-color":"#8b5cf6"},children:[s.jsx("span",{className:"admin-mini-stat-label",children:"Total Redeemed"}),s.jsx("span",{className:"admin-mini-stat-value dg-mono-text",style:{color:"#8b5cf6"},children:s.jsx(Zn,{value:j.totalRedeemed})})]}),s.jsxs("div",{className:"admin-mini-stat glass-card",style:{"--stat-color":"#ec4899"},children:[s.jsx("span",{className:"admin-mini-stat-label",children:"Revenue Impact"}),s.jsx("span",{className:"admin-mini-stat-value dg-mono-text",style:{color:"#ec4899"},children:s.jsx(Zn,{value:j.revenueImpact,prefix:"$"})})]})]}),s.jsxs("div",{className:"admin-generate-section glass-card",style:{marginBottom:24,padding:24},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[s.jsx("h3",{style:{color:"#fff",margin:0,fontSize:16},children:"Generate Coupons"}),s.jsxs("div",{className:"admin-range-selector",children:[s.jsx("button",{className:`admin-range-btn ${I==="single"?"active":""}`,onClick:()=>D("single"),children:"Single"}),s.jsx("button",{className:`admin-range-btn ${I==="bulk"?"active":""}`,onClick:()=>D("bulk"),children:"Bulk"})]})]}),E&&s.jsxs("div",{className:"admin-alert-banner",style:{background:"rgba(16,185,129,0.1)",border:"1px solid rgba(16,185,129,0.25)",color:"#10b981",marginBottom:16},children:[" ",E]}),I==="single"?s.jsxs("div",{children:[s.jsxs("div",{className:"admin-form-row",children:[s.jsxs("div",{className:"admin-form-group",style:{flex:2},children:[s.jsx("label",{className:"admin-form-label",children:"Code"}),s.jsxs("div",{style:{display:"flex",gap:8},children:[s.jsx("input",{className:"admin-input",value:Z.code,onChange:V=>se(ie=>({...ie,code:V.target.value.toUpperCase()})),placeholder:"SUMMER2026"}),s.jsx("button",{className:"admin-btn",onClick:oe,title:"Auto-generate",children:""})]})]}),s.jsxs("div",{className:"admin-form-group",children:[s.jsx("label",{className:"admin-form-label",children:"Type"}),s.jsxs("select",{className:"admin-input",value:Z.type,onChange:V=>se(ie=>({...ie,type:V.target.value})),children:[s.jsx("option",{value:"percentage",children:"Percentage (%)"}),s.jsx("option",{value:"fixed",children:"Fixed ($)"})]})]}),s.jsxs("div",{className:"admin-form-group",children:[s.jsx("label",{className:"admin-form-label",children:"Value"}),s.jsx("input",{className:"admin-input",type:"number",value:Z.value,onChange:V=>se(ie=>({...ie,value:V.target.value})),placeholder:Z.type==="percentage"?"20":"5.00"})]}),s.jsxs("div",{className:"admin-form-group",children:[s.jsx("label",{className:"admin-form-label",children:"Max Uses"}),s.jsx("input",{className:"admin-input",type:"number",value:Z.maxUses,onChange:V=>se(ie=>({...ie,maxUses:V.target.value}))})]}),s.jsxs("div",{className:"admin-form-group",children:[s.jsx("label",{className:"admin-form-label",children:"Expires"}),s.jsx("input",{className:"admin-input",type:"date",value:Z.expiresAt,onChange:V=>se(ie=>({...ie,expiresAt:V.target.value}))})]}),s.jsx("div",{className:"admin-form-group",style:{alignSelf:"flex-end"},children:s.jsx("button",{className:"admin-btn primary",onClick:Le,disabled:U,children:U?"":"Create"})})]}),s.jsx(Ce,{scope:Z.courseScope,selectedCourses:Z.selectedCourses,onScopeChange:V=>se(ie=>({...ie,courseScope:V,selectedCourses:V==="global"?[]:ie.selectedCourses})),onToggleCourse:V=>Se(se,Z.selectedCourses,V)})]}):s.jsxs("div",{children:[s.jsxs("div",{className:"admin-form-row",children:[s.jsxs("div",{className:"admin-form-group",children:[s.jsx("label",{className:"admin-form-label",children:"Prefix"}),s.jsx("input",{className:"admin-input",value:w.prefix,onChange:V=>C(ie=>({...ie,prefix:V.target.value.toUpperCase()})),placeholder:"SUMMER"})]}),s.jsxs("div",{className:"admin-form-group",children:[s.jsx("label",{className:"admin-form-label",children:"Count"}),s.jsx("input",{className:"admin-input",type:"number",value:w.count,onChange:V=>C(ie=>({...ie,count:V.target.value}))})]}),s.jsxs("div",{className:"admin-form-group",children:[s.jsx("label",{className:"admin-form-label",children:"Type"}),s.jsxs("select",{className:"admin-input",value:w.type,onChange:V=>C(ie=>({...ie,type:V.target.value})),children:[s.jsx("option",{value:"percentage",children:"Percentage (%)"}),s.jsx("option",{value:"fixed",children:"Fixed ($)"})]})]}),s.jsxs("div",{className:"admin-form-group",children:[s.jsx("label",{className:"admin-form-label",children:"Value"}),s.jsx("input",{className:"admin-input",type:"number",value:w.value,onChange:V=>C(ie=>({...ie,value:V.target.value}))})]}),s.jsxs("div",{className:"admin-form-group",children:[s.jsx("label",{className:"admin-form-label",children:"Expires"}),s.jsx("input",{className:"admin-input",type:"date",value:w.expiresAt,onChange:V=>C(ie=>({...ie,expiresAt:V.target.value}))})]}),s.jsx("div",{className:"admin-form-group",style:{alignSelf:"flex-end"},children:s.jsx("button",{className:"admin-btn primary",onClick:tt,disabled:U,children:U?"":"Generate"})})]}),s.jsx(Ce,{scope:w.courseScope,selectedCourses:w.selectedCourses,onScopeChange:V=>C(ie=>({...ie,courseScope:V,selectedCourses:V==="global"?[]:ie.selectedCourses})),onToggleCourse:V=>Se(C,w.selectedCourses,V)}),ne.length>0&&s.jsx("div",{className:"admin-codes-list",style:{marginTop:12},children:ne.map(V=>s.jsx("span",{className:"admin-coupon-code",style:{cursor:"pointer"},onClick:()=>Ye(V),children:V},V))})]})]}),s.jsx(er,{columns:ct,data:r,total:o,page:p,pageSize:g,onPageChange:c,onPageSizeChange:V=>{h(V),c(1)},onSearch:H,searchPlaceholder:"Search coupons",loading:k,emptyMessage:"No coupons found",emptyIcon:"",filters:[yt],actions:V=>s.jsxs("div",{className:"dg-action-wrap",children:[s.jsx("button",{className:"dg-action-btn",title:"Copy code",onClick:()=>Ye(V.code),style:{fontSize:14},children:""}),s.jsx("button",{className:"dg-action-btn",title:"Edit",onClick:()=>ze(V),style:{fontSize:14},children:""}),s.jsx("button",{className:`dg-action-btn ${V.active?"warning":"success"}`,title:V.active?"Deactivate":"Activate",onClick:()=>gt(V),style:{fontSize:14},children:V.active?"":""}),s.jsx("button",{className:"dg-action-btn danger",title:"Delete",onClick:()=>ot(V),style:{fontSize:14},children:""})]})}),ee&&s.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},onClick:()=>J(null),children:s.jsxs("div",{style:{background:"#1a1a2e",borderRadius:16,padding:32,maxWidth:520,width:"90%",border:"1px solid rgba(139,92,246,0.3)",boxShadow:"0 20px 60px rgba(0,0,0,0.5)"},onClick:V=>V.stopPropagation(),children:[s.jsxs("h3",{style:{color:"#fff",marginTop:0,marginBottom:20},children:[" Edit Coupon: ",ee.code]}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:16},children:[s.jsxs("div",{children:[s.jsx("label",{className:"admin-form-label",children:"Type"}),s.jsxs("select",{className:"admin-input",value:Q.type,onChange:V=>re(ie=>({...ie,type:V.target.value})),children:[s.jsx("option",{value:"percentage",children:"Percentage (%)"}),s.jsx("option",{value:"fixed",children:"Fixed ($)"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"admin-form-label",children:"Value"}),s.jsx("input",{className:"admin-input",type:"number",value:Q.value,onChange:V=>re(ie=>({...ie,value:V.target.value}))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"admin-form-label",children:"Max Uses"}),s.jsx("input",{className:"admin-input",type:"number",value:Q.maxUses,onChange:V=>re(ie=>({...ie,maxUses:V.target.value}))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"admin-form-label",children:"Expires"}),s.jsx("input",{className:"admin-input",type:"date",value:Q.expiresAt,onChange:V=>re(ie=>({...ie,expiresAt:V.target.value}))})]})]}),s.jsx("div",{style:{marginBottom:16},children:s.jsxs("label",{style:{color:"#ccc",display:"flex",alignItems:"center",gap:8,cursor:"pointer"},children:[s.jsx("input",{type:"checkbox",checked:Q.active,onChange:V=>re(ie=>({...ie,active:V.target.checked}))}),"Active"]})}),s.jsx(Ce,{scope:Q.courseScope,selectedCourses:Q.selectedCourses,onScopeChange:V=>re(ie=>({...ie,courseScope:V,selectedCourses:V==="global"?[]:ie.selectedCourses})),onToggleCourse:V=>re(ie=>{const je=ie.selectedCourses.includes(V)?ie.selectedCourses.filter(Ae=>Ae!==V):[...ie.selectedCourses,V];return{...ie,selectedCourses:je}})}),s.jsxs("div",{style:{display:"flex",gap:12,marginTop:24,justifyContent:"flex-end"},children:[s.jsx("button",{className:"admin-btn",onClick:()=>J(null),children:"Cancel"}),s.jsx("button",{className:"admin-btn primary",onClick:me,children:"Save Changes"})]})]})})]})}let Ps=null;Ze(()=>import("./admin.service-BC-t6ThH.js"),__vite__mapDeps([4,1,2,3])).then(r=>{Ps=r}).catch(()=>{});function xy(){const[r,a]=_.useState({demoMode:!1,emailNotifications:!0,maintenanceMode:!1,stripeKey:"",razorpayKey:"",emailjsServiceId:""}),[o,l]=_.useState({current:"",newPw:"",confirm:""}),[p,c]=_.useState(!1),[g,h]=_.useState(""),b=k=>a(S=>({...S,[k]:!S[k]})),m=(k,S)=>a(j=>({...j,[k]:S})),v=k=>{h(k),setTimeout(()=>h(""),3e3)},z=async()=>{try{Ps||(Ps=await Ze(()=>import("./admin.service-BC-t6ThH.js"),__vite__mapDeps([4,1,2,3])));const k=["profiles","children","purchases","progress","coupons"],S={};for(const I of k){const D=await Ps.exportCSV(I);S[I]=D.data||[]}const j=new Blob([JSON.stringify(S,null,2)],{type:"application/json"}),R=document.createElement("a");R.href=URL.createObjectURL(j),R.download=`nextgen-export-${new Date().toISOString().slice(0,10)}.json`,R.click(),v("Data exported successfully")}catch(k){console.error(k)}};return s.jsxs("div",{children:[s.jsxs("div",{className:"admin-page-header",children:[s.jsx("h2",{className:"admin-page-title",children:"Settings"}),s.jsx("p",{className:"admin-page-subtitle",children:"Configure your application preferences"})]}),g&&s.jsxs("div",{className:"admin-alert-banner",style:{background:"rgba(16,185,129,0.1)",border:"1px solid rgba(16,185,129,0.25)",color:"#10b981",marginBottom:16},children:[" ",g]}),s.jsxs("div",{className:"admin-settings-grid-pro",children:[s.jsxs("div",{className:"admin-settings-section-pro glass-card",children:[s.jsxs("div",{className:"admin-settings-section-header",children:[s.jsx("span",{className:"admin-settings-section-icon",children:""}),s.jsx("h3",{children:"General"})]}),s.jsxs("div",{className:"admin-setting-row-pro",children:[s.jsxs("div",{children:[s.jsx("span",{className:"admin-setting-name",children:"Demo Mode"}),s.jsx("span",{className:"admin-setting-desc",children:"Use mock data instead of live database"})]}),s.jsxs("label",{className:"admin-toggle",children:[s.jsx("input",{type:"checkbox",checked:r.demoMode,onChange:()=>b("demoMode")}),s.jsx("span",{className:"admin-toggle-slider"})]})]}),s.jsxs("div",{className:"admin-setting-row-pro",children:[s.jsxs("div",{children:[s.jsx("span",{className:"admin-setting-name",children:"Maintenance Mode"}),s.jsx("span",{className:"admin-setting-desc",children:"Show maintenance page to all users"})]}),s.jsxs("label",{className:"admin-toggle",children:[s.jsx("input",{type:"checkbox",checked:r.maintenanceMode,onChange:()=>b("maintenanceMode")}),s.jsx("span",{className:"admin-toggle-slider"})]})]})]}),s.jsxs("div",{className:"admin-settings-section-pro glass-card",children:[s.jsxs("div",{className:"admin-settings-section-header",children:[s.jsx("span",{className:"admin-settings-section-icon",children:""}),s.jsx("h3",{children:"Payment"})]}),s.jsxs("div",{className:"admin-form-group",children:[s.jsx("label",{className:"admin-form-label",children:"Stripe Secret Key"}),s.jsx("input",{className:"admin-input",type:"password",placeholder:"sk_live_",value:r.stripeKey,onChange:k=>m("stripeKey",k.target.value)})]}),s.jsxs("div",{className:"admin-form-group",children:[s.jsx("label",{className:"admin-form-label",children:"Razorpay Key ID"}),s.jsx("input",{className:"admin-input",type:"password",placeholder:"rzp_live_",value:r.razorpayKey,onChange:k=>m("razorpayKey",k.target.value)})]}),s.jsx("button",{className:"admin-btn primary",style:{marginTop:8},onClick:()=>v("Payment settings saved"),children:"Save Payment Settings"})]}),s.jsxs("div",{className:"admin-settings-section-pro glass-card",children:[s.jsxs("div",{className:"admin-settings-section-header",children:[s.jsx("span",{className:"admin-settings-section-icon",children:""}),s.jsx("h3",{children:"Email"})]}),s.jsxs("div",{className:"admin-setting-row-pro",children:[s.jsxs("div",{children:[s.jsx("span",{className:"admin-setting-name",children:"Email Notifications"}),s.jsx("span",{className:"admin-setting-desc",children:"Send emails on enrollments and payments"})]}),s.jsxs("label",{className:"admin-toggle",children:[s.jsx("input",{type:"checkbox",checked:r.emailNotifications,onChange:()=>b("emailNotifications")}),s.jsx("span",{className:"admin-toggle-slider"})]})]}),s.jsxs("div",{className:"admin-form-group",style:{marginTop:12},children:[s.jsx("label",{className:"admin-form-label",children:"EmailJS Service ID"}),s.jsx("input",{className:"admin-input",placeholder:"service_xxxxxx",value:r.emailjsServiceId,onChange:k=>m("emailjsServiceId",k.target.value)})]}),s.jsx("button",{className:"admin-btn primary",style:{marginTop:8},onClick:()=>v("Email settings saved"),children:"Save Email Settings"})]}),s.jsxs("div",{className:"admin-settings-section-pro glass-card",children:[s.jsxs("div",{className:"admin-settings-section-header",children:[s.jsx("span",{className:"admin-settings-section-icon",children:""}),s.jsx("h3",{children:"Security"})]}),s.jsxs("div",{className:"admin-form-group",children:[s.jsx("label",{className:"admin-form-label",children:"Current Password"}),s.jsx("input",{className:"admin-input",type:"password",value:o.current,onChange:k=>l(S=>({...S,current:k.target.value}))})]}),s.jsxs("div",{className:"admin-form-group",children:[s.jsx("label",{className:"admin-form-label",children:"New Password"}),s.jsx("input",{className:"admin-input",type:"password",value:o.newPw,onChange:k=>l(S=>({...S,newPw:k.target.value}))})]}),s.jsxs("div",{className:"admin-form-group",children:[s.jsx("label",{className:"admin-form-label",children:"Confirm New Password"}),s.jsx("input",{className:"admin-input",type:"password",value:o.confirm,onChange:k=>l(S=>({...S,confirm:k.target.value}))})]}),s.jsx("button",{className:"admin-btn primary",style:{marginTop:8},onClick:()=>{o.newPw===o.confirm&&(l({current:"",newPw:"",confirm:""}),v("Password updated"))},children:"Update Password"})]})]}),s.jsxs("div",{className:"admin-danger-zone glass-card",style:{marginTop:24},children:[s.jsxs("div",{className:"admin-settings-section-header",children:[s.jsx("span",{className:"admin-settings-section-icon",children:""}),s.jsx("h3",{style:{color:"#ef4444"},children:"Danger Zone"})]}),s.jsxs("div",{className:"admin-danger-row",children:[s.jsxs("div",{children:[s.jsx("span",{className:"admin-setting-name",children:"Export All Data"}),s.jsx("span",{className:"admin-setting-desc",children:"Download a JSON dump of all tables"})]}),s.jsx("button",{className:"admin-btn",onClick:z,children:" Export"})]}),s.jsxs("div",{className:"admin-danger-row",children:[s.jsxs("div",{children:[s.jsx("span",{className:"admin-setting-name",children:"Reset All Data"}),s.jsx("span",{className:"admin-setting-desc",children:"Permanently delete all data. This cannot be undone."})]}),s.jsx("button",{className:"admin-btn danger-btn",children:" Reset"})]})]})]})}const yy=["kids","professional","teacher"],vy=["beginner","intermediate","advanced"],wy=["3-5","5-8","8-12","12-16","16+","adult"],ky=["#8b5cf6","#6d28d9","#3b82f6","#06b6d4","#10b981","#f59e0b","#ef4444","#ec4899","#f97316","#14b8a6"],Ec={id:"",title:"",description:"",emoji:"",color:"#8b5cf6",category:"kids",difficulty:"beginner",target_age:"8-12",tags:[],thumbnail_url:"",is_premium:!1,sort_order:0,chapterCount:5};function vf({open:r,onClose:a,course:o,onSave:l,saving:p=!1}){const[c,g]=_.useState(Ec),[h,b]=_.useState(""),[m,v]=_.useState(""),[z,k]=_.useState(""),S=!o?.id;_.useEffect(()=>{o?(g({...Ec,...o,chapterCount:o.chapters?.length||5}),b((o.tags||[]).join(", "))):(g({...Ec,id:"course-"+Date.now()}),b("")),k("")},[o,r]);const j=(E,N)=>g(M=>({...M,[E]:N})),R=()=>{if(!c.title.trim()){k("Title is required");return}if(!c.id.trim()){k("ID is required");return}const E=h.split(",").map(N=>N.trim()).filter(Boolean);l({...c,tags:E},S?c.chapterCount:void 0)},I={width:"100%",padding:"10px 14px",background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)",borderRadius:8,color:"#fff",fontSize:14,outline:"none",boxSizing:"border-box"},D={color:"rgba(255,255,255,0.6)",fontSize:12,fontWeight:600,marginBottom:4,display:"block"},U={display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:12},B={marginBottom:12};return s.jsx(zi,{open:r,onClose:a,title:S?" Create Course":` Edit  ${c.emoji} ${c.title}`,width:"600px",children:s.jsxs("div",{style:{maxHeight:"70vh",overflowY:"auto",padding:"0 4px"},children:[s.jsxs("div",{style:U,children:[s.jsxs("div",{children:[s.jsx("label",{style:D,children:"Course ID"}),s.jsx("input",{style:I,value:c.id,onChange:E=>j("id",E.target.value),disabled:!S,placeholder:"course-my-course"})]}),s.jsxs("div",{children:[s.jsx("label",{style:D,children:"Emoji"}),s.jsx("input",{style:{...I,maxWidth:80,fontSize:24,textAlign:"center"},value:c.emoji,onChange:E=>j("emoji",E.target.value)})]})]}),s.jsxs("div",{style:B,children:[s.jsx("label",{style:D,children:"Title"}),s.jsx("input",{style:I,value:c.title,onChange:E=>j("title",E.target.value),placeholder:"Course title"})]}),s.jsxs("div",{style:B,children:[s.jsx("label",{style:D,children:"Description"}),s.jsx("textarea",{style:{...I,minHeight:80,resize:"vertical"},value:c.description||"",onChange:E=>j("description",E.target.value),placeholder:"Course description"})]}),s.jsxs("div",{style:U,children:[s.jsxs("div",{children:[s.jsx("label",{style:D,children:"Category"}),s.jsx("select",{style:I,value:c.category,onChange:E=>j("category",E.target.value),children:yy.map(E=>s.jsx("option",{value:E,children:E.charAt(0).toUpperCase()+E.slice(1)},E))})]}),s.jsxs("div",{children:[s.jsx("label",{style:D,children:"Difficulty"}),s.jsx("select",{style:I,value:c.difficulty,onChange:E=>j("difficulty",E.target.value),children:vy.map(E=>s.jsx("option",{value:E,children:E.charAt(0).toUpperCase()+E.slice(1)},E))})]})]}),s.jsxs("div",{style:U,children:[s.jsxs("div",{children:[s.jsx("label",{style:D,children:"Target Age"}),s.jsx("select",{style:I,value:c.target_age,onChange:E=>j("target_age",E.target.value),children:wy.map(E=>s.jsx("option",{value:E,children:E},E))})]}),s.jsxs("div",{children:[s.jsx("label",{style:D,children:"Sort Order"}),s.jsx("input",{style:I,type:"number",value:c.sort_order,onChange:E=>j("sort_order",Number(E.target.value))})]})]}),s.jsxs("div",{style:B,children:[s.jsx("label",{style:D,children:"Color"}),s.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[ky.map(E=>s.jsx("button",{onClick:()=>j("color",E),style:{width:32,height:32,borderRadius:8,background:E,border:c.color===E?"3px solid #fff":"2px solid transparent",cursor:"pointer",transition:"all .15s"}},E)),s.jsx("input",{type:"color",value:c.color||"#8b5cf6",onChange:E=>j("color",E.target.value),style:{width:32,height:32,borderRadius:8,border:"none",cursor:"pointer",background:"transparent"}})]})]}),s.jsxs("div",{style:B,children:[s.jsx("label",{style:D,children:"Tags (comma-separated)"}),s.jsx("input",{style:I,value:h,onChange:E=>b(E.target.value),placeholder:"math, science, fun"})]}),s.jsxs("div",{style:B,children:[s.jsx("label",{style:D,children:"Thumbnail URL"}),s.jsx("input",{style:I,value:c.thumbnail_url||"",onChange:E=>j("thumbnail_url",E.target.value),placeholder:"https://..."}),c.thumbnail_url&&s.jsx("img",{src:c.thumbnail_url,alt:"",style:{maxWidth:200,borderRadius:8,marginTop:8},onError:E=>E.target.style.display="none"})]}),s.jsx("div",{style:{display:"flex",gap:16,alignItems:"center",marginBottom:12},children:s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,cursor:"pointer",color:"rgba(255,255,255,0.7)"},children:[s.jsx("input",{type:"checkbox",checked:c.is_premium||!1,onChange:E=>j("is_premium",E.target.checked)})," Premium Course"]})}),S&&s.jsxs("div",{style:B,children:[s.jsx("label",{style:D,children:"Number of Chapters"}),s.jsx("input",{style:{...I,maxWidth:120},type:"number",min:1,max:100,value:c.chapterCount,onChange:E=>j("chapterCount",Number(E.target.value))})]}),z&&s.jsxs("div",{style:{color:"#ef4444",fontSize:13,marginBottom:8},children:[" ",z]}),s.jsxs("div",{style:{display:"flex",gap:8,marginTop:16},children:[s.jsx("button",{onClick:R,disabled:p,style:{background:"linear-gradient(135deg, #8b5cf6, #6d28d9)",color:"#fff",border:"none",borderRadius:8,padding:"10px 24px",cursor:"pointer",fontWeight:600,fontSize:14},children:p?"Saving":S?" Create Course":" Save Changes"}),s.jsx("button",{onClick:a,style:{background:"rgba(255,255,255,0.06)",color:"rgba(255,255,255,0.6)",border:"1px solid rgba(255,255,255,0.1)",borderRadius:8,padding:"10px 24px",cursor:"pointer",fontSize:14},children:"Cancel"})]})]})})}const wf={keyInsight:{label:" Key Insight",html:`<div style="background: linear-gradient(135deg, rgba(139,92,246,0.15), rgba(139,92,246,0.05)); border-left: 4px solid #8b5cf6; border-radius: 12px; padding: 20px; margin: 16px 0;">
  <h4 style="color: #a78bfa; margin: 0 0 8px;"> Key Insight</h4>
  <p style="color: rgba(255,255,255,0.8); margin: 0;">Your insight text here...</p>
</div>`},keyTakeaways:{label:" Key Takeaways",html:`<div style="background: linear-gradient(135deg, rgba(16,185,129,0.15), rgba(16,185,129,0.05)); border-left: 4px solid #10b981; border-radius: 12px; padding: 20px; margin: 16px 0;">
  <h4 style="color: #34d399; margin: 0 0 12px;"> Key Takeaways</h4>
  <ul style="color: rgba(255,255,255,0.8); margin: 0; padding-left: 20px;">
    <li>Takeaway 1</li>
    <li>Takeaway 2</li>
    <li>Takeaway 3</li>
  </ul>
</div>`},quiz:{label:" Quiz",html:`<div class="lesson-quiz" data-type="quiz" style="background: rgba(59,130,246,0.1); border: 1px solid rgba(59,130,246,0.3); border-radius: 12px; padding: 20px; margin: 16px 0;">
  <h4 style="color: #60a5fa; margin: 0 0 12px;"> Quick Quiz</h4>
  <p style="color: rgba(255,255,255,0.8);">Question text here?</p>
  <div class="quiz-options">
    <button class="quiz-option" data-correct="false">A) Option 1</button>
    <button class="quiz-option" data-correct="true">B) Correct Answer</button>
    <button class="quiz-option" data-correct="false">C) Option 3</button>
    <button class="quiz-option" data-correct="false">D) Option 4</button>
  </div>
</div>`},dragDrop:{label:" Drag & Drop",html:`<div class="lesson-activity" data-type="drag-drop" style="background: rgba(245,158,11,0.1); border: 1px solid rgba(245,158,11,0.3); border-radius: 12px; padding: 20px; margin: 16px 0;">
  <h4 style="color: #fbbf24; margin: 0 0 12px;"> Drag & Drop Activity</h4>
  <p style="color: rgba(255,255,255,0.7);">Match the items correctly:</p>
  <div class="drag-items" data-pairs='[{"item":"Item 1","target":"Target 1"},{"item":"Item 2","target":"Target 2"}]'>
    <div class="drag-item" draggable="true">Item 1</div>
    <div class="drag-item" draggable="true">Item 2</div>
  </div>
  <div class="drop-targets">
    <div class="drop-target" data-accept="Item 1">Target 1</div>
    <div class="drop-target" data-accept="Item 2">Target 2</div>
  </div>
</div>`}},Sy=[{label:"B",title:"Bold",insert:(r,a,o)=>Os(r,a,o,"<strong>","</strong>")},{label:"H",title:"Heading",insert:(r,a,o)=>Os(r,a,o,"<h3>","</h3>")},{label:"",title:"List",insert:(r,a,o)=>Os(r,a,o,`<ul>
  <li>`,`</li>
</ul>`)},{label:"<>",title:"Code Block",insert:(r,a,o)=>Os(r,a,o,"<pre><code>","</code></pre>")},{label:"",title:"Image",insert:(r,a,o)=>zy(r,a,'<img src="" alt="" style="max-width:100%;border-radius:12px;" />')}];function Os(r,a,o,l,p){const c=r.slice(a,o)||"text";return r.slice(0,a)+l+c+p+r.slice(o)}function zy(r,a,o){return r.slice(0,a)+o+r.slice(a)}function jy({content:r="",onChange:a,onSave:o,saving:l=!1,autoSaveMs:p=3e4}){const[c,g]=_.useState(r),[h,b]=_.useState("split"),[m,v]=_.useState(null),[z,k]=_.useState(!1),S=_.useRef(null),j=_.useRef(null);_.useEffect(()=>{g(r),k(!1)},[r]),_.useEffect(()=>{if(!(!z||!p))return j.current=setTimeout(()=>{o&&(o(c),v(new Date),k(!1))},p),()=>clearTimeout(j.current)},[c,z]);const R=_.useCallback(N=>{g(N),k(!0),a&&a(N)},[a]),I=N=>{const M=S.current;if(!M)return;const y=M.selectionStart,O=M.selectionEnd,$=N.insert(c,y,O);R($)},D=N=>{const M=S.current,y=M?M.selectionStart:c.length,O=wf[N].html;R(c.slice(0,y)+`
`+O+`
`+c.slice(y))},U=()=>{o&&(o(c),v(new Date),k(!1))},B=c.replace(/<[^>]*>/g," ").split(/\s+/).filter(Boolean).length,E=c.length;return s.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%",gap:0},children:[s.jsxs("div",{style:ka.toolbar,children:[s.jsxs("div",{style:{display:"flex",gap:4,flexWrap:"wrap",flex:1},children:[Sy.map(N=>s.jsx("button",{onClick:()=>I(N),title:N.title,style:ka.toolBtn,children:N.label},N.title)),s.jsx("span",{style:ka.divider}),Object.entries(wf).map(([N,M])=>s.jsx("button",{onClick:()=>D(N),title:M.label,style:ka.tplBtn,children:M.label},N))]}),s.jsx("div",{style:{display:"flex",gap:4,alignItems:"center"},children:["edit","split","preview"].map(N=>s.jsx("button",{onClick:()=>b(N),style:{...ka.modeBtn,...h===N?ka.modeBtnActive:{}},children:N==="edit"?"":N==="preview"?"":""},N))})]}),s.jsxs("div",{style:{display:"flex",flex:1,minHeight:400,gap:0},children:[(h==="edit"||h==="split")&&s.jsx("textarea",{ref:S,value:c,onChange:N=>R(N.target.value),style:{...ka.editor,width:h==="split"?"50%":"100%"},spellCheck:!1}),(h==="preview"||h==="split")&&s.jsx("div",{style:{...ka.preview,width:h==="split"?"50%":"100%"},dangerouslySetInnerHTML:{__html:c}})]}),s.jsxs("div",{style:ka.footer,children:[s.jsxs("span",{style:{color:"rgba(255,255,255,0.4)",fontSize:12},children:[B," words  ",E.toLocaleString()," chars"]}),s.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[z&&s.jsx("span",{style:{color:"#f59e0b",fontSize:12},children:" Unsaved"}),m&&!z&&s.jsxs("span",{style:{color:"#10b981",fontSize:12},children:[" Saved ",m.toLocaleTimeString()]}),s.jsx("button",{onClick:U,disabled:l||!z,style:ka.saveBtn,children:l?"Saving":" Save"})]})]})]})}const ka={toolbar:{display:"flex",alignItems:"center",gap:8,padding:"8px 12px",background:"rgba(255,255,255,0.03)",borderBottom:"1px solid rgba(255,255,255,0.08)",flexWrap:"wrap"},toolBtn:{background:"rgba(255,255,255,0.06)",border:"1px solid rgba(255,255,255,0.1)",color:"#fff",borderRadius:6,padding:"4px 10px",cursor:"pointer",fontSize:13,fontWeight:600,fontFamily:"monospace"},tplBtn:{background:"rgba(139,92,246,0.1)",border:"1px solid rgba(139,92,246,0.2)",color:"#c4b5fd",borderRadius:6,padding:"4px 10px",cursor:"pointer",fontSize:12,whiteSpace:"nowrap"},divider:{width:1,height:24,background:"rgba(255,255,255,0.1)",margin:"0 4px"},modeBtn:{background:"transparent",border:"1px solid rgba(255,255,255,0.1)",color:"rgba(255,255,255,0.5)",borderRadius:6,padding:"4px 8px",cursor:"pointer",fontSize:14},modeBtnActive:{background:"rgba(139,92,246,0.2)",borderColor:"#8b5cf6",color:"#c4b5fd"},editor:{background:"#0a0a12",color:"#e2e8f0",fontFamily:"JetBrains Mono, Fira Code, monospace",fontSize:13,lineHeight:1.6,padding:16,border:"none",resize:"none",outline:"none",flex:1,minHeight:400},preview:{background:"#050508",color:"rgba(255,255,255,0.85)",padding:24,overflowY:"auto",fontSize:15,lineHeight:1.7,borderLeft:"1px solid rgba(255,255,255,0.06)"},footer:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 12px",background:"rgba(255,255,255,0.02)",borderTop:"1px solid rgba(255,255,255,0.06)"},saveBtn:{background:"linear-gradient(135deg, #8b5cf6, #6d28d9)",color:"#fff",border:"none",borderRadius:8,padding:"6px 16px",cursor:"pointer",fontSize:13,fontWeight:600}},ea=()=>{if(!Zi)throw new Error("supabaseAdmin not configured");return Zi};async function _y(r,a){const{data:o,error:l}=await ea().from("lesson_content").select("*").eq("course_id",r).eq("chapter_idx",a).maybeSingle();if(l)throw l;return o}async function Gs(r){const{data:a,error:o}=await ea().from("lesson_content").select("*").eq("course_id",r).order("chapter_idx");if(o)throw o;return a||[]}async function Fs(r,a,o){const l={course_id:r,chapter_idx:a,...o,updated_at:new Date().toISOString()},{data:p,error:c}=await ea().from("lesson_content").upsert(l,{onConflict:"course_id,chapter_idx"}).select().single();if(c)throw c;return p}async function Ay({page:r=1,pageSize:a=25,search:o="",sortKey:l="title",sortDir:p="asc"}={}){let c=ea().from("courses").select("*",{count:"exact"});o&&(c=c.or(`title.ilike.%${o}%,category.ilike.%${o}%`)),c=c.order(l,{ascending:p==="asc"}),c=c.range((r-1)*a,r*a-1);const{data:g,error:h,count:b}=await c;if(h)throw h;return{data:g||[],total:b||0}}async function Ey(r){const{data:a,error:o}=await ea().from("courses").select("*").eq("id",r).single();if(o)throw o;return a}async function Gc(r){const{data:a,error:o}=await ea().from("courses").upsert(r,{onConflict:"id"}).select().single();if(o)throw o;return a}async function Cy(r){await ea().from("lesson_content").delete().eq("course_id",r);const{error:a}=await ea().from("courses").delete().eq("id",r);if(a)throw a}async function Ds(r,a){const{error:o}=await ea().from("courses").update({chapters:a}).eq("id",r);if(o)throw o}async function ib(r){const a=await Ey(r),o=await Gs(r);return{course:a,lessons:o}}async function Ty(r){const{course:a,lessons:o}=r;if(!a?.id)throw new Error("Invalid course data: missing id");if(await Gc(a),o?.length)for(const l of o)await Fs(l.course_id||a.id,l.chapter_idx,l);return a}async function Ny(r,a,o){const{course:l,lessons:p}=await ib(r),c={...l,id:a,title:o,created_at:new Date().toISOString()};await Gc(c);for(const g of p){const{id:h,...b}=g;await Fs(a,g.chapter_idx,b)}return c}async function Ry(){const{count:r}=await ea().from("courses").select("*",{count:"exact",head:!0}),{count:a}=await ea().from("lesson_content").select("*",{count:"exact",head:!0}),{data:o}=await ea().from("lesson_content").select("course_id").not("content_html","is",null),l=new Set((o||[]).map(c=>c.course_id)),{count:p}=await ea().from("lesson_content").select("*",{count:"exact",head:!0}).or("content_html.is.null,content_html.eq.");return{totalCourses:r||0,totalLessons:a||0,coursesWithContent:l.size,emptyLessons:p||0}}function Bs({icon:r,label:a,value:o,color:l="#8b5cf6"}){return s.jsxs("div",{style:{background:"rgba(255,255,255,0.03)",backdropFilter:"blur(20px)",border:"1px solid rgba(255,255,255,0.08)",borderRadius:16,padding:"20px 24px",flex:"1 1 180px",minWidth:160},children:[s.jsx("div",{style:{fontSize:28,marginBottom:4},children:r}),s.jsx("div",{style:{fontSize:28,fontWeight:700,color:l,fontFamily:"JetBrains Mono, monospace"},children:o}),s.jsx("div",{style:{color:"rgba(255,255,255,0.4)",fontSize:12,marginTop:4},children:a})]})}function My(){const[r,a]=_.useState("list"),[o,l]=_.useState(null),[p,c]=_.useState([]),[g,h]=_.useState(0),[b,m]=_.useState(1),[v,z]=_.useState(25),[k,S]=_.useState(""),[j,R]=_.useState("title"),[I,D]=_.useState("asc"),[U,B]=_.useState(!0),[E,N]=_.useState(null),[M,y]=_.useState({open:!1,course:null}),[O,$]=_.useState({open:!1,courseId:null,chapterIdx:null,chapter:null}),[ee,J]=_.useState(!1),[Q,re]=_.useState(null),[Z,se]=_.useState(null),[w,C]=_.useState({id:"",title:""}),ne=_.useRef(null),F=_.useCallback(async()=>{B(!0);try{const W=await Ay({page:b,pageSize:v,search:k,sortKey:j,sortDir:I});c(W.data),h(W.total)}catch(W){re(W.message)}finally{B(!1)}},[b,v,k,j,I]),q=_.useCallback(async()=>{try{const W=await Ry();N(W)}catch{}},[]);_.useEffect(()=>{F()},[F]),_.useEffect(()=>{q()},[]);const[H,oe]=_.useState([]),[de,Se]=_.useState([]),[Le,tt]=_.useState(!1),[Ye,gt]=_.useState(null),[ot,ze]=_.useState(!1),me=_.useCallback(async W=>{l(W),a("editor"),tt(!0);try{const he=W.chapters||[];oe(he);const qe=await Gs(W.id);Se(qe)}catch(he){re(he.message)}finally{tt(!1)}},[]),Te=async(W,he)=>{J(!0);try{he&&(W.chapters=Array.from({length:he},(qe,at)=>({title:`Chapter ${at+1}`,emoji:"",duration:null}))),await Gc(W),y({open:!1,course:null}),F(),q(),o?.id===W.id&&me({...o,...W})}catch(qe){re(qe.message)}finally{J(!1)}},Ce=async W=>{if(confirm("Delete this course and all its content? This cannot be undone."))try{await Cy(W),o?.id===W&&(a("list"),l(null)),F(),q()}catch(he){re(he.message)}},ct=async()=>{const W=[...H,{title:`Chapter ${H.length+1}`,emoji:"",duration:null}];oe(W),await Ds(o.id,W)},yt=async(W,he,qe)=>{const at=[...H];at[W]={...at[W],[he]:qe},oe(at),await Ds(o.id,at)},V=async(W,he)=>{$({open:!0,courseId:o.id,chapterIdx:W,chapter:he}),ze(!0);try{const qe=await _y(o.id,W);gt(qe||{content_html:"",has_interactive:!1,has_audio:!1,has_threejs:!1,has_karaoke:!1,infographic_url:"",audio_url:"",duration_min:0})}catch{gt({content_html:""})}finally{ze(!1)}},ie=async W=>{if(O.courseId){J(!0);try{await Fs(O.courseId,O.chapterIdx,{...Ye,content_html:W});const he=await Gs(o.id);Se(he)}catch(he){re(he.message)}finally{J(!1)}}},je=async(W,he)=>{const qe={...Ye,[W]:he};gt(qe)},Ae=async()=>{J(!0);try{await Fs(O.courseId,O.chapterIdx,Ye);const W=await Gs(o.id);Se(W)}catch(W){re(W.message)}finally{J(!1)}},le=async W=>{try{const he=await ib(W),qe=new Blob([JSON.stringify(he,null,2)],{type:"application/json"}),at=document.createElement("a");at.href=URL.createObjectURL(qe),at.download=`${W}-export.json`,at.click()}catch(he){re(he.message)}},ue=async W=>{const he=W.target.files?.[0];if(he){try{const qe=await he.text(),at=JSON.parse(qe);await Ty(at),F(),q(),alert("Course imported successfully!")}catch(qe){re("Import failed: "+qe.message)}W.target.value=""}},pe=async()=>{if(!(!w.id||!w.title)){J(!0);try{await Ny(Z.id,w.id,w.title),se(null),F(),q()}catch(W){re(W.message)}finally{J(!1)}}},Ue=[{key:"title",label:"Course",sortable:!0,width:"280px",render:(W,he)=>s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[s.jsx("span",{style:{fontSize:20},children:he.emoji||""}),s.jsxs("div",{children:[s.jsx("div",{style:{color:"#fff",fontWeight:600,fontSize:14},children:he.title}),s.jsx("div",{style:{color:"rgba(255,255,255,0.3)",fontSize:11,fontFamily:"monospace"},children:he.id})]})]})},{key:"category",label:"Category",sortable:!0,render:W=>s.jsx(ja,{status:W||"none"})},{key:"chapters",label:"Chapters",width:"90px",render:W=>s.jsx("span",{className:"dg-mono-text",children:Array.isArray(W)?W.length:0})},{key:"is_premium",label:"Premium",width:"80px",render:W=>W?s.jsx("span",{style:{color:"#f59e0b"},children:""}):s.jsx("span",{style:{color:"rgba(255,255,255,0.2)"},children:""})},{key:"sort_order",label:"Order",sortable:!0,width:"70px",render:W=>s.jsx("span",{className:"dg-mono-text",children:W??0})}],ye=[{key:"idx",label:"#",width:"50px",render:(W,he,qe)=>s.jsx("span",{className:"dg-mono-text",children:qe+1})},{key:"title",label:"Title",render:(W,he,qe)=>s.jsx("input",{value:W||"",onChange:at=>yt(qe,"title",at.target.value),onBlur:()=>Ds(o.id,H),style:{background:"transparent",border:"none",color:"#fff",fontSize:14,width:"100%",outline:"none"}})},{key:"emoji",label:"Emoji",width:"60px",render:(W,he,qe)=>s.jsx("input",{value:W||"",onChange:at=>yt(qe,"emoji",at.target.value),onBlur:()=>Ds(o.id,H),style:{background:"transparent",border:"none",color:"#fff",fontSize:18,width:40,textAlign:"center",outline:"none"}})},{key:"hasContent",label:"Content",width:"80px",render:(W,he,qe)=>de.some(Xr=>Xr.chapter_idx===qe&&Xr.content_html)?s.jsx("span",{style:{color:"#10b981"},children:""}):s.jsx("span",{style:{color:"rgba(255,255,255,0.2)"},children:""})}];return _.useEffect(()=>{if(Q){const W=setTimeout(()=>re(null),5e3);return()=>clearTimeout(W)}},[Q]),r==="editor"&&o?s.jsxs("div",{children:[Q&&s.jsxs("div",{style:Mt.errorToast,children:[" ",Q]}),s.jsxs("div",{className:"admin-page-header",style:{display:"flex",alignItems:"center",gap:12,marginBottom:24},children:[s.jsx("button",{onClick:()=>{a("list"),l(null)},style:Mt.backBtn,children:" Back"}),s.jsx("span",{style:{fontSize:32},children:o.emoji||""}),s.jsxs("div",{children:[s.jsx("h2",{className:"admin-page-title",style:{margin:0},children:o.title}),s.jsxs("p",{className:"admin-page-subtitle",style:{margin:0},children:["Course Editor  ",H.length," chapters"]})]}),s.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:8},children:[s.jsx("button",{onClick:()=>y({open:!0,course:o}),style:Mt.actionBtn,children:" Edit Info"}),s.jsx("button",{onClick:()=>le(o.id),style:Mt.actionBtn,children:" Export"}),s.jsx("button",{onClick:()=>{se(o),C({id:o.id+"-copy",title:o.title+" (Copy)"})},style:Mt.actionBtn,children:" Duplicate"}),s.jsx("button",{onClick:()=>Ce(o.id),style:{...Mt.actionBtn,borderColor:"rgba(239,68,68,0.3)",color:"#ef4444"},children:" Delete"})]})]}),s.jsx("div",{className:"glass-card",style:{padding:0,borderRadius:16,overflow:"hidden"},children:s.jsx(er,{title:" Chapters",columns:ye,data:H.map((W,he)=>({...W,id:he,idx:he})),total:H.length,page:1,pageSize:100,loading:Le,onRowClick:W=>V(W.idx,W),emptyMessage:"No chapters yet",emptyIcon:"",headerExtra:s.jsx("button",{onClick:ct,style:Mt.primaryBtn,children:"+ Add Chapter"}),actions:W=>s.jsx("div",{style:{display:"flex",gap:4},children:s.jsx(Si,{icon:"",title:"Edit Content",onClick:()=>V(W.idx,W)})})})}),O.open&&s.jsx("div",{className:"admin-modal-overlay",onClick:()=>$({open:!1}),children:s.jsxs("div",{className:"admin-modal glass-card",style:{maxWidth:"95vw",width:1200,maxHeight:"92vh",display:"flex",flexDirection:"column"},onClick:W=>W.stopPropagation(),children:[s.jsxs("div",{className:"admin-modal-header",children:[s.jsxs("h3",{style:{margin:0,fontSize:16,color:"#fff"},children:[O.chapter?.emoji||""," Chapter ",O.chapterIdx+1,": ",O.chapter?.title||"Untitled"]}),s.jsx("button",{className:"admin-modal-close",onClick:()=>$({open:!1}),children:""})]}),ot?s.jsx("div",{style:{padding:40,textAlign:"center",color:"rgba(255,255,255,0.3)"},children:"Loading"}):s.jsxs("div",{style:{display:"flex",flexDirection:"column",flex:1,overflow:"hidden"},children:[s.jsxs("div",{style:{display:"flex",gap:16,padding:"12px 16px",background:"rgba(255,255,255,0.02)",borderBottom:"1px solid rgba(255,255,255,0.06)",flexWrap:"wrap",alignItems:"center"},children:[s.jsxs("label",{style:Mt.toggle,children:[s.jsx("input",{type:"checkbox",checked:Ye?.has_interactive||!1,onChange:W=>je("has_interactive",W.target.checked)}),"  Interactive"]}),s.jsxs("label",{style:Mt.toggle,children:[s.jsx("input",{type:"checkbox",checked:Ye?.has_audio||!1,onChange:W=>je("has_audio",W.target.checked)}),"  Audio"]}),s.jsxs("label",{style:Mt.toggle,children:[s.jsx("input",{type:"checkbox",checked:Ye?.has_threejs||!1,onChange:W=>je("has_threejs",W.target.checked)}),"  3D/ThreeJS"]}),s.jsxs("label",{style:Mt.toggle,children:[s.jsx("input",{type:"checkbox",checked:Ye?.has_karaoke||!1,onChange:W=>je("has_karaoke",W.target.checked)}),"  Karaoke"]}),s.jsx("span",{style:{width:1,height:24,background:"rgba(255,255,255,0.1)"}}),s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[s.jsx("span",{style:{color:"rgba(255,255,255,0.4)",fontSize:12},children:""}),s.jsx("input",{type:"number",value:Ye?.duration_min||0,onChange:W=>je("duration_min",Number(W.target.value)),style:{width:60,padding:"4px 8px",background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)",borderRadius:6,color:"#fff",fontSize:13}}),s.jsx("span",{style:{color:"rgba(255,255,255,0.3)",fontSize:12},children:"min"})]}),s.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:8},children:[s.jsx("button",{onClick:Ae,disabled:ee,style:Mt.primaryBtn,children:ee?"Saving":" Save All"}),s.jsx("button",{style:{...Mt.actionBtn,opacity:.5,cursor:"not-allowed"},disabled:!0,title:"Coming soon",children:" Generate with AI"})]})]}),s.jsxs("div",{style:{display:"flex",gap:12,padding:"8px 16px",background:"rgba(255,255,255,0.01)",borderBottom:"1px solid rgba(255,255,255,0.04)",flexWrap:"wrap"},children:[s.jsxs("div",{style:{flex:1,minWidth:200},children:[s.jsx("label",{style:{color:"rgba(255,255,255,0.4)",fontSize:11},children:"Infographic URL"}),s.jsx("input",{value:Ye?.infographic_url||"",onChange:W=>je("infographic_url",W.target.value),style:{width:"100%",padding:"6px 10px",background:"rgba(255,255,255,0.04)",border:"1px solid rgba(255,255,255,0.08)",borderRadius:6,color:"#fff",fontSize:13,boxSizing:"border-box"},placeholder:"https://..."})]}),s.jsxs("div",{style:{flex:1,minWidth:200},children:[s.jsx("label",{style:{color:"rgba(255,255,255,0.4)",fontSize:11},children:"Audio URL"}),s.jsxs("div",{style:{display:"flex",gap:6},children:[s.jsx("input",{value:Ye?.audio_url||"",onChange:W=>je("audio_url",W.target.value),style:{flex:1,padding:"6px 10px",background:"rgba(255,255,255,0.04)",border:"1px solid rgba(255,255,255,0.08)",borderRadius:6,color:"#fff",fontSize:13},placeholder:"https://..."}),Ye?.audio_url&&s.jsx("button",{onClick:()=>{new Audio(Ye.audio_url).play()},style:{background:"rgba(139,92,246,0.15)",border:"1px solid rgba(139,92,246,0.3)",borderRadius:6,color:"#c4b5fd",cursor:"pointer",padding:"4px 10px"},children:""})]})]})]}),s.jsx("div",{style:{flex:1,overflow:"hidden"},children:s.jsx(jy,{content:Ye?.content_html||"",onChange:W=>gt(he=>({...he,content_html:W})),onSave:ie,saving:ee})})]})]})}),s.jsx(vf,{open:M.open,onClose:()=>y({open:!1,course:null}),course:M.course,onSave:Te,saving:ee}),s.jsxs(zi,{open:!!Z,onClose:()=>se(null),title:" Duplicate Course",children:[s.jsxs("div",{style:{marginBottom:12},children:[s.jsx("label",{style:{color:"rgba(255,255,255,0.6)",fontSize:12,display:"block",marginBottom:4},children:"New Course ID"}),s.jsx("input",{className:"admin-input",value:w.id,onChange:W=>C(he=>({...he,id:W.target.value}))})]}),s.jsxs("div",{style:{marginBottom:16},children:[s.jsx("label",{style:{color:"rgba(255,255,255,0.6)",fontSize:12,display:"block",marginBottom:4},children:"New Title"}),s.jsx("input",{className:"admin-input",value:w.title,onChange:W=>C(he=>({...he,title:W.target.value}))})]}),s.jsxs("div",{style:{display:"flex",gap:8},children:[s.jsx("button",{className:"admin-btn primary",onClick:pe,disabled:ee,children:ee?"Duplicating":"Duplicate"}),s.jsx("button",{className:"admin-btn",onClick:()=>se(null),children:"Cancel"})]})]})]}):s.jsxs("div",{children:[Q&&s.jsxs("div",{style:Mt.errorToast,children:[" ",Q]}),s.jsxs("div",{className:"admin-page-header",children:[s.jsx("h2",{className:"admin-page-title",children:" Content Manager"}),s.jsx("p",{className:"admin-page-subtitle",children:"Manage course content, lessons, and media"})]}),E&&s.jsxs("div",{style:{display:"flex",gap:12,marginBottom:24,flexWrap:"wrap"},children:[s.jsx(Bs,{icon:"",label:"Total Courses",value:E.totalCourses}),s.jsx(Bs,{icon:"",label:"Total Lessons",value:E.totalLessons,color:"#06b6d4"}),s.jsx(Bs,{icon:"",label:"Courses with Content",value:E.coursesWithContent,color:"#10b981"}),s.jsx(Bs,{icon:"",label:"Empty Lessons",value:E.emptyLessons,color:"#f59e0b"})]}),s.jsx("div",{className:"glass-card",style:{padding:0,borderRadius:16,overflow:"hidden"},children:s.jsx(er,{columns:Ue,data:p,total:g,page:b,pageSize:v,onPageChange:m,onPageSizeChange:z,onSort:(W,he)=>{R(W),D(he)},sortKey:j,sortDir:I,searchValue:k,onSearch:W=>{S(W),m(1)},searchPlaceholder:"Search courses",loading:U,onRowClick:W=>me(W),emptyMessage:"No courses found",emptyIcon:"",headerExtra:s.jsxs("div",{style:{display:"flex",gap:8},children:[s.jsx("button",{onClick:()=>y({open:!0,course:null}),style:Mt.primaryBtn,children:"+ Create Course"}),s.jsx("button",{onClick:()=>ne.current?.click(),style:Mt.actionBtn,children:" Import JSON"}),s.jsx("input",{ref:ne,type:"file",accept:".json",onChange:ue,style:{display:"none"}})]}),actions:W=>s.jsxs("div",{style:{display:"flex",gap:4},children:[s.jsx(Si,{icon:"",title:"Edit",onClick:()=>me(W)}),s.jsx(Si,{icon:"",title:"Export",onClick:()=>le(W.id)}),s.jsx(Si,{icon:"",title:"Duplicate",onClick:()=>{se(W),C({id:W.id+"-copy",title:W.title+" (Copy)"})}}),s.jsx(Si,{icon:"",title:"Delete",variant:"danger",onClick:()=>Ce(W.id)})]})})}),s.jsx(vf,{open:M.open,onClose:()=>y({open:!1,course:null}),course:M.course,onSave:Te,saving:ee}),s.jsxs(zi,{open:!!Z,onClose:()=>se(null),title:" Duplicate Course",children:[s.jsxs("div",{style:{marginBottom:12},children:[s.jsx("label",{style:{color:"rgba(255,255,255,0.6)",fontSize:12,display:"block",marginBottom:4},children:"New Course ID"}),s.jsx("input",{className:"admin-input",value:w.id,onChange:W=>C(he=>({...he,id:W.target.value}))})]}),s.jsxs("div",{style:{marginBottom:16},children:[s.jsx("label",{style:{color:"rgba(255,255,255,0.6)",fontSize:12,display:"block",marginBottom:4},children:"New Title"}),s.jsx("input",{className:"admin-input",value:w.title,onChange:W=>C(he=>({...he,title:W.target.value}))})]}),s.jsxs("div",{style:{display:"flex",gap:8},children:[s.jsx("button",{className:"admin-btn primary",onClick:pe,disabled:ee,children:ee?"Duplicating":"Duplicate"}),s.jsx("button",{className:"admin-btn",onClick:()=>se(null),children:"Cancel"})]})]})]})}const Mt={primaryBtn:{background:"linear-gradient(135deg, #8b5cf6, #6d28d9)",color:"#fff",border:"none",borderRadius:8,padding:"8px 16px",cursor:"pointer",fontWeight:600,fontSize:13,whiteSpace:"nowrap"},actionBtn:{background:"rgba(255,255,255,0.05)",color:"rgba(255,255,255,0.7)",border:"1px solid rgba(255,255,255,0.1)",borderRadius:8,padding:"8px 14px",cursor:"pointer",fontSize:13,whiteSpace:"nowrap"},backBtn:{background:"rgba(255,255,255,0.05)",color:"rgba(255,255,255,0.6)",border:"1px solid rgba(255,255,255,0.1)",borderRadius:8,padding:"8px 16px",cursor:"pointer",fontSize:14},toggle:{display:"flex",alignItems:"center",gap:6,color:"rgba(255,255,255,0.6)",fontSize:13,cursor:"pointer",whiteSpace:"nowrap"},errorToast:{position:"fixed",top:20,right:20,background:"rgba(239,68,68,0.15)",border:"1px solid rgba(239,68,68,0.3)",color:"#ef4444",padding:"12px 20px",borderRadius:12,fontSize:14,zIndex:9999,backdropFilter:"blur(20px)"}};function Oy(){try{const r=h=>{try{return JSON.parse(localStorage.getItem("ngs_db_"+h)||"null")}catch{return null}},a=r("users")||[],o=r("children")||[],l=r("purchases")||[];let p=`Type,Name,Email,Children,Plan,Amount,Status,Date
`;a.forEach(h=>{const b=o.filter(v=>v.parentId===h.id).map(v=>v.name).join("; "),m=l.filter(v=>v.userId===h.id);m.length?m.forEach(v=>{p+=`Parent,"${h.name}","${h.email}","${b}",${v.plan},$${v.amount},${v.status},${v.date?.split("T")[0]||""}
`}):p+=`Parent,"${h.name}","${h.email}","${b}",,,,${h.createdAt?.split("T")[0]||""}
`});const c=new Blob([p],{type:"text/csv"}),g=document.createElement("a");g.href=URL.createObjectURL(c),g.download=`nextgen-school-export-${new Date().toISOString().split("T")[0]}.csv`,g.click()}catch(r){console.error("CSV export failed:",r),alert("Export failed. Check console for details.")}}const Cc=[{id:"dashboard",label:" Dashboard",component:ab},{id:"enrollments",label:" Enrollments",component:dy},{id:"payments",label:" Payments",component:cy},{id:"analytics",label:" Analytics",component:gy},{id:"courses",label:" Courses",component:hy},{id:"users",label:" Users",component:fy},{id:"students",label:" Students",component:by},{id:"coupons",label:" Coupons",component:my},{id:"content",label:" Content",component:My},{id:"settings",label:" Settings",component:xy}];function Dy({onBack:r}){const{isLoggedIn:a,isAdmin:o,openAuthModal:l,currentUser:p}=ji(),[c,g]=_.useState(!1),[h,b]=_.useState(""),[m,v]=_.useState("dashboard"),[z,k]=_.useState(!1),[S,j]=_.useState(!1),R=_.useCallback(E=>{v(E),j(!1)},[]),I=()=>{h==="admin123"?(g(!0),k(!1)):k(!0)},D=E=>{E.key==="Enter"&&I()},U=()=>{r?r():window.location.hash="#home"},B=Cc.find(E=>E.id===m)?.component||ab;return s.jsx("div",{id:"admin-panel",style:{display:"block"},children:c?s.jsxs("div",{id:"admin-content",className:"admin-layout",children:[s.jsxs("div",{className:"admin-mobile-bar",children:[s.jsx("button",{className:"admin-hamburger",onClick:()=>j(!S),children:s.jsxs("span",{className:`hamburger-icon${S?" open":""}`,children:[s.jsx("span",{}),s.jsx("span",{}),s.jsx("span",{})]})}),s.jsx("div",{className:"admin-mobile-title",children:Cc.find(E=>E.id===m)?.label||" Dashboard"}),s.jsx("button",{className:"admin-back-btn",onClick:U,children:""})]}),S&&s.jsx("div",{className:"admin-overlay",onClick:()=>j(!1)}),s.jsxs("aside",{className:`admin-sidebar${S?" open":""}`,children:[s.jsxs("div",{className:"admin-sidebar-header",children:[s.jsx("button",{className:"admin-back-btn",onClick:U,children:""}),s.jsx("div",{className:"admin-sidebar-title",children:" Admin"})]}),Cc.map(E=>s.jsx("button",{className:`admin-sidebar-item${m===E.id?" active":""}`,onClick:()=>R(E.id),children:E.label},E.id)),s.jsx("div",{className:"admin-sidebar-footer",children:s.jsx("button",{className:"admin-sidebar-item",onClick:()=>{Oy(),j(!1)},children:" Export CSV"})})]}),s.jsx("div",{id:"admin-tab-content",className:"admin-main",children:s.jsx(B,{})})]}):s.jsxs("div",{className:"container",children:[s.jsxs("div",{className:"admin-header",children:[s.jsx("button",{className:"btn btn-back",onClick:U,children:" Back"}),s.jsx("h2",{children:" Admin Dashboard"})]}),s.jsxs("div",{className:"admin-password",id:"admin-password-gate",children:[s.jsx("span",{style:{fontSize:"4rem"},children:""}),s.jsx("h3",{children:"Admin Access Required"}),a?s.jsxs("p",{style:{color:"#10b981",fontSize:".85rem",marginBottom:8},children:[" Logged in as ",p?.email]}):s.jsxs("div",{style:{textAlign:"center"},children:[s.jsx("p",{style:{color:"rgba(255,255,255,0.6)",marginBottom:16,fontSize:".9rem"},children:"You must be logged in with an admin account to access the dashboard."}),s.jsx("button",{className:"btn btn-primary",onClick:l,style:{marginBottom:12},children:" Log In First"}),s.jsx("p",{style:{color:"rgba(255,255,255,0.35)",fontSize:".8rem"},children:"Then enter the admin password below."})]}),s.jsx("input",{className:"auth-input",placeholder:"Enter admin password",type:"password",style:{maxWidth:300},value:h,onChange:E=>b(E.target.value),onKeyDown:D}),z&&s.jsx("p",{style:{color:"var(--red)",fontSize:".85rem"},children:"Invalid password"}),s.jsx("button",{className:"btn btn-primary",onClick:I,children:"Access "})]})]})})}function By({onComplete:r}){const{state:a,setState:o,save:l}=lo(),[p,c]=_.useState(1),[g,h]=_.useState(""),[b,m]=_.useState(""),[v,z]=_.useState(!1),k=()=>{if(!g.trim()){z(!0);return}z(!1),c(2)},S=()=>{c(1)},j=()=>{const R=g.trim();R&&(o&&o(I=>({...I,name:R,parentEmail:b.trim()||I.parentEmail})),l&&l(),r&&r(R,b.trim()))};return s.jsx("div",{id:"onboarding",className:"show",style:{position:"fixed",inset:0,zIndex:1e4,background:"rgba(5,5,16,0.95)",backdropFilter:"blur(20px)",display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"},children:s.jsxs("div",{className:"wizard-card glass",style:{maxWidth:"500px",width:"100%",padding:"40px",textAlign:"center"},children:[p===1&&s.jsxs("div",{children:[s.jsx("span",{style:{fontSize:"4rem",display:"block",marginBottom:"16px"},children:""}),s.jsx("h2",{children:"Welcome to NextGen School!"}),s.jsx("p",{style:{color:"var(--text2)",marginBottom:"24px"},children:"Ready to explore AI, space, and robotics? Let's set up your profile!"}),s.jsx("input",{className:"wizard-input",placeholder:"What's your name, explorer?",maxLength:20,value:g,onChange:R=>{h(R.target.value),z(!1)},style:v?{borderColor:"var(--red)"}:{}}),s.jsxs("div",{className:"wizard-dots",children:[s.jsx("span",{className:"wizard-dot active"}),s.jsx("span",{className:"wizard-dot"})]}),s.jsx("button",{className:"btn btn-primary",onClick:k,style:{width:"100%"},children:"Next "})]}),p===2&&s.jsxs("div",{children:[s.jsx("span",{style:{fontSize:"4rem",display:"block",marginBottom:"16px"},children:""}),s.jsx("h2",{children:"Parent's Email (Optional)"}),s.jsx("p",{style:{color:"var(--text2)",marginBottom:"24px"},children:"We'll send progress reports and certificates to your parent!"}),s.jsx("input",{className:"wizard-input",placeholder:"parent@email.com",type:"email",value:b,onChange:R=>m(R.target.value)}),s.jsxs("div",{className:"wizard-dots",children:[s.jsx("span",{className:"wizard-dot"}),s.jsx("span",{className:"wizard-dot active"})]}),s.jsx("button",{className:"btn btn-primary",onClick:j,style:{width:"100%"},children:"Let's Go! "}),s.jsx("button",{className:"btn btn-back",onClick:S,style:{width:"100%",marginTop:"8px"},children:" Back"})]})]})})}function Iy(){const{authModalType:r,closeAuthModal:a,openAuthModal:o,doSignup:l,doLogin:p,doChildLogin:c,doGoogleLogin:g,enableDemoMode:h,resetPassword:b}=ji(),[m,v]=_.useState("parent"),[z,k]=_.useState({name:"",email:"",password:"",childName:"",childAge:"",childPin:""}),[S,j]=_.useState({email:"",password:""}),[R,I]=_.useState(""),[D,U]=_.useState(""),[B,E]=_.useState(""),[N,M]=_.useState(!1),[y,O]=_.useState(!1),[$,ee]=_.useState(""),[J,Q]=_.useState(!1),re=_.useCallback(()=>{E(""),I(""),v("parent"),M(!1),O(!1),Q(!1),ee("")},[]);if(!r)return null;const Z=()=>{re(),a()};if(r==="signup"){const se=async()=>{E("");const{name:w,email:C,password:ne,childName:F,childAge:q,childPin:H}=z;if(!w||!C||!ne){E("Please fill in all required fields");return}if(ne.length<6){E("Password must be at least 6 characters");return}M(!0);try{await l({name:w,email:C,password:ne,childName:F,childAge:q,childPin:H}),Z()}catch(oe){E(oe.message||"Signup failed")}finally{M(!1)}};return s.jsx("div",{className:"auth-overlay show",onClick:w=>w.target===w.currentTarget&&Z(),children:s.jsxs("div",{className:"auth-modal",children:[s.jsx("button",{className:"close-btn",onClick:Z,children:""}),s.jsx("span",{style:{fontSize:"3rem",display:"block",textAlign:"center",marginBottom:"8px"},children:""}),s.jsx("h2",{children:"Create Parent Account"}),s.jsx("p",{style:{textAlign:"center",color:"var(--text2)",marginBottom:"24px",fontSize:".95rem"},children:"Set up your family's learning journey"}),B&&s.jsx("div",{className:"auth-error",style:{display:"block"},children:B}),s.jsx("input",{className:"auth-input",placeholder:"Your full name *",maxLength:50,value:z.name,onChange:w=>k(C=>({...C,name:w.target.value})),onKeyDown:w=>w.key==="Enter"&&se()}),s.jsx("input",{className:"auth-input",placeholder:"Email address *",type:"email",value:z.email,onChange:w=>k(C=>({...C,email:w.target.value})),onKeyDown:w=>w.key==="Enter"&&se()}),s.jsx("input",{className:"auth-input",placeholder:"Password (min 6 chars) *",type:"password",value:z.password,onChange:w=>k(C=>({...C,password:w.target.value})),onKeyDown:w=>w.key==="Enter"&&se()}),s.jsx("div",{style:{borderTop:"1px solid rgba(255,255,255,0.08)",margin:"16px 0",paddingTop:"12px"},children:s.jsx("p",{style:{fontSize:".85rem",color:"var(--text3)",marginBottom:"8px"},children:"Optional: Add your child"})}),s.jsx("input",{className:"auth-input",placeholder:"Child's name",value:z.childName,onChange:w=>k(C=>({...C,childName:w.target.value}))}),s.jsx("input",{className:"auth-input",placeholder:"Child's age (9-13)",type:"number",min:9,max:13,value:z.childAge,onChange:w=>k(C=>({...C,childAge:w.target.value}))}),s.jsx("input",{className:"auth-input",placeholder:"Child's 4-digit PIN",type:"password",maxLength:4,value:z.childPin,onChange:w=>k(C=>({...C,childPin:w.target.value.replace(/\D/g,"")}))}),s.jsx("button",{className:"btn btn-primary",onClick:se,disabled:N,style:{width:"100%"},children:N?s.jsx("span",{className:"auth-spinner"}):"Create Account "}),s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",margin:"16px 0"},children:[s.jsx("div",{style:{flex:1,height:"1px",background:"rgba(255,255,255,0.1)"}}),s.jsx("span",{style:{color:"var(--text3)",fontSize:".85rem"},children:"or"}),s.jsx("div",{style:{flex:1,height:"1px",background:"rgba(255,255,255,0.1)"}})]}),s.jsxs("button",{className:"btn btn-google",onClick:async()=>{try{await g()}catch(w){E(w.message)}},style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",background:"rgba(255,255,255,0.08)",border:"1px solid rgba(255,255,255,0.12)",color:"#fff",padding:"12px",borderRadius:"12px",cursor:"pointer",fontSize:".95rem"},children:[s.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 48 48",children:[s.jsx("path",{fill:"#EA4335",d:"M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"}),s.jsx("path",{fill:"#4285F4",d:"M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"}),s.jsx("path",{fill:"#34A853",d:"M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"}),s.jsx("path",{fill:"#FBBC05",d:"M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"})]}),"Continue with Google"]}),s.jsxs("div",{className:"auth-switch",children:["Already have an account? ",s.jsx("a",{onClick:()=>{re(),o("login")},children:"Log in"})]})]})})}if(r==="login"){const se=async()=>{if(E(""),!S.email||!S.password){E("Please fill in all fields");return}M(!0);try{await p(S.email,S.password),Z()}catch(q){E(q.message||"Login failed")}finally{M(!1)}},w=q=>{if(R.length>=4)return;const H=R+q;I(H),H.length===4&&setTimeout(async()=>{E(""),M(!0);try{await c(H,D),Z()}catch(oe){E(oe.message||"Invalid PIN"),I("")}finally{M(!1)}},200)},C=()=>I(q=>q.slice(0,-1)),ne=async()=>{if(!$){E("Please enter your email");return}M(!0),E("");try{const q=await b($);q.error?E(q.error):Q(!0)}catch(q){E(q.message||"Failed to send reset email")}finally{M(!1)}},F=()=>{h&&h(),Z()};return y?s.jsx("div",{className:"auth-overlay show",onClick:q=>q.target===q.currentTarget&&Z(),children:s.jsxs("div",{className:"auth-modal",children:[s.jsx("button",{className:"close-btn",onClick:Z,children:""}),s.jsx("span",{style:{fontSize:"3rem",display:"block",textAlign:"center",marginBottom:"8px"},children:""}),s.jsx("h2",{children:"Reset Password"}),J?s.jsxs("div",{style:{textAlign:"center",padding:"20px 0"},children:[s.jsx("p",{style:{color:"var(--green)",marginBottom:"16px"},children:" Reset link sent! Check your email."}),s.jsx("button",{className:"btn btn-back",onClick:()=>{O(!1),Q(!1)},children:" Back to Login"})]}):s.jsxs(s.Fragment,{children:[s.jsx("p",{style:{textAlign:"center",color:"var(--text2)",marginBottom:"24px",fontSize:".95rem"},children:"Enter your email and we'll send a reset link"}),B&&s.jsx("div",{className:"auth-error",style:{display:"block"},children:B}),s.jsx("input",{className:"auth-input",placeholder:"Email address",type:"email",value:$,onChange:q=>ee(q.target.value),onKeyDown:q=>q.key==="Enter"&&ne()}),s.jsx("button",{className:"btn btn-primary",onClick:ne,disabled:N,style:{width:"100%"},children:N?s.jsx("span",{className:"auth-spinner"}):"Send Reset Link"}),s.jsx("div",{className:"auth-switch",children:s.jsx("a",{onClick:()=>{O(!1),E("")},children:" Back to Login"})})]})]})}):s.jsx("div",{className:"auth-overlay show",onClick:q=>q.target===q.currentTarget&&Z(),children:s.jsxs("div",{className:"auth-modal",children:[s.jsx("button",{className:"close-btn",onClick:Z,children:""}),s.jsx("span",{style:{fontSize:"3rem",display:"block",textAlign:"center",marginBottom:"8px"},children:""}),s.jsx("h2",{children:"Welcome Back"}),s.jsx("p",{style:{textAlign:"center",color:"var(--text2)",marginBottom:"24px",fontSize:".95rem"},children:"Log in to your account"}),s.jsxs("div",{className:"auth-tabs",children:[s.jsx("button",{className:`auth-tab${m==="parent"?" active":""}`,onClick:()=>{v("parent"),E("")},children:" Parent"}),s.jsx("button",{className:`auth-tab${m==="child"?" active":""}`,onClick:()=>{v("child"),E(""),I("")},children:" Child PIN"})]}),B&&s.jsx("div",{className:"auth-error",style:{display:"block"},children:B}),m==="parent"&&s.jsxs("div",{children:[s.jsx("input",{className:"auth-input",placeholder:"Email address",type:"email",value:S.email,onChange:q=>j(H=>({...H,email:q.target.value})),onKeyDown:q=>q.key==="Enter"&&se()}),s.jsx("input",{className:"auth-input",placeholder:"Password",type:"password",value:S.password,onChange:q=>j(H=>({...H,password:q.target.value})),onKeyDown:q=>q.key==="Enter"&&se()}),s.jsx("button",{className:"btn btn-primary",onClick:se,disabled:N,style:{width:"100%"},children:N?s.jsx("span",{className:"auth-spinner"}):"Log In "}),s.jsx("div",{style:{textAlign:"center",marginTop:"12px"},children:s.jsx("a",{onClick:()=>{O(!0),E(""),ee(S.email)},style:{color:"var(--cyan)",cursor:"pointer",fontSize:".85rem"},children:"Forgot password?"})}),s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",margin:"16px 0"},children:[s.jsx("div",{style:{flex:1,height:"1px",background:"rgba(255,255,255,0.1)"}}),s.jsx("span",{style:{color:"var(--text3)",fontSize:".85rem"},children:"or"}),s.jsx("div",{style:{flex:1,height:"1px",background:"rgba(255,255,255,0.1)"}})]}),s.jsxs("button",{onClick:async()=>{try{await g()}catch(q){E(q.message)}},style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",background:"rgba(255,255,255,0.08)",border:"1px solid rgba(255,255,255,0.12)",color:"#fff",padding:"12px",borderRadius:"12px",cursor:"pointer",fontSize:".95rem"},children:[s.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 48 48",children:[s.jsx("path",{fill:"#EA4335",d:"M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"}),s.jsx("path",{fill:"#4285F4",d:"M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"}),s.jsx("path",{fill:"#34A853",d:"M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"}),s.jsx("path",{fill:"#FBBC05",d:"M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"})]}),"Continue with Google"]})]}),m==="child"&&s.jsxs("div",{children:[s.jsx("input",{type:"text",placeholder:"Your Name",value:D,onChange:q=>U(q.target.value),className:"auth-input",style:{marginBottom:12,textAlign:"center",fontSize:"1rem"},autoComplete:"off"}),s.jsx("p",{style:{textAlign:"center",color:"var(--text2)",fontSize:".9rem",marginBottom:"8px"},children:"Enter your 4-digit PIN"}),s.jsx("div",{className:"pin-dots",children:[0,1,2,3].map(q=>s.jsx("div",{className:`pin-dot${q<R.length?" filled":""}`},q))}),N&&s.jsx("div",{style:{textAlign:"center",margin:"8px 0"},children:s.jsx("span",{className:"auth-spinner"})}),s.jsxs("div",{className:"child-pin-grid",children:[[1,2,3,4,5,6,7,8,9].map(q=>s.jsx("button",{className:"child-pin-btn",onClick:()=>w(String(q)),disabled:N,children:q},q)),s.jsx("button",{className:"child-pin-btn",onClick:C,disabled:N,children:""}),s.jsx("button",{className:"child-pin-btn",onClick:()=>w("0"),disabled:N,children:"0"}),s.jsx("button",{className:"child-pin-btn",disabled:!0,style:{opacity:.3},children:""})]})]}),s.jsx("div",{style:{textAlign:"center",margin:"16px 0"},children:s.jsx("button",{className:"btn btn-back",onClick:F,style:{fontSize:".85rem"},children:" Try Demo Mode"})}),s.jsxs("div",{className:"auth-switch",children:["Don't have an account? ",s.jsx("a",{onClick:()=>{re(),o("signup")},children:"Sign up"})]})]})})}return null}const Ly=_.lazy(()=>Ze(()=>import("./MangalyaanLanding-MTEWPBW8.js"),__vite__mapDeps([5,3,1,6]))),Uy=_.lazy(()=>Ze(()=>import("./NasaLanding-D6S_1iwA.js"),__vite__mapDeps([7,3,1,6])));function qy(){const{state:r,setCurrentView:a,handlePurchase:o}=lo(),{isLoggedIn:l,currentUser:p}=ji();_.useEffect(()=>{const g=new URLSearchParams(window.location.search);if(g.get("payment")==="success"){const h=g.get("plan")||"fullAccess";localStorage.setItem("stripe_success",JSON.stringify({plan:h,ts:Date.now()})),window.history.replaceState({},"",window.location.pathname+window.location.hash)}},[]),_.useEffect(()=>{if(!p?.id)return;const g=localStorage.getItem("stripe_success");if(!g)return;let h;try{h=JSON.parse(g)}catch{return}if(Date.now()-h.ts>1800*1e3){localStorage.removeItem("stripe_success");return}const b=h.plan;localStorage.removeItem("stripe_success"),localStorage.removeItem("pending_payment"),(async()=>{try{const{supabaseAdmin:m,supabase:v}=await Ze(async()=>{const{supabaseAdmin:k,supabase:S}=await Promise.resolve().then(()=>Jf);return{supabaseAdmin:k,supabase:S}},void 0),z=m||v;if(z){await z.from("purchases").update({status:"completed"}).eq("user_id",p.id).eq("status","pending").eq("plan",b);const k=b==="fullAccess"||b==="familyPlan"?["ai","space","robotics","aiart"]:[localStorage.getItem("pending_course")||"ai"];for(const S of k){const{data:j}=await z.from("course_access").select("id").eq("user_id",p.id).eq("course_id",S).limit(1);(!j||j.length===0)&&await z.from("course_access").insert({user_id:p.id,course_id:S,granted_by:"stripe_payment",active:!0})}}}catch(m){console.error("Payment record error:",m)}o&&o(b),alert(" Payment successful! Your courses are now unlocked.")})()},[o,p?.id]),_.useEffect(()=>{function g(){const h=window.location.hash.replace("#","")||"home";["home","courses","badges","parent","admin","onboarding","mangalyaan-landing","nasa-landing"].includes(h)?a(h):a("home")}return g(),window.addEventListener("hashchange",g),()=>window.removeEventListener("hashchange",g)},[a]);const{currentView:c}=r;return s.jsxs(s.Fragment,{children:[s.jsx(Bx,{}),s.jsxs("div",{style:{display:"flex",minHeight:"100vh",overflow:"hidden",maxWidth:"100vw"},className:c==="admin"?"admin-active":"",children:[c!=="admin"&&c!=="mangalyaan-landing"&&c!=="nasa-landing"&&!(c==="courses"&&r.currentCourse)&&s.jsx(Lx,{}),s.jsxs("main",{className:"main-content",style:c==="admin"||c==="mangalyaan-landing"||c==="nasa-landing"||c==="courses"&&r.currentCourse?{marginLeft:0,width:"100%",maxWidth:"100%"}:void 0,children:[c==="home"&&s.jsx(mf,{}),c==="courses"&&r.currentCourse&&s.jsx(Xx,{courseId:r.currentCourse,initialChapter:r.currentChapter||0,user:p,onBack:()=>{window.location.hash="#home"}}),c==="courses"&&!r.currentCourse&&s.jsx(mf,{}),c==="badges"&&s.jsx(ny,{}),c==="parent"&&s.jsx(oy,{}),c==="admin"&&s.jsx(Dy,{}),c==="onboarding"&&s.jsx(By,{}),c==="mangalyaan-landing"&&s.jsx(_.Suspense,{fallback:s.jsx("div",{style:{background:"#0a0a1a",minHeight:"100vh"}}),children:s.jsx(Ly,{})}),c==="nasa-landing"&&s.jsx(_.Suspense,{fallback:s.jsx("div",{style:{background:"#0a0a1a",minHeight:"100vh"}}),children:s.jsx(Uy,{})})]})]}),s.jsx(Iy,{})]})}function Hy(){return s.jsx(Ox,{children:s.jsx(Dx,{children:s.jsx(qy,{})})})}_0.createRoot(document.getElementById("root")).render(s.jsx(_.StrictMode,{children:s.jsx(Hy,{})}));export{$e as a,S0 as r,Zi as s};
